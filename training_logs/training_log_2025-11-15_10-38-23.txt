[*] Load /home/manish/BrainTumorHFF/HFF/data/brats20/final/0-train.txt, which contains 295 paired volume
modilities: ['flair_L', 't1_L', 't1ce_L', 't2_L', 'flair_H1', 'flair_H2', 'flair_H3', 'flair_H4', 't1_H1', 't1_H2', 't1_H3', 't1_H4', 't1ce_H1', 't1ce_H2', 't1ce_H3', 't1ce_H4', 't2_H1', 't2_H2', 't2_H3', 't2_H4']
[*] Load /home/manish/BrainTumorHFF/HFF/data/brats20/final/0-val.txt, which contains 36 paired volume
modilities: ['flair_L', 't1_L', 't1ce_L', 't2_L', 'flair_H1', 'flair_H2', 'flair_H3', 'flair_H4', 't1_H1', 't1_H2', 't1_H3', 't1_H4', 't1ce_H1', 't1ce_H2', 't1ce_H3', 't1ce_H4', 't2_H1', 't2_H2', 't2_H3', 't2_H4']
[34m[1mwandb[0m: Currently logged in as: [33mk7aditya[0m ([33mk7aditya-iiita-alumni-affairs[0m) to [32mhttps://api.wandb.ai[0m. Use [1m`wandb login --relogin`[0m to force relogin
[34m[1mwandb[0m: setting up run 9ulapidc (0.0s)
[Am[2K[34m[1mwandb[0m: setting up run 9ulapidc (0.0s)
[Am[2K[34m[1mwandb[0m: setting up run 9ulapidc (0.0s)
[Am[2K[34m[1mwandb[0m: setting up run 9ulapidc (0.0s)
[Am[2K[34m[1mwandb[0m: setting up run 9ulapidc (0.0s)
[Am[2K[34m[1mwandb[0m: Tracking run with wandb version 0.22.3
[34m[1mwandb[0m: Run data is saved locally in [35m[1m/home/manish/BrainTumorHFF/HFF/wandb/run-20251115_103825-9ulapidc[0m
[34m[1mwandb[0m: Run [1m`wandb offline`[0m to turn off syncing.
[34m[1mwandb[0m: Syncing run [33mlogical-morning-40[0m
[34m[1mwandb[0m:  View project at [34m[4mhttps://wandb.ai/k7aditya-iiita-alumni-affairs/learning%20rate%3D0.3epochs%3D200-step_size%3D50-gamma%3D0.55weight%20between%20braches%3D15warmup%20epochs%3D3brats20_all[0m
[34m[1mwandb[0m:  View run at [34m[4mhttps://wandb.ai/k7aditya-iiita-alumni-affairs/learning%20rate%3D0.3epochs%3D200-step_size%3D50-gamma%3D0.55weight%20between%20braches%3D15warmup%20epochs%3D3brats20_all/runs/9ulapidc[0m
[LOAD] Loading from: /home/manish/BrainTumorHFF/HFF/result/checkpoints/hff/brats20/all/hff-l=0.3-e=200-s=50-g=0.55-b=1-cw=15-w=3-100L-H-2025-11-14_12-23-36/best_Result2_et_0.8317_tc_0.9095_wt_0.8975.pth
[LOAD] âœ“ Checkpoint loaded successfully
[*] Load /home/manish/BrainTumorHFF/HFF/data/brats20/final/0-train.txt, which contains 295 paired volume
modilities: ['flair_L', 't1_L', 't1ce_L', 't2_L', 'flair_H1', 'flair_H2', 'flair_H3', 'flair_H4', 't1_H1', 't1_H2', 't1_H3', 't1_H4', 't1ce_H1', 't1ce_H2', 't1ce_H3', 't1ce_H4', 't2_H1', 't2_H2', 't2_H3', 't2_H4']
[*] Load /home/manish/BrainTumorHFF/HFF/data/brats20/final/0-val.txt, which contains 36 paired volume
modilities: ['flair_L', 't1_L', 't1ce_L', 't2_L', 'flair_H1', 'flair_H2', 'flair_H3', 'flair_H4', 't1_H1', 't1_H2', 't1_H3', 't1_H4', 't1ce_H1', 't1ce_H2', 't1ce_H3', 't1ce_H4', 't2_H1', 't2_H2', 't2_H3', 't2_H4']
[LOAD] Loading from: /home/manish/BrainTumorHFF/HFF/result/checkpoints/hff/brats20/all/hff-l=0.3-e=200-s=50-g=0.55-b=1-cw=15-w=3-100L-H-2025-11-14_12-23-36/best_Result2_et_0.8317_tc_0.9095_wt_0.8975.pth
[LOAD] âœ“ Checkpoint loaded successfully
Set dropout rate to 0.5000 (18 layers)
Set dropout rate to 0.2000 (18 layers)
Epoch 182 - Dropout rate set to 0.1380
  0%|                                                                            | 0/74 [00:00<?, ?it/s]Set dropout rate to 0.5000 (18 layers)
Set dropout rate to 0.2000 (18 layers)
  1%|9                                                                   | 1/74 [00:10<13:13, 10.86s/it]  3%|#8                                                                  | 2/74 [00:11<05:57,  4.97s/it]  4%|##7                                                                 | 3/74 [00:13<04:20,  3.67s/it]  5%|###6                                                                | 4/74 [00:14<02:57,  2.53s/it]  7%|####5                                                               | 5/74 [00:19<03:52,  3.37s/it]  8%|#####5                                                              | 6/74 [00:20<02:49,  2.49s/it]  9%|######4                                                             | 7/74 [00:24<03:29,  3.12s/it] 11%|#######3                                                            | 8/74 [00:25<02:39,  2.42s/it] 12%|########2                                                           | 9/74 [00:30<03:26,  3.17s/it] 14%|#########                                                          | 10/74 [00:31<02:36,  2.44s/it] 15%|#########9                                                         | 11/74 [00:35<03:16,  3.12s/it] 16%|##########8                                                        | 12/74 [00:36<02:30,  2.42s/it] 18%|###########7                                                       | 13/74 [00:41<03:05,  3.04s/it] 19%|############6                                                      | 14/74 [00:41<02:21,  2.36s/it] 20%|#############5                                                     | 15/74 [00:46<03:04,  3.13s/it] 22%|##############4                                                    | 16/74 [00:47<02:21,  2.44s/it] 23%|###############3                                                   | 17/74 [00:51<02:41,  2.83s/it] 24%|################2                                                  | 18/74 [00:52<02:05,  2.24s/it] 26%|#################2                                                 | 19/74 [00:56<02:41,  2.94s/it] 27%|##################1                                                | 20/74 [00:57<02:06,  2.34s/it] 28%|###################                                                | 21/74 [01:01<02:29,  2.81s/it] 30%|###################9                                               | 22/74 [01:02<01:58,  2.28s/it] 31%|####################8                                              | 23/74 [01:06<02:19,  2.73s/it] 32%|#####################7                                             | 24/74 [01:08<01:57,  2.35s/it] 34%|######################6                                            | 25/74 [01:11<02:15,  2.77s/it] 35%|#######################5                                           | 26/74 [01:13<01:58,  2.47s/it] 36%|########################4                                          | 27/74 [01:16<02:09,  2.76s/it] 38%|#########################3                                         | 28/74 [01:18<01:54,  2.48s/it] 39%|##########################2                                        | 29/74 [01:21<01:59,  2.66s/it] 41%|###########################1                                       | 30/74 [01:23<01:46,  2.43s/it] 42%|############################                                       | 31/74 [01:26<01:53,  2.64s/it] 43%|############################9                                      | 32/74 [01:29<01:45,  2.50s/it] 45%|#############################8                                     | 33/74 [01:32<01:53,  2.76s/it] 46%|##############################7                                    | 34/74 [01:34<01:44,  2.61s/it] 47%|###############################6                                   | 35/74 [01:37<01:49,  2.80s/it] 49%|################################5                                  | 36/74 [01:40<01:40,  2.65s/it] 50%|#################################5                                 | 37/74 [01:43<01:44,  2.83s/it] 51%|##################################4                                | 38/74 [01:45<01:37,  2.72s/it] 53%|###################################3                               | 39/74 [01:49<01:39,  2.83s/it] 54%|####################################2                              | 40/74 [01:52<01:37,  2.87s/it] 55%|#####################################1                             | 41/74 [01:54<01:28,  2.68s/it] 57%|######################################                             | 42/74 [01:57<01:32,  2.88s/it] 58%|######################################9                            | 43/74 [01:59<01:24,  2.71s/it] 59%|#######################################8                           | 44/74 [02:03<01:28,  2.96s/it] 61%|########################################7                          | 45/74 [02:05<01:16,  2.62s/it] 62%|#########################################6                         | 46/74 [02:08<01:19,  2.84s/it] 64%|##########################################5                        | 47/74 [02:10<01:10,  2.61s/it] 65%|###########################################4                       | 48/74 [02:14<01:14,  2.88s/it] 66%|############################################3                      | 49/74 [02:15<01:02,  2.49s/it] 68%|#############################################2                     | 50/74 [02:19<01:06,  2.77s/it] 69%|##############################################1                    | 51/74 [02:21<00:59,  2.59s/it] 70%|###############################################                    | 52/74 [02:24<01:02,  2.83s/it] 72%|###############################################9                   | 53/74 [02:26<00:52,  2.49s/it] 73%|################################################8                  | 54/74 [02:29<00:55,  2.79s/it] 74%|#################################################7                 | 55/74 [02:31<00:45,  2.39s/it] 76%|##################################################7                | 56/74 [02:34<00:49,  2.74s/it] 77%|###################################################6               | 57/74 [02:37<00:42,  2.53s/it] 78%|####################################################5              | 58/74 [02:40<00:45,  2.82s/it] 80%|#####################################################4             | 59/74 [02:41<00:36,  2.41s/it] 81%|######################################################3            | 60/74 [02:45<00:38,  2.75s/it] 82%|#######################################################2           | 61/74 [02:46<00:30,  2.36s/it] 84%|########################################################1          | 62/74 [02:50<00:32,  2.70s/it] 85%|#########################################################          | 63/74 [02:52<00:26,  2.39s/it] 86%|#########################################################9         | 64/74 [02:56<00:28,  2.88s/it] 88%|##########################################################8        | 65/74 [02:57<00:22,  2.45s/it] 89%|###########################################################7       | 66/74 [03:01<00:23,  2.92s/it] 91%|############################################################6      | 67/74 [03:02<00:16,  2.40s/it] 92%|#############################################################5     | 68/74 [03:06<00:16,  2.81s/it] 93%|##############################################################4    | 69/74 [03:07<00:11,  2.32s/it] 95%|###############################################################3   | 70/74 [03:11<00:11,  2.78s/it] 96%|################################################################2  | 71/74 [03:12<00:06,  2.30s/it] 97%|#################################################################1 | 72/74 [03:16<00:05,  2.72s/it] 99%|################################################################## | 73/74 [03:18<00:02,  2.55s/it]100%|###################################################################| 74/74 [03:22<00:00,  2.94s/it]100%|###################################################################| 74/74 [03:22<00:00,  2.74s/it]
===============================================================
| Epoch 182/200                                               |
---------------------------------------------------------------
| Train Sup Loss LF: 0.1782    | Train SUP Loss HF: 0.1995    |
| Train Unsup Loss: 0.0685     | Train Total Loss: 1.7986     |
---------------------------------------------------------------
  0%|                                                                             | 0/9 [00:00<?, ?it/s]Set dropout rate to 0.2000 (18 layers)
 11%|#######6                                                             | 1/9 [00:05<00:41,  5.14s/it] 22%|###############3                                                     | 2/9 [00:06<00:19,  2.72s/it] 33%|#######################                                              | 3/9 [00:08<00:15,  2.62s/it] 44%|##############################6                                      | 4/9 [00:09<00:09,  1.98s/it] 56%|######################################3                              | 5/9 [00:12<00:08,  2.16s/it] 67%|##############################################                       | 6/9 [00:13<00:05,  1.95s/it] 78%|#####################################################6               | 7/9 [00:15<00:03,  1.97s/it] 89%|#############################################################3       | 8/9 [00:17<00:01,  1.86s/it]100%|#####################################################################| 9/9 [00:19<00:00,  1.90s/it]100%|#####################################################################| 9/9 [00:19<00:00,  2.16s/it]
---------------------------------------------------------------
| Val Sup Loss LF: 0.2353      | Val Sup Loss HF: 0.2222      |
---------------------------------------------------------------
/home/manish/.conda/envs/hff-xai/lib/python3.10/site-packages/monai/metrics/utils.py:329: UserWarning: the ground truth of class 0 is all 0, this may result in nan/inf distance.
  warnings.warn(
| Val ET Dice LF: 0.8376       | Val ET Dice HF: 0.8320       |
| Val ET HD95 LF: nan          | Val ET HD95 HF: nan          |
| Val TC Dice LF: 0.8999       | Val TC Dice HF: 0.9098       |
| Val TC HD95 LF: 12.1584      | Val TC HD95 HF: 4.8313       |
| Val WT Dice LF: 0.8973       | Val WT Dice HF: 0.8970       |
| Val WT HD95 LF: 18.4270      | Val WT HD95 HF: 18.0619      |
---------------------------------------------------------------
| Epoch Time: 233.8955s                                       |
Set dropout rate to 0.2000 (18 layers)
Epoch 183 - Dropout rate set to 0.1360
  0%|                                                                            | 0/74 [00:00<?, ?it/s]  1%|9                                                                   | 1/74 [00:06<08:01,  6.59s/it]  3%|#8                                                                  | 2/74 [00:07<03:54,  3.26s/it]  4%|##7                                                                 | 3/74 [00:11<04:16,  3.61s/it]  5%|###6                                                                | 4/74 [00:12<03:00,  2.57s/it]  7%|####5                                                               | 5/74 [00:16<03:39,  3.18s/it]  8%|#####5                                                              | 6/74 [00:17<02:47,  2.46s/it]  9%|######4                                                             | 7/74 [00:22<03:30,  3.14s/it] 11%|#######3                                                            | 8/74 [00:23<02:42,  2.46s/it] 12%|########2                                                           | 9/74 [00:27<03:18,  3.05s/it] 14%|#########                                                          | 10/74 [00:28<02:35,  2.42s/it] 15%|#########9                                                         | 11/74 [00:32<02:55,  2.79s/it] 16%|##########8                                                        | 12/74 [00:33<02:16,  2.20s/it] 18%|###########7                                                       | 13/74 [00:37<02:53,  2.85s/it] 19%|############6                                                      | 14/74 [00:39<02:25,  2.42s/it] 20%|#############5                                                     | 15/74 [00:42<02:50,  2.89s/it] 22%|##############4                                                    | 16/74 [00:44<02:23,  2.47s/it] 23%|###############3                                                   | 17/74 [00:47<02:31,  2.67s/it] 24%|################2                                                  | 18/74 [00:49<02:12,  2.37s/it] 26%|#################2                                                 | 19/74 [00:52<02:32,  2.77s/it] 27%|##################1                                                | 20/74 [00:54<02:12,  2.45s/it] 28%|###################                                                | 21/74 [00:57<02:22,  2.70s/it] 30%|###################9                                               | 22/74 [00:59<02:03,  2.38s/it] 31%|####################8                                              | 23/74 [01:02<02:11,  2.58s/it] 32%|#####################7                                             | 24/74 [01:04<01:56,  2.33s/it] 34%|######################6                                            | 25/74 [01:07<02:12,  2.71s/it] 35%|#######################5                                           | 26/74 [01:09<01:55,  2.41s/it] 36%|########################4                                          | 27/74 [01:13<02:11,  2.81s/it] 38%|#########################3                                         | 28/74 [01:15<01:54,  2.50s/it] 39%|##########################2                                        | 29/74 [01:18<02:02,  2.72s/it] 41%|###########################1                                       | 30/74 [01:20<01:45,  2.40s/it] 42%|############################                                       | 31/74 [01:23<01:52,  2.61s/it] 43%|############################9                                      | 32/74 [01:24<01:37,  2.32s/it] 45%|#############################8                                     | 33/74 [01:28<01:51,  2.71s/it] 46%|##############################7                                    | 34/74 [01:30<01:35,  2.39s/it] 47%|###############################6                                   | 35/74 [01:33<01:47,  2.77s/it] 49%|################################5                                  | 36/74 [01:35<01:31,  2.42s/it] 50%|#################################5                                 | 37/74 [01:39<01:43,  2.79s/it] 51%|##################################4                                | 38/74 [01:40<01:28,  2.46s/it] 53%|###################################3                               | 39/74 [01:44<01:36,  2.77s/it] 54%|####################################2                              | 40/74 [01:46<01:25,  2.51s/it] 55%|#####################################1                             | 41/74 [01:49<01:28,  2.67s/it] 57%|######################################                             | 42/74 [01:51<01:19,  2.50s/it] 58%|######################################9                            | 43/74 [01:54<01:23,  2.70s/it] 59%|#######################################8                           | 44/74 [01:56<01:16,  2.56s/it] 61%|########################################7                          | 45/74 [01:59<01:16,  2.63s/it] 62%|#########################################6                         | 46/74 [02:01<01:10,  2.53s/it] 64%|##########################################5                        | 47/74 [02:04<01:12,  2.69s/it] 65%|###########################################4                       | 48/74 [02:07<01:07,  2.60s/it] 66%|############################################3                      | 49/74 [02:09<01:02,  2.51s/it] 68%|#############################################2                     | 50/74 [02:12<01:01,  2.54s/it] 69%|##############################################1                    | 51/74 [02:14<00:59,  2.57s/it] 70%|###############################################                    | 52/74 [02:17<00:58,  2.67s/it] 72%|###############################################9                   | 53/74 [02:19<00:53,  2.55s/it] 73%|################################################8                  | 54/74 [02:22<00:53,  2.67s/it] 74%|#################################################7                 | 55/74 [02:24<00:47,  2.49s/it] 76%|##################################################7                | 56/74 [02:27<00:47,  2.65s/it] 77%|###################################################6               | 57/74 [02:30<00:44,  2.61s/it] 78%|####################################################5              | 58/74 [02:34<00:48,  3.04s/it] 80%|#####################################################4             | 59/74 [02:35<00:37,  2.47s/it] 81%|######################################################3            | 60/74 [02:39<00:42,  3.02s/it] 82%|#######################################################2           | 61/74 [02:41<00:31,  2.44s/it] 84%|########################################################1          | 62/74 [02:45<00:36,  3.03s/it] 85%|#########################################################          | 63/74 [02:46<00:27,  2.47s/it] 86%|#########################################################9         | 64/74 [02:50<00:29,  2.99s/it] 88%|##########################################################8        | 65/74 [02:51<00:21,  2.41s/it] 89%|###########################################################7       | 66/74 [02:56<00:23,  2.93s/it] 91%|############################################################6      | 67/74 [02:57<00:16,  2.35s/it] 92%|#############################################################5     | 68/74 [03:00<00:16,  2.81s/it] 93%|##############################################################4    | 69/74 [03:01<00:11,  2.27s/it] 95%|###############################################################3   | 70/74 [03:06<00:11,  2.81s/it] 96%|################################################################2  | 71/74 [03:07<00:06,  2.27s/it] 97%|#################################################################1 | 72/74 [03:10<00:05,  2.76s/it] 99%|################################################################## | 73/74 [03:12<00:02,  2.36s/it]100%|###################################################################| 74/74 [03:16<00:00,  2.78s/it]100%|###################################################################| 74/74 [03:16<00:00,  2.65s/it]
Set dropout rate to 0.2000 (18 layers)
===============================================================
| Epoch 183/200                                               |
---------------------------------------------------------------
| Train Sup Loss LF: 0.2205    | Train SUP Loss HF: 0.2993    |
| Train Unsup Loss: 1.3767     | Train Total Loss: 3.2762     |
---------------------------------------------------------------
  0%|                                                                             | 0/9 [00:00<?, ?it/s] 11%|#######6                                                             | 1/9 [00:05<00:45,  5.68s/it] 22%|###############3                                                     | 2/9 [00:06<00:19,  2.80s/it] 33%|#######################                                              | 3/9 [00:09<00:16,  2.70s/it] 44%|##############################6                                      | 4/9 [00:09<00:09,  1.94s/it] 56%|######################################3                              | 5/9 [00:12<00:08,  2.22s/it] 67%|##############################################                       | 6/9 [00:13<00:05,  1.87s/it] 78%|#####################################################6               | 7/9 [00:16<00:04,  2.09s/it] 89%|#############################################################3       | 8/9 [00:17<00:01,  1.74s/it]100%|#####################################################################| 9/9 [00:19<00:00,  1.85s/it]100%|#####################################################################| 9/9 [00:19<00:00,  2.18s/it]
---------------------------------------------------------------
| Val Sup Loss LF: 0.2576      | Val Sup Loss HF: 0.2420      |
---------------------------------------------------------------
/home/manish/.conda/envs/hff-xai/lib/python3.10/site-packages/monai/metrics/utils.py:334: UserWarning: the prediction of class 0 is all 0, this may result in nan/inf distance.
  warnings.warn(
| Val ET Dice LF: 0.8231       | Val ET Dice HF: 0.8289       |
| Val ET HD95 LF: nan          | Val ET HD95 HF: nan          |
| Val TC Dice LF: 0.8734       | Val TC Dice HF: 0.8966       |
| Val TC HD95 LF: 14.5548      | Val TC HD95 HF: 5.4852       |
| Val WT Dice LF: 0.8829       | Val WT Dice HF: 0.8890       |
| Val WT HD95 LF: 19.3919      | Val WT HD95 HF: 12.1686      |
---------------------------------------------------------------
| Epoch Time: 228.2393s                                       |
Set dropout rate to 0.2000 (18 layers)
Epoch 184 - Dropout rate set to 0.1340
  0%|                                                                            | 0/74 [00:00<?, ?it/s]  0%|                                                                            | 0/74 [00:13<?, ?it/s]
Traceback (most recent call last):
  File "/home/manish/BrainTumorHFF/HFF/train_multiGPU_fix.py", line 471, in <module>
    outputs_train_1, outputs_train_2,side1,side2 = model(low_freq_inputs, high_freq_inputs)
  File "/home/manish/.conda/envs/hff-xai/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1501, in _call_impl
    return forward_call(*args, **kwargs)
  File "/home/manish/.conda/envs/hff-xai/lib/python3.10/site-packages/torch/nn/parallel/distributed.py", line 1156, in forward
    output = self._run_ddp_forward(*inputs, **kwargs)
  File "/home/manish/.conda/envs/hff-xai/lib/python3.10/site-packages/torch/nn/parallel/distributed.py", line 1110, in _run_ddp_forward
    return module_to_run(*inputs[0], **kwargs[0])  # type: ignore[index]
  File "/home/manish/.conda/envs/hff-xai/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1501, in _call_impl
    return forward_call(*args, **kwargs)
  File "/home/manish/BrainTumorHFF/HFF/model/HFF_MobileNetV3_fixed.py", line 438, in forward
    layer1_LF, layer2_LF, layer3_LF, layer4_LF_1, layer5_LF_1 = self.mobilenet_encoder_b1(input1)
  File "/home/manish/.conda/envs/hff-xai/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1501, in _call_impl
    return forward_call(*args, **kwargs)
  File "/home/manish/BrainTumorHFF/HFF/model/HFF_MobileNetV3_fixed.py", line 103, in forward
    x = self.stem(x)
  File "/home/manish/.conda/envs/hff-xai/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1501, in _call_impl
    return forward_call(*args, **kwargs)
  File "/home/manish/.conda/envs/hff-xai/lib/python3.10/site-packages/torch/nn/modules/container.py", line 217, in forward
    input = module(input)
  File "/home/manish/.conda/envs/hff-xai/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1501, in _call_impl
    return forward_call(*args, **kwargs)
  File "/home/manish/BrainTumorHFF/HFF/model/HFF_MobileNetV3_fixed.py", line 26, in forward
    return x * F.relu6(x + 3., inplace=self.inplace) / 6.
torch.cuda.OutOfMemoryError: CUDA out of memory. Tried to allocate 128.00 MiB (GPU 0; 23.70 GiB total capacity; 889.01 MiB already allocated; 35.56 MiB free; 1.04 GiB reserved in total by PyTorch) If reserved memory is >> allocated memory try setting max_split_size_mb to avoid fragmentation.  See documentation for Memory Management and PYTORCH_CUDA_ALLOC_CONF
