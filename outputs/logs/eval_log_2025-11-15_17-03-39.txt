
======================================================================
HFF-NET EVALUATION WITH METRICS
======================================================================
Log file: ./outputs/logs/eval_log_2025-11-15_17-03-39.txt
Checkpoint: /home/manish/BrainTumorHFF/HFF/result/checkpoints/hff/brats20/all/hff-l=0.3-e=200-s=50-g=0.55-b=1-cw=15-w=3-100L-H-2025-11-14_12-23-36/best_Result2_et_0.8320_tc_0.9098_wt_0.8970.pth
Output directory: ./outputs

[Loading] Model...

[LOADING CHECKPOINT]
Path: /home/manish/BrainTumorHFF/HFF/result/checkpoints/hff/brats20/all/hff-l=0.3-e=200-s=50-g=0.55-b=1-cw=15-w=3-100L-H-2025-11-14_12-23-36/best_Result2_et_0.8320_tc_0.9098_wt_0.8970.pth
Device: cuda
======================================================================
Loading checkpoint from disk...
✓ Checkpoint loaded to CPU

[STEP 1] Identifying checkpoint format...
Checkpoint is a dict with keys: ['module.laplacian_target', 'module.input_ed.conv.weight', 'module.LF_l4_FDCA.semantic_att.linear.0.weight', 'module.LF_l4_FDCA.semantic_att.linear.0.bias', 'module.LF_l4_FDCA.semantic_att.linear.2.weight', 'module.LF_l4_FDCA.semantic_att.linear.2.bias', 'module.LF_l4_FDCA.positional_att.conv.weight', 'module.LF_l4_FDCA.positional_att.conv.bias', 'module.LF_l4_FDCA.slice_att.linear.0.weight', 'module.LF_l4_FDCA.slice_att.linear.0.bias', 'module.LF_l4_FDCA.slice_att.linear.2.weight', 'module.LF_l4_FDCA.slice_att.linear.2.bias', 'module.LF_l4_FDCA.slice_att.mean.weight', 'module.LF_l4_FDCA.slice_att.mean.bias', 'module.LF_l4_FDCA.slice_att.log_diag.weight', 'module.LF_l4_FDCA.slice_att.log_diag.bias', 'module.LF_l4_FDCA.slice_att.factor.weight', 'module.LF_l4_FDCA.slice_att.factor.bias', 'module.LF_l5_FDCA.semantic_att.linear.0.weight', 'module.LF_l5_FDCA.semantic_att.linear.0.bias', 'module.LF_l5_FDCA.semantic_att.linear.2.weight', 'module.LF_l5_FDCA.semantic_att.linear.2.bias', 'module.LF_l5_FDCA.positional_att.conv.weight', 'module.LF_l5_FDCA.positional_att.conv.bias', 'module.LF_l5_FDCA.slice_att.linear.0.weight', 'module.LF_l5_FDCA.slice_att.linear.0.bias', 'module.LF_l5_FDCA.slice_att.linear.2.weight', 'module.LF_l5_FDCA.slice_att.linear.2.bias', 'module.LF_l5_FDCA.slice_att.mean.weight', 'module.LF_l5_FDCA.slice_att.mean.bias', 'module.LF_l5_FDCA.slice_att.log_diag.weight', 'module.LF_l5_FDCA.slice_att.log_diag.bias', 'module.LF_l5_FDCA.slice_att.factor.weight', 'module.LF_l5_FDCA.slice_att.factor.bias', 'module.HF_l4_FDCA.semantic_att.linear.0.weight', 'module.HF_l4_FDCA.semantic_att.linear.0.bias', 'module.HF_l4_FDCA.semantic_att.linear.2.weight', 'module.HF_l4_FDCA.semantic_att.linear.2.bias', 'module.HF_l4_FDCA.positional_att.conv.weight', 'module.HF_l4_FDCA.positional_att.conv.bias', 'module.HF_l4_FDCA.slice_att.linear.0.weight', 'module.HF_l4_FDCA.slice_att.linear.0.bias', 'module.HF_l4_FDCA.slice_att.linear.2.weight', 'module.HF_l4_FDCA.slice_att.linear.2.bias', 'module.HF_l4_FDCA.slice_att.mean.weight', 'module.HF_l4_FDCA.slice_att.mean.bias', 'module.HF_l4_FDCA.slice_att.log_diag.weight', 'module.HF_l4_FDCA.slice_att.log_diag.bias', 'module.HF_l4_FDCA.slice_att.factor.weight', 'module.HF_l4_FDCA.slice_att.factor.bias', 'module.HF_l5_FDCA.semantic_att.linear.0.weight', 'module.HF_l5_FDCA.semantic_att.linear.0.bias', 'module.HF_l5_FDCA.semantic_att.linear.2.weight', 'module.HF_l5_FDCA.semantic_att.linear.2.bias', 'module.HF_l5_FDCA.positional_att.conv.weight', 'module.HF_l5_FDCA.positional_att.conv.bias', 'module.HF_l5_FDCA.slice_att.linear.0.weight', 'module.HF_l5_FDCA.slice_att.linear.0.bias', 'module.HF_l5_FDCA.slice_att.linear.2.weight', 'module.HF_l5_FDCA.slice_att.linear.2.bias', 'module.HF_l5_FDCA.slice_att.mean.weight', 'module.HF_l5_FDCA.slice_att.mean.bias', 'module.HF_l5_FDCA.slice_att.log_diag.weight', 'module.HF_l5_FDCA.slice_att.log_diag.bias', 'module.HF_l5_FDCA.slice_att.factor.weight', 'module.HF_l5_FDCA.slice_att.factor.bias', 'module.mobilenet_encoder_b1.stem.0.weight', 'module.mobilenet_encoder_b1.enc1.conv.0.weight', 'module.mobilenet_encoder_b1.enc1.conv.3.fc1.weight', 'module.mobilenet_encoder_b1.enc1.conv.3.fc1.bias', 'module.mobilenet_encoder_b1.enc1.conv.3.fc2.weight', 'module.mobilenet_encoder_b1.enc1.conv.3.fc2.bias', 'module.mobilenet_encoder_b1.enc1.conv.4.weight', 'module.mobilenet_encoder_b1.enc2.conv.0.weight', 'module.mobilenet_encoder_b1.enc2.conv.3.weight', 'module.mobilenet_encoder_b1.enc2.conv.6.weight', 'module.mobilenet_encoder_b1.enc3.conv.0.weight', 'module.mobilenet_encoder_b1.enc3.conv.3.weight', 'module.mobilenet_encoder_b1.enc3.conv.6.fc1.weight', 'module.mobilenet_encoder_b1.enc3.conv.6.fc1.bias', 'module.mobilenet_encoder_b1.enc3.conv.6.fc2.weight', 'module.mobilenet_encoder_b1.enc3.conv.6.fc2.bias', 'module.mobilenet_encoder_b1.enc3.conv.7.weight', 'module.mobilenet_encoder_b1.enc4.conv.0.weight', 'module.mobilenet_encoder_b1.enc4.conv.3.weight', 'module.mobilenet_encoder_b1.enc4.conv.6.fc1.weight', 'module.mobilenet_encoder_b1.enc4.conv.6.fc1.bias', 'module.mobilenet_encoder_b1.enc4.conv.6.fc2.weight', 'module.mobilenet_encoder_b1.enc4.conv.6.fc2.bias', 'module.mobilenet_encoder_b1.enc4.conv.7.weight', 'module.mobilenet_encoder_b1.enc5.conv.0.weight', 'module.mobilenet_encoder_b1.enc5.conv.3.weight', 'module.mobilenet_encoder_b1.enc5.conv.6.fc1.weight', 'module.mobilenet_encoder_b1.enc5.conv.6.fc1.bias', 'module.mobilenet_encoder_b1.enc5.conv.6.fc2.weight', 'module.mobilenet_encoder_b1.enc5.conv.6.fc2.bias', 'module.mobilenet_encoder_b1.enc5.conv.7.weight', 'module.mobilenet_encoder_b2.stem.0.weight', 'module.mobilenet_encoder_b2.enc1.conv.0.weight', 'module.mobilenet_encoder_b2.enc1.conv.3.fc1.weight', 'module.mobilenet_encoder_b2.enc1.conv.3.fc1.bias', 'module.mobilenet_encoder_b2.enc1.conv.3.fc2.weight', 'module.mobilenet_encoder_b2.enc1.conv.3.fc2.bias', 'module.mobilenet_encoder_b2.enc1.conv.4.weight', 'module.mobilenet_encoder_b2.enc2.conv.0.weight', 'module.mobilenet_encoder_b2.enc2.conv.3.weight', 'module.mobilenet_encoder_b2.enc2.conv.6.weight', 'module.mobilenet_encoder_b2.enc3.conv.0.weight', 'module.mobilenet_encoder_b2.enc3.conv.3.weight', 'module.mobilenet_encoder_b2.enc3.conv.6.fc1.weight', 'module.mobilenet_encoder_b2.enc3.conv.6.fc1.bias', 'module.mobilenet_encoder_b2.enc3.conv.6.fc2.weight', 'module.mobilenet_encoder_b2.enc3.conv.6.fc2.bias', 'module.mobilenet_encoder_b2.enc3.conv.7.weight', 'module.mobilenet_encoder_b2.enc4.conv.0.weight', 'module.mobilenet_encoder_b2.enc4.conv.3.weight', 'module.mobilenet_encoder_b2.enc4.conv.6.fc1.weight', 'module.mobilenet_encoder_b2.enc4.conv.6.fc1.bias', 'module.mobilenet_encoder_b2.enc4.conv.6.fc2.weight', 'module.mobilenet_encoder_b2.enc4.conv.6.fc2.bias', 'module.mobilenet_encoder_b2.enc4.conv.7.weight', 'module.mobilenet_encoder_b2.enc5.conv.0.weight', 'module.mobilenet_encoder_b2.enc5.conv.3.weight', 'module.mobilenet_encoder_b2.enc5.conv.6.fc1.weight', 'module.mobilenet_encoder_b2.enc5.conv.6.fc1.bias', 'module.mobilenet_encoder_b2.enc5.conv.6.fc2.weight', 'module.mobilenet_encoder_b2.enc5.conv.6.fc2.bias', 'module.mobilenet_encoder_b2.enc5.conv.7.weight', 'module.x1_3side.up.1.weight', 'module.x1_3side.up.1.bias', 'module.x1_3side.up.4.weight', 'module.x1_3side.up.4.bias', 'module.x1_3side.up.7.weight', 'module.x1_3side.up.7.bias', 'module.x2_3side.up.1.weight', 'module.x2_3side.up.1.bias', 'module.x2_3side.up.4.weight', 'module.x2_3side.up.4.bias', 'module.x2_3side.up.7.weight', 'module.x2_3side.up.7.bias', 'module.l4_b1_t.transition.0.weight', 'module.l4_b2_t.transition.0.weight', 'module.l5_b1_t.transition.0.weight', 'module.l5_b2_t.transition.0.weight', 'module.l4_b1_2.conv.0.weight', 'module.l4_b1_2.conv.3.weight', 'module.l4_b1_2.conv.6.fc1.weight', 'module.l4_b1_2.conv.6.fc1.bias', 'module.l4_b1_2.conv.6.fc2.weight', 'module.l4_b1_2.conv.6.fc2.bias', 'module.l4_b1_2.conv.7.weight', 'module.l4_b1_d2.down.0.weight', 'module.l4_b1_s.same.0.weight', 'module.l4_b1_3.conv.0.weight', 'module.l4_b1_3.conv.3.weight', 'module.l4_b1_3.conv.6.fc1.weight', 'module.l4_b1_3.conv.6.fc1.bias', 'module.l4_b1_3.conv.6.fc2.weight', 'module.l4_b1_3.conv.6.fc2.bias', 'module.l4_b1_3.conv.7.weight', 'module.l4_b1_4.conv1.weight', 'module.l4_b1_4.conv2.weight', 'module.l4_b1_4.downsample.0.weight', 'module.l4_b1_u.up.1.weight', 'module.l4_b1_u.up.1.bias', 'module.l5_b1_1.conv.0.weight', 'module.l5_b1_1.conv.3.weight', 'module.l5_b1_1.conv.6.fc1.weight', 'module.l5_b1_1.conv.6.fc1.bias', 'module.l5_b1_1.conv.6.fc2.weight', 'module.l5_b1_1.conv.6.fc2.bias', 'module.l5_b1_1.conv.7.weight', 'module.l5_b1_u.up.1.weight', 'module.l5_b1_u.up.1.bias', 'module.l5_b1_s.same.0.weight', 'module.l5_b1_2.conv.0.weight', 'module.l5_b1_2.conv.3.weight', 'module.l5_b1_2.conv.6.fc1.weight', 'module.l5_b1_2.conv.6.fc1.bias', 'module.l5_b1_2.conv.6.fc2.weight', 'module.l5_b1_2.conv.6.fc2.bias', 'module.l5_b1_2.conv.7.weight', 'module.l5_b1_u2.up.1.weight', 'module.l5_b1_u2.up.1.bias', 'module.l3_b1_2.conv1.weight', 'module.l3_b1_2.conv2.weight', 'module.l3_b1_2.downsample.0.weight', 'module.l3_b1_u.up.1.weight', 'module.l3_b1_u.up.1.bias', 'module.l2_b1_2.conv1.weight', 'module.l2_b1_2.conv2.weight', 'module.l2_b1_2.downsample.0.weight', 'module.l2_b1_u.up.1.weight', 'module.l2_b1_u.up.1.bias', 'module.l1_b1_2.conv1.weight', 'module.l1_b1_2.conv2.weight', 'module.l1_b1_2.downsample.0.weight', 'module.l1_b1_f.weight', 'module.l1_b1_f.bias', 'module.l4_b2_2.conv.0.weight', 'module.l4_b2_2.conv.3.weight', 'module.l4_b2_2.conv.6.fc1.weight', 'module.l4_b2_2.conv.6.fc1.bias', 'module.l4_b2_2.conv.6.fc2.weight', 'module.l4_b2_2.conv.6.fc2.bias', 'module.l4_b2_2.conv.7.weight', 'module.l4_b2_d2.down.0.weight', 'module.l4_b2_s.same.0.weight', 'module.l4_b2_3.conv.0.weight', 'module.l4_b2_3.conv.3.weight', 'module.l4_b2_3.conv.6.fc1.weight', 'module.l4_b2_3.conv.6.fc1.bias', 'module.l4_b2_3.conv.6.fc2.weight', 'module.l4_b2_3.conv.6.fc2.bias', 'module.l4_b2_3.conv.7.weight', 'module.l4_b2_4.conv1.weight', 'module.l4_b2_4.conv2.weight', 'module.l4_b2_4.downsample.0.weight', 'module.l4_b2_u.up.1.weight', 'module.l4_b2_u.up.1.bias', 'module.l5_b2_1.conv.0.weight', 'module.l5_b2_1.conv.3.weight', 'module.l5_b2_1.conv.6.fc1.weight', 'module.l5_b2_1.conv.6.fc1.bias', 'module.l5_b2_1.conv.6.fc2.weight', 'module.l5_b2_1.conv.6.fc2.bias', 'module.l5_b2_1.conv.7.weight', 'module.l5_b2_u.up.1.weight', 'module.l5_b2_u.up.1.bias', 'module.l5_b2_s.same.0.weight', 'module.l5_b2_2.conv.0.weight', 'module.l5_b2_2.conv.3.weight', 'module.l5_b2_2.conv.6.fc1.weight', 'module.l5_b2_2.conv.6.fc1.bias', 'module.l5_b2_2.conv.6.fc2.weight', 'module.l5_b2_2.conv.6.fc2.bias', 'module.l5_b2_2.conv.7.weight', 'module.l5_b2_u2.up.1.weight', 'module.l5_b2_u2.up.1.bias', 'module.l3_b2_2.conv1.weight', 'module.l3_b2_2.conv2.weight', 'module.l3_b2_2.downsample.0.weight', 'module.l3_b2_u.up.1.weight', 'module.l3_b2_u.up.1.bias', 'module.l2_b2_2.conv1.weight', 'module.l2_b2_2.conv2.weight', 'module.l2_b2_2.downsample.0.weight', 'module.l2_b2_u.up.1.weight', 'module.l2_b2_u.up.1.bias', 'module.l1_b2_2.conv1.weight', 'module.l1_b2_2.conv2.weight', 'module.l1_b2_2.downsample.0.weight', 'module.l1_b2_f.weight', 'module.l1_b2_f.bias']
ℹ Treating entire checkpoint as state_dict

[STEP 2] Checking for DDP prefix handling...
Sample keys: ['module.laplacian_target', 'module.input_ed.conv.weight', 'module.LF_l4_FDCA.semantic_att.linear.0.weight']
⚠ Detected DDP 'module.' prefix in checkpoint
Removing 'module.' prefix from all keys...
✓ Removed 'module.' from 254 keys

[STEP 3] Loading state_dict into model...
✓ State dict loaded successfully

[STEP 4] Verification...
✓ Model parameters: 26,104,612
✓ Trainable parameters verified: 3+

======================================================================
✅ CHECKPOINT LOADED SUCCESSFULLY
======================================================================

✓ Model loaded successfully
✓ XAI modules initialized
✓ Run output directory: outputs/xai_2025-11-15_17-03-40

[Loading] Data from /home/manish/BrainTumorHFF/HFF/data/brats20/final/0-test.txt
[*] Load /home/manish/BrainTumorHFF/HFF/data/brats20/final/0-test.txt, which contains 38 paired volume
modilities: ['flair_L', 't1_L', 't1ce_L', 't2_L', 'flair_H1', 'flair_H2', 'flair_H3', 'flair_H4', 't1_H1', 't1_H2', 't1_H3', 't1_H4', 't1ce_H1', 't1ce_H2', 't1ce_H3', 't1ce_H4', 't2_H1', 't2_H2', 't2_H3', 't2_H4']
[*] Load /home/manish/BrainTumorHFF/HFF/data/brats20/final/0-test.txt, which contains 38 paired volume
modilities: ['flair_L', 't1_L', 't1ce_L', 't2_L', 'flair_H1', 'flair_H2', 'flair_H3', 'flair_H4', 't1_H1', 't1_H2', 't1_H3', 't1_H4', 't1ce_H1', 't1ce_H2', 't1ce_H3', 't1ce_H4', 't2_H1', 't2_H2', 't2_H3', 't2_H4']
✓ Data loaded: 38 batches

[Starting] Evaluation...
======================================================================
Evaluating:   0%|          | 0/38 [00:00<?, ?it/s]Getting prediction...
  Sample: sample_0000
    class_0: Dice=0.9962, IoU=0.9924
    class_1: Dice=0.7369, IoU=0.5834
    class_2: Dice=0.7294, IoU=0.5741
    class_3: Dice=0.8159, IoU=0.6891
Evaluating:   3%|2         | 1/38 [00:09<06:04,  9.85s/it]Getting prediction...
  Sample: sample_0001
    class_0: Dice=0.9977, IoU=0.9955
    class_1: Dice=0.9023, IoU=0.8220
    class_2: Dice=0.9454, IoU=0.8965
    class_3: Dice=0.9367, IoU=0.8809
Evaluating:   5%|5         | 2/38 [00:14<03:55,  6.53s/it]Getting prediction...
  Sample: sample_0002
    class_0: Dice=0.9970, IoU=0.9940
    class_1: Dice=0.9447, IoU=0.8951
    class_2: Dice=0.6757, IoU=0.5103
    class_3: Dice=0.8275, IoU=0.7058
Evaluating:   8%|7         | 3/38 [00:18<03:09,  5.42s/it]Getting prediction...
  Sample: sample_0003
    class_0: Dice=0.9992, IoU=0.9984
    class_1: Dice=0.4896, IoU=0.3241
    class_2: Dice=0.7833, IoU=0.6437
    class_3: Dice=0.7797, IoU=0.6390
Evaluating:  11%|#         | 4/38 [00:22<02:48,  4.95s/it]Getting prediction...
  Sample: sample_0004
    class_0: Dice=0.9964, IoU=0.9928
    class_1: Dice=0.6903, IoU=0.5270
    class_2: Dice=0.1849, IoU=0.1019
    class_3: Dice=0.4282, IoU=0.2724
Evaluating:  13%|#3        | 5/38 [00:26<02:34,  4.68s/it]Getting prediction...
  Sample: sample_0005
    class_0: Dice=0.9904, IoU=0.9809
    class_1: Dice=0.6593, IoU=0.4918
    class_2: Dice=0.7334, IoU=0.5791
    class_3: Dice=0.8469, IoU=0.7344
Evaluating:  16%|#5        | 6/38 [00:30<02:24,  4.51s/it]Getting prediction...
  Sample: sample_0006
    class_0: Dice=0.9924, IoU=0.9849
    class_1: Dice=0.9211, IoU=0.8537
    class_2: Dice=0.8872, IoU=0.7973
    class_3: Dice=0.9034, IoU=0.8239
Evaluating:  18%|#8        | 7/38 [00:34<02:16,  4.41s/it]Getting prediction...
  Sample: sample_0007
    class_0: Dice=0.9852, IoU=0.9708
    class_1: Dice=0.7809, IoU=0.6406
    class_2: Dice=0.5555, IoU=0.3846
    class_3: Dice=0.4010, IoU=0.2508
Evaluating:  21%|##1       | 8/38 [00:38<02:07,  4.24s/it]Getting prediction...
  Sample: sample_0008
    class_0: Dice=0.9981, IoU=0.9962
    class_1: Dice=0.8737, IoU=0.7758
    class_2: Dice=0.8050, IoU=0.6736
    class_3: Dice=0.8841, IoU=0.7923
Evaluating:  24%|##3       | 9/38 [00:42<02:01,  4.19s/it]Getting prediction...
  Sample: sample_0009
    class_0: Dice=0.9964, IoU=0.9928
    class_1: Dice=0.3157, IoU=0.1874
    class_2: Dice=0.7599, IoU=0.6128
    class_3: Dice=0.7793, IoU=0.6384
Evaluating:  26%|##6       | 10/38 [00:47<01:57,  4.20s/it]Getting prediction...
  Sample: sample_0010
    class_0: Dice=0.9958, IoU=0.9916
    class_1: Dice=0.7397, IoU=0.5870
    class_2: Dice=0.8283, IoU=0.7070
    class_3: Dice=0.8722, IoU=0.7733
Evaluating:  29%|##8       | 11/38 [00:51<01:52,  4.18s/it]Getting prediction...
  Sample: sample_0011
    class_0: Dice=0.9915, IoU=0.9831
    class_1: Dice=0.6787, IoU=0.5136
    class_2: Dice=0.5247, IoU=0.3556
    class_3: Dice=0.3360, IoU=0.2019
Evaluating:  32%|###1      | 12/38 [00:55<01:48,  4.16s/it]Getting prediction...
  Sample: sample_0012
    class_0: Dice=0.9946, IoU=0.9893
    class_1: Dice=0.7828, IoU=0.6432
    class_2: Dice=0.2822, IoU=0.1643
    class_3: Dice=0.6808, IoU=0.5161
Evaluating:  34%|###4      | 13/38 [00:59<01:43,  4.12s/it]Getting prediction...
  Sample: sample_0013
    class_0: Dice=0.9970, IoU=0.9940
    class_1: Dice=0.1184, IoU=0.0629
    class_2: Dice=0.7835, IoU=0.6441
    class_3: Dice=0.7981, IoU=0.6640
Evaluating:  37%|###6      | 14/38 [01:03<01:39,  4.16s/it]Getting prediction...
  Sample: sample_0014
    class_0: Dice=0.9928, IoU=0.9857
    class_1: Dice=0.8651, IoU=0.7623
    class_2: Dice=0.8275, IoU=0.7058
    class_3: Dice=0.9096, IoU=0.8342
Evaluating:  39%|###9      | 15/38 [01:07<01:35,  4.15s/it]Getting prediction...
  Sample: sample_0015
    class_0: Dice=0.9945, IoU=0.9891
    class_1: Dice=0.7750, IoU=0.6326
    class_2: Dice=0.7026, IoU=0.5415
    class_3: Dice=0.0000, IoU=0.0000
Evaluating:  42%|####2     | 16/38 [01:11<01:31,  4.16s/it]Getting prediction...
  Sample: sample_0016
    class_0: Dice=0.9869, IoU=0.9741
    class_1: Dice=0.8852, IoU=0.7941
    class_2: Dice=0.7236, IoU=0.5669
    class_3: Dice=0.0007, IoU=0.0003
Evaluating:  45%|####4     | 17/38 [01:16<01:26,  4.12s/it]Getting prediction...
  Sample: sample_0017
    class_0: Dice=0.9983, IoU=0.9966
    class_1: Dice=0.2203, IoU=0.1238
    class_2: Dice=0.5579, IoU=0.3869
    class_3: Dice=0.6857, IoU=0.5217
Evaluating:  47%|####7     | 18/38 [01:20<01:22,  4.14s/it]Getting prediction...
  Sample: sample_0018
    class_0: Dice=0.9918, IoU=0.9837
    class_1: Dice=0.6610, IoU=0.4937
    class_2: Dice=0.5253, IoU=0.3562
    class_3: Dice=0.6018, IoU=0.4304
Evaluating:  50%|#####     | 19/38 [01:24<01:18,  4.14s/it]Getting prediction...
  Sample: sample_0019
    class_0: Dice=0.9968, IoU=0.9937
    class_1: Dice=0.8788, IoU=0.7838
    class_2: Dice=0.9359, IoU=0.8795
    class_3: Dice=0.9121, IoU=0.8385
Evaluating:  53%|#####2    | 20/38 [01:28<01:14,  4.12s/it]Getting prediction...
  Sample: sample_0020
    class_0: Dice=0.9968, IoU=0.9937
    class_1: Dice=0.7857, IoU=0.6471
    class_2: Dice=0.8691, IoU=0.7685
    class_3: Dice=0.8882, IoU=0.7989
Evaluating:  55%|#####5    | 21/38 [01:32<01:09,  4.10s/it]Getting prediction...
  Sample: sample_0021
    class_0: Dice=0.9971, IoU=0.9942
    class_1: Dice=0.7084, IoU=0.5484
    class_2: Dice=0.7921, IoU=0.6557
    class_3: Dice=0.7878, IoU=0.6498
Evaluating:  58%|#####7    | 22/38 [01:36<01:04,  4.04s/it]Getting prediction...
  Sample: sample_0022
    class_0: Dice=0.9943, IoU=0.9886
    class_1: Dice=0.7812, IoU=0.6410
    class_2: Dice=0.8353, IoU=0.7172
    class_3: Dice=0.8413, IoU=0.7260
Evaluating:  61%|######    | 23/38 [01:40<01:00,  4.03s/it]Getting prediction...
  Sample: sample_0023
    class_0: Dice=0.9987, IoU=0.9974
    class_1: Dice=0.7516, IoU=0.6020
    class_2: Dice=0.5018, IoU=0.3349
    class_3: Dice=0.8419, IoU=0.7270
Evaluating:  63%|######3   | 24/38 [01:44<00:56,  4.07s/it]Getting prediction...
  Sample: sample_0024
    class_0: Dice=0.9928, IoU=0.9856
    class_1: Dice=0.7924, IoU=0.6561
    class_2: Dice=0.7590, IoU=0.6115
    class_3: Dice=0.0000, IoU=0.0000
Evaluating:  66%|######5   | 25/38 [01:48<00:52,  4.06s/it]Getting prediction...
  Sample: sample_0025
    class_0: Dice=0.9974, IoU=0.9949
    class_1: Dice=0.9792, IoU=0.9592
    class_2: Dice=0.9535, IoU=0.9111
    class_3: Dice=0.9474, IoU=0.9000
Evaluating:  68%|######8   | 26/38 [01:52<00:49,  4.09s/it]Getting prediction...
  Sample: sample_0026
    class_0: Dice=0.9946, IoU=0.9893
    class_1: Dice=0.1256, IoU=0.0670
    class_2: Dice=0.5560, IoU=0.3851
    class_3: Dice=0.7093, IoU=0.5495
Evaluating:  71%|#######1  | 27/38 [01:56<00:45,  4.10s/it]Getting prediction...
  Sample: sample_0027
    class_0: Dice=0.9976, IoU=0.9953
    class_1: Dice=0.6587, IoU=0.4911
    class_2: Dice=0.9046, IoU=0.8258
    class_3: Dice=0.8701, IoU=0.7701
Evaluating:  74%|#######3  | 28/38 [02:00<00:41,  4.10s/it]Getting prediction...
  Sample: sample_0028
    class_0: Dice=0.9971, IoU=0.9943
    class_1: Dice=0.5036, IoU=0.3365
    class_2: Dice=0.8756, IoU=0.7787
    class_3: Dice=0.8345, IoU=0.7160
Evaluating:  76%|#######6  | 29/38 [02:05<00:37,  4.12s/it]Getting prediction...
  Sample: sample_0029
    class_0: Dice=0.9981, IoU=0.9962
    class_1: Dice=0.0621, IoU=0.0321
    class_2: Dice=0.7158, IoU=0.5574
    class_3: Dice=0.0000, IoU=0.0000
Evaluating:  79%|#######8  | 30/38 [02:09<00:32,  4.08s/it]Getting prediction...
  Sample: sample_0030
    class_0: Dice=0.9909, IoU=0.9819
    class_1: Dice=0.6632, IoU=0.4961
    class_2: Dice=0.7068, IoU=0.5466
    class_3: Dice=0.6635, IoU=0.4965
Evaluating:  82%|########1 | 31/38 [02:12<00:27,  3.96s/it]Getting prediction...
  Sample: sample_0031
    class_0: Dice=0.9928, IoU=0.9857
    class_1: Dice=0.6376, IoU=0.4680
    class_2: Dice=0.8917, IoU=0.8046
    class_3: Dice=0.7240, IoU=0.5673
Evaluating:  84%|########4 | 32/38 [02:16<00:23,  3.84s/it]Getting prediction...
  Sample: sample_0032
    class_0: Dice=0.9967, IoU=0.9934
    class_1: Dice=0.8931, IoU=0.8068
    class_2: Dice=0.8402, IoU=0.7245
    class_3: Dice=0.8166, IoU=0.6900
Evaluating:  87%|########6 | 33/38 [02:19<00:18,  3.74s/it]Getting prediction...
  Sample: sample_0033
    class_0: Dice=0.9946, IoU=0.9893
    class_1: Dice=0.3552, IoU=0.2159
    class_2: Dice=0.7147, IoU=0.5561
    class_3: Dice=0.6570, IoU=0.4892
Evaluating:  89%|########9 | 34/38 [02:23<00:14,  3.72s/it]Getting prediction...
  Sample: sample_0034
    class_0: Dice=0.9966, IoU=0.9933
    class_1: Dice=0.0859, IoU=0.0449
    class_2: Dice=0.6756, IoU=0.5101
    class_3: Dice=0.8134, IoU=0.6855
Evaluating:  92%|#########2| 35/38 [02:27<00:11,  3.70s/it]Getting prediction...
  Sample: sample_0035
    class_0: Dice=0.9985, IoU=0.9970
    class_1: Dice=0.9014, IoU=0.8205
    class_2: Dice=0.9256, IoU=0.8616
    class_3: Dice=0.9384, IoU=0.8839
Evaluating:  95%|#########4| 36/38 [02:30<00:07,  3.64s/it]Getting prediction...
  Sample: sample_0036
    class_0: Dice=0.9899, IoU=0.9799
    class_1: Dice=0.8433, IoU=0.7291
    class_2: Dice=0.8577, IoU=0.7509
    class_3: Dice=0.8580, IoU=0.7513
Evaluating:  97%|#########7| 37/38 [02:34<00:03,  3.59s/it]Getting prediction...
  Sample: sample_0037
    class_0: Dice=0.9913, IoU=0.9827
    class_1: Dice=0.7622, IoU=0.6157
    class_2: Dice=0.8297, IoU=0.7090
    class_3: Dice=0.6368, IoU=0.4672
Evaluating: 100%|##########| 38/38 [02:37<00:00,  3.57s/it]Evaluating: 100%|##########| 38/38 [02:37<00:00,  4.15s/it]


======================================================================
FINAL METRICS SUMMARY
======================================================================

PER-CLASS METRICS (Mean ± Std):
======================================================================

class_0:
  Dice: 0.9949 ± 0.0033
  IoU:  0.9898 ± 0.0065

class_1:
  Dice: 0.6634 ± 0.2561
  IoU:  0.5441 ± 0.2530

class_2:
  Dice: 0.7357 ± 0.1713
  IoU:  0.6077 ± 0.1929

class_3:
  Dice: 0.6902 ± 0.2759
  IoU:  0.5809 ± 0.2604

======================================================================

EVALUATION COMPLETE
======================================================================
Samples evaluated: 38
Output directory: ./outputs
Metrics: YES ✓
======================================================================

