
======================================================================
HFF-NET ENHANCED EVALUATION WITH XAI + METRICS
======================================================================
Log file: ./outputs/logs/eval_log_2025-11-15_17-25-20.txt
Output directory: ./outputs

[Loading] Model from /home/manish/BrainTumorHFF/HFF/result/checkpoints/hff/brats20/all/hff-l=0.3-e=200-s=50-g=0.55-b=1-cw=15-w=3-100L-H-2025-11-14_12-23-36/best_Result2_et_0.8320_tc_0.9098_wt_0.8970.pth
[LOAD] Loading checkpoint: /home/manish/BrainTumorHFF/HFF/result/checkpoints/hff/brats20/all/hff-l=0.3-e=200-s=50-g=0.55-b=1-cw=15-w=3-100L-H-2025-11-14_12-23-36/best_Result2_et_0.8320_tc_0.9098_wt_0.8970.pth
âœ“ Checkpoint loaded and model moved to device
âœ“ Model loaded successfully
âœ“ XAI modules initialized
âœ“ Run output directory: outputs/xai_2025-11-15_17-25-23

[Loading] Data from /home/manish/BrainTumorHFF/HFF/data/brats20/final/0-test.txt
[*] Load /home/manish/BrainTumorHFF/HFF/data/brats20/final/0-test.txt, which contains 38 paired volume
modilities: ['flair_L', 't1_L', 't1ce_L', 't2_L', 'flair_H1', 'flair_H2', 'flair_H3', 'flair_H4', 't1_H1', 't1_H2', 't1_H3', 't1_H4', 't1ce_H1', 't1ce_H2', 't1ce_H3', 't1ce_H4', 't2_H1', 't2_H2', 't2_H3', 't2_H4']
[*] Load /home/manish/BrainTumorHFF/HFF/data/brats20/final/0-test.txt, which contains 38 paired volume
modilities: ['flair_L', 't1_L', 't1ce_L', 't2_L', 'flair_H1', 'flair_H2', 'flair_H3', 'flair_H4', 't1_H1', 't1_H2', 't1_H3', 't1_H4', 't1ce_H1', 't1ce_H2', 't1ce_H3', 't1ce_H4', 't2_H1', 't2_H2', 't2_H3', 't2_H4']
âœ“ Data loaded: 38 batches

[Starting] Evaluation (XAI + per-sample metrics)...
======================================================================
Evaluating:   0%|          | 0/38 [00:00<?, ?it/s]
[1] Getting primary prediction...

[METRICS FOR sample_0000]
==================================================
class_0: Dice=0.9962, IoU=0.9924
class_1: Dice=0.7369, IoU=0.5834
class_2: Dice=0.7294, IoU=0.5741
class_3: Dice=0.8159, IoU=0.6891
==================================================

[2] Generating attention maps...
Clipping input data to the valid range for imshow with RGB data ([0..1] for floats or [0..255] for integers).
Clipping input data to the valid range for imshow with RGB data ([0..1] for floats or [0..255] for integers).
âœ“ Saved: outputs/xai_2025-11-15_17-25-23/attention/sample_0000_attention.png

[MECHANISTIC INTERPRETABILITY ANALYSIS]
======================================================================
Sample: sample_0000
======================================================================

ðŸ“Š Layer: LF_l4_FDCA.semantic_att
   â”œâ”€ Features: 1
   â”œâ”€ Mean Importance: 0.1365
   â”œâ”€ Max Importance: 0.1365
   â”œâ”€ Min Importance: 0.1365
   â””â”€ Top-5 Important Features: [0]
      â””â”€ Top-5 Values: ['0.1365']

ðŸ“Š Layer: LF_l4_FDCA.positional_att.conv
   â”œâ”€ Features: 1
   â”œâ”€ Mean Importance: 260.5983
   â”œâ”€ Max Importance: 260.5983
   â”œâ”€ Min Importance: 260.5983
   â””â”€ Top-5 Important Features: [0]
      â””â”€ Top-5 Values: ['260.5983']

ðŸ“Š Layer: LF_l4_FDCA.positional_att
   â”œâ”€ Features: 1
   â”œâ”€ Mean Importance: 50.5485
   â”œâ”€ Max Importance: 50.5485
   â”œâ”€ Min Importance: 50.5485
   â””â”€ Top-5 Important Features: [0]
      â””â”€ Top-5 Values: ['50.5485']

ðŸ“Š Layer: LF_l4_FDCA.slice_att.linear.0
   â”œâ”€ Features: 1
   â”œâ”€ Mean Importance: 66.1849
   â”œâ”€ Max Importance: 66.1849
   â”œâ”€ Min Importance: 66.1849
   â””â”€ Top-5 Important Features: [0]
      â””â”€ Top-5 Values: ['66.1849']

ðŸ“Š Layer: LF_l4_FDCA.slice_att.linear.1
   â”œâ”€ Features: 1
   â”œâ”€ Mean Importance: 56.1497
   â”œâ”€ Max Importance: 56.1497
   â”œâ”€ Min Importance: 56.1497
   â””â”€ Top-5 Important Features: [0]
      â””â”€ Top-5 Values: ['56.1497']

ðŸ“Š Layer: LF_l4_FDCA.slice_att.linear.2
   â”œâ”€ Features: 1
   â”œâ”€ Mean Importance: 53.2638
   â”œâ”€ Max Importance: 53.2638
   â”œâ”€ Min Importance: 53.2638
   â””â”€ Top-5 Important Features: [0]
      â””â”€ Top-5 Values: ['53.2638']

ðŸ“Š Layer: LF_l4_FDCA.slice_att.linear
   â”œâ”€ Features: 1
   â”œâ”€ Mean Importance: 53.2638
   â”œâ”€ Max Importance: 53.2638
   â”œâ”€ Min Importance: 53.2638
   â””â”€ Top-5 Important Features: [0]
      â””â”€ Top-5 Values: ['53.2638']

ðŸ“Š Layer: LF_l4_FDCA.slice_att.non_linear
   â”œâ”€ Features: 1
   â”œâ”€ Mean Importance: 27118424.0000
   â”œâ”€ Max Importance: 27118424.0000
   â”œâ”€ Min Importance: 27118424.0000
   â””â”€ Top-5 Important Features: [0]
      â””â”€ Top-5 Values: ['27118424.0000']

ðŸ“Š Layer: LF_l4_FDCA.slice_att.mean
   â”œâ”€ Features: 1
   â”œâ”€ Mean Importance: 108336424.0000
   â”œâ”€ Max Importance: 108336424.0000
   â”œâ”€ Min Importance: 108336424.0000
   â””â”€ Top-5 Important Features: [0]
      â””â”€ Top-5 Values: ['108336424.0000']

ðŸ“Š Layer: LF_l4_FDCA.slice_att.log_diag
   â”œâ”€ Features: 1
   â”œâ”€ Mean Importance: 6714.6660
   â”œâ”€ Max Importance: 6714.6660
   â”œâ”€ Min Importance: 6714.6660
   â””â”€ Top-5 Important Features: [0]
      â””â”€ Top-5 Values: ['6714.6660']

ðŸ“Š Layer: LF_l4_FDCA.slice_att.factor
   â”œâ”€ Features: 1
   â”œâ”€ Mean Importance: 41963532.0000
   â”œâ”€ Max Importance: 41963532.0000
   â”œâ”€ Min Importance: 41963532.0000
   â””â”€ Top-5 Important Features: [0]
      â””â”€ Top-5 Values: ['41963532.0000']

ðŸ“Š Layer: LF_l4_FDCA.slice_att
   â”œâ”€ Features: 1
   â”œâ”€ Mean Importance: 2366306.7500
   â”œâ”€ Max Importance: 2366306.7500
   â”œâ”€ Min Importance: 2366306.7500
   â””â”€ Top-5 Important Features: [0]
      â””â”€ Top-5 Values: ['2366306.7500']

ðŸ“Š Layer: LF_l4_FDCA
   â”œâ”€ Features: 1
   â”œâ”€ Mean Importance: 73466283181473792.0000
   â”œâ”€ Max Importance: 73466283181473792.0000
   â”œâ”€ Min Importance: 73466283181473792.0000
   â””â”€ Top-5 Important Features: [0]
      â””â”€ Top-5 Values: ['73466283181473792.0000']

ðŸ“Š Layer: LF_l5_FDCA.semantic_att
   â”œâ”€ Features: 1
   â”œâ”€ Mean Importance: 0.0853
   â”œâ”€ Max Importance: 0.0853
   â”œâ”€ Min Importance: 0.0853
   â””â”€ Top-5 Important Features: [0]
      â””â”€ Top-5 Values: ['0.0853']

ðŸ“Š Layer: LF_l5_FDCA.positional_att.conv
   â”œâ”€ Features: 1
   â”œâ”€ Mean Importance: 64.4767
   â”œâ”€ Max Importance: 64.4767
   â”œâ”€ Min Importance: 64.4767
   â””â”€ Top-5 Important Features: [0]
      â””â”€ Top-5 Values: ['64.4767']

ðŸ“Š Layer: LF_l5_FDCA.positional_att
   â”œâ”€ Features: 1
   â”œâ”€ Mean Importance: 0.0000
   â”œâ”€ Max Importance: 0.0000
   â”œâ”€ Min Importance: 0.0000
   â””â”€ Top-5 Important Features: [0]
      â””â”€ Top-5 Values: ['0.0000']

ðŸ“Š Layer: LF_l5_FDCA.slice_att.linear.0
   â”œâ”€ Features: 1
   â”œâ”€ Mean Importance: 0.0000
   â”œâ”€ Max Importance: 0.0000
   â”œâ”€ Min Importance: 0.0000
   â””â”€ Top-5 Important Features: [0]
      â””â”€ Top-5 Values: ['0.0000']

ðŸ“Š Layer: LF_l5_FDCA.slice_att.linear.1
   â”œâ”€ Features: 1
   â”œâ”€ Mean Importance: 0.0000
   â”œâ”€ Max Importance: 0.0000
   â”œâ”€ Min Importance: 0.0000
   â””â”€ Top-5 Important Features: [0]
      â””â”€ Top-5 Values: ['0.0000']

ðŸ“Š Layer: LF_l5_FDCA.slice_att.linear.2
   â”œâ”€ Features: 1
   â”œâ”€ Mean Importance: 0.0000
   â”œâ”€ Max Importance: 0.0000
   â”œâ”€ Min Importance: 0.0000
   â””â”€ Top-5 Important Features: [0]
      â””â”€ Top-5 Values: ['0.0000']

ðŸ“Š Layer: LF_l5_FDCA.slice_att.linear
   â”œâ”€ Features: 1
   â”œâ”€ Mean Importance: 0.0000
   â”œâ”€ Max Importance: 0.0000
   â”œâ”€ Min Importance: 0.0000
   â””â”€ Top-5 Important Features: [0]
      â””â”€ Top-5 Values: ['0.0000']

ðŸ“Š Layer: LF_l5_FDCA.slice_att.non_linear
   â”œâ”€ Features: 1
   â”œâ”€ Mean Importance: 0.0000
   â”œâ”€ Max Importance: 0.0000
   â”œâ”€ Min Importance: 0.0000
   â””â”€ Top-5 Important Features: [0]
      â””â”€ Top-5 Values: ['0.0000']

ðŸ“Š Layer: LF_l5_FDCA.slice_att.mean
   â”œâ”€ Features: 1
   â”œâ”€ Mean Importance: 0.0017
   â”œâ”€ Max Importance: 0.0017
   â”œâ”€ Min Importance: 0.0017
   â””â”€ Top-5 Important Features: [0]
      â””â”€ Top-5 Values: ['0.0017']

ðŸ“Š Layer: LF_l5_FDCA.slice_att.log_diag
   â”œâ”€ Features: 1
   â”œâ”€ Mean Importance: 0.0000
   â”œâ”€ Max Importance: 0.0000
   â”œâ”€ Min Importance: 0.0000
   â””â”€ Top-5 Important Features: [0]
      â””â”€ Top-5 Values: ['0.0000']

ðŸ“Š Layer: LF_l5_FDCA.slice_att.factor
   â”œâ”€ Features: 1
   â”œâ”€ Mean Importance: 0.0001
   â”œâ”€ Max Importance: 0.0001
   â”œâ”€ Min Importance: 0.0001
   â””â”€ Top-5 Important Features: [0]
      â””â”€ Top-5 Values: ['0.0001']

ðŸ“Š Layer: LF_l5_FDCA.slice_att
   â”œâ”€ Features: 1
   â”œâ”€ Mean Importance: 0.0000
   â”œâ”€ Max Importance: 0.0000
   â”œâ”€ Min Importance: 0.0000
   â””â”€ Top-5 Important Features: [0]
      â””â”€ Top-5 Values: ['0.0000']

ðŸ“Š Layer: LF_l5_FDCA
   â”œâ”€ Features: 1
   â”œâ”€ Mean Importance: 0.0000
   â”œâ”€ Max Importance: 0.0000
   â”œâ”€ Min Importance: 0.0000
   â””â”€ Top-5 Important Features: [0]
      â””â”€ Top-5 Values: ['0.0000']

ðŸ“Š Layer: HF_l4_FDCA.semantic_att
   â”œâ”€ Features: 1
   â”œâ”€ Mean Importance: 0.0832
   â”œâ”€ Max Importance: 0.0832
   â”œâ”€ Min Importance: 0.0832
   â””â”€ Top-5 Important Features: [0]
      â””â”€ Top-5 Values: ['0.0832']

ðŸ“Š Layer: HF_l4_FDCA.positional_att.conv
   â”œâ”€ Features: 1
   â”œâ”€ Mean Importance: 9.9985
   â”œâ”€ Max Importance: 9.9985
   â”œâ”€ Min Importance: 9.9985
   â””â”€ Top-5 Important Features: [0]
      â””â”€ Top-5 Values: ['9.9985']

ðŸ“Š Layer: HF_l4_FDCA.positional_att
   â”œâ”€ Features: 1
   â”œâ”€ Mean Importance: 0.0018
   â”œâ”€ Max Importance: 0.0018
   â”œâ”€ Min Importance: 0.0018
   â””â”€ Top-5 Important Features: [0]
      â””â”€ Top-5 Values: ['0.0018']

ðŸ“Š Layer: HF_l4_FDCA.slice_att.linear.0
   â”œâ”€ Features: 1
   â”œâ”€ Mean Importance: 0.0000
   â”œâ”€ Max Importance: 0.0000
   â”œâ”€ Min Importance: 0.0000
   â””â”€ Top-5 Important Features: [0]
      â””â”€ Top-5 Values: ['0.0000']

ðŸ“Š Layer: HF_l4_FDCA.slice_att.linear.1
   â”œâ”€ Features: 1
   â”œâ”€ Mean Importance: 0.0000
   â”œâ”€ Max Importance: 0.0000
   â”œâ”€ Min Importance: 0.0000
   â””â”€ Top-5 Important Features: [0]
      â””â”€ Top-5 Values: ['0.0000']

ðŸ“Š Layer: HF_l4_FDCA.slice_att.linear.2
   â”œâ”€ Features: 1
   â”œâ”€ Mean Importance: 0.0000
   â”œâ”€ Max Importance: 0.0000
   â”œâ”€ Min Importance: 0.0000
   â””â”€ Top-5 Important Features: [0]
      â””â”€ Top-5 Values: ['0.0000']

ðŸ“Š Layer: HF_l4_FDCA.slice_att.linear
   â”œâ”€ Features: 1
   â”œâ”€ Mean Importance: 0.0000
   â”œâ”€ Max Importance: 0.0000
   â”œâ”€ Min Importance: 0.0000
   â””â”€ Top-5 Important Features: [0]
      â””â”€ Top-5 Values: ['0.0000']

ðŸ“Š Layer: HF_l4_FDCA.slice_att.non_linear
   â”œâ”€ Features: 1
   â”œâ”€ Mean Importance: 0.0000
   â”œâ”€ Max Importance: 0.0000
   â”œâ”€ Min Importance: 0.0000
   â””â”€ Top-5 Important Features: [0]
      â””â”€ Top-5 Values: ['0.0000']

ðŸ“Š Layer: HF_l4_FDCA.slice_att.mean
   â”œâ”€ Features: 1
   â”œâ”€ Mean Importance: 0.0000
   â”œâ”€ Max Importance: 0.0000
   â”œâ”€ Min Importance: 0.0000
   â””â”€ Top-5 Important Features: [0]
      â””â”€ Top-5 Values: ['0.0000']

ðŸ“Š Layer: HF_l4_FDCA.slice_att.log_diag
   â”œâ”€ Features: 1
   â”œâ”€ Mean Importance: 0.0000
   â”œâ”€ Max Importance: 0.0000
   â”œâ”€ Min Importance: 0.0000
   â””â”€ Top-5 Important Features: [0]
      â””â”€ Top-5 Values: ['0.0000']

ðŸ“Š Layer: HF_l4_FDCA.slice_att.factor
   â”œâ”€ Features: 1
   â”œâ”€ Mean Importance: 0.0000
   â”œâ”€ Max Importance: 0.0000
   â”œâ”€ Min Importance: 0.0000
   â””â”€ Top-5 Important Features: [0]
      â””â”€ Top-5 Values: ['0.0000']

ðŸ“Š Layer: HF_l4_FDCA.slice_att
   â”œâ”€ Features: 1
   â”œâ”€ Mean Importance: 0.0121
   â”œâ”€ Max Importance: 0.0121
   â”œâ”€ Min Importance: 0.0121
   â””â”€ Top-5 Important Features: [0]
      â””â”€ Top-5 Values: ['0.0121']

ðŸ“Š Layer: HF_l4_FDCA
   â”œâ”€ Features: 1
   â”œâ”€ Mean Importance: 2.6144
   â”œâ”€ Max Importance: 2.6144
   â”œâ”€ Min Importance: 2.6144
   â””â”€ Top-5 Important Features: [0]
      â””â”€ Top-5 Values: ['2.6144']

ðŸ“Š Layer: HF_l5_FDCA.semantic_att
   â”œâ”€ Features: 1
   â”œâ”€ Mean Importance: 0.0735
   â”œâ”€ Max Importance: 0.0735
   â”œâ”€ Min Importance: 0.0735
   â””â”€ Top-5 Important Features: [0]
      â””â”€ Top-5 Values: ['0.0735']

ðŸ“Š Layer: HF_l5_FDCA.positional_att.conv
   â”œâ”€ Features: 1
   â”œâ”€ Mean Importance: 13.2624
   â”œâ”€ Max Importance: 13.2624
   â”œâ”€ Min Importance: 13.2624
   â””â”€ Top-5 Important Features: [0]
      â””â”€ Top-5 Values: ['13.2624']

ðŸ“Š Layer: HF_l5_FDCA.positional_att
   â”œâ”€ Features: 1
   â”œâ”€ Mean Importance: 0.0001
   â”œâ”€ Max Importance: 0.0001
   â”œâ”€ Min Importance: 0.0001
   â””â”€ Top-5 Important Features: [0]
      â””â”€ Top-5 Values: ['0.0001']

ðŸ“Š Layer: HF_l5_FDCA.slice_att.linear.0
   â”œâ”€ Features: 1
   â”œâ”€ Mean Importance: 0.0000
   â”œâ”€ Max Importance: 0.0000
   â”œâ”€ Min Importance: 0.0000
   â””â”€ Top-5 Important Features: [0]
      â””â”€ Top-5 Values: ['0.0000']

ðŸ“Š Layer: HF_l5_FDCA.slice_att.linear.1
   â”œâ”€ Features: 1
   â”œâ”€ Mean Importance: 0.0000
   â”œâ”€ Max Importance: 0.0000
   â”œâ”€ Min Importance: 0.0000
   â””â”€ Top-5 Important Features: [0]
      â””â”€ Top-5 Values: ['0.0000']

ðŸ“Š Layer: HF_l5_FDCA.slice_att.linear.2
   â”œâ”€ Features: 1
   â”œâ”€ Mean Importance: 0.0000
   â”œâ”€ Max Importance: 0.0000
   â”œâ”€ Min Importance: 0.0000
   â””â”€ Top-5 Important Features: [0]
      â””â”€ Top-5 Values: ['0.0000']

ðŸ“Š Layer: HF_l5_FDCA.slice_att.linear
   â”œâ”€ Features: 1
   â”œâ”€ Mean Importance: 0.0000
   â”œâ”€ Max Importance: 0.0000
   â”œâ”€ Min Importance: 0.0000
   â””â”€ Top-5 Important Features: [0]
      â””â”€ Top-5 Values: ['0.0000']

ðŸ“Š Layer: HF_l5_FDCA.slice_att.non_linear
   â”œâ”€ Features: 1
   â”œâ”€ Mean Importance: 0.0000
   â”œâ”€ Max Importance: 0.0000
   â”œâ”€ Min Importance: 0.0000
   â””â”€ Top-5 Important Features: [0]
      â””â”€ Top-5 Values: ['0.0000']

ðŸ“Š Layer: HF_l5_FDCA.slice_att.mean
   â”œâ”€ Features: 1
   â”œâ”€ Mean Importance: 0.0000
   â”œâ”€ Max Importance: 0.0000
   â”œâ”€ Min Importance: 0.0000
   â””â”€ Top-5 Important Features: [0]
      â””â”€ Top-5 Values: ['0.0000']

ðŸ“Š Layer: HF_l5_FDCA.slice_att.log_diag
   â”œâ”€ Features: 1
   â”œâ”€ Mean Importance: 0.0000
   â”œâ”€ Max Importance: 0.0000
   â”œâ”€ Min Importance: 0.0000
   â””â”€ Top-5 Important Features: [0]
      â””â”€ Top-5 Values: ['0.0000']

ðŸ“Š Layer: HF_l5_FDCA.slice_att.factor
   â”œâ”€ Features: 1
   â”œâ”€ Mean Importance: 0.0000
   â”œâ”€ Max Importance: 0.0000
   â”œâ”€ Min Importance: 0.0000
   â””â”€ Top-5 Important Features: [0]
      â””â”€ Top-5 Values: ['0.0000']

ðŸ“Š Layer: HF_l5_FDCA.slice_att
   â”œâ”€ Features: 1
   â”œâ”€ Mean Importance: 0.0001
   â”œâ”€ Max Importance: 0.0001
   â”œâ”€ Min Importance: 0.0001
   â””â”€ Top-5 Important Features: [0]
      â””â”€ Top-5 Values: ['0.0001']

ðŸ“Š Layer: HF_l5_FDCA
   â”œâ”€ Features: 1
   â”œâ”€ Mean Importance: 0.0000
   â”œâ”€ Max Importance: 0.0000
   â”œâ”€ Min Importance: 0.0000
   â””â”€ Top-5 Important Features: [0]
      â””â”€ Top-5 Values: ['0.0000']

======================================================================
âœ“ Mechanistic analysis complete

[3] Generating Grad-CAM...
Warning: Failed to generate CAM for class 0: element 0 of tensors does not require grad and does not have a grad_fn
Warning: Failed to generate CAM for class 1: element 0 of tensors does not require grad and does not have a grad_fn
Warning: Failed to generate CAM for class 2: element 0 of tensors does not require grad and does not have a grad_fn
Warning: Failed to generate CAM for class 3: element 0 of tensors does not require grad and does not have a grad_fn
[4] Analyzing frequency components...
âœ“ Saved: outputs/xai_2025-11-15_17-25-23/freq_component/sample_0000_freq_comp.png
âœ“ Evaluation complete for sample_0000
Evaluating:   3%|2         | 1/38 [00:23<14:14, 23.10s/it]
[1] Getting primary prediction...

[METRICS FOR sample_0001]
==================================================
class_0: Dice=0.9977, IoU=0.9954
class_1: Dice=0.9027, IoU=0.8227
class_2: Dice=0.9440, IoU=0.8940
class_3: Dice=0.9364, IoU=0.8804
==================================================

[2] Generating attention maps...
Clipping input data to the valid range for imshow with RGB data ([0..1] for floats or [0..255] for integers).
Clipping input data to the valid range for imshow with RGB data ([0..1] for floats or [0..255] for integers).
âœ“ Saved: outputs/xai_2025-11-15_17-25-23/attention/sample_0001_attention.png

[MECHANISTIC INTERPRETABILITY ANALYSIS]
======================================================================
Sample: sample_0001
======================================================================

ðŸ“Š Layer: LF_l4_FDCA.semantic_att
   â”œâ”€ Features: 1
   â”œâ”€ Mean Importance: 0.1001
   â”œâ”€ Max Importance: 0.1001
   â”œâ”€ Min Importance: 0.1001
   â””â”€ Top-5 Important Features: [0]
      â””â”€ Top-5 Values: ['0.1001']

ðŸ“Š Layer: LF_l4_FDCA.positional_att.conv
   â”œâ”€ Features: 1
   â”œâ”€ Mean Importance: 217.4890
   â”œâ”€ Max Importance: 217.4890
   â”œâ”€ Min Importance: 217.4890
   â””â”€ Top-5 Important Features: [0]
      â””â”€ Top-5 Values: ['217.4890']

ðŸ“Š Layer: LF_l4_FDCA.positional_att
   â”œâ”€ Features: 1
   â”œâ”€ Mean Importance: 34.0346
   â”œâ”€ Max Importance: 34.0346
   â”œâ”€ Min Importance: 34.0346
   â””â”€ Top-5 Important Features: [0]
      â””â”€ Top-5 Values: ['34.0346']

ðŸ“Š Layer: LF_l4_FDCA.slice_att.linear.0
   â”œâ”€ Features: 1
   â”œâ”€ Mean Importance: 63.1482
   â”œâ”€ Max Importance: 63.1482
   â”œâ”€ Min Importance: 63.1482
   â””â”€ Top-5 Important Features: [0]
      â””â”€ Top-5 Values: ['63.1482']

ðŸ“Š Layer: LF_l4_FDCA.slice_att.linear.1
   â”œâ”€ Features: 1
   â”œâ”€ Mean Importance: 53.5635
   â”œâ”€ Max Importance: 53.5635
   â”œâ”€ Min Importance: 53.5635
   â””â”€ Top-5 Important Features: [0]
      â””â”€ Top-5 Values: ['53.5635']

ðŸ“Š Layer: LF_l4_FDCA.slice_att.linear.2
   â”œâ”€ Features: 1
   â”œâ”€ Mean Importance: 50.8420
   â”œâ”€ Max Importance: 50.8420
   â”œâ”€ Min Importance: 50.8420
   â””â”€ Top-5 Important Features: [0]
      â””â”€ Top-5 Values: ['50.8420']

ðŸ“Š Layer: LF_l4_FDCA.slice_att.linear
   â”œâ”€ Features: 1
   â”œâ”€ Mean Importance: 50.8420
   â”œâ”€ Max Importance: 50.8420
   â”œâ”€ Min Importance: 50.8420
   â””â”€ Top-5 Important Features: [0]
      â””â”€ Top-5 Values: ['50.8420']

ðŸ“Š Layer: LF_l4_FDCA.slice_att.non_linear
   â”œâ”€ Features: 1
   â”œâ”€ Mean Importance: 22159164.0000
   â”œâ”€ Max Importance: 22159164.0000
   â”œâ”€ Min Importance: 22159164.0000
   â””â”€ Top-5 Important Features: [0]
      â””â”€ Top-5 Values: ['22159164.0000']

ðŸ“Š Layer: LF_l4_FDCA.slice_att.mean
   â”œâ”€ Features: 1
   â”œâ”€ Mean Importance: 88549872.0000
   â”œâ”€ Max Importance: 88549872.0000
   â”œâ”€ Min Importance: 88549872.0000
   â””â”€ Top-5 Important Features: [0]
      â””â”€ Top-5 Values: ['88549872.0000']

ðŸ“Š Layer: LF_l4_FDCA.slice_att.log_diag
   â”œâ”€ Features: 1
   â”œâ”€ Mean Importance: 5488.0718
   â”œâ”€ Max Importance: 5488.0718
   â”œâ”€ Min Importance: 5488.0718
   â””â”€ Top-5 Important Features: [0]
      â””â”€ Top-5 Values: ['5488.0718']

ðŸ“Š Layer: LF_l4_FDCA.slice_att.factor
   â”œâ”€ Features: 1
   â”œâ”€ Mean Importance: 34299604.0000
   â”œâ”€ Max Importance: 34299604.0000
   â”œâ”€ Min Importance: 34299604.0000
   â””â”€ Top-5 Important Features: [0]
      â””â”€ Top-5 Values: ['34299604.0000']

ðŸ“Š Layer: LF_l4_FDCA.slice_att
   â”œâ”€ Features: 1
   â”œâ”€ Mean Importance: 13478680.0000
   â”œâ”€ Max Importance: 13478680.0000
   â”œâ”€ Min Importance: 13478680.0000
   â””â”€ Top-5 Important Features: [0]
      â””â”€ Top-5 Values: ['13478680.0000']

ðŸ“Š Layer: LF_l4_FDCA
   â”œâ”€ Features: 1
   â”œâ”€ Mean Importance: 1630351581058695168.0000
   â”œâ”€ Max Importance: 1630351581058695168.0000
   â”œâ”€ Min Importance: 1630351581058695168.0000
   â””â”€ Top-5 Important Features: [0]
      â””â”€ Top-5 Values: ['1630351581058695168.0000']

ðŸ“Š Layer: LF_l5_FDCA.semantic_att
   â”œâ”€ Features: 1
   â”œâ”€ Mean Importance: 0.0762
   â”œâ”€ Max Importance: 0.0762
   â”œâ”€ Min Importance: 0.0762
   â””â”€ Top-5 Important Features: [0]
      â””â”€ Top-5 Values: ['0.0762']

ðŸ“Š Layer: LF_l5_FDCA.positional_att.conv
   â”œâ”€ Features: 1
   â”œâ”€ Mean Importance: 87.2557
   â”œâ”€ Max Importance: 87.2557
   â”œâ”€ Min Importance: 87.2557
   â””â”€ Top-5 Important Features: [0]
      â””â”€ Top-5 Values: ['87.2557']

ðŸ“Š Layer: LF_l5_FDCA.positional_att
   â”œâ”€ Features: 1
   â”œâ”€ Mean Importance: 0.0000
   â”œâ”€ Max Importance: 0.0000
   â”œâ”€ Min Importance: 0.0000
   â””â”€ Top-5 Important Features: [0]
      â””â”€ Top-5 Values: ['0.0000']

ðŸ“Š Layer: LF_l5_FDCA.slice_att.linear.0
   â”œâ”€ Features: 1
   â”œâ”€ Mean Importance: 0.0000
   â”œâ”€ Max Importance: 0.0000
   â”œâ”€ Min Importance: 0.0000
   â””â”€ Top-5 Important Features: [0]
      â””â”€ Top-5 Values: ['0.0000']

ðŸ“Š Layer: LF_l5_FDCA.slice_att.linear.1
   â”œâ”€ Features: 1
   â”œâ”€ Mean Importance: 0.0000
   â”œâ”€ Max Importance: 0.0000
   â”œâ”€ Min Importance: 0.0000
   â””â”€ Top-5 Important Features: [0]
      â””â”€ Top-5 Values: ['0.0000']

ðŸ“Š Layer: LF_l5_FDCA.slice_att.linear.2
   â”œâ”€ Features: 1
   â”œâ”€ Mean Importance: 0.0000
   â”œâ”€ Max Importance: 0.0000
   â”œâ”€ Min Importance: 0.0000
   â””â”€ Top-5 Important Features: [0]
      â””â”€ Top-5 Values: ['0.0000']

ðŸ“Š Layer: LF_l5_FDCA.slice_att.linear
   â”œâ”€ Features: 1
   â”œâ”€ Mean Importance: 0.0000
   â”œâ”€ Max Importance: 0.0000
   â”œâ”€ Min Importance: 0.0000
   â””â”€ Top-5 Important Features: [0]
      â””â”€ Top-5 Values: ['0.0000']

ðŸ“Š Layer: LF_l5_FDCA.slice_att.non_linear
   â”œâ”€ Features: 1
   â”œâ”€ Mean Importance: 0.0000
   â”œâ”€ Max Importance: 0.0000
   â”œâ”€ Min Importance: 0.0000
   â””â”€ Top-5 Important Features: [0]
      â””â”€ Top-5 Values: ['0.0000']

ðŸ“Š Layer: LF_l5_FDCA.slice_att.mean
   â”œâ”€ Features: 1
   â”œâ”€ Mean Importance: 0.0017
   â”œâ”€ Max Importance: 0.0017
   â”œâ”€ Min Importance: 0.0017
   â””â”€ Top-5 Important Features: [0]
      â””â”€ Top-5 Values: ['0.0017']

ðŸ“Š Layer: LF_l5_FDCA.slice_att.log_diag
   â”œâ”€ Features: 1
   â”œâ”€ Mean Importance: 0.0000
   â”œâ”€ Max Importance: 0.0000
   â”œâ”€ Min Importance: 0.0000
   â””â”€ Top-5 Important Features: [0]
      â””â”€ Top-5 Values: ['0.0000']

ðŸ“Š Layer: LF_l5_FDCA.slice_att.factor
   â”œâ”€ Features: 1
   â”œâ”€ Mean Importance: 0.0001
   â”œâ”€ Max Importance: 0.0001
   â”œâ”€ Min Importance: 0.0001
   â””â”€ Top-5 Important Features: [0]
      â””â”€ Top-5 Values: ['0.0001']

ðŸ“Š Layer: LF_l5_FDCA.slice_att
   â”œâ”€ Features: 1
   â”œâ”€ Mean Importance: 0.0000
   â”œâ”€ Max Importance: 0.0000
   â”œâ”€ Min Importance: 0.0000
   â””â”€ Top-5 Important Features: [0]
      â””â”€ Top-5 Values: ['0.0000']

ðŸ“Š Layer: LF_l5_FDCA
   â”œâ”€ Features: 1
   â”œâ”€ Mean Importance: 0.0000
   â”œâ”€ Max Importance: 0.0000
   â”œâ”€ Min Importance: 0.0000
   â””â”€ Top-5 Important Features: [0]
      â””â”€ Top-5 Values: ['0.0000']

ðŸ“Š Layer: HF_l4_FDCA.semantic_att
   â”œâ”€ Features: 1
   â”œâ”€ Mean Importance: 0.0812
   â”œâ”€ Max Importance: 0.0812
   â”œâ”€ Min Importance: 0.0812
   â””â”€ Top-5 Important Features: [0]
      â””â”€ Top-5 Values: ['0.0812']

ðŸ“Š Layer: HF_l4_FDCA.positional_att.conv
   â”œâ”€ Features: 1
   â”œâ”€ Mean Importance: 8.6603
   â”œâ”€ Max Importance: 8.6603
   â”œâ”€ Min Importance: 8.6603
   â””â”€ Top-5 Important Features: [0]
      â””â”€ Top-5 Values: ['8.6603']

ðŸ“Š Layer: HF_l4_FDCA.positional_att
   â”œâ”€ Features: 1
   â”œâ”€ Mean Importance: 0.0017
   â”œâ”€ Max Importance: 0.0017
   â”œâ”€ Min Importance: 0.0017
   â””â”€ Top-5 Important Features: [0]
      â””â”€ Top-5 Values: ['0.0017']

ðŸ“Š Layer: HF_l4_FDCA.slice_att.linear.0
   â”œâ”€ Features: 1
   â”œâ”€ Mean Importance: 0.0000
   â”œâ”€ Max Importance: 0.0000
   â”œâ”€ Min Importance: 0.0000
   â””â”€ Top-5 Important Features: [0]
      â””â”€ Top-5 Values: ['0.0000']

ðŸ“Š Layer: HF_l4_FDCA.slice_att.linear.1
   â”œâ”€ Features: 1
   â”œâ”€ Mean Importance: 0.0000
   â”œâ”€ Max Importance: 0.0000
   â”œâ”€ Min Importance: 0.0000
   â””â”€ Top-5 Important Features: [0]
      â””â”€ Top-5 Values: ['0.0000']

ðŸ“Š Layer: HF_l4_FDCA.slice_att.linear.2
   â”œâ”€ Features: 1
   â”œâ”€ Mean Importance: 0.0000
   â”œâ”€ Max Importance: 0.0000
   â”œâ”€ Min Importance: 0.0000
   â””â”€ Top-5 Important Features: [0]
      â””â”€ Top-5 Values: ['0.0000']

ðŸ“Š Layer: HF_l4_FDCA.slice_att.linear
   â”œâ”€ Features: 1
   â”œâ”€ Mean Importance: 0.0000
   â”œâ”€ Max Importance: 0.0000
   â”œâ”€ Min Importance: 0.0000
   â””â”€ Top-5 Important Features: [0]
      â””â”€ Top-5 Values: ['0.0000']

ðŸ“Š Layer: HF_l4_FDCA.slice_att.non_linear
   â”œâ”€ Features: 1
   â”œâ”€ Mean Importance: 0.0000
   â”œâ”€ Max Importance: 0.0000
   â”œâ”€ Min Importance: 0.0000
   â””â”€ Top-5 Important Features: [0]
      â””â”€ Top-5 Values: ['0.0000']

ðŸ“Š Layer: HF_l4_FDCA.slice_att.mean
   â”œâ”€ Features: 1
   â”œâ”€ Mean Importance: 0.0000
   â”œâ”€ Max Importance: 0.0000
   â”œâ”€ Min Importance: 0.0000
   â””â”€ Top-5 Important Features: [0]
      â””â”€ Top-5 Values: ['0.0000']

ðŸ“Š Layer: HF_l4_FDCA.slice_att.log_diag
   â”œâ”€ Features: 1
   â”œâ”€ Mean Importance: 0.0000
   â”œâ”€ Max Importance: 0.0000
   â”œâ”€ Min Importance: 0.0000
   â””â”€ Top-5 Important Features: [0]
      â””â”€ Top-5 Values: ['0.0000']

ðŸ“Š Layer: HF_l4_FDCA.slice_att.factor
   â”œâ”€ Features: 1
   â”œâ”€ Mean Importance: 0.0000
   â”œâ”€ Max Importance: 0.0000
   â”œâ”€ Min Importance: 0.0000
   â””â”€ Top-5 Important Features: [0]
      â””â”€ Top-5 Values: ['0.0000']

ðŸ“Š Layer: HF_l4_FDCA.slice_att
   â”œâ”€ Features: 1
   â”œâ”€ Mean Importance: 0.0113
   â”œâ”€ Max Importance: 0.0113
   â”œâ”€ Min Importance: 0.0113
   â””â”€ Top-5 Important Features: [0]
      â””â”€ Top-5 Values: ['0.0113']

ðŸ“Š Layer: HF_l4_FDCA
   â”œâ”€ Features: 1
   â”œâ”€ Mean Importance: 2.2615
   â”œâ”€ Max Importance: 2.2615
   â”œâ”€ Min Importance: 2.2615
   â””â”€ Top-5 Important Features: [0]
      â””â”€ Top-5 Values: ['2.2615']

ðŸ“Š Layer: HF_l5_FDCA.semantic_att
   â”œâ”€ Features: 1
   â”œâ”€ Mean Importance: 0.0647
   â”œâ”€ Max Importance: 0.0647
   â”œâ”€ Min Importance: 0.0647
   â””â”€ Top-5 Important Features: [0]
      â””â”€ Top-5 Values: ['0.0647']

ðŸ“Š Layer: HF_l5_FDCA.positional_att.conv
   â”œâ”€ Features: 1
   â”œâ”€ Mean Importance: 16.7104
   â”œâ”€ Max Importance: 16.7104
   â”œâ”€ Min Importance: 16.7104
   â””â”€ Top-5 Important Features: [0]
      â””â”€ Top-5 Values: ['16.7104']

ðŸ“Š Layer: HF_l5_FDCA.positional_att
   â”œâ”€ Features: 1
   â”œâ”€ Mean Importance: 0.0001
   â”œâ”€ Max Importance: 0.0001
   â”œâ”€ Min Importance: 0.0001
   â””â”€ Top-5 Important Features: [0]
      â””â”€ Top-5 Values: ['0.0001']

ðŸ“Š Layer: HF_l5_FDCA.slice_att.linear.0
   â”œâ”€ Features: 1
   â”œâ”€ Mean Importance: 0.0000
   â”œâ”€ Max Importance: 0.0000
   â”œâ”€ Min Importance: 0.0000
   â””â”€ Top-5 Important Features: [0]
      â””â”€ Top-5 Values: ['0.0000']

ðŸ“Š Layer: HF_l5_FDCA.slice_att.linear.1
   â”œâ”€ Features: 1
   â”œâ”€ Mean Importance: 0.0000
   â”œâ”€ Max Importance: 0.0000
   â”œâ”€ Min Importance: 0.0000
   â””â”€ Top-5 Important Features: [0]
      â””â”€ Top-5 Values: ['0.0000']

ðŸ“Š Layer: HF_l5_FDCA.slice_att.linear.2
   â”œâ”€ Features: 1
   â”œâ”€ Mean Importance: 0.0000
   â”œâ”€ Max Importance: 0.0000
   â”œâ”€ Min Importance: 0.0000
   â””â”€ Top-5 Important Features: [0]
      â””â”€ Top-5 Values: ['0.0000']

ðŸ“Š Layer: HF_l5_FDCA.slice_att.linear
   â”œâ”€ Features: 1
   â”œâ”€ Mean Importance: 0.0000
   â”œâ”€ Max Importance: 0.0000
   â”œâ”€ Min Importance: 0.0000
   â””â”€ Top-5 Important Features: [0]
      â””â”€ Top-5 Values: ['0.0000']

ðŸ“Š Layer: HF_l5_FDCA.slice_att.non_linear
   â”œâ”€ Features: 1
   â”œâ”€ Mean Importance: 0.0000
   â”œâ”€ Max Importance: 0.0000
   â”œâ”€ Min Importance: 0.0000
   â””â”€ Top-5 Important Features: [0]
      â””â”€ Top-5 Values: ['0.0000']

ðŸ“Š Layer: HF_l5_FDCA.slice_att.mean
   â”œâ”€ Features: 1
   â”œâ”€ Mean Importance: 0.0000
   â”œâ”€ Max Importance: 0.0000
   â”œâ”€ Min Importance: 0.0000
   â””â”€ Top-5 Important Features: [0]
      â””â”€ Top-5 Values: ['0.0000']

ðŸ“Š Layer: HF_l5_FDCA.slice_att.log_diag
   â”œâ”€ Features: 1
   â”œâ”€ Mean Importance: 0.0000
   â”œâ”€ Max Importance: 0.0000
   â”œâ”€ Min Importance: 0.0000
   â””â”€ Top-5 Important Features: [0]
      â””â”€ Top-5 Values: ['0.0000']

ðŸ“Š Layer: HF_l5_FDCA.slice_att.factor
   â”œâ”€ Features: 1
   â”œâ”€ Mean Importance: 0.0000
   â”œâ”€ Max Importance: 0.0000
   â”œâ”€ Min Importance: 0.0000
   â””â”€ Top-5 Important Features: [0]
      â””â”€ Top-5 Values: ['0.0000']

ðŸ“Š Layer: HF_l5_FDCA.slice_att
   â”œâ”€ Features: 1
   â”œâ”€ Mean Importance: 0.0003
   â”œâ”€ Max Importance: 0.0003
   â”œâ”€ Min Importance: 0.0003
   â””â”€ Top-5 Important Features: [0]
      â””â”€ Top-5 Values: ['0.0003']

ðŸ“Š Layer: HF_l5_FDCA
   â”œâ”€ Features: 1
   â”œâ”€ Mean Importance: 0.0009
   â”œâ”€ Max Importance: 0.0009
   â”œâ”€ Min Importance: 0.0009
   â””â”€ Top-5 Important Features: [0]
      â””â”€ Top-5 Values: ['0.0009']

======================================================================
âœ“ Mechanistic analysis complete

[3] Generating Grad-CAM...
Warning: Failed to generate CAM for class 0: element 0 of tensors does not require grad and does not have a grad_fn
Warning: Failed to generate CAM for class 1: element 0 of tensors does not require grad and does not have a grad_fn
Warning: Failed to generate CAM for class 2: element 0 of tensors does not require grad and does not have a grad_fn
Warning: Failed to generate CAM for class 3: element 0 of tensors does not require grad and does not have a grad_fn
[4] Analyzing frequency components...
âœ“ Saved: outputs/xai_2025-11-15_17-25-23/freq_component/sample_0001_freq_comp.png
âœ“ Evaluation complete for sample_0001
Evaluating:   5%|5         | 2/38 [00:38<11:19, 18.86s/it]
[1] Getting primary prediction...

[METRICS FOR sample_0002]
==================================================
class_0: Dice=0.9970, IoU=0.9940
class_1: Dice=0.9447, IoU=0.8952
class_2: Dice=0.6756, IoU=0.5101
class_3: Dice=0.8275, IoU=0.7057
==================================================

[2] Generating attention maps...
Clipping input data to the valid range for imshow with RGB data ([0..1] for floats or [0..255] for integers).
Clipping input data to the valid range for imshow with RGB data ([0..1] for floats or [0..255] for integers).
âœ“ Saved: outputs/xai_2025-11-15_17-25-23/attention/sample_0002_attention.png

[MECHANISTIC INTERPRETABILITY ANALYSIS]
======================================================================
Sample: sample_0002
======================================================================

ðŸ“Š Layer: LF_l4_FDCA.semantic_att
   â”œâ”€ Features: 1
   â”œâ”€ Mean Importance: 0.1313
   â”œâ”€ Max Importance: 0.1313
   â”œâ”€ Min Importance: 0.1313
   â””â”€ Top-5 Important Features: [0]
      â””â”€ Top-5 Values: ['0.1313']

ðŸ“Š Layer: LF_l4_FDCA.positional_att.conv
   â”œâ”€ Features: 1
   â”œâ”€ Mean Importance: 257.9340
   â”œâ”€ Max Importance: 257.9340
   â”œâ”€ Min Importance: 257.9340
   â””â”€ Top-5 Important Features: [0]
      â””â”€ Top-5 Values: ['257.9340']

ðŸ“Š Layer: LF_l4_FDCA.positional_att
   â”œâ”€ Features: 1
   â”œâ”€ Mean Importance: 52.6325
   â”œâ”€ Max Importance: 52.6325
   â”œâ”€ Min Importance: 52.6325
   â””â”€ Top-5 Important Features: [0]
      â””â”€ Top-5 Values: ['52.6325']

ðŸ“Š Layer: LF_l4_FDCA.slice_att.linear.0
   â”œâ”€ Features: 1
   â”œâ”€ Mean Importance: 75.3637
   â”œâ”€ Max Importance: 75.3637
   â”œâ”€ Min Importance: 75.3637
   â””â”€ Top-5 Important Features: [0]
      â””â”€ Top-5 Values: ['75.3637']

ðŸ“Š Layer: LF_l4_FDCA.slice_att.linear.1
   â”œâ”€ Features: 1
   â”œâ”€ Mean Importance: 63.9374
   â”œâ”€ Max Importance: 63.9374
   â”œâ”€ Min Importance: 63.9374
   â””â”€ Top-5 Important Features: [0]
      â””â”€ Top-5 Values: ['63.9374']

ðŸ“Š Layer: LF_l4_FDCA.slice_att.linear.2
   â”œâ”€ Features: 1
   â”œâ”€ Mean Importance: 60.6532
   â”œâ”€ Max Importance: 60.6532
   â”œâ”€ Min Importance: 60.6532
   â””â”€ Top-5 Important Features: [0]
      â””â”€ Top-5 Values: ['60.6532']

ðŸ“Š Layer: LF_l4_FDCA.slice_att.linear
   â”œâ”€ Features: 1
   â”œâ”€ Mean Importance: 60.6532
   â”œâ”€ Max Importance: 60.6532
   â”œâ”€ Min Importance: 60.6532
   â””â”€ Top-5 Important Features: [0]
      â””â”€ Top-5 Values: ['60.6532']

ðŸ“Š Layer: LF_l4_FDCA.slice_att.non_linear
   â”œâ”€ Features: 1
   â”œâ”€ Mean Importance: 25265008.0000
   â”œâ”€ Max Importance: 25265008.0000
   â”œâ”€ Min Importance: 25265008.0000
   â””â”€ Top-5 Important Features: [0]
      â””â”€ Top-5 Values: ['25265008.0000']

ðŸ“Š Layer: LF_l4_FDCA.slice_att.mean
   â”œâ”€ Features: 1
   â”œâ”€ Mean Importance: 100933912.0000
   â”œâ”€ Max Importance: 100933912.0000
   â”œâ”€ Min Importance: 100933912.0000
   â””â”€ Top-5 Important Features: [0]
      â””â”€ Top-5 Values: ['100933912.0000']

ðŸ“Š Layer: LF_l4_FDCA.slice_att.log_diag
   â”œâ”€ Features: 1
   â”œâ”€ Mean Importance: 6255.8457
   â”œâ”€ Max Importance: 6255.8457
   â”œâ”€ Min Importance: 6255.8457
   â””â”€ Top-5 Important Features: [0]
      â””â”€ Top-5 Values: ['6255.8457']

ðŸ“Š Layer: LF_l4_FDCA.slice_att.factor
   â”œâ”€ Features: 1
   â”œâ”€ Mean Importance: 39096224.0000
   â”œâ”€ Max Importance: 39096224.0000
   â”œâ”€ Min Importance: 39096224.0000
   â””â”€ Top-5 Important Features: [0]
      â””â”€ Top-5 Values: ['39096224.0000']

ðŸ“Š Layer: LF_l4_FDCA.slice_att
   â”œâ”€ Features: 1
   â”œâ”€ Mean Importance: 1150268.7500
   â”œâ”€ Max Importance: 1150268.7500
   â”œâ”€ Min Importance: 1150268.7500
   â””â”€ Top-5 Important Features: [0]
      â””â”€ Top-5 Values: ['1150268.7500']

ðŸ“Š Layer: LF_l4_FDCA
   â”œâ”€ Features: 1
   â”œâ”€ Mean Importance: 17126256180985856.0000
   â”œâ”€ Max Importance: 17126256180985856.0000
   â”œâ”€ Min Importance: 17126256180985856.0000
   â””â”€ Top-5 Important Features: [0]
      â””â”€ Top-5 Values: ['17126256180985856.0000']

ðŸ“Š Layer: LF_l5_FDCA.semantic_att
   â”œâ”€ Features: 1
   â”œâ”€ Mean Importance: 0.0830
   â”œâ”€ Max Importance: 0.0830
   â”œâ”€ Min Importance: 0.0830
   â””â”€ Top-5 Important Features: [0]
      â””â”€ Top-5 Values: ['0.0830']

ðŸ“Š Layer: LF_l5_FDCA.positional_att.conv
   â”œâ”€ Features: 1
   â”œâ”€ Mean Importance: 67.1125
   â”œâ”€ Max Importance: 67.1125
   â”œâ”€ Min Importance: 67.1125
   â””â”€ Top-5 Important Features: [0]
      â””â”€ Top-5 Values: ['67.1125']

ðŸ“Š Layer: LF_l5_FDCA.positional_att
   â”œâ”€ Features: 1
   â”œâ”€ Mean Importance: 0.0000
   â”œâ”€ Max Importance: 0.0000
   â”œâ”€ Min Importance: 0.0000
   â””â”€ Top-5 Important Features: [0]
      â””â”€ Top-5 Values: ['0.0000']

ðŸ“Š Layer: LF_l5_FDCA.slice_att.linear.0
   â”œâ”€ Features: 1
   â”œâ”€ Mean Importance: 0.0000
   â”œâ”€ Max Importance: 0.0000
   â”œâ”€ Min Importance: 0.0000
   â””â”€ Top-5 Important Features: [0]
      â””â”€ Top-5 Values: ['0.0000']

ðŸ“Š Layer: LF_l5_FDCA.slice_att.linear.1
   â”œâ”€ Features: 1
   â”œâ”€ Mean Importance: 0.0000
   â”œâ”€ Max Importance: 0.0000
   â”œâ”€ Min Importance: 0.0000
   â””â”€ Top-5 Important Features: [0]
      â””â”€ Top-5 Values: ['0.0000']

ðŸ“Š Layer: LF_l5_FDCA.slice_att.linear.2
   â”œâ”€ Features: 1
   â”œâ”€ Mean Importance: 0.0000
   â”œâ”€ Max Importance: 0.0000
   â”œâ”€ Min Importance: 0.0000
   â””â”€ Top-5 Important Features: [0]
      â””â”€ Top-5 Values: ['0.0000']

ðŸ“Š Layer: LF_l5_FDCA.slice_att.linear
   â”œâ”€ Features: 1
   â”œâ”€ Mean Importance: 0.0000
   â”œâ”€ Max Importance: 0.0000
   â”œâ”€ Min Importance: 0.0000
   â””â”€ Top-5 Important Features: [0]
      â””â”€ Top-5 Values: ['0.0000']

ðŸ“Š Layer: LF_l5_FDCA.slice_att.non_linear
   â”œâ”€ Features: 1
   â”œâ”€ Mean Importance: 0.0000
   â”œâ”€ Max Importance: 0.0000
   â”œâ”€ Min Importance: 0.0000
   â””â”€ Top-5 Important Features: [0]
      â””â”€ Top-5 Values: ['0.0000']

ðŸ“Š Layer: LF_l5_FDCA.slice_att.mean
   â”œâ”€ Features: 1
   â”œâ”€ Mean Importance: 0.0017
   â”œâ”€ Max Importance: 0.0017
   â”œâ”€ Min Importance: 0.0017
   â””â”€ Top-5 Important Features: [0]
      â””â”€ Top-5 Values: ['0.0017']

ðŸ“Š Layer: LF_l5_FDCA.slice_att.log_diag
   â”œâ”€ Features: 1
   â”œâ”€ Mean Importance: 0.0000
   â”œâ”€ Max Importance: 0.0000
   â”œâ”€ Min Importance: 0.0000
   â””â”€ Top-5 Important Features: [0]
      â””â”€ Top-5 Values: ['0.0000']

ðŸ“Š Layer: LF_l5_FDCA.slice_att.factor
   â”œâ”€ Features: 1
   â”œâ”€ Mean Importance: 0.0001
   â”œâ”€ Max Importance: 0.0001
   â”œâ”€ Min Importance: 0.0001
   â””â”€ Top-5 Important Features: [0]
      â””â”€ Top-5 Values: ['0.0001']

ðŸ“Š Layer: LF_l5_FDCA.slice_att
   â”œâ”€ Features: 1
   â”œâ”€ Mean Importance: 0.0000
   â”œâ”€ Max Importance: 0.0000
   â”œâ”€ Min Importance: 0.0000
   â””â”€ Top-5 Important Features: [0]
      â””â”€ Top-5 Values: ['0.0000']

ðŸ“Š Layer: LF_l5_FDCA
   â”œâ”€ Features: 1
   â”œâ”€ Mean Importance: 0.0000
   â”œâ”€ Max Importance: 0.0000
   â”œâ”€ Min Importance: 0.0000
   â””â”€ Top-5 Important Features: [0]
      â””â”€ Top-5 Values: ['0.0000']

ðŸ“Š Layer: HF_l4_FDCA.semantic_att
   â”œâ”€ Features: 1
   â”œâ”€ Mean Importance: 0.0817
   â”œâ”€ Max Importance: 0.0817
   â”œâ”€ Min Importance: 0.0817
   â””â”€ Top-5 Important Features: [0]
      â””â”€ Top-5 Values: ['0.0817']

ðŸ“Š Layer: HF_l4_FDCA.positional_att.conv
   â”œâ”€ Features: 1
   â”œâ”€ Mean Importance: 8.2780
   â”œâ”€ Max Importance: 8.2780
   â”œâ”€ Min Importance: 8.2780
   â””â”€ Top-5 Important Features: [0]
      â””â”€ Top-5 Values: ['8.2780']

ðŸ“Š Layer: HF_l4_FDCA.positional_att
   â”œâ”€ Features: 1
   â”œâ”€ Mean Importance: 0.0018
   â”œâ”€ Max Importance: 0.0018
   â”œâ”€ Min Importance: 0.0018
   â””â”€ Top-5 Important Features: [0]
      â””â”€ Top-5 Values: ['0.0018']

ðŸ“Š Layer: HF_l4_FDCA.slice_att.linear.0
   â”œâ”€ Features: 1
   â”œâ”€ Mean Importance: 0.0000
   â”œâ”€ Max Importance: 0.0000
   â”œâ”€ Min Importance: 0.0000
   â””â”€ Top-5 Important Features: [0]
      â””â”€ Top-5 Values: ['0.0000']

ðŸ“Š Layer: HF_l4_FDCA.slice_att.linear.1
   â”œâ”€ Features: 1
   â”œâ”€ Mean Importance: 0.0000
   â”œâ”€ Max Importance: 0.0000
   â”œâ”€ Min Importance: 0.0000
   â””â”€ Top-5 Important Features: [0]
      â””â”€ Top-5 Values: ['0.0000']

ðŸ“Š Layer: HF_l4_FDCA.slice_att.linear.2
   â”œâ”€ Features: 1
   â”œâ”€ Mean Importance: 0.0000
   â”œâ”€ Max Importance: 0.0000
   â”œâ”€ Min Importance: 0.0000
   â””â”€ Top-5 Important Features: [0]
      â””â”€ Top-5 Values: ['0.0000']

ðŸ“Š Layer: HF_l4_FDCA.slice_att.linear
   â”œâ”€ Features: 1
   â”œâ”€ Mean Importance: 0.0000
   â”œâ”€ Max Importance: 0.0000
   â”œâ”€ Min Importance: 0.0000
   â””â”€ Top-5 Important Features: [0]
      â””â”€ Top-5 Values: ['0.0000']

ðŸ“Š Layer: HF_l4_FDCA.slice_att.non_linear
   â”œâ”€ Features: 1
   â”œâ”€ Mean Importance: 0.0000
   â”œâ”€ Max Importance: 0.0000
   â”œâ”€ Min Importance: 0.0000
   â””â”€ Top-5 Important Features: [0]
      â””â”€ Top-5 Values: ['0.0000']

ðŸ“Š Layer: HF_l4_FDCA.slice_att.mean
   â”œâ”€ Features: 1
   â”œâ”€ Mean Importance: 0.0000
   â”œâ”€ Max Importance: 0.0000
   â”œâ”€ Min Importance: 0.0000
   â””â”€ Top-5 Important Features: [0]
      â””â”€ Top-5 Values: ['0.0000']

ðŸ“Š Layer: HF_l4_FDCA.slice_att.log_diag
   â”œâ”€ Features: 1
   â”œâ”€ Mean Importance: 0.0000
   â”œâ”€ Max Importance: 0.0000
   â”œâ”€ Min Importance: 0.0000
   â””â”€ Top-5 Important Features: [0]
      â””â”€ Top-5 Values: ['0.0000']

ðŸ“Š Layer: HF_l4_FDCA.slice_att.factor
   â”œâ”€ Features: 1
   â”œâ”€ Mean Importance: 0.0000
   â”œâ”€ Max Importance: 0.0000
   â”œâ”€ Min Importance: 0.0000
   â””â”€ Top-5 Important Features: [0]
      â””â”€ Top-5 Values: ['0.0000']

ðŸ“Š Layer: HF_l4_FDCA.slice_att
   â”œâ”€ Features: 1
   â”œâ”€ Mean Importance: 0.0102
   â”œâ”€ Max Importance: 0.0102
   â”œâ”€ Min Importance: 0.0102
   â””â”€ Top-5 Important Features: [0]
      â””â”€ Top-5 Values: ['0.0102']

ðŸ“Š Layer: HF_l4_FDCA
   â”œâ”€ Features: 1
   â”œâ”€ Mean Importance: 2.1518
   â”œâ”€ Max Importance: 2.1518
   â”œâ”€ Min Importance: 2.1518
   â””â”€ Top-5 Important Features: [0]
      â””â”€ Top-5 Values: ['2.1518']

ðŸ“Š Layer: HF_l5_FDCA.semantic_att
   â”œâ”€ Features: 1
   â”œâ”€ Mean Importance: 0.0650
   â”œâ”€ Max Importance: 0.0650
   â”œâ”€ Min Importance: 0.0650
   â””â”€ Top-5 Important Features: [0]
      â””â”€ Top-5 Values: ['0.0650']

ðŸ“Š Layer: HF_l5_FDCA.positional_att.conv
   â”œâ”€ Features: 1
   â”œâ”€ Mean Importance: 12.7636
   â”œâ”€ Max Importance: 12.7636
   â”œâ”€ Min Importance: 12.7636
   â””â”€ Top-5 Important Features: [0]
      â””â”€ Top-5 Values: ['12.7636']

ðŸ“Š Layer: HF_l5_FDCA.positional_att
   â”œâ”€ Features: 1
   â”œâ”€ Mean Importance: 0.0001
   â”œâ”€ Max Importance: 0.0001
   â”œâ”€ Min Importance: 0.0001
   â””â”€ Top-5 Important Features: [0]
      â””â”€ Top-5 Values: ['0.0001']

ðŸ“Š Layer: HF_l5_FDCA.slice_att.linear.0
   â”œâ”€ Features: 1
   â”œâ”€ Mean Importance: 0.0000
   â”œâ”€ Max Importance: 0.0000
   â”œâ”€ Min Importance: 0.0000
   â””â”€ Top-5 Important Features: [0]
      â””â”€ Top-5 Values: ['0.0000']

ðŸ“Š Layer: HF_l5_FDCA.slice_att.linear.1
   â”œâ”€ Features: 1
   â”œâ”€ Mean Importance: 0.0000
   â”œâ”€ Max Importance: 0.0000
   â”œâ”€ Min Importance: 0.0000
   â””â”€ Top-5 Important Features: [0]
      â””â”€ Top-5 Values: ['0.0000']

ðŸ“Š Layer: HF_l5_FDCA.slice_att.linear.2
   â”œâ”€ Features: 1
   â”œâ”€ Mean Importance: 0.0000
   â”œâ”€ Max Importance: 0.0000
   â”œâ”€ Min Importance: 0.0000
   â””â”€ Top-5 Important Features: [0]
      â””â”€ Top-5 Values: ['0.0000']

ðŸ“Š Layer: HF_l5_FDCA.slice_att.linear
   â”œâ”€ Features: 1
   â”œâ”€ Mean Importance: 0.0000
   â”œâ”€ Max Importance: 0.0000
   â”œâ”€ Min Importance: 0.0000
   â””â”€ Top-5 Important Features: [0]
      â””â”€ Top-5 Values: ['0.0000']

ðŸ“Š Layer: HF_l5_FDCA.slice_att.non_linear
   â”œâ”€ Features: 1
   â”œâ”€ Mean Importance: 0.0000
   â”œâ”€ Max Importance: 0.0000
   â”œâ”€ Min Importance: 0.0000
   â””â”€ Top-5 Important Features: [0]
      â””â”€ Top-5 Values: ['0.0000']

ðŸ“Š Layer: HF_l5_FDCA.slice_att.mean
   â”œâ”€ Features: 1
   â”œâ”€ Mean Importance: 0.0000
   â”œâ”€ Max Importance: 0.0000
   â”œâ”€ Min Importance: 0.0000
   â””â”€ Top-5 Important Features: [0]
      â””â”€ Top-5 Values: ['0.0000']

ðŸ“Š Layer: HF_l5_FDCA.slice_att.log_diag
   â”œâ”€ Features: 1
   â”œâ”€ Mean Importance: 0.0000
   â”œâ”€ Max Importance: 0.0000
   â”œâ”€ Min Importance: 0.0000
   â””â”€ Top-5 Important Features: [0]
      â””â”€ Top-5 Values: ['0.0000']

ðŸ“Š Layer: HF_l5_FDCA.slice_att.factor
   â”œâ”€ Features: 1
   â”œâ”€ Mean Importance: 0.0000
   â”œâ”€ Max Importance: 0.0000
   â”œâ”€ Min Importance: 0.0000
   â””â”€ Top-5 Important Features: [0]
      â””â”€ Top-5 Values: ['0.0000']

ðŸ“Š Layer: HF_l5_FDCA.slice_att
   â”œâ”€ Features: 1
   â”œâ”€ Mean Importance: 0.0002
   â”œâ”€ Max Importance: 0.0002
   â”œâ”€ Min Importance: 0.0002
   â””â”€ Top-5 Important Features: [0]
      â””â”€ Top-5 Values: ['0.0002']

ðŸ“Š Layer: HF_l5_FDCA
   â”œâ”€ Features: 1
   â”œâ”€ Mean Importance: 0.0005
   â”œâ”€ Max Importance: 0.0005
   â”œâ”€ Min Importance: 0.0005
   â””â”€ Top-5 Important Features: [0]
      â””â”€ Top-5 Values: ['0.0005']

======================================================================
âœ“ Mechanistic analysis complete

[3] Generating Grad-CAM...
Warning: Failed to generate CAM for class 0: element 0 of tensors does not require grad and does not have a grad_fn
Warning: Failed to generate CAM for class 1: element 0 of tensors does not require grad and does not have a grad_fn
Warning: Failed to generate CAM for class 2: element 0 of tensors does not require grad and does not have a grad_fn
Warning: Failed to generate CAM for class 3: element 0 of tensors does not require grad and does not have a grad_fn
[4] Analyzing frequency components...
âœ“ Saved: outputs/xai_2025-11-15_17-25-23/freq_component/sample_0002_freq_comp.png
âœ“ Evaluation complete for sample_0002
Evaluating:   8%|7         | 3/38 [00:54<10:05, 17.30s/it]
[1] Getting primary prediction...

[METRICS FOR sample_0003]
==================================================
class_0: Dice=0.9992, IoU=0.9984
class_1: Dice=0.4896, IoU=0.3241
class_2: Dice=0.7833, IoU=0.6438
class_3: Dice=0.7796, IoU=0.6387
==================================================

[2] Generating attention maps...
Clipping input data to the valid range for imshow with RGB data ([0..1] for floats or [0..255] for integers).
Clipping input data to the valid range for imshow with RGB data ([0..1] for floats or [0..255] for integers).
âœ“ Saved: outputs/xai_2025-11-15_17-25-23/attention/sample_0003_attention.png

[MECHANISTIC INTERPRETABILITY ANALYSIS]
======================================================================
Sample: sample_0003
======================================================================

ðŸ“Š Layer: LF_l4_FDCA.semantic_att
   â”œâ”€ Features: 1
   â”œâ”€ Mean Importance: 0.1450
   â”œâ”€ Max Importance: 0.1450
   â”œâ”€ Min Importance: 0.1450
   â””â”€ Top-5 Important Features: [0]
      â””â”€ Top-5 Values: ['0.1450']

ðŸ“Š Layer: LF_l4_FDCA.positional_att.conv
   â”œâ”€ Features: 1
   â”œâ”€ Mean Importance: 291.9435
   â”œâ”€ Max Importance: 291.9435
   â”œâ”€ Min Importance: 291.9435
   â””â”€ Top-5 Important Features: [0]
      â””â”€ Top-5 Values: ['291.9435']

ðŸ“Š Layer: LF_l4_FDCA.positional_att
   â”œâ”€ Features: 1
   â”œâ”€ Mean Importance: 58.1776
   â”œâ”€ Max Importance: 58.1776
   â”œâ”€ Min Importance: 58.1776
   â””â”€ Top-5 Important Features: [0]
      â””â”€ Top-5 Values: ['58.1776']

ðŸ“Š Layer: LF_l4_FDCA.slice_att.linear.0
   â”œâ”€ Features: 1
   â”œâ”€ Mean Importance: 79.8711
   â”œâ”€ Max Importance: 79.8711
   â”œâ”€ Min Importance: 79.8711
   â””â”€ Top-5 Important Features: [0]
      â””â”€ Top-5 Values: ['79.8711']

ðŸ“Š Layer: LF_l4_FDCA.slice_att.linear.1
   â”œâ”€ Features: 1
   â”œâ”€ Mean Importance: 67.7609
   â”œâ”€ Max Importance: 67.7609
   â”œâ”€ Min Importance: 67.7609
   â””â”€ Top-5 Important Features: [0]
      â””â”€ Top-5 Values: ['67.7609']

ðŸ“Š Layer: LF_l4_FDCA.slice_att.linear.2
   â”œâ”€ Features: 1
   â”œâ”€ Mean Importance: 64.2727
   â”œâ”€ Max Importance: 64.2727
   â”œâ”€ Min Importance: 64.2727
   â””â”€ Top-5 Important Features: [0]
      â””â”€ Top-5 Values: ['64.2727']

ðŸ“Š Layer: LF_l4_FDCA.slice_att.linear
   â”œâ”€ Features: 1
   â”œâ”€ Mean Importance: 64.2727
   â”œâ”€ Max Importance: 64.2727
   â”œâ”€ Min Importance: 64.2727
   â””â”€ Top-5 Important Features: [0]
      â””â”€ Top-5 Values: ['64.2727']

ðŸ“Š Layer: LF_l4_FDCA.slice_att.non_linear
   â”œâ”€ Features: 1
   â”œâ”€ Mean Importance: 32396574.0000
   â”œâ”€ Max Importance: 32396574.0000
   â”œâ”€ Min Importance: 32396574.0000
   â””â”€ Top-5 Important Features: [0]
      â””â”€ Top-5 Values: ['32396574.0000']

ðŸ“Š Layer: LF_l4_FDCA.slice_att.mean
   â”œâ”€ Features: 1
   â”œâ”€ Mean Importance: 129423024.0000
   â”œâ”€ Max Importance: 129423024.0000
   â”œâ”€ Min Importance: 129423024.0000
   â””â”€ Top-5 Important Features: [0]
      â””â”€ Top-5 Values: ['129423024.0000']

ðŸ“Š Layer: LF_l4_FDCA.slice_att.log_diag
   â”œâ”€ Features: 1
   â”œâ”€ Mean Importance: 8021.6001
   â”œâ”€ Max Importance: 8021.6001
   â”œâ”€ Min Importance: 8021.6001
   â””â”€ Top-5 Important Features: [0]
      â””â”€ Top-5 Values: ['8021.6001']

ðŸ“Š Layer: LF_l4_FDCA.slice_att.factor
   â”œâ”€ Features: 1
   â”œâ”€ Mean Importance: 50131324.0000
   â”œâ”€ Max Importance: 50131324.0000
   â”œâ”€ Min Importance: 50131324.0000
   â””â”€ Top-5 Important Features: [0]
      â””â”€ Top-5 Values: ['50131324.0000']

ðŸ“Š Layer: LF_l4_FDCA.slice_att
   â”œâ”€ Features: 1
   â”œâ”€ Mean Importance: 20773802.0000
   â”œâ”€ Max Importance: 20773802.0000
   â”œâ”€ Min Importance: 20773802.0000
   â””â”€ Top-5 Important Features: [0]
      â””â”€ Top-5 Values: ['20773802.0000']

ðŸ“Š Layer: LF_l4_FDCA
   â”œâ”€ Features: 1
   â”œâ”€ Mean Importance: 2823536239402024960.0000
   â”œâ”€ Max Importance: 2823536239402024960.0000
   â”œâ”€ Min Importance: 2823536239402024960.0000
   â””â”€ Top-5 Important Features: [0]
      â””â”€ Top-5 Values: ['2823536239402024960.0000']

ðŸ“Š Layer: LF_l5_FDCA.semantic_att
   â”œâ”€ Features: 1
   â”œâ”€ Mean Importance: 0.0878
   â”œâ”€ Max Importance: 0.0878
   â”œâ”€ Min Importance: 0.0878
   â””â”€ Top-5 Important Features: [0]
      â””â”€ Top-5 Values: ['0.0878']

ðŸ“Š Layer: LF_l5_FDCA.positional_att.conv
   â”œâ”€ Features: 1
   â”œâ”€ Mean Importance: 61.3653
   â”œâ”€ Max Importance: 61.3653
   â”œâ”€ Min Importance: 61.3653
   â””â”€ Top-5 Important Features: [0]
      â””â”€ Top-5 Values: ['61.3653']

ðŸ“Š Layer: LF_l5_FDCA.positional_att
   â”œâ”€ Features: 1
   â”œâ”€ Mean Importance: 0.0000
   â”œâ”€ Max Importance: 0.0000
   â”œâ”€ Min Importance: 0.0000
   â””â”€ Top-5 Important Features: [0]
      â””â”€ Top-5 Values: ['0.0000']

ðŸ“Š Layer: LF_l5_FDCA.slice_att.linear.0
   â”œâ”€ Features: 1
   â”œâ”€ Mean Importance: 0.0000
   â”œâ”€ Max Importance: 0.0000
   â”œâ”€ Min Importance: 0.0000
   â””â”€ Top-5 Important Features: [0]
      â””â”€ Top-5 Values: ['0.0000']

ðŸ“Š Layer: LF_l5_FDCA.slice_att.linear.1
   â”œâ”€ Features: 1
   â”œâ”€ Mean Importance: 0.0000
   â”œâ”€ Max Importance: 0.0000
   â”œâ”€ Min Importance: 0.0000
   â””â”€ Top-5 Important Features: [0]
      â””â”€ Top-5 Values: ['0.0000']

ðŸ“Š Layer: LF_l5_FDCA.slice_att.linear.2
   â”œâ”€ Features: 1
   â”œâ”€ Mean Importance: 0.0000
   â”œâ”€ Max Importance: 0.0000
   â”œâ”€ Min Importance: 0.0000
   â””â”€ Top-5 Important Features: [0]
      â””â”€ Top-5 Values: ['0.0000']

ðŸ“Š Layer: LF_l5_FDCA.slice_att.linear
   â”œâ”€ Features: 1
   â”œâ”€ Mean Importance: 0.0000
   â”œâ”€ Max Importance: 0.0000
   â”œâ”€ Min Importance: 0.0000
   â””â”€ Top-5 Important Features: [0]
      â””â”€ Top-5 Values: ['0.0000']

ðŸ“Š Layer: LF_l5_FDCA.slice_att.non_linear
   â”œâ”€ Features: 1
   â”œâ”€ Mean Importance: 0.0000
   â”œâ”€ Max Importance: 0.0000
   â”œâ”€ Min Importance: 0.0000
   â””â”€ Top-5 Important Features: [0]
      â””â”€ Top-5 Values: ['0.0000']

ðŸ“Š Layer: LF_l5_FDCA.slice_att.mean
   â”œâ”€ Features: 1
   â”œâ”€ Mean Importance: 0.0017
   â”œâ”€ Max Importance: 0.0017
   â”œâ”€ Min Importance: 0.0017
   â””â”€ Top-5 Important Features: [0]
      â””â”€ Top-5 Values: ['0.0017']

ðŸ“Š Layer: LF_l5_FDCA.slice_att.log_diag
   â”œâ”€ Features: 1
   â”œâ”€ Mean Importance: 0.0000
   â”œâ”€ Max Importance: 0.0000
   â”œâ”€ Min Importance: 0.0000
   â””â”€ Top-5 Important Features: [0]
      â””â”€ Top-5 Values: ['0.0000']

ðŸ“Š Layer: LF_l5_FDCA.slice_att.factor
   â”œâ”€ Features: 1
   â”œâ”€ Mean Importance: 0.0001
   â”œâ”€ Max Importance: 0.0001
   â”œâ”€ Min Importance: 0.0001
   â””â”€ Top-5 Important Features: [0]
      â””â”€ Top-5 Values: ['0.0001']

ðŸ“Š Layer: LF_l5_FDCA.slice_att
   â”œâ”€ Features: 1
   â”œâ”€ Mean Importance: 0.0000
   â”œâ”€ Max Importance: 0.0000
   â”œâ”€ Min Importance: 0.0000
   â””â”€ Top-5 Important Features: [0]
      â””â”€ Top-5 Values: ['0.0000']

ðŸ“Š Layer: LF_l5_FDCA
   â”œâ”€ Features: 1
   â”œâ”€ Mean Importance: 0.0000
   â”œâ”€ Max Importance: 0.0000
   â”œâ”€ Min Importance: 0.0000
   â””â”€ Top-5 Important Features: [0]
      â””â”€ Top-5 Values: ['0.0000']

ðŸ“Š Layer: HF_l4_FDCA.semantic_att
   â”œâ”€ Features: 1
   â”œâ”€ Mean Importance: 0.0842
   â”œâ”€ Max Importance: 0.0842
   â”œâ”€ Min Importance: 0.0842
   â””â”€ Top-5 Important Features: [0]
      â””â”€ Top-5 Values: ['0.0842']

ðŸ“Š Layer: HF_l4_FDCA.positional_att.conv
   â”œâ”€ Features: 1
   â”œâ”€ Mean Importance: 9.5485
   â”œâ”€ Max Importance: 9.5485
   â”œâ”€ Min Importance: 9.5485
   â””â”€ Top-5 Important Features: [0]
      â””â”€ Top-5 Values: ['9.5485']

ðŸ“Š Layer: HF_l4_FDCA.positional_att
   â”œâ”€ Features: 1
   â”œâ”€ Mean Importance: 0.0019
   â”œâ”€ Max Importance: 0.0019
   â”œâ”€ Min Importance: 0.0019
   â””â”€ Top-5 Important Features: [0]
      â””â”€ Top-5 Values: ['0.0019']

ðŸ“Š Layer: HF_l4_FDCA.slice_att.linear.0
   â”œâ”€ Features: 1
   â”œâ”€ Mean Importance: 0.0000
   â”œâ”€ Max Importance: 0.0000
   â”œâ”€ Min Importance: 0.0000
   â””â”€ Top-5 Important Features: [0]
      â””â”€ Top-5 Values: ['0.0000']

ðŸ“Š Layer: HF_l4_FDCA.slice_att.linear.1
   â”œâ”€ Features: 1
   â”œâ”€ Mean Importance: 0.0000
   â”œâ”€ Max Importance: 0.0000
   â”œâ”€ Min Importance: 0.0000
   â””â”€ Top-5 Important Features: [0]
      â””â”€ Top-5 Values: ['0.0000']

ðŸ“Š Layer: HF_l4_FDCA.slice_att.linear.2
   â”œâ”€ Features: 1
   â”œâ”€ Mean Importance: 0.0000
   â”œâ”€ Max Importance: 0.0000
   â”œâ”€ Min Importance: 0.0000
   â””â”€ Top-5 Important Features: [0]
      â””â”€ Top-5 Values: ['0.0000']

ðŸ“Š Layer: HF_l4_FDCA.slice_att.linear
   â”œâ”€ Features: 1
   â”œâ”€ Mean Importance: 0.0000
   â”œâ”€ Max Importance: 0.0000
   â”œâ”€ Min Importance: 0.0000
   â””â”€ Top-5 Important Features: [0]
      â””â”€ Top-5 Values: ['0.0000']

ðŸ“Š Layer: HF_l4_FDCA.slice_att.non_linear
   â”œâ”€ Features: 1
   â”œâ”€ Mean Importance: 0.0000
   â”œâ”€ Max Importance: 0.0000
   â”œâ”€ Min Importance: 0.0000
   â””â”€ Top-5 Important Features: [0]
      â””â”€ Top-5 Values: ['0.0000']

ðŸ“Š Layer: HF_l4_FDCA.slice_att.mean
   â”œâ”€ Features: 1
   â”œâ”€ Mean Importance: 0.0000
   â”œâ”€ Max Importance: 0.0000
   â”œâ”€ Min Importance: 0.0000
   â””â”€ Top-5 Important Features: [0]
      â””â”€ Top-5 Values: ['0.0000']

ðŸ“Š Layer: HF_l4_FDCA.slice_att.log_diag
   â”œâ”€ Features: 1
   â”œâ”€ Mean Importance: 0.0000
   â”œâ”€ Max Importance: 0.0000
   â”œâ”€ Min Importance: 0.0000
   â””â”€ Top-5 Important Features: [0]
      â””â”€ Top-5 Values: ['0.0000']

ðŸ“Š Layer: HF_l4_FDCA.slice_att.factor
   â”œâ”€ Features: 1
   â”œâ”€ Mean Importance: 0.0000
   â”œâ”€ Max Importance: 0.0000
   â”œâ”€ Min Importance: 0.0000
   â””â”€ Top-5 Important Features: [0]
      â””â”€ Top-5 Values: ['0.0000']

ðŸ“Š Layer: HF_l4_FDCA.slice_att
   â”œâ”€ Features: 1
   â”œâ”€ Mean Importance: 0.0074
   â”œâ”€ Max Importance: 0.0074
   â”œâ”€ Min Importance: 0.0074
   â””â”€ Top-5 Important Features: [0]
      â””â”€ Top-5 Values: ['0.0074']

ðŸ“Š Layer: HF_l4_FDCA
   â”œâ”€ Features: 1
   â”œâ”€ Mean Importance: 1.7519
   â”œâ”€ Max Importance: 1.7519
   â”œâ”€ Min Importance: 1.7519
   â””â”€ Top-5 Important Features: [0]
      â””â”€ Top-5 Values: ['1.7519']

ðŸ“Š Layer: HF_l5_FDCA.semantic_att
   â”œâ”€ Features: 1
   â”œâ”€ Mean Importance: 0.0732
   â”œâ”€ Max Importance: 0.0732
   â”œâ”€ Min Importance: 0.0732
   â””â”€ Top-5 Important Features: [0]
      â””â”€ Top-5 Values: ['0.0732']

ðŸ“Š Layer: HF_l5_FDCA.positional_att.conv
   â”œâ”€ Features: 1
   â”œâ”€ Mean Importance: 15.6031
   â”œâ”€ Max Importance: 15.6031
   â”œâ”€ Min Importance: 15.6031
   â””â”€ Top-5 Important Features: [0]
      â””â”€ Top-5 Values: ['15.6031']

ðŸ“Š Layer: HF_l5_FDCA.positional_att
   â”œâ”€ Features: 1
   â”œâ”€ Mean Importance: 0.0001
   â”œâ”€ Max Importance: 0.0001
   â”œâ”€ Min Importance: 0.0001
   â””â”€ Top-5 Important Features: [0]
      â””â”€ Top-5 Values: ['0.0001']

ðŸ“Š Layer: HF_l5_FDCA.slice_att.linear.0
   â”œâ”€ Features: 1
   â”œâ”€ Mean Importance: 0.0000
   â”œâ”€ Max Importance: 0.0000
   â”œâ”€ Min Importance: 0.0000
   â””â”€ Top-5 Important Features: [0]
      â””â”€ Top-5 Values: ['0.0000']

ðŸ“Š Layer: HF_l5_FDCA.slice_att.linear.1
   â”œâ”€ Features: 1
   â”œâ”€ Mean Importance: 0.0000
   â”œâ”€ Max Importance: 0.0000
   â”œâ”€ Min Importance: 0.0000
   â””â”€ Top-5 Important Features: [0]
      â””â”€ Top-5 Values: ['0.0000']

ðŸ“Š Layer: HF_l5_FDCA.slice_att.linear.2
   â”œâ”€ Features: 1
   â”œâ”€ Mean Importance: 0.0000
   â”œâ”€ Max Importance: 0.0000
   â”œâ”€ Min Importance: 0.0000
   â””â”€ Top-5 Important Features: [0]
      â””â”€ Top-5 Values: ['0.0000']

ðŸ“Š Layer: HF_l5_FDCA.slice_att.linear
   â”œâ”€ Features: 1
   â”œâ”€ Mean Importance: 0.0000
   â”œâ”€ Max Importance: 0.0000
   â”œâ”€ Min Importance: 0.0000
   â””â”€ Top-5 Important Features: [0]
      â””â”€ Top-5 Values: ['0.0000']

ðŸ“Š Layer: HF_l5_FDCA.slice_att.non_linear
   â”œâ”€ Features: 1
   â”œâ”€ Mean Importance: 0.0000
   â”œâ”€ Max Importance: 0.0000
   â”œâ”€ Min Importance: 0.0000
   â””â”€ Top-5 Important Features: [0]
      â””â”€ Top-5 Values: ['0.0000']

ðŸ“Š Layer: HF_l5_FDCA.slice_att.mean
   â”œâ”€ Features: 1
   â”œâ”€ Mean Importance: 0.0000
   â”œâ”€ Max Importance: 0.0000
   â”œâ”€ Min Importance: 0.0000
   â””â”€ Top-5 Important Features: [0]
      â””â”€ Top-5 Values: ['0.0000']

ðŸ“Š Layer: HF_l5_FDCA.slice_att.log_diag
   â”œâ”€ Features: 1
   â”œâ”€ Mean Importance: 0.0000
   â”œâ”€ Max Importance: 0.0000
   â”œâ”€ Min Importance: 0.0000
   â””â”€ Top-5 Important Features: [0]
      â””â”€ Top-5 Values: ['0.0000']

ðŸ“Š Layer: HF_l5_FDCA.slice_att.factor
   â”œâ”€ Features: 1
   â”œâ”€ Mean Importance: 0.0000
   â”œâ”€ Max Importance: 0.0000
   â”œâ”€ Min Importance: 0.0000
   â””â”€ Top-5 Important Features: [0]
      â””â”€ Top-5 Values: ['0.0000']

ðŸ“Š Layer: HF_l5_FDCA.slice_att
   â”œâ”€ Features: 1
   â”œâ”€ Mean Importance: 0.0001
   â”œâ”€ Max Importance: 0.0001
   â”œâ”€ Min Importance: 0.0001
   â””â”€ Top-5 Important Features: [0]
      â””â”€ Top-5 Values: ['0.0001']

ðŸ“Š Layer: HF_l5_FDCA
   â”œâ”€ Features: 1
   â”œâ”€ Mean Importance: 0.0001
   â”œâ”€ Max Importance: 0.0001
   â”œâ”€ Min Importance: 0.0001
   â””â”€ Top-5 Important Features: [0]
      â””â”€ Top-5 Values: ['0.0001']

======================================================================
âœ“ Mechanistic analysis complete

[3] Generating Grad-CAM...
Warning: Failed to generate CAM for class 0: element 0 of tensors does not require grad and does not have a grad_fn
Warning: Failed to generate CAM for class 1: element 0 of tensors does not require grad and does not have a grad_fn
Warning: Failed to generate CAM for class 2: element 0 of tensors does not require grad and does not have a grad_fn
Warning: Failed to generate CAM for class 3: element 0 of tensors does not require grad and does not have a grad_fn
[4] Analyzing frequency components...
âœ“ Saved: outputs/xai_2025-11-15_17-25-23/freq_component/sample_0003_freq_comp.png
âœ“ Evaluation complete for sample_0003
Evaluating:  11%|#         | 4/38 [01:10<09:36, 16.96s/it]
[1] Getting primary prediction...

[METRICS FOR sample_0004]
==================================================
class_0: Dice=0.9964, IoU=0.9928
class_1: Dice=0.6900, IoU=0.5268
class_2: Dice=0.1848, IoU=0.1018
class_3: Dice=0.4283, IoU=0.2725
==================================================

[2] Generating attention maps...
Clipping input data to the valid range for imshow with RGB data ([0..1] for floats or [0..255] for integers).
Clipping input data to the valid range for imshow with RGB data ([0..1] for floats or [0..255] for integers).
âœ“ Saved: outputs/xai_2025-11-15_17-25-23/attention/sample_0004_attention.png

[MECHANISTIC INTERPRETABILITY ANALYSIS]
======================================================================
Sample: sample_0004
======================================================================

ðŸ“Š Layer: LF_l4_FDCA.semantic_att
   â”œâ”€ Features: 1
   â”œâ”€ Mean Importance: 0.1253
   â”œâ”€ Max Importance: 0.1253
   â”œâ”€ Min Importance: 0.1253
   â””â”€ Top-5 Important Features: [0]
      â””â”€ Top-5 Values: ['0.1253']

ðŸ“Š Layer: LF_l4_FDCA.positional_att.conv
   â”œâ”€ Features: 1
   â”œâ”€ Mean Importance: 248.7045
   â”œâ”€ Max Importance: 248.7045
   â”œâ”€ Min Importance: 248.7045
   â””â”€ Top-5 Important Features: [0]
      â””â”€ Top-5 Values: ['248.7045']

ðŸ“Š Layer: LF_l4_FDCA.positional_att
   â”œâ”€ Features: 1
   â”œâ”€ Mean Importance: 49.5141
   â”œâ”€ Max Importance: 49.5141
   â”œâ”€ Min Importance: 49.5141
   â””â”€ Top-5 Important Features: [0]
      â””â”€ Top-5 Values: ['49.5141']

ðŸ“Š Layer: LF_l4_FDCA.slice_att.linear.0
   â”œâ”€ Features: 1
   â”œâ”€ Mean Importance: 73.7709
   â”œâ”€ Max Importance: 73.7709
   â”œâ”€ Min Importance: 73.7709
   â””â”€ Top-5 Important Features: [0]
      â””â”€ Top-5 Values: ['73.7709']

ðŸ“Š Layer: LF_l4_FDCA.slice_att.linear.1
   â”œâ”€ Features: 1
   â”œâ”€ Mean Importance: 62.5842
   â”œâ”€ Max Importance: 62.5842
   â”œâ”€ Min Importance: 62.5842
   â””â”€ Top-5 Important Features: [0]
      â””â”€ Top-5 Values: ['62.5842']

ðŸ“Š Layer: LF_l4_FDCA.slice_att.linear.2
   â”œâ”€ Features: 1
   â”œâ”€ Mean Importance: 59.3761
   â”œâ”€ Max Importance: 59.3761
   â”œâ”€ Min Importance: 59.3761
   â””â”€ Top-5 Important Features: [0]
      â””â”€ Top-5 Values: ['59.3761']

ðŸ“Š Layer: LF_l4_FDCA.slice_att.linear
   â”œâ”€ Features: 1
   â”œâ”€ Mean Importance: 59.3761
   â”œâ”€ Max Importance: 59.3761
   â”œâ”€ Min Importance: 59.3761
   â””â”€ Top-5 Important Features: [0]
      â””â”€ Top-5 Values: ['59.3761']

ðŸ“Š Layer: LF_l4_FDCA.slice_att.non_linear
   â”œâ”€ Features: 1
   â”œâ”€ Mean Importance: 23731182.0000
   â”œâ”€ Max Importance: 23731182.0000
   â”œâ”€ Min Importance: 23731182.0000
   â””â”€ Top-5 Important Features: [0]
      â””â”€ Top-5 Values: ['23731182.0000']

ðŸ“Š Layer: LF_l4_FDCA.slice_att.mean
   â”œâ”€ Features: 1
   â”œâ”€ Mean Importance: 94808200.0000
   â”œâ”€ Max Importance: 94808200.0000
   â”œâ”€ Min Importance: 94808200.0000
   â””â”€ Top-5 Important Features: [0]
      â””â”€ Top-5 Values: ['94808200.0000']

ðŸ“Š Layer: LF_l4_FDCA.slice_att.log_diag
   â”œâ”€ Features: 1
   â”œâ”€ Mean Importance: 5876.1577
   â”œâ”€ Max Importance: 5876.1577
   â”œâ”€ Min Importance: 5876.1577
   â””â”€ Top-5 Important Features: [0]
      â””â”€ Top-5 Values: ['5876.1577']

ðŸ“Š Layer: LF_l4_FDCA.slice_att.factor
   â”œâ”€ Features: 1
   â”œâ”€ Mean Importance: 36723480.0000
   â”œâ”€ Max Importance: 36723480.0000
   â”œâ”€ Min Importance: 36723480.0000
   â””â”€ Top-5 Important Features: [0]
      â””â”€ Top-5 Values: ['36723480.0000']

ðŸ“Š Layer: LF_l4_FDCA.slice_att
   â”œâ”€ Features: 1
   â”œâ”€ Mean Importance: 944142.8125
   â”œâ”€ Max Importance: 944142.8125
   â”œâ”€ Min Importance: 944142.8125
   â””â”€ Top-5 Important Features: [0]
      â””â”€ Top-5 Values: ['944142.8125']

ðŸ“Š Layer: LF_l4_FDCA
   â”œâ”€ Features: 1
   â”œâ”€ Mean Importance: 11642810230898688.0000
   â”œâ”€ Max Importance: 11642810230898688.0000
   â”œâ”€ Min Importance: 11642810230898688.0000
   â””â”€ Top-5 Important Features: [0]
      â””â”€ Top-5 Values: ['11642810230898688.0000']

ðŸ“Š Layer: LF_l5_FDCA.semantic_att
   â”œâ”€ Features: 1
   â”œâ”€ Mean Importance: 0.0868
   â”œâ”€ Max Importance: 0.0868
   â”œâ”€ Min Importance: 0.0868
   â””â”€ Top-5 Important Features: [0]
      â””â”€ Top-5 Values: ['0.0868']

ðŸ“Š Layer: LF_l5_FDCA.positional_att.conv
   â”œâ”€ Features: 1
   â”œâ”€ Mean Importance: 61.5991
   â”œâ”€ Max Importance: 61.5991
   â”œâ”€ Min Importance: 61.5991
   â””â”€ Top-5 Important Features: [0]
      â””â”€ Top-5 Values: ['61.5991']

ðŸ“Š Layer: LF_l5_FDCA.positional_att
   â”œâ”€ Features: 1
   â”œâ”€ Mean Importance: 0.0000
   â”œâ”€ Max Importance: 0.0000
   â”œâ”€ Min Importance: 0.0000
   â””â”€ Top-5 Important Features: [0]
      â””â”€ Top-5 Values: ['0.0000']

ðŸ“Š Layer: LF_l5_FDCA.slice_att.linear.0
   â”œâ”€ Features: 1
   â”œâ”€ Mean Importance: 0.0000
   â”œâ”€ Max Importance: 0.0000
   â”œâ”€ Min Importance: 0.0000
   â””â”€ Top-5 Important Features: [0]
      â””â”€ Top-5 Values: ['0.0000']

ðŸ“Š Layer: LF_l5_FDCA.slice_att.linear.1
   â”œâ”€ Features: 1
   â”œâ”€ Mean Importance: 0.0000
   â”œâ”€ Max Importance: 0.0000
   â”œâ”€ Min Importance: 0.0000
   â””â”€ Top-5 Important Features: [0]
      â””â”€ Top-5 Values: ['0.0000']

ðŸ“Š Layer: LF_l5_FDCA.slice_att.linear.2
   â”œâ”€ Features: 1
   â”œâ”€ Mean Importance: 0.0000
   â”œâ”€ Max Importance: 0.0000
   â”œâ”€ Min Importance: 0.0000
   â””â”€ Top-5 Important Features: [0]
      â””â”€ Top-5 Values: ['0.0000']

ðŸ“Š Layer: LF_l5_FDCA.slice_att.linear
   â”œâ”€ Features: 1
   â”œâ”€ Mean Importance: 0.0000
   â”œâ”€ Max Importance: 0.0000
   â”œâ”€ Min Importance: 0.0000
   â””â”€ Top-5 Important Features: [0]
      â””â”€ Top-5 Values: ['0.0000']

ðŸ“Š Layer: LF_l5_FDCA.slice_att.non_linear
   â”œâ”€ Features: 1
   â”œâ”€ Mean Importance: 0.0000
   â”œâ”€ Max Importance: 0.0000
   â”œâ”€ Min Importance: 0.0000
   â””â”€ Top-5 Important Features: [0]
      â””â”€ Top-5 Values: ['0.0000']

ðŸ“Š Layer: LF_l5_FDCA.slice_att.mean
   â”œâ”€ Features: 1
   â”œâ”€ Mean Importance: 0.0017
   â”œâ”€ Max Importance: 0.0017
   â”œâ”€ Min Importance: 0.0017
   â””â”€ Top-5 Important Features: [0]
      â””â”€ Top-5 Values: ['0.0017']

ðŸ“Š Layer: LF_l5_FDCA.slice_att.log_diag
   â”œâ”€ Features: 1
   â”œâ”€ Mean Importance: 0.0000
   â”œâ”€ Max Importance: 0.0000
   â”œâ”€ Min Importance: 0.0000
   â””â”€ Top-5 Important Features: [0]
      â””â”€ Top-5 Values: ['0.0000']

ðŸ“Š Layer: LF_l5_FDCA.slice_att.factor
   â”œâ”€ Features: 1
   â”œâ”€ Mean Importance: 0.0001
   â”œâ”€ Max Importance: 0.0001
   â”œâ”€ Min Importance: 0.0001
   â””â”€ Top-5 Important Features: [0]
      â””â”€ Top-5 Values: ['0.0001']

ðŸ“Š Layer: LF_l5_FDCA.slice_att
   â”œâ”€ Features: 1
   â”œâ”€ Mean Importance: 0.0000
   â”œâ”€ Max Importance: 0.0000
   â”œâ”€ Min Importance: 0.0000
   â””â”€ Top-5 Important Features: [0]
      â””â”€ Top-5 Values: ['0.0000']

ðŸ“Š Layer: LF_l5_FDCA
   â”œâ”€ Features: 1
   â”œâ”€ Mean Importance: 0.0000
   â”œâ”€ Max Importance: 0.0000
   â”œâ”€ Min Importance: 0.0000
   â””â”€ Top-5 Important Features: [0]
      â””â”€ Top-5 Values: ['0.0000']

ðŸ“Š Layer: HF_l4_FDCA.semantic_att
   â”œâ”€ Features: 1
   â”œâ”€ Mean Importance: 0.0825
   â”œâ”€ Max Importance: 0.0825
   â”œâ”€ Min Importance: 0.0825
   â””â”€ Top-5 Important Features: [0]
      â””â”€ Top-5 Values: ['0.0825']

ðŸ“Š Layer: HF_l4_FDCA.positional_att.conv
   â”œâ”€ Features: 1
   â”œâ”€ Mean Importance: 9.4477
   â”œâ”€ Max Importance: 9.4477
   â”œâ”€ Min Importance: 9.4477
   â””â”€ Top-5 Important Features: [0]
      â””â”€ Top-5 Values: ['9.4477']

ðŸ“Š Layer: HF_l4_FDCA.positional_att
   â”œâ”€ Features: 1
   â”œâ”€ Mean Importance: 0.0016
   â”œâ”€ Max Importance: 0.0016
   â”œâ”€ Min Importance: 0.0016
   â””â”€ Top-5 Important Features: [0]
      â””â”€ Top-5 Values: ['0.0016']

ðŸ“Š Layer: HF_l4_FDCA.slice_att.linear.0
   â”œâ”€ Features: 1
   â”œâ”€ Mean Importance: 0.0000
   â”œâ”€ Max Importance: 0.0000
   â”œâ”€ Min Importance: 0.0000
   â””â”€ Top-5 Important Features: [0]
      â””â”€ Top-5 Values: ['0.0000']

ðŸ“Š Layer: HF_l4_FDCA.slice_att.linear.1
   â”œâ”€ Features: 1
   â”œâ”€ Mean Importance: 0.0000
   â”œâ”€ Max Importance: 0.0000
   â”œâ”€ Min Importance: 0.0000
   â””â”€ Top-5 Important Features: [0]
      â””â”€ Top-5 Values: ['0.0000']

ðŸ“Š Layer: HF_l4_FDCA.slice_att.linear.2
   â”œâ”€ Features: 1
   â”œâ”€ Mean Importance: 0.0000
   â”œâ”€ Max Importance: 0.0000
   â”œâ”€ Min Importance: 0.0000
   â””â”€ Top-5 Important Features: [0]
      â””â”€ Top-5 Values: ['0.0000']

ðŸ“Š Layer: HF_l4_FDCA.slice_att.linear
   â”œâ”€ Features: 1
   â”œâ”€ Mean Importance: 0.0000
   â”œâ”€ Max Importance: 0.0000
   â”œâ”€ Min Importance: 0.0000
   â””â”€ Top-5 Important Features: [0]
      â””â”€ Top-5 Values: ['0.0000']

ðŸ“Š Layer: HF_l4_FDCA.slice_att.non_linear
   â”œâ”€ Features: 1
   â”œâ”€ Mean Importance: 0.0000
   â”œâ”€ Max Importance: 0.0000
   â”œâ”€ Min Importance: 0.0000
   â””â”€ Top-5 Important Features: [0]
      â””â”€ Top-5 Values: ['0.0000']

ðŸ“Š Layer: HF_l4_FDCA.slice_att.mean
   â”œâ”€ Features: 1
   â”œâ”€ Mean Importance: 0.0000
   â”œâ”€ Max Importance: 0.0000
   â”œâ”€ Min Importance: 0.0000
   â””â”€ Top-5 Important Features: [0]
      â””â”€ Top-5 Values: ['0.0000']

ðŸ“Š Layer: HF_l4_FDCA.slice_att.log_diag
   â”œâ”€ Features: 1
   â”œâ”€ Mean Importance: 0.0000
   â”œâ”€ Max Importance: 0.0000
   â”œâ”€ Min Importance: 0.0000
   â””â”€ Top-5 Important Features: [0]
      â””â”€ Top-5 Values: ['0.0000']

ðŸ“Š Layer: HF_l4_FDCA.slice_att.factor
   â”œâ”€ Features: 1
   â”œâ”€ Mean Importance: 0.0000
   â”œâ”€ Max Importance: 0.0000
   â”œâ”€ Min Importance: 0.0000
   â””â”€ Top-5 Important Features: [0]
      â””â”€ Top-5 Values: ['0.0000']

ðŸ“Š Layer: HF_l4_FDCA.slice_att
   â”œâ”€ Features: 1
   â”œâ”€ Mean Importance: 0.0067
   â”œâ”€ Max Importance: 0.0067
   â”œâ”€ Min Importance: 0.0067
   â””â”€ Top-5 Important Features: [0]
      â””â”€ Top-5 Values: ['0.0067']

ðŸ“Š Layer: HF_l4_FDCA
   â”œâ”€ Features: 1
   â”œâ”€ Mean Importance: 1.4155
   â”œâ”€ Max Importance: 1.4155
   â”œâ”€ Min Importance: 1.4155
   â””â”€ Top-5 Important Features: [0]
      â””â”€ Top-5 Values: ['1.4155']

ðŸ“Š Layer: HF_l5_FDCA.semantic_att
   â”œâ”€ Features: 1
   â”œâ”€ Mean Importance: 0.0740
   â”œâ”€ Max Importance: 0.0740
   â”œâ”€ Min Importance: 0.0740
   â””â”€ Top-5 Important Features: [0]
      â””â”€ Top-5 Values: ['0.0740']

ðŸ“Š Layer: HF_l5_FDCA.positional_att.conv
   â”œâ”€ Features: 1
   â”œâ”€ Mean Importance: 17.2101
   â”œâ”€ Max Importance: 17.2101
   â”œâ”€ Min Importance: 17.2101
   â””â”€ Top-5 Important Features: [0]
      â””â”€ Top-5 Values: ['17.2101']

ðŸ“Š Layer: HF_l5_FDCA.positional_att
   â”œâ”€ Features: 1
   â”œâ”€ Mean Importance: 0.0001
   â”œâ”€ Max Importance: 0.0001
   â”œâ”€ Min Importance: 0.0001
   â””â”€ Top-5 Important Features: [0]
      â””â”€ Top-5 Values: ['0.0001']

ðŸ“Š Layer: HF_l5_FDCA.slice_att.linear.0
   â”œâ”€ Features: 1
   â”œâ”€ Mean Importance: 0.0000
   â”œâ”€ Max Importance: 0.0000
   â”œâ”€ Min Importance: 0.0000
   â””â”€ Top-5 Important Features: [0]
      â””â”€ Top-5 Values: ['0.0000']

ðŸ“Š Layer: HF_l5_FDCA.slice_att.linear.1
   â”œâ”€ Features: 1
   â”œâ”€ Mean Importance: 0.0000
   â”œâ”€ Max Importance: 0.0000
   â”œâ”€ Min Importance: 0.0000
   â””â”€ Top-5 Important Features: [0]
      â””â”€ Top-5 Values: ['0.0000']

ðŸ“Š Layer: HF_l5_FDCA.slice_att.linear.2
   â”œâ”€ Features: 1
   â”œâ”€ Mean Importance: 0.0000
   â”œâ”€ Max Importance: 0.0000
   â”œâ”€ Min Importance: 0.0000
   â””â”€ Top-5 Important Features: [0]
      â””â”€ Top-5 Values: ['0.0000']

ðŸ“Š Layer: HF_l5_FDCA.slice_att.linear
   â”œâ”€ Features: 1
   â”œâ”€ Mean Importance: 0.0000
   â”œâ”€ Max Importance: 0.0000
   â”œâ”€ Min Importance: 0.0000
   â””â”€ Top-5 Important Features: [0]
      â””â”€ Top-5 Values: ['0.0000']

ðŸ“Š Layer: HF_l5_FDCA.slice_att.non_linear
   â”œâ”€ Features: 1
   â”œâ”€ Mean Importance: 0.0000
   â”œâ”€ Max Importance: 0.0000
   â”œâ”€ Min Importance: 0.0000
   â””â”€ Top-5 Important Features: [0]
      â””â”€ Top-5 Values: ['0.0000']

ðŸ“Š Layer: HF_l5_FDCA.slice_att.mean
   â”œâ”€ Features: 1
   â”œâ”€ Mean Importance: 0.0000
   â”œâ”€ Max Importance: 0.0000
   â”œâ”€ Min Importance: 0.0000
   â””â”€ Top-5 Important Features: [0]
      â””â”€ Top-5 Values: ['0.0000']

ðŸ“Š Layer: HF_l5_FDCA.slice_att.log_diag
   â”œâ”€ Features: 1
   â”œâ”€ Mean Importance: 0.0000
   â”œâ”€ Max Importance: 0.0000
   â”œâ”€ Min Importance: 0.0000
   â””â”€ Top-5 Important Features: [0]
      â””â”€ Top-5 Values: ['0.0000']

ðŸ“Š Layer: HF_l5_FDCA.slice_att.factor
   â”œâ”€ Features: 1
   â”œâ”€ Mean Importance: 0.0000
   â”œâ”€ Max Importance: 0.0000
   â”œâ”€ Min Importance: 0.0000
   â””â”€ Top-5 Important Features: [0]
      â””â”€ Top-5 Values: ['0.0000']

ðŸ“Š Layer: HF_l5_FDCA.slice_att
   â”œâ”€ Features: 1
   â”œâ”€ Mean Importance: 0.0002
   â”œâ”€ Max Importance: 0.0002
   â”œâ”€ Min Importance: 0.0002
   â””â”€ Top-5 Important Features: [0]
      â””â”€ Top-5 Values: ['0.0002']

ðŸ“Š Layer: HF_l5_FDCA
   â”œâ”€ Features: 1
   â”œâ”€ Mean Importance: 0.0007
   â”œâ”€ Max Importance: 0.0007
   â”œâ”€ Min Importance: 0.0007
   â””â”€ Top-5 Important Features: [0]
      â””â”€ Top-5 Values: ['0.0007']

======================================================================
âœ“ Mechanistic analysis complete

[3] Generating Grad-CAM...
Warning: Failed to generate CAM for class 0: element 0 of tensors does not require grad and does not have a grad_fn
Warning: Failed to generate CAM for class 1: element 0 of tensors does not require grad and does not have a grad_fn
Warning: Failed to generate CAM for class 2: element 0 of tensors does not require grad and does not have a grad_fn
Warning: Failed to generate CAM for class 3: element 0 of tensors does not require grad and does not have a grad_fn
[4] Analyzing frequency components...
âœ“ Saved: outputs/xai_2025-11-15_17-25-23/freq_component/sample_0004_freq_comp.png
âœ“ Evaluation complete for sample_0004
Evaluating:  13%|#3        | 5/38 [01:26<09:05, 16.52s/it]
[1] Getting primary prediction...

[METRICS FOR sample_0005]
==================================================
class_0: Dice=0.9908, IoU=0.9818
class_1: Dice=0.6571, IoU=0.4893
class_2: Dice=0.7381, IoU=0.5849
class_3: Dice=0.8474, IoU=0.7352
==================================================

[2] Generating attention maps...
Clipping input data to the valid range for imshow with RGB data ([0..1] for floats or [0..255] for integers).
Clipping input data to the valid range for imshow with RGB data ([0..1] for floats or [0..255] for integers).
âœ“ Saved: outputs/xai_2025-11-15_17-25-23/attention/sample_0005_attention.png

[MECHANISTIC INTERPRETABILITY ANALYSIS]
======================================================================
Sample: sample_0005
======================================================================

ðŸ“Š Layer: LF_l4_FDCA.semantic_att
   â”œâ”€ Features: 1
   â”œâ”€ Mean Importance: 0.1188
   â”œâ”€ Max Importance: 0.1188
   â”œâ”€ Min Importance: 0.1188
   â””â”€ Top-5 Important Features: [0]
      â””â”€ Top-5 Values: ['0.1188']

ðŸ“Š Layer: LF_l4_FDCA.positional_att.conv
   â”œâ”€ Features: 1
   â”œâ”€ Mean Importance: 233.7761
   â”œâ”€ Max Importance: 233.7761
   â”œâ”€ Min Importance: 233.7761
   â””â”€ Top-5 Important Features: [0]
      â””â”€ Top-5 Values: ['233.7761']

ðŸ“Š Layer: LF_l4_FDCA.positional_att
   â”œâ”€ Features: 1
   â”œâ”€ Mean Importance: 44.0685
   â”œâ”€ Max Importance: 44.0685
   â”œâ”€ Min Importance: 44.0685
   â””â”€ Top-5 Important Features: [0]
      â””â”€ Top-5 Values: ['44.0685']

ðŸ“Š Layer: LF_l4_FDCA.slice_att.linear.0
   â”œâ”€ Features: 1
   â”œâ”€ Mean Importance: 63.2724
   â”œâ”€ Max Importance: 63.2724
   â”œâ”€ Min Importance: 63.2724
   â””â”€ Top-5 Important Features: [0]
      â””â”€ Top-5 Values: ['63.2724']

ðŸ“Š Layer: LF_l4_FDCA.slice_att.linear.1
   â”œâ”€ Features: 1
   â”œâ”€ Mean Importance: 53.6770
   â”œâ”€ Max Importance: 53.6770
   â”œâ”€ Min Importance: 53.6770
   â””â”€ Top-5 Important Features: [0]
      â””â”€ Top-5 Values: ['53.6770']

ðŸ“Š Layer: LF_l4_FDCA.slice_att.linear.2
   â”œâ”€ Features: 1
   â”œâ”€ Mean Importance: 50.9295
   â”œâ”€ Max Importance: 50.9295
   â”œâ”€ Min Importance: 50.9295
   â””â”€ Top-5 Important Features: [0]
      â””â”€ Top-5 Values: ['50.9295']

ðŸ“Š Layer: LF_l4_FDCA.slice_att.linear
   â”œâ”€ Features: 1
   â”œâ”€ Mean Importance: 50.9295
   â”œâ”€ Max Importance: 50.9295
   â”œâ”€ Min Importance: 50.9295
   â””â”€ Top-5 Important Features: [0]
      â””â”€ Top-5 Values: ['50.9295']

ðŸ“Š Layer: LF_l4_FDCA.slice_att.non_linear
   â”œâ”€ Features: 1
   â”œâ”€ Mean Importance: 21222254.0000
   â”œâ”€ Max Importance: 21222254.0000
   â”œâ”€ Min Importance: 21222254.0000
   â””â”€ Top-5 Important Features: [0]
      â””â”€ Top-5 Values: ['21222254.0000']

ðŸ“Š Layer: LF_l4_FDCA.slice_att.mean
   â”œâ”€ Features: 1
   â”œâ”€ Mean Importance: 84788048.0000
   â”œâ”€ Max Importance: 84788048.0000
   â”œâ”€ Min Importance: 84788048.0000
   â””â”€ Top-5 Important Features: [0]
      â””â”€ Top-5 Values: ['84788048.0000']

ðŸ“Š Layer: LF_l4_FDCA.slice_att.log_diag
   â”œâ”€ Features: 1
   â”œâ”€ Mean Importance: 5255.0869
   â”œâ”€ Max Importance: 5255.0869
   â”œâ”€ Min Importance: 5255.0869
   â””â”€ Top-5 Important Features: [0]
      â””â”€ Top-5 Values: ['5255.0869']

ðŸ“Š Layer: LF_l4_FDCA.slice_att.factor
   â”œâ”€ Features: 1
   â”œâ”€ Mean Importance: 32842266.0000
   â”œâ”€ Max Importance: 32842266.0000
   â”œâ”€ Min Importance: 32842266.0000
   â””â”€ Top-5 Important Features: [0]
      â””â”€ Top-5 Values: ['32842266.0000']

ðŸ“Š Layer: LF_l4_FDCA.slice_att
   â”œâ”€ Features: 1
   â”œâ”€ Mean Importance: 14210924.0000
   â”œâ”€ Max Importance: 14210924.0000
   â”œâ”€ Min Importance: 14210924.0000
   â””â”€ Top-5 Important Features: [0]
      â””â”€ Top-5 Values: ['14210924.0000']

ðŸ“Š Layer: LF_l4_FDCA
   â”œâ”€ Features: 1
   â”œâ”€ Mean Importance: 1645771132126625792.0000
   â”œâ”€ Max Importance: 1645771132126625792.0000
   â”œâ”€ Min Importance: 1645771132126625792.0000
   â””â”€ Top-5 Important Features: [0]
      â””â”€ Top-5 Values: ['1645771132126625792.0000']

ðŸ“Š Layer: LF_l5_FDCA.semantic_att
   â”œâ”€ Features: 1
   â”œâ”€ Mean Importance: 0.0782
   â”œâ”€ Max Importance: 0.0782
   â”œâ”€ Min Importance: 0.0782
   â””â”€ Top-5 Important Features: [0]
      â””â”€ Top-5 Values: ['0.0782']

ðŸ“Š Layer: LF_l5_FDCA.positional_att.conv
   â”œâ”€ Features: 1
   â”œâ”€ Mean Importance: 71.5906
   â”œâ”€ Max Importance: 71.5906
   â”œâ”€ Min Importance: 71.5906
   â””â”€ Top-5 Important Features: [0]
      â””â”€ Top-5 Values: ['71.5906']

ðŸ“Š Layer: LF_l5_FDCA.positional_att
   â”œâ”€ Features: 1
   â”œâ”€ Mean Importance: 0.0000
   â”œâ”€ Max Importance: 0.0000
   â”œâ”€ Min Importance: 0.0000
   â””â”€ Top-5 Important Features: [0]
      â””â”€ Top-5 Values: ['0.0000']

ðŸ“Š Layer: LF_l5_FDCA.slice_att.linear.0
   â”œâ”€ Features: 1
   â”œâ”€ Mean Importance: 0.0000
   â”œâ”€ Max Importance: 0.0000
   â”œâ”€ Min Importance: 0.0000
   â””â”€ Top-5 Important Features: [0]
      â””â”€ Top-5 Values: ['0.0000']

ðŸ“Š Layer: LF_l5_FDCA.slice_att.linear.1
   â”œâ”€ Features: 1
   â”œâ”€ Mean Importance: 0.0000
   â”œâ”€ Max Importance: 0.0000
   â”œâ”€ Min Importance: 0.0000
   â””â”€ Top-5 Important Features: [0]
      â””â”€ Top-5 Values: ['0.0000']

ðŸ“Š Layer: LF_l5_FDCA.slice_att.linear.2
   â”œâ”€ Features: 1
   â”œâ”€ Mean Importance: 0.0000
   â”œâ”€ Max Importance: 0.0000
   â”œâ”€ Min Importance: 0.0000
   â””â”€ Top-5 Important Features: [0]
      â””â”€ Top-5 Values: ['0.0000']

ðŸ“Š Layer: LF_l5_FDCA.slice_att.linear
   â”œâ”€ Features: 1
   â”œâ”€ Mean Importance: 0.0000
   â”œâ”€ Max Importance: 0.0000
   â”œâ”€ Min Importance: 0.0000
   â””â”€ Top-5 Important Features: [0]
      â””â”€ Top-5 Values: ['0.0000']

ðŸ“Š Layer: LF_l5_FDCA.slice_att.non_linear
   â”œâ”€ Features: 1
   â”œâ”€ Mean Importance: 0.0000
   â”œâ”€ Max Importance: 0.0000
   â”œâ”€ Min Importance: 0.0000
   â””â”€ Top-5 Important Features: [0]
      â””â”€ Top-5 Values: ['0.0000']

ðŸ“Š Layer: LF_l5_FDCA.slice_att.mean
   â”œâ”€ Features: 1
   â”œâ”€ Mean Importance: 0.0017
   â”œâ”€ Max Importance: 0.0017
   â”œâ”€ Min Importance: 0.0017
   â””â”€ Top-5 Important Features: [0]
      â””â”€ Top-5 Values: ['0.0017']

ðŸ“Š Layer: LF_l5_FDCA.slice_att.log_diag
   â”œâ”€ Features: 1
   â”œâ”€ Mean Importance: 0.0000
   â”œâ”€ Max Importance: 0.0000
   â”œâ”€ Min Importance: 0.0000
   â””â”€ Top-5 Important Features: [0]
      â””â”€ Top-5 Values: ['0.0000']

ðŸ“Š Layer: LF_l5_FDCA.slice_att.factor
   â”œâ”€ Features: 1
   â”œâ”€ Mean Importance: 0.0001
   â”œâ”€ Max Importance: 0.0001
   â”œâ”€ Min Importance: 0.0001
   â””â”€ Top-5 Important Features: [0]
      â””â”€ Top-5 Values: ['0.0001']

ðŸ“Š Layer: LF_l5_FDCA.slice_att
   â”œâ”€ Features: 1
   â”œâ”€ Mean Importance: 0.0000
   â”œâ”€ Max Importance: 0.0000
   â”œâ”€ Min Importance: 0.0000
   â””â”€ Top-5 Important Features: [0]
      â””â”€ Top-5 Values: ['0.0000']

ðŸ“Š Layer: LF_l5_FDCA
   â”œâ”€ Features: 1
   â”œâ”€ Mean Importance: 0.0000
   â”œâ”€ Max Importance: 0.0000
   â”œâ”€ Min Importance: 0.0000
   â””â”€ Top-5 Important Features: [0]
      â””â”€ Top-5 Values: ['0.0000']

ðŸ“Š Layer: HF_l4_FDCA.semantic_att
   â”œâ”€ Features: 1
   â”œâ”€ Mean Importance: 0.0821
   â”œâ”€ Max Importance: 0.0821
   â”œâ”€ Min Importance: 0.0821
   â””â”€ Top-5 Important Features: [0]
      â””â”€ Top-5 Values: ['0.0821']

ðŸ“Š Layer: HF_l4_FDCA.positional_att.conv
   â”œâ”€ Features: 1
   â”œâ”€ Mean Importance: 8.3032
   â”œâ”€ Max Importance: 8.3032
   â”œâ”€ Min Importance: 8.3032
   â””â”€ Top-5 Important Features: [0]
      â””â”€ Top-5 Values: ['8.3032']

ðŸ“Š Layer: HF_l4_FDCA.positional_att
   â”œâ”€ Features: 1
   â”œâ”€ Mean Importance: 0.0018
   â”œâ”€ Max Importance: 0.0018
   â”œâ”€ Min Importance: 0.0018
   â””â”€ Top-5 Important Features: [0]
      â””â”€ Top-5 Values: ['0.0018']

ðŸ“Š Layer: HF_l4_FDCA.slice_att.linear.0
   â”œâ”€ Features: 1
   â”œâ”€ Mean Importance: 0.0000
   â”œâ”€ Max Importance: 0.0000
   â”œâ”€ Min Importance: 0.0000
   â””â”€ Top-5 Important Features: [0]
      â””â”€ Top-5 Values: ['0.0000']

ðŸ“Š Layer: HF_l4_FDCA.slice_att.linear.1
   â”œâ”€ Features: 1
   â”œâ”€ Mean Importance: 0.0000
   â”œâ”€ Max Importance: 0.0000
   â”œâ”€ Min Importance: 0.0000
   â””â”€ Top-5 Important Features: [0]
      â””â”€ Top-5 Values: ['0.0000']

ðŸ“Š Layer: HF_l4_FDCA.slice_att.linear.2
   â”œâ”€ Features: 1
   â”œâ”€ Mean Importance: 0.0000
   â”œâ”€ Max Importance: 0.0000
   â”œâ”€ Min Importance: 0.0000
   â””â”€ Top-5 Important Features: [0]
      â””â”€ Top-5 Values: ['0.0000']

ðŸ“Š Layer: HF_l4_FDCA.slice_att.linear
   â”œâ”€ Features: 1
   â”œâ”€ Mean Importance: 0.0000
   â”œâ”€ Max Importance: 0.0000
   â”œâ”€ Min Importance: 0.0000
   â””â”€ Top-5 Important Features: [0]
      â””â”€ Top-5 Values: ['0.0000']

ðŸ“Š Layer: HF_l4_FDCA.slice_att.non_linear
   â”œâ”€ Features: 1
   â”œâ”€ Mean Importance: 0.0000
   â”œâ”€ Max Importance: 0.0000
   â”œâ”€ Min Importance: 0.0000
   â””â”€ Top-5 Important Features: [0]
      â””â”€ Top-5 Values: ['0.0000']

ðŸ“Š Layer: HF_l4_FDCA.slice_att.mean
   â”œâ”€ Features: 1
   â”œâ”€ Mean Importance: 0.0000
   â”œâ”€ Max Importance: 0.0000
   â”œâ”€ Min Importance: 0.0000
   â””â”€ Top-5 Important Features: [0]
      â””â”€ Top-5 Values: ['0.0000']

ðŸ“Š Layer: HF_l4_FDCA.slice_att.log_diag
   â”œâ”€ Features: 1
   â”œâ”€ Mean Importance: 0.0000
   â”œâ”€ Max Importance: 0.0000
   â”œâ”€ Min Importance: 0.0000
   â””â”€ Top-5 Important Features: [0]
      â””â”€ Top-5 Values: ['0.0000']

ðŸ“Š Layer: HF_l4_FDCA.slice_att.factor
   â”œâ”€ Features: 1
   â”œâ”€ Mean Importance: 0.0000
   â”œâ”€ Max Importance: 0.0000
   â”œâ”€ Min Importance: 0.0000
   â””â”€ Top-5 Important Features: [0]
      â””â”€ Top-5 Values: ['0.0000']

ðŸ“Š Layer: HF_l4_FDCA.slice_att
   â”œâ”€ Features: 1
   â”œâ”€ Mean Importance: 0.0086
   â”œâ”€ Max Importance: 0.0086
   â”œâ”€ Min Importance: 0.0086
   â””â”€ Top-5 Important Features: [0]
      â””â”€ Top-5 Values: ['0.0086']

ðŸ“Š Layer: HF_l4_FDCA
   â”œâ”€ Features: 1
   â”œâ”€ Mean Importance: 2.6038
   â”œâ”€ Max Importance: 2.6038
   â”œâ”€ Min Importance: 2.6038
   â””â”€ Top-5 Important Features: [0]
      â””â”€ Top-5 Values: ['2.6038']

ðŸ“Š Layer: HF_l5_FDCA.semantic_att
   â”œâ”€ Features: 1
   â”œâ”€ Mean Importance: 0.0692
   â”œâ”€ Max Importance: 0.0692
   â”œâ”€ Min Importance: 0.0692
   â””â”€ Top-5 Important Features: [0]
      â””â”€ Top-5 Values: ['0.0692']

ðŸ“Š Layer: HF_l5_FDCA.positional_att.conv
   â”œâ”€ Features: 1
   â”œâ”€ Mean Importance: 14.7131
   â”œâ”€ Max Importance: 14.7131
   â”œâ”€ Min Importance: 14.7131
   â””â”€ Top-5 Important Features: [0]
      â””â”€ Top-5 Values: ['14.7131']

ðŸ“Š Layer: HF_l5_FDCA.positional_att
   â”œâ”€ Features: 1
   â”œâ”€ Mean Importance: 0.0001
   â”œâ”€ Max Importance: 0.0001
   â”œâ”€ Min Importance: 0.0001
   â””â”€ Top-5 Important Features: [0]
      â””â”€ Top-5 Values: ['0.0001']

ðŸ“Š Layer: HF_l5_FDCA.slice_att.linear.0
   â”œâ”€ Features: 1
   â”œâ”€ Mean Importance: 0.0000
   â”œâ”€ Max Importance: 0.0000
   â”œâ”€ Min Importance: 0.0000
   â””â”€ Top-5 Important Features: [0]
      â””â”€ Top-5 Values: ['0.0000']

ðŸ“Š Layer: HF_l5_FDCA.slice_att.linear.1
   â”œâ”€ Features: 1
   â”œâ”€ Mean Importance: 0.0000
   â”œâ”€ Max Importance: 0.0000
   â”œâ”€ Min Importance: 0.0000
   â””â”€ Top-5 Important Features: [0]
      â””â”€ Top-5 Values: ['0.0000']

ðŸ“Š Layer: HF_l5_FDCA.slice_att.linear.2
   â”œâ”€ Features: 1
   â”œâ”€ Mean Importance: 0.0000
   â”œâ”€ Max Importance: 0.0000
   â”œâ”€ Min Importance: 0.0000
   â””â”€ Top-5 Important Features: [0]
      â””â”€ Top-5 Values: ['0.0000']

ðŸ“Š Layer: HF_l5_FDCA.slice_att.linear
   â”œâ”€ Features: 1
   â”œâ”€ Mean Importance: 0.0000
   â”œâ”€ Max Importance: 0.0000
   â”œâ”€ Min Importance: 0.0000
   â””â”€ Top-5 Important Features: [0]
      â””â”€ Top-5 Values: ['0.0000']

ðŸ“Š Layer: HF_l5_FDCA.slice_att.non_linear
   â”œâ”€ Features: 1
   â”œâ”€ Mean Importance: 0.0000
   â”œâ”€ Max Importance: 0.0000
   â”œâ”€ Min Importance: 0.0000
   â””â”€ Top-5 Important Features: [0]
      â””â”€ Top-5 Values: ['0.0000']

ðŸ“Š Layer: HF_l5_FDCA.slice_att.mean
   â”œâ”€ Features: 1
   â”œâ”€ Mean Importance: 0.0000
   â”œâ”€ Max Importance: 0.0000
   â”œâ”€ Min Importance: 0.0000
   â””â”€ Top-5 Important Features: [0]
      â””â”€ Top-5 Values: ['0.0000']

ðŸ“Š Layer: HF_l5_FDCA.slice_att.log_diag
   â”œâ”€ Features: 1
   â”œâ”€ Mean Importance: 0.0000
   â”œâ”€ Max Importance: 0.0000
   â”œâ”€ Min Importance: 0.0000
   â””â”€ Top-5 Important Features: [0]
      â””â”€ Top-5 Values: ['0.0000']

ðŸ“Š Layer: HF_l5_FDCA.slice_att.factor
   â”œâ”€ Features: 1
   â”œâ”€ Mean Importance: 0.0000
   â”œâ”€ Max Importance: 0.0000
   â”œâ”€ Min Importance: 0.0000
   â””â”€ Top-5 Important Features: [0]
      â””â”€ Top-5 Values: ['0.0000']

ðŸ“Š Layer: HF_l5_FDCA.slice_att
   â”œâ”€ Features: 1
   â”œâ”€ Mean Importance: 0.0002
   â”œâ”€ Max Importance: 0.0002
   â”œâ”€ Min Importance: 0.0002
   â””â”€ Top-5 Important Features: [0]
      â””â”€ Top-5 Values: ['0.0002']

ðŸ“Š Layer: HF_l5_FDCA
   â”œâ”€ Features: 1
   â”œâ”€ Mean Importance: 0.0010
   â”œâ”€ Max Importance: 0.0010
   â”œâ”€ Min Importance: 0.0010
   â””â”€ Top-5 Important Features: [0]
      â””â”€ Top-5 Values: ['0.0010']

======================================================================
âœ“ Mechanistic analysis complete

[3] Generating Grad-CAM...
Warning: Failed to generate CAM for class 0: element 0 of tensors does not require grad and does not have a grad_fn
Warning: Failed to generate CAM for class 1: element 0 of tensors does not require grad and does not have a grad_fn
Warning: Failed to generate CAM for class 2: element 0 of tensors does not require grad and does not have a grad_fn
Warning: Failed to generate CAM for class 3: element 0 of tensors does not require grad and does not have a grad_fn
[4] Analyzing frequency components...
âœ“ Saved: outputs/xai_2025-11-15_17-25-23/freq_component/sample_0005_freq_comp.png
âœ“ Evaluation complete for sample_0005
Evaluating:  16%|#5        | 6/38 [01:42<08:43, 16.35s/it]
[1] Getting primary prediction...

[METRICS FOR sample_0006]
==================================================
class_0: Dice=0.9923, IoU=0.9847
class_1: Dice=0.9220, IoU=0.8553
class_2: Dice=0.8866, IoU=0.7964
class_3: Dice=0.9032, IoU=0.8235
==================================================

[2] Generating attention maps...
Clipping input data to the valid range for imshow with RGB data ([0..1] for floats or [0..255] for integers).
Clipping input data to the valid range for imshow with RGB data ([0..1] for floats or [0..255] for integers).
âœ“ Saved: outputs/xai_2025-11-15_17-25-23/attention/sample_0006_attention.png

[MECHANISTIC INTERPRETABILITY ANALYSIS]
======================================================================
Sample: sample_0006
======================================================================

ðŸ“Š Layer: LF_l4_FDCA.semantic_att
   â”œâ”€ Features: 1
   â”œâ”€ Mean Importance: 0.1124
   â”œâ”€ Max Importance: 0.1124
   â”œâ”€ Min Importance: 0.1124
   â””â”€ Top-5 Important Features: [0]
      â””â”€ Top-5 Values: ['0.1124']

ðŸ“Š Layer: LF_l4_FDCA.positional_att.conv
   â”œâ”€ Features: 1
   â”œâ”€ Mean Importance: 209.6474
   â”œâ”€ Max Importance: 209.6474
   â”œâ”€ Min Importance: 209.6474
   â””â”€ Top-5 Important Features: [0]
      â””â”€ Top-5 Values: ['209.6474']

ðŸ“Š Layer: LF_l4_FDCA.positional_att
   â”œâ”€ Features: 1
   â”œâ”€ Mean Importance: 35.3084
   â”œâ”€ Max Importance: 35.3084
   â”œâ”€ Min Importance: 35.3084
   â””â”€ Top-5 Important Features: [0]
      â””â”€ Top-5 Values: ['35.3084']

ðŸ“Š Layer: LF_l4_FDCA.slice_att.linear.0
   â”œâ”€ Features: 1
   â”œâ”€ Mean Importance: 66.3348
   â”œâ”€ Max Importance: 66.3348
   â”œâ”€ Min Importance: 66.3348
   â””â”€ Top-5 Important Features: [0]
      â””â”€ Top-5 Values: ['66.3348']

ðŸ“Š Layer: LF_l4_FDCA.slice_att.linear.1
   â”œâ”€ Features: 1
   â”œâ”€ Mean Importance: 56.2644
   â”œâ”€ Max Importance: 56.2644
   â”œâ”€ Min Importance: 56.2644
   â””â”€ Top-5 Important Features: [0]
      â””â”€ Top-5 Values: ['56.2644']

ðŸ“Š Layer: LF_l4_FDCA.slice_att.linear.2
   â”œâ”€ Features: 1
   â”œâ”€ Mean Importance: 53.4063
   â”œâ”€ Max Importance: 53.4063
   â”œâ”€ Min Importance: 53.4063
   â””â”€ Top-5 Important Features: [0]
      â””â”€ Top-5 Values: ['53.4063']

ðŸ“Š Layer: LF_l4_FDCA.slice_att.linear
   â”œâ”€ Features: 1
   â”œâ”€ Mean Importance: 53.4063
   â”œâ”€ Max Importance: 53.4063
   â”œâ”€ Min Importance: 53.4063
   â””â”€ Top-5 Important Features: [0]
      â””â”€ Top-5 Values: ['53.4063']

ðŸ“Š Layer: LF_l4_FDCA.slice_att.non_linear
   â”œâ”€ Features: 1
   â”œâ”€ Mean Importance: 21642306.0000
   â”œâ”€ Max Importance: 21642306.0000
   â”œâ”€ Min Importance: 21642306.0000
   â””â”€ Top-5 Important Features: [0]
      â””â”€ Top-5 Values: ['21642306.0000']

ðŸ“Š Layer: LF_l4_FDCA.slice_att.mean
   â”œâ”€ Features: 1
   â”œâ”€ Mean Importance: 86484952.0000
   â”œâ”€ Max Importance: 86484952.0000
   â”œâ”€ Min Importance: 86484952.0000
   â””â”€ Top-5 Important Features: [0]
      â””â”€ Top-5 Values: ['86484952.0000']

ðŸ“Š Layer: LF_l4_FDCA.slice_att.log_diag
   â”œâ”€ Features: 1
   â”œâ”€ Mean Importance: 5360.0908
   â”œâ”€ Max Importance: 5360.0908
   â”œâ”€ Min Importance: 5360.0908
   â””â”€ Top-5 Important Features: [0]
      â””â”€ Top-5 Values: ['5360.0908']

ðŸ“Š Layer: LF_l4_FDCA.slice_att.factor
   â”œâ”€ Features: 1
   â”œâ”€ Mean Importance: 33499770.0000
   â”œâ”€ Max Importance: 33499770.0000
   â”œâ”€ Min Importance: 33499770.0000
   â””â”€ Top-5 Important Features: [0]
      â””â”€ Top-5 Values: ['33499770.0000']

ðŸ“Š Layer: LF_l4_FDCA.slice_att
   â”œâ”€ Features: 1
   â”œâ”€ Mean Importance: 13831434.0000
   â”œâ”€ Max Importance: 13831434.0000
   â”œâ”€ Min Importance: 13831434.0000
   â””â”€ Top-5 Important Features: [0]
      â””â”€ Top-5 Values: ['13831434.0000']

ðŸ“Š Layer: LF_l4_FDCA
   â”œâ”€ Features: 1
   â”œâ”€ Mean Importance: 1690470952720138240.0000
   â”œâ”€ Max Importance: 1690470952720138240.0000
   â”œâ”€ Min Importance: 1690470952720138240.0000
   â””â”€ Top-5 Important Features: [0]
      â””â”€ Top-5 Values: ['1690470952720138240.0000']

ðŸ“Š Layer: LF_l5_FDCA.semantic_att
   â”œâ”€ Features: 1
   â”œâ”€ Mean Importance: 0.0788
   â”œâ”€ Max Importance: 0.0788
   â”œâ”€ Min Importance: 0.0788
   â””â”€ Top-5 Important Features: [0]
      â””â”€ Top-5 Values: ['0.0788']

ðŸ“Š Layer: LF_l5_FDCA.positional_att.conv
   â”œâ”€ Features: 1
   â”œâ”€ Mean Importance: 77.8469
   â”œâ”€ Max Importance: 77.8469
   â”œâ”€ Min Importance: 77.8469
   â””â”€ Top-5 Important Features: [0]
      â””â”€ Top-5 Values: ['77.8469']

ðŸ“Š Layer: LF_l5_FDCA.positional_att
   â”œâ”€ Features: 1
   â”œâ”€ Mean Importance: 0.0000
   â”œâ”€ Max Importance: 0.0000
   â”œâ”€ Min Importance: 0.0000
   â””â”€ Top-5 Important Features: [0]
      â””â”€ Top-5 Values: ['0.0000']

ðŸ“Š Layer: LF_l5_FDCA.slice_att.linear.0
   â”œâ”€ Features: 1
   â”œâ”€ Mean Importance: 0.0000
   â”œâ”€ Max Importance: 0.0000
   â”œâ”€ Min Importance: 0.0000
   â””â”€ Top-5 Important Features: [0]
      â””â”€ Top-5 Values: ['0.0000']

ðŸ“Š Layer: LF_l5_FDCA.slice_att.linear.1
   â”œâ”€ Features: 1
   â”œâ”€ Mean Importance: 0.0000
   â”œâ”€ Max Importance: 0.0000
   â”œâ”€ Min Importance: 0.0000
   â””â”€ Top-5 Important Features: [0]
      â””â”€ Top-5 Values: ['0.0000']

ðŸ“Š Layer: LF_l5_FDCA.slice_att.linear.2
   â”œâ”€ Features: 1
   â”œâ”€ Mean Importance: 0.0000
   â”œâ”€ Max Importance: 0.0000
   â”œâ”€ Min Importance: 0.0000
   â””â”€ Top-5 Important Features: [0]
      â””â”€ Top-5 Values: ['0.0000']

ðŸ“Š Layer: LF_l5_FDCA.slice_att.linear
   â”œâ”€ Features: 1
   â”œâ”€ Mean Importance: 0.0000
   â”œâ”€ Max Importance: 0.0000
   â”œâ”€ Min Importance: 0.0000
   â””â”€ Top-5 Important Features: [0]
      â””â”€ Top-5 Values: ['0.0000']

ðŸ“Š Layer: LF_l5_FDCA.slice_att.non_linear
   â”œâ”€ Features: 1
   â”œâ”€ Mean Importance: 0.0000
   â”œâ”€ Max Importance: 0.0000
   â”œâ”€ Min Importance: 0.0000
   â””â”€ Top-5 Important Features: [0]
      â””â”€ Top-5 Values: ['0.0000']

ðŸ“Š Layer: LF_l5_FDCA.slice_att.mean
   â”œâ”€ Features: 1
   â”œâ”€ Mean Importance: 0.0017
   â”œâ”€ Max Importance: 0.0017
   â”œâ”€ Min Importance: 0.0017
   â””â”€ Top-5 Important Features: [0]
      â””â”€ Top-5 Values: ['0.0017']

ðŸ“Š Layer: LF_l5_FDCA.slice_att.log_diag
   â”œâ”€ Features: 1
   â”œâ”€ Mean Importance: 0.0000
   â”œâ”€ Max Importance: 0.0000
   â”œâ”€ Min Importance: 0.0000
   â””â”€ Top-5 Important Features: [0]
      â””â”€ Top-5 Values: ['0.0000']

ðŸ“Š Layer: LF_l5_FDCA.slice_att.factor
   â”œâ”€ Features: 1
   â”œâ”€ Mean Importance: 0.0001
   â”œâ”€ Max Importance: 0.0001
   â”œâ”€ Min Importance: 0.0001
   â””â”€ Top-5 Important Features: [0]
      â””â”€ Top-5 Values: ['0.0001']

ðŸ“Š Layer: LF_l5_FDCA.slice_att
   â”œâ”€ Features: 1
   â”œâ”€ Mean Importance: 0.0000
   â”œâ”€ Max Importance: 0.0000
   â”œâ”€ Min Importance: 0.0000
   â””â”€ Top-5 Important Features: [0]
      â””â”€ Top-5 Values: ['0.0000']

ðŸ“Š Layer: LF_l5_FDCA
   â”œâ”€ Features: 1
   â”œâ”€ Mean Importance: 0.0000
   â”œâ”€ Max Importance: 0.0000
   â”œâ”€ Min Importance: 0.0000
   â””â”€ Top-5 Important Features: [0]
      â””â”€ Top-5 Values: ['0.0000']

ðŸ“Š Layer: HF_l4_FDCA.semantic_att
   â”œâ”€ Features: 1
   â”œâ”€ Mean Importance: 0.0820
   â”œâ”€ Max Importance: 0.0820
   â”œâ”€ Min Importance: 0.0820
   â””â”€ Top-5 Important Features: [0]
      â””â”€ Top-5 Values: ['0.0820']

ðŸ“Š Layer: HF_l4_FDCA.positional_att.conv
   â”œâ”€ Features: 1
   â”œâ”€ Mean Importance: 8.9233
   â”œâ”€ Max Importance: 8.9233
   â”œâ”€ Min Importance: 8.9233
   â””â”€ Top-5 Important Features: [0]
      â””â”€ Top-5 Values: ['8.9233']

ðŸ“Š Layer: HF_l4_FDCA.positional_att
   â”œâ”€ Features: 1
   â”œâ”€ Mean Importance: 0.0016
   â”œâ”€ Max Importance: 0.0016
   â”œâ”€ Min Importance: 0.0016
   â””â”€ Top-5 Important Features: [0]
      â””â”€ Top-5 Values: ['0.0016']

ðŸ“Š Layer: HF_l4_FDCA.slice_att.linear.0
   â”œâ”€ Features: 1
   â”œâ”€ Mean Importance: 0.0000
   â”œâ”€ Max Importance: 0.0000
   â”œâ”€ Min Importance: 0.0000
   â””â”€ Top-5 Important Features: [0]
      â””â”€ Top-5 Values: ['0.0000']

ðŸ“Š Layer: HF_l4_FDCA.slice_att.linear.1
   â”œâ”€ Features: 1
   â”œâ”€ Mean Importance: 0.0000
   â”œâ”€ Max Importance: 0.0000
   â”œâ”€ Min Importance: 0.0000
   â””â”€ Top-5 Important Features: [0]
      â””â”€ Top-5 Values: ['0.0000']

ðŸ“Š Layer: HF_l4_FDCA.slice_att.linear.2
   â”œâ”€ Features: 1
   â”œâ”€ Mean Importance: 0.0000
   â”œâ”€ Max Importance: 0.0000
   â”œâ”€ Min Importance: 0.0000
   â””â”€ Top-5 Important Features: [0]
      â””â”€ Top-5 Values: ['0.0000']

ðŸ“Š Layer: HF_l4_FDCA.slice_att.linear
   â”œâ”€ Features: 1
   â”œâ”€ Mean Importance: 0.0000
   â”œâ”€ Max Importance: 0.0000
   â”œâ”€ Min Importance: 0.0000
   â””â”€ Top-5 Important Features: [0]
      â””â”€ Top-5 Values: ['0.0000']

ðŸ“Š Layer: HF_l4_FDCA.slice_att.non_linear
   â”œâ”€ Features: 1
   â”œâ”€ Mean Importance: 0.0000
   â”œâ”€ Max Importance: 0.0000
   â”œâ”€ Min Importance: 0.0000
   â””â”€ Top-5 Important Features: [0]
      â””â”€ Top-5 Values: ['0.0000']

ðŸ“Š Layer: HF_l4_FDCA.slice_att.mean
   â”œâ”€ Features: 1
   â”œâ”€ Mean Importance: 0.0000
   â”œâ”€ Max Importance: 0.0000
   â”œâ”€ Min Importance: 0.0000
   â””â”€ Top-5 Important Features: [0]
      â””â”€ Top-5 Values: ['0.0000']

ðŸ“Š Layer: HF_l4_FDCA.slice_att.log_diag
   â”œâ”€ Features: 1
   â”œâ”€ Mean Importance: 0.0000
   â”œâ”€ Max Importance: 0.0000
   â”œâ”€ Min Importance: 0.0000
   â””â”€ Top-5 Important Features: [0]
      â””â”€ Top-5 Values: ['0.0000']

ðŸ“Š Layer: HF_l4_FDCA.slice_att.factor
   â”œâ”€ Features: 1
   â”œâ”€ Mean Importance: 0.0000
   â”œâ”€ Max Importance: 0.0000
   â”œâ”€ Min Importance: 0.0000
   â””â”€ Top-5 Important Features: [0]
      â””â”€ Top-5 Values: ['0.0000']

ðŸ“Š Layer: HF_l4_FDCA.slice_att
   â”œâ”€ Features: 1
   â”œâ”€ Mean Importance: 0.0057
   â”œâ”€ Max Importance: 0.0057
   â”œâ”€ Min Importance: 0.0057
   â””â”€ Top-5 Important Features: [0]
      â””â”€ Top-5 Values: ['0.0057']

ðŸ“Š Layer: HF_l4_FDCA
   â”œâ”€ Features: 1
   â”œâ”€ Mean Importance: 1.5548
   â”œâ”€ Max Importance: 1.5548
   â”œâ”€ Min Importance: 1.5548
   â””â”€ Top-5 Important Features: [0]
      â””â”€ Top-5 Values: ['1.5548']

ðŸ“Š Layer: HF_l5_FDCA.semantic_att
   â”œâ”€ Features: 1
   â”œâ”€ Mean Importance: 0.0688
   â”œâ”€ Max Importance: 0.0688
   â”œâ”€ Min Importance: 0.0688
   â””â”€ Top-5 Important Features: [0]
      â””â”€ Top-5 Values: ['0.0688']

ðŸ“Š Layer: HF_l5_FDCA.positional_att.conv
   â”œâ”€ Features: 1
   â”œâ”€ Mean Importance: 14.0868
   â”œâ”€ Max Importance: 14.0868
   â”œâ”€ Min Importance: 14.0868
   â””â”€ Top-5 Important Features: [0]
      â””â”€ Top-5 Values: ['14.0868']

ðŸ“Š Layer: HF_l5_FDCA.positional_att
   â”œâ”€ Features: 1
   â”œâ”€ Mean Importance: 0.0001
   â”œâ”€ Max Importance: 0.0001
   â”œâ”€ Min Importance: 0.0001
   â””â”€ Top-5 Important Features: [0]
      â””â”€ Top-5 Values: ['0.0001']

ðŸ“Š Layer: HF_l5_FDCA.slice_att.linear.0
   â”œâ”€ Features: 1
   â”œâ”€ Mean Importance: 0.0000
   â”œâ”€ Max Importance: 0.0000
   â”œâ”€ Min Importance: 0.0000
   â””â”€ Top-5 Important Features: [0]
      â””â”€ Top-5 Values: ['0.0000']

ðŸ“Š Layer: HF_l5_FDCA.slice_att.linear.1
   â”œâ”€ Features: 1
   â”œâ”€ Mean Importance: 0.0000
   â”œâ”€ Max Importance: 0.0000
   â”œâ”€ Min Importance: 0.0000
   â””â”€ Top-5 Important Features: [0]
      â””â”€ Top-5 Values: ['0.0000']

ðŸ“Š Layer: HF_l5_FDCA.slice_att.linear.2
   â”œâ”€ Features: 1
   â”œâ”€ Mean Importance: 0.0000
   â”œâ”€ Max Importance: 0.0000
   â”œâ”€ Min Importance: 0.0000
   â””â”€ Top-5 Important Features: [0]
      â””â”€ Top-5 Values: ['0.0000']

ðŸ“Š Layer: HF_l5_FDCA.slice_att.linear
   â”œâ”€ Features: 1
   â”œâ”€ Mean Importance: 0.0000
   â”œâ”€ Max Importance: 0.0000
   â”œâ”€ Min Importance: 0.0000
   â””â”€ Top-5 Important Features: [0]
      â””â”€ Top-5 Values: ['0.0000']

ðŸ“Š Layer: HF_l5_FDCA.slice_att.non_linear
   â”œâ”€ Features: 1
   â”œâ”€ Mean Importance: 0.0000
   â”œâ”€ Max Importance: 0.0000
   â”œâ”€ Min Importance: 0.0000
   â””â”€ Top-5 Important Features: [0]
      â””â”€ Top-5 Values: ['0.0000']

ðŸ“Š Layer: HF_l5_FDCA.slice_att.mean
   â”œâ”€ Features: 1
   â”œâ”€ Mean Importance: 0.0000
   â”œâ”€ Max Importance: 0.0000
   â”œâ”€ Min Importance: 0.0000
   â””â”€ Top-5 Important Features: [0]
      â””â”€ Top-5 Values: ['0.0000']

ðŸ“Š Layer: HF_l5_FDCA.slice_att.log_diag
   â”œâ”€ Features: 1
   â”œâ”€ Mean Importance: 0.0000
   â”œâ”€ Max Importance: 0.0000
   â”œâ”€ Min Importance: 0.0000
   â””â”€ Top-5 Important Features: [0]
      â””â”€ Top-5 Values: ['0.0000']

ðŸ“Š Layer: HF_l5_FDCA.slice_att.factor
   â”œâ”€ Features: 1
   â”œâ”€ Mean Importance: 0.0000
   â”œâ”€ Max Importance: 0.0000
   â”œâ”€ Min Importance: 0.0000
   â””â”€ Top-5 Important Features: [0]
      â””â”€ Top-5 Values: ['0.0000']

ðŸ“Š Layer: HF_l5_FDCA.slice_att
   â”œâ”€ Features: 1
   â”œâ”€ Mean Importance: 0.0002
   â”œâ”€ Max Importance: 0.0002
   â”œâ”€ Min Importance: 0.0002
   â””â”€ Top-5 Important Features: [0]
      â””â”€ Top-5 Values: ['0.0002']

ðŸ“Š Layer: HF_l5_FDCA
   â”œâ”€ Features: 1
   â”œâ”€ Mean Importance: 0.0009
   â”œâ”€ Max Importance: 0.0009
   â”œâ”€ Min Importance: 0.0009
   â””â”€ Top-5 Important Features: [0]
      â””â”€ Top-5 Values: ['0.0009']

======================================================================
âœ“ Mechanistic analysis complete

[3] Generating Grad-CAM...
Warning: Failed to generate CAM for class 0: element 0 of tensors does not require grad and does not have a grad_fn
Warning: Failed to generate CAM for class 1: element 0 of tensors does not require grad and does not have a grad_fn
Warning: Failed to generate CAM for class 2: element 0 of tensors does not require grad and does not have a grad_fn
Warning: Failed to generate CAM for class 3: element 0 of tensors does not require grad and does not have a grad_fn
[4] Analyzing frequency components...
âœ“ Saved: outputs/xai_2025-11-15_17-25-23/freq_component/sample_0006_freq_comp.png
âœ“ Evaluation complete for sample_0006
Evaluating:  18%|#8        | 7/38 [01:58<08:23, 16.25s/it]
[1] Getting primary prediction...

[METRICS FOR sample_0007]
==================================================
class_0: Dice=0.9852, IoU=0.9708
class_1: Dice=0.7808, IoU=0.6404
class_2: Dice=0.5555, IoU=0.3846
class_3: Dice=0.4010, IoU=0.2508
==================================================

[2] Generating attention maps...
Clipping input data to the valid range for imshow with RGB data ([0..1] for floats or [0..255] for integers).
Clipping input data to the valid range for imshow with RGB data ([0..1] for floats or [0..255] for integers).
âœ“ Saved: outputs/xai_2025-11-15_17-25-23/attention/sample_0007_attention.png

[MECHANISTIC INTERPRETABILITY ANALYSIS]
======================================================================
Sample: sample_0007
======================================================================

ðŸ“Š Layer: LF_l4_FDCA.semantic_att
   â”œâ”€ Features: 1
   â”œâ”€ Mean Importance: 0.1271
   â”œâ”€ Max Importance: 0.1271
   â”œâ”€ Min Importance: 0.1271
   â””â”€ Top-5 Important Features: [0]
      â””â”€ Top-5 Values: ['0.1271']

ðŸ“Š Layer: LF_l4_FDCA.positional_att.conv
   â”œâ”€ Features: 1
   â”œâ”€ Mean Importance: 223.5792
   â”œâ”€ Max Importance: 223.5792
   â”œâ”€ Min Importance: 223.5792
   â””â”€ Top-5 Important Features: [0]
      â””â”€ Top-5 Values: ['223.5792']

ðŸ“Š Layer: LF_l4_FDCA.positional_att
   â”œâ”€ Features: 1
   â”œâ”€ Mean Importance: 42.4329
   â”œâ”€ Max Importance: 42.4329
   â”œâ”€ Min Importance: 42.4329
   â””â”€ Top-5 Important Features: [0]
      â””â”€ Top-5 Values: ['42.4329']

ðŸ“Š Layer: LF_l4_FDCA.slice_att.linear.0
   â”œâ”€ Features: 1
   â”œâ”€ Mean Importance: 60.6614
   â”œâ”€ Max Importance: 60.6614
   â”œâ”€ Min Importance: 60.6614
   â””â”€ Top-5 Important Features: [0]
      â””â”€ Top-5 Values: ['60.6614']

ðŸ“Š Layer: LF_l4_FDCA.slice_att.linear.1
   â”œâ”€ Features: 1
   â”œâ”€ Mean Importance: 51.4615
   â”œâ”€ Max Importance: 51.4615
   â”œâ”€ Min Importance: 51.4615
   â””â”€ Top-5 Important Features: [0]
      â””â”€ Top-5 Values: ['51.4615']

ðŸ“Š Layer: LF_l4_FDCA.slice_att.linear.2
   â”œâ”€ Features: 1
   â”œâ”€ Mean Importance: 48.8289
   â”œâ”€ Max Importance: 48.8289
   â”œâ”€ Min Importance: 48.8289
   â””â”€ Top-5 Important Features: [0]
      â””â”€ Top-5 Values: ['48.8289']

ðŸ“Š Layer: LF_l4_FDCA.slice_att.linear
   â”œâ”€ Features: 1
   â”œâ”€ Mean Importance: 48.8289
   â”œâ”€ Max Importance: 48.8289
   â”œâ”€ Min Importance: 48.8289
   â””â”€ Top-5 Important Features: [0]
      â””â”€ Top-5 Values: ['48.8289']

ðŸ“Š Layer: LF_l4_FDCA.slice_att.non_linear
   â”œâ”€ Features: 1
   â”œâ”€ Mean Importance: 19793368.0000
   â”œâ”€ Max Importance: 19793368.0000
   â”œâ”€ Min Importance: 19793368.0000
   â””â”€ Top-5 Important Features: [0]
      â””â”€ Top-5 Values: ['19793368.0000']

ðŸ“Š Layer: LF_l4_FDCA.slice_att.mean
   â”œâ”€ Features: 1
   â”œâ”€ Mean Importance: 79080808.0000
   â”œâ”€ Max Importance: 79080808.0000
   â”œâ”€ Min Importance: 79080808.0000
   â””â”€ Top-5 Important Features: [0]
      â””â”€ Top-5 Values: ['79080808.0000']

ðŸ“Š Layer: LF_l4_FDCA.slice_att.log_diag
   â”œâ”€ Features: 1
   â”œâ”€ Mean Importance: 4901.3438
   â”œâ”€ Max Importance: 4901.3438
   â”œâ”€ Min Importance: 4901.3438
   â””â”€ Top-5 Important Features: [0]
      â””â”€ Top-5 Values: ['4901.3438']

ðŸ“Š Layer: LF_l4_FDCA.slice_att.factor
   â”œâ”€ Features: 1
   â”œâ”€ Mean Importance: 30631604.0000
   â”œâ”€ Max Importance: 30631604.0000
   â”œâ”€ Min Importance: 30631604.0000
   â””â”€ Top-5 Important Features: [0]
      â””â”€ Top-5 Values: ['30631604.0000']

ðŸ“Š Layer: LF_l4_FDCA.slice_att
   â”œâ”€ Features: 1
   â”œâ”€ Mean Importance: 463281.4688
   â”œâ”€ Max Importance: 463281.4688
   â”œâ”€ Min Importance: 463281.4688
   â””â”€ Top-5 Important Features: [0]
      â””â”€ Top-5 Values: ['463281.4688']

ðŸ“Š Layer: LF_l4_FDCA
   â”œâ”€ Features: 1
   â”œâ”€ Mean Importance: 2946845244391424.0000
   â”œâ”€ Max Importance: 2946845244391424.0000
   â”œâ”€ Min Importance: 2946845244391424.0000
   â””â”€ Top-5 Important Features: [0]
      â””â”€ Top-5 Values: ['2946845244391424.0000']

ðŸ“Š Layer: LF_l5_FDCA.semantic_att
   â”œâ”€ Features: 1
   â”œâ”€ Mean Importance: 0.0813
   â”œâ”€ Max Importance: 0.0813
   â”œâ”€ Min Importance: 0.0813
   â””â”€ Top-5 Important Features: [0]
      â””â”€ Top-5 Values: ['0.0813']

ðŸ“Š Layer: LF_l5_FDCA.positional_att.conv
   â”œâ”€ Features: 1
   â”œâ”€ Mean Importance: 61.3967
   â”œâ”€ Max Importance: 61.3967
   â”œâ”€ Min Importance: 61.3967
   â””â”€ Top-5 Important Features: [0]
      â””â”€ Top-5 Values: ['61.3967']

ðŸ“Š Layer: LF_l5_FDCA.positional_att
   â”œâ”€ Features: 1
   â”œâ”€ Mean Importance: 0.0000
   â”œâ”€ Max Importance: 0.0000
   â”œâ”€ Min Importance: 0.0000
   â””â”€ Top-5 Important Features: [0]
      â””â”€ Top-5 Values: ['0.0000']

ðŸ“Š Layer: LF_l5_FDCA.slice_att.linear.0
   â”œâ”€ Features: 1
   â”œâ”€ Mean Importance: 0.0000
   â”œâ”€ Max Importance: 0.0000
   â”œâ”€ Min Importance: 0.0000
   â””â”€ Top-5 Important Features: [0]
      â””â”€ Top-5 Values: ['0.0000']

ðŸ“Š Layer: LF_l5_FDCA.slice_att.linear.1
   â”œâ”€ Features: 1
   â”œâ”€ Mean Importance: 0.0000
   â”œâ”€ Max Importance: 0.0000
   â”œâ”€ Min Importance: 0.0000
   â””â”€ Top-5 Important Features: [0]
      â””â”€ Top-5 Values: ['0.0000']

ðŸ“Š Layer: LF_l5_FDCA.slice_att.linear.2
   â”œâ”€ Features: 1
   â”œâ”€ Mean Importance: 0.0000
   â”œâ”€ Max Importance: 0.0000
   â”œâ”€ Min Importance: 0.0000
   â””â”€ Top-5 Important Features: [0]
      â””â”€ Top-5 Values: ['0.0000']

ðŸ“Š Layer: LF_l5_FDCA.slice_att.linear
   â”œâ”€ Features: 1
   â”œâ”€ Mean Importance: 0.0000
   â”œâ”€ Max Importance: 0.0000
   â”œâ”€ Min Importance: 0.0000
   â””â”€ Top-5 Important Features: [0]
      â””â”€ Top-5 Values: ['0.0000']

ðŸ“Š Layer: LF_l5_FDCA.slice_att.non_linear
   â”œâ”€ Features: 1
   â”œâ”€ Mean Importance: 0.0000
   â”œâ”€ Max Importance: 0.0000
   â”œâ”€ Min Importance: 0.0000
   â””â”€ Top-5 Important Features: [0]
      â””â”€ Top-5 Values: ['0.0000']

ðŸ“Š Layer: LF_l5_FDCA.slice_att.mean
   â”œâ”€ Features: 1
   â”œâ”€ Mean Importance: 0.0017
   â”œâ”€ Max Importance: 0.0017
   â”œâ”€ Min Importance: 0.0017
   â””â”€ Top-5 Important Features: [0]
      â””â”€ Top-5 Values: ['0.0017']

ðŸ“Š Layer: LF_l5_FDCA.slice_att.log_diag
   â”œâ”€ Features: 1
   â”œâ”€ Mean Importance: 0.0000
   â”œâ”€ Max Importance: 0.0000
   â”œâ”€ Min Importance: 0.0000
   â””â”€ Top-5 Important Features: [0]
      â””â”€ Top-5 Values: ['0.0000']

ðŸ“Š Layer: LF_l5_FDCA.slice_att.factor
   â”œâ”€ Features: 1
   â”œâ”€ Mean Importance: 0.0001
   â”œâ”€ Max Importance: 0.0001
   â”œâ”€ Min Importance: 0.0001
   â””â”€ Top-5 Important Features: [0]
      â””â”€ Top-5 Values: ['0.0001']

ðŸ“Š Layer: LF_l5_FDCA.slice_att
   â”œâ”€ Features: 1
   â”œâ”€ Mean Importance: 0.0000
   â”œâ”€ Max Importance: 0.0000
   â”œâ”€ Min Importance: 0.0000
   â””â”€ Top-5 Important Features: [0]
      â””â”€ Top-5 Values: ['0.0000']

ðŸ“Š Layer: LF_l5_FDCA
   â”œâ”€ Features: 1
   â”œâ”€ Mean Importance: 0.0000
   â”œâ”€ Max Importance: 0.0000
   â”œâ”€ Min Importance: 0.0000
   â””â”€ Top-5 Important Features: [0]
      â””â”€ Top-5 Values: ['0.0000']

ðŸ“Š Layer: HF_l4_FDCA.semantic_att
   â”œâ”€ Features: 1
   â”œâ”€ Mean Importance: 0.0829
   â”œâ”€ Max Importance: 0.0829
   â”œâ”€ Min Importance: 0.0829
   â””â”€ Top-5 Important Features: [0]
      â””â”€ Top-5 Values: ['0.0829']

ðŸ“Š Layer: HF_l4_FDCA.positional_att.conv
   â”œâ”€ Features: 1
   â”œâ”€ Mean Importance: 9.1376
   â”œâ”€ Max Importance: 9.1376
   â”œâ”€ Min Importance: 9.1376
   â””â”€ Top-5 Important Features: [0]
      â””â”€ Top-5 Values: ['9.1376']

ðŸ“Š Layer: HF_l4_FDCA.positional_att
   â”œâ”€ Features: 1
   â”œâ”€ Mean Importance: 0.0018
   â”œâ”€ Max Importance: 0.0018
   â”œâ”€ Min Importance: 0.0018
   â””â”€ Top-5 Important Features: [0]
      â””â”€ Top-5 Values: ['0.0018']

ðŸ“Š Layer: HF_l4_FDCA.slice_att.linear.0
   â”œâ”€ Features: 1
   â”œâ”€ Mean Importance: 0.0000
   â”œâ”€ Max Importance: 0.0000
   â”œâ”€ Min Importance: 0.0000
   â””â”€ Top-5 Important Features: [0]
      â””â”€ Top-5 Values: ['0.0000']

ðŸ“Š Layer: HF_l4_FDCA.slice_att.linear.1
   â”œâ”€ Features: 1
   â”œâ”€ Mean Importance: 0.0000
   â”œâ”€ Max Importance: 0.0000
   â”œâ”€ Min Importance: 0.0000
   â””â”€ Top-5 Important Features: [0]
      â””â”€ Top-5 Values: ['0.0000']

ðŸ“Š Layer: HF_l4_FDCA.slice_att.linear.2
   â”œâ”€ Features: 1
   â”œâ”€ Mean Importance: 0.0000
   â”œâ”€ Max Importance: 0.0000
   â”œâ”€ Min Importance: 0.0000
   â””â”€ Top-5 Important Features: [0]
      â””â”€ Top-5 Values: ['0.0000']

ðŸ“Š Layer: HF_l4_FDCA.slice_att.linear
   â”œâ”€ Features: 1
   â”œâ”€ Mean Importance: 0.0000
   â”œâ”€ Max Importance: 0.0000
   â”œâ”€ Min Importance: 0.0000
   â””â”€ Top-5 Important Features: [0]
      â””â”€ Top-5 Values: ['0.0000']

ðŸ“Š Layer: HF_l4_FDCA.slice_att.non_linear
   â”œâ”€ Features: 1
   â”œâ”€ Mean Importance: 0.0000
   â”œâ”€ Max Importance: 0.0000
   â”œâ”€ Min Importance: 0.0000
   â””â”€ Top-5 Important Features: [0]
      â””â”€ Top-5 Values: ['0.0000']

ðŸ“Š Layer: HF_l4_FDCA.slice_att.mean
   â”œâ”€ Features: 1
   â”œâ”€ Mean Importance: 0.0000
   â”œâ”€ Max Importance: 0.0000
   â”œâ”€ Min Importance: 0.0000
   â””â”€ Top-5 Important Features: [0]
      â””â”€ Top-5 Values: ['0.0000']

ðŸ“Š Layer: HF_l4_FDCA.slice_att.log_diag
   â”œâ”€ Features: 1
   â”œâ”€ Mean Importance: 0.0000
   â”œâ”€ Max Importance: 0.0000
   â”œâ”€ Min Importance: 0.0000
   â””â”€ Top-5 Important Features: [0]
      â””â”€ Top-5 Values: ['0.0000']

ðŸ“Š Layer: HF_l4_FDCA.slice_att.factor
   â”œâ”€ Features: 1
   â”œâ”€ Mean Importance: 0.0000
   â”œâ”€ Max Importance: 0.0000
   â”œâ”€ Min Importance: 0.0000
   â””â”€ Top-5 Important Features: [0]
      â””â”€ Top-5 Values: ['0.0000']

ðŸ“Š Layer: HF_l4_FDCA.slice_att
   â”œâ”€ Features: 1
   â”œâ”€ Mean Importance: 0.0075
   â”œâ”€ Max Importance: 0.0075
   â”œâ”€ Min Importance: 0.0075
   â””â”€ Top-5 Important Features: [0]
      â””â”€ Top-5 Values: ['0.0075']

ðŸ“Š Layer: HF_l4_FDCA
   â”œâ”€ Features: 1
   â”œâ”€ Mean Importance: 1.1002
   â”œâ”€ Max Importance: 1.1002
   â”œâ”€ Min Importance: 1.1002
   â””â”€ Top-5 Important Features: [0]
      â””â”€ Top-5 Values: ['1.1002']

ðŸ“Š Layer: HF_l5_FDCA.semantic_att
   â”œâ”€ Features: 1
   â”œâ”€ Mean Importance: 0.0803
   â”œâ”€ Max Importance: 0.0803
   â”œâ”€ Min Importance: 0.0803
   â””â”€ Top-5 Important Features: [0]
      â””â”€ Top-5 Values: ['0.0803']

ðŸ“Š Layer: HF_l5_FDCA.positional_att.conv
   â”œâ”€ Features: 1
   â”œâ”€ Mean Importance: 17.2527
   â”œâ”€ Max Importance: 17.2527
   â”œâ”€ Min Importance: 17.2527
   â””â”€ Top-5 Important Features: [0]
      â””â”€ Top-5 Values: ['17.2527']

ðŸ“Š Layer: HF_l5_FDCA.positional_att
   â”œâ”€ Features: 1
   â”œâ”€ Mean Importance: 0.0001
   â”œâ”€ Max Importance: 0.0001
   â”œâ”€ Min Importance: 0.0001
   â””â”€ Top-5 Important Features: [0]
      â””â”€ Top-5 Values: ['0.0001']

ðŸ“Š Layer: HF_l5_FDCA.slice_att.linear.0
   â”œâ”€ Features: 1
   â”œâ”€ Mean Importance: 0.0000
   â”œâ”€ Max Importance: 0.0000
   â”œâ”€ Min Importance: 0.0000
   â””â”€ Top-5 Important Features: [0]
      â””â”€ Top-5 Values: ['0.0000']

ðŸ“Š Layer: HF_l5_FDCA.slice_att.linear.1
   â”œâ”€ Features: 1
   â”œâ”€ Mean Importance: 0.0000
   â”œâ”€ Max Importance: 0.0000
   â”œâ”€ Min Importance: 0.0000
   â””â”€ Top-5 Important Features: [0]
      â””â”€ Top-5 Values: ['0.0000']

ðŸ“Š Layer: HF_l5_FDCA.slice_att.linear.2
   â”œâ”€ Features: 1
   â”œâ”€ Mean Importance: 0.0000
   â”œâ”€ Max Importance: 0.0000
   â”œâ”€ Min Importance: 0.0000
   â””â”€ Top-5 Important Features: [0]
      â””â”€ Top-5 Values: ['0.0000']

ðŸ“Š Layer: HF_l5_FDCA.slice_att.linear
   â”œâ”€ Features: 1
   â”œâ”€ Mean Importance: 0.0000
   â”œâ”€ Max Importance: 0.0000
   â”œâ”€ Min Importance: 0.0000
   â””â”€ Top-5 Important Features: [0]
      â””â”€ Top-5 Values: ['0.0000']

ðŸ“Š Layer: HF_l5_FDCA.slice_att.non_linear
   â”œâ”€ Features: 1
   â”œâ”€ Mean Importance: 0.0000
   â”œâ”€ Max Importance: 0.0000
   â”œâ”€ Min Importance: 0.0000
   â””â”€ Top-5 Important Features: [0]
      â””â”€ Top-5 Values: ['0.0000']

ðŸ“Š Layer: HF_l5_FDCA.slice_att.mean
   â”œâ”€ Features: 1
   â”œâ”€ Mean Importance: 0.0000
   â”œâ”€ Max Importance: 0.0000
   â”œâ”€ Min Importance: 0.0000
   â””â”€ Top-5 Important Features: [0]
      â””â”€ Top-5 Values: ['0.0000']

ðŸ“Š Layer: HF_l5_FDCA.slice_att.log_diag
   â”œâ”€ Features: 1
   â”œâ”€ Mean Importance: 0.0000
   â”œâ”€ Max Importance: 0.0000
   â”œâ”€ Min Importance: 0.0000
   â””â”€ Top-5 Important Features: [0]
      â””â”€ Top-5 Values: ['0.0000']

ðŸ“Š Layer: HF_l5_FDCA.slice_att.factor
   â”œâ”€ Features: 1
   â”œâ”€ Mean Importance: 0.0000
   â”œâ”€ Max Importance: 0.0000
   â”œâ”€ Min Importance: 0.0000
   â””â”€ Top-5 Important Features: [0]
      â””â”€ Top-5 Values: ['0.0000']

ðŸ“Š Layer: HF_l5_FDCA.slice_att
   â”œâ”€ Features: 1
   â”œâ”€ Mean Importance: 0.0004
   â”œâ”€ Max Importance: 0.0004
   â”œâ”€ Min Importance: 0.0004
   â””â”€ Top-5 Important Features: [0]
      â””â”€ Top-5 Values: ['0.0004']

ðŸ“Š Layer: HF_l5_FDCA
   â”œâ”€ Features: 1
   â”œâ”€ Mean Importance: 0.0012
   â”œâ”€ Max Importance: 0.0012
   â”œâ”€ Min Importance: 0.0012
   â””â”€ Top-5 Important Features: [0]
      â””â”€ Top-5 Values: ['0.0012']

======================================================================
âœ“ Mechanistic analysis complete

[3] Generating Grad-CAM...
Warning: Failed to generate CAM for class 0: element 0 of tensors does not require grad and does not have a grad_fn
Warning: Failed to generate CAM for class 1: element 0 of tensors does not require grad and does not have a grad_fn
Warning: Failed to generate CAM for class 2: element 0 of tensors does not require grad and does not have a grad_fn
Warning: Failed to generate CAM for class 3: element 0 of tensors does not require grad and does not have a grad_fn
[4] Analyzing frequency components...
âœ“ Saved: outputs/xai_2025-11-15_17-25-23/freq_component/sample_0007_freq_comp.png
âœ“ Evaluation complete for sample_0007
Evaluating:  21%|##1       | 8/38 [02:15<08:12, 16.40s/it]
[1] Getting primary prediction...

[METRICS FOR sample_0008]
==================================================
class_0: Dice=0.9981, IoU=0.9962
class_1: Dice=0.8736, IoU=0.7756
class_2: Dice=0.8048, IoU=0.6734
class_3: Dice=0.8841, IoU=0.7922
==================================================

[2] Generating attention maps...
Clipping input data to the valid range for imshow with RGB data ([0..1] for floats or [0..255] for integers).
Clipping input data to the valid range for imshow with RGB data ([0..1] for floats or [0..255] for integers).
âœ“ Saved: outputs/xai_2025-11-15_17-25-23/attention/sample_0008_attention.png

[MECHANISTIC INTERPRETABILITY ANALYSIS]
======================================================================
Sample: sample_0008
======================================================================

ðŸ“Š Layer: LF_l4_FDCA.semantic_att
   â”œâ”€ Features: 1
   â”œâ”€ Mean Importance: 0.1265
   â”œâ”€ Max Importance: 0.1265
   â”œâ”€ Min Importance: 0.1265
   â””â”€ Top-5 Important Features: [0]
      â””â”€ Top-5 Values: ['0.1265']

ðŸ“Š Layer: LF_l4_FDCA.positional_att.conv
   â”œâ”€ Features: 1
   â”œâ”€ Mean Importance: 283.7854
   â”œâ”€ Max Importance: 283.7854
   â”œâ”€ Min Importance: 283.7854
   â””â”€ Top-5 Important Features: [0]
      â””â”€ Top-5 Values: ['283.7854']

ðŸ“Š Layer: LF_l4_FDCA.positional_att
   â”œâ”€ Features: 1
   â”œâ”€ Mean Importance: 48.6379
   â”œâ”€ Max Importance: 48.6379
   â”œâ”€ Min Importance: 48.6379
   â””â”€ Top-5 Important Features: [0]
      â””â”€ Top-5 Values: ['48.6379']

ðŸ“Š Layer: LF_l4_FDCA.slice_att.linear.0
   â”œâ”€ Features: 1
   â”œâ”€ Mean Importance: 90.7155
   â”œâ”€ Max Importance: 90.7155
   â”œâ”€ Min Importance: 90.7155
   â””â”€ Top-5 Important Features: [0]
      â””â”€ Top-5 Values: ['90.7155']

ðŸ“Š Layer: LF_l4_FDCA.slice_att.linear.1
   â”œâ”€ Features: 1
   â”œâ”€ Mean Importance: 76.9547
   â”œâ”€ Max Importance: 76.9547
   â”œâ”€ Min Importance: 76.9547
   â””â”€ Top-5 Important Features: [0]
      â””â”€ Top-5 Values: ['76.9547']

ðŸ“Š Layer: LF_l4_FDCA.slice_att.linear.2
   â”œâ”€ Features: 1
   â”œâ”€ Mean Importance: 73.0263
   â”œâ”€ Max Importance: 73.0263
   â”œâ”€ Min Importance: 73.0263
   â””â”€ Top-5 Important Features: [0]
      â””â”€ Top-5 Values: ['73.0263']

ðŸ“Š Layer: LF_l4_FDCA.slice_att.linear
   â”œâ”€ Features: 1
   â”œâ”€ Mean Importance: 73.0263
   â”œâ”€ Max Importance: 73.0263
   â”œâ”€ Min Importance: 73.0263
   â””â”€ Top-5 Important Features: [0]
      â””â”€ Top-5 Values: ['73.0263']

ðŸ“Š Layer: LF_l4_FDCA.slice_att.non_linear
   â”œâ”€ Features: 1
   â”œâ”€ Mean Importance: 31528562.0000
   â”œâ”€ Max Importance: 31528562.0000
   â”œâ”€ Min Importance: 31528562.0000
   â””â”€ Top-5 Important Features: [0]
      â””â”€ Top-5 Values: ['31528562.0000']

ðŸ“Š Layer: LF_l4_FDCA.slice_att.mean
   â”œâ”€ Features: 1
   â”œâ”€ Mean Importance: 125981184.0000
   â”œâ”€ Max Importance: 125981184.0000
   â”œâ”€ Min Importance: 125981184.0000
   â””â”€ Top-5 Important Features: [0]
      â””â”€ Top-5 Values: ['125981184.0000']

ðŸ“Š Layer: LF_l4_FDCA.slice_att.log_diag
   â”œâ”€ Features: 1
   â”œâ”€ Mean Importance: 7808.0420
   â”œâ”€ Max Importance: 7808.0420
   â”œâ”€ Min Importance: 7808.0420
   â””â”€ Top-5 Important Features: [0]
      â””â”€ Top-5 Values: ['7808.0420']

ðŸ“Š Layer: LF_l4_FDCA.slice_att.factor
   â”œâ”€ Features: 1
   â”œâ”€ Mean Importance: 48798432.0000
   â”œâ”€ Max Importance: 48798432.0000
   â”œâ”€ Min Importance: 48798432.0000
   â””â”€ Top-5 Important Features: [0]
      â””â”€ Top-5 Values: ['48798432.0000']

ðŸ“Š Layer: LF_l4_FDCA.slice_att
   â”œâ”€ Features: 1
   â”œâ”€ Mean Importance: 19955874.0000
   â”œâ”€ Max Importance: 19955874.0000
   â”œâ”€ Min Importance: 19955874.0000
   â””â”€ Top-5 Important Features: [0]
      â””â”€ Top-5 Values: ['19955874.0000']

ðŸ“Š Layer: LF_l4_FDCA
   â”œâ”€ Features: 1
   â”œâ”€ Mean Importance: 3456377474076639232.0000
   â”œâ”€ Max Importance: 3456377474076639232.0000
   â”œâ”€ Min Importance: 3456377474076639232.0000
   â””â”€ Top-5 Important Features: [0]
      â””â”€ Top-5 Values: ['3456377474076639232.0000']

ðŸ“Š Layer: LF_l5_FDCA.semantic_att
   â”œâ”€ Features: 1
   â”œâ”€ Mean Importance: 0.0847
   â”œâ”€ Max Importance: 0.0847
   â”œâ”€ Min Importance: 0.0847
   â””â”€ Top-5 Important Features: [0]
      â””â”€ Top-5 Values: ['0.0847']

ðŸ“Š Layer: LF_l5_FDCA.positional_att.conv
   â”œâ”€ Features: 1
   â”œâ”€ Mean Importance: 58.2505
   â”œâ”€ Max Importance: 58.2505
   â”œâ”€ Min Importance: 58.2505
   â””â”€ Top-5 Important Features: [0]
      â””â”€ Top-5 Values: ['58.2505']

ðŸ“Š Layer: LF_l5_FDCA.positional_att
   â”œâ”€ Features: 1
   â”œâ”€ Mean Importance: 0.0000
   â”œâ”€ Max Importance: 0.0000
   â”œâ”€ Min Importance: 0.0000
   â””â”€ Top-5 Important Features: [0]
      â””â”€ Top-5 Values: ['0.0000']

ðŸ“Š Layer: LF_l5_FDCA.slice_att.linear.0
   â”œâ”€ Features: 1
   â”œâ”€ Mean Importance: 0.0000
   â”œâ”€ Max Importance: 0.0000
   â”œâ”€ Min Importance: 0.0000
   â””â”€ Top-5 Important Features: [0]
      â””â”€ Top-5 Values: ['0.0000']

ðŸ“Š Layer: LF_l5_FDCA.slice_att.linear.1
   â”œâ”€ Features: 1
   â”œâ”€ Mean Importance: 0.0000
   â”œâ”€ Max Importance: 0.0000
   â”œâ”€ Min Importance: 0.0000
   â””â”€ Top-5 Important Features: [0]
      â””â”€ Top-5 Values: ['0.0000']

ðŸ“Š Layer: LF_l5_FDCA.slice_att.linear.2
   â”œâ”€ Features: 1
   â”œâ”€ Mean Importance: 0.0000
   â”œâ”€ Max Importance: 0.0000
   â”œâ”€ Min Importance: 0.0000
   â””â”€ Top-5 Important Features: [0]
      â””â”€ Top-5 Values: ['0.0000']

ðŸ“Š Layer: LF_l5_FDCA.slice_att.linear
   â”œâ”€ Features: 1
   â”œâ”€ Mean Importance: 0.0000
   â”œâ”€ Max Importance: 0.0000
   â”œâ”€ Min Importance: 0.0000
   â””â”€ Top-5 Important Features: [0]
      â””â”€ Top-5 Values: ['0.0000']

ðŸ“Š Layer: LF_l5_FDCA.slice_att.non_linear
   â”œâ”€ Features: 1
   â”œâ”€ Mean Importance: 0.0000
   â”œâ”€ Max Importance: 0.0000
   â”œâ”€ Min Importance: 0.0000
   â””â”€ Top-5 Important Features: [0]
      â””â”€ Top-5 Values: ['0.0000']

ðŸ“Š Layer: LF_l5_FDCA.slice_att.mean
   â”œâ”€ Features: 1
   â”œâ”€ Mean Importance: 0.0017
   â”œâ”€ Max Importance: 0.0017
   â”œâ”€ Min Importance: 0.0017
   â””â”€ Top-5 Important Features: [0]
      â””â”€ Top-5 Values: ['0.0017']

ðŸ“Š Layer: LF_l5_FDCA.slice_att.log_diag
   â”œâ”€ Features: 1
   â”œâ”€ Mean Importance: 0.0000
   â”œâ”€ Max Importance: 0.0000
   â”œâ”€ Min Importance: 0.0000
   â””â”€ Top-5 Important Features: [0]
      â””â”€ Top-5 Values: ['0.0000']

ðŸ“Š Layer: LF_l5_FDCA.slice_att.factor
   â”œâ”€ Features: 1
   â”œâ”€ Mean Importance: 0.0001
   â”œâ”€ Max Importance: 0.0001
   â”œâ”€ Min Importance: 0.0001
   â””â”€ Top-5 Important Features: [0]
      â””â”€ Top-5 Values: ['0.0001']

ðŸ“Š Layer: LF_l5_FDCA.slice_att
   â”œâ”€ Features: 1
   â”œâ”€ Mean Importance: 0.0000
   â”œâ”€ Max Importance: 0.0000
   â”œâ”€ Min Importance: 0.0000
   â””â”€ Top-5 Important Features: [0]
      â””â”€ Top-5 Values: ['0.0000']

ðŸ“Š Layer: LF_l5_FDCA
   â”œâ”€ Features: 1
   â”œâ”€ Mean Importance: 0.0000
   â”œâ”€ Max Importance: 0.0000
   â”œâ”€ Min Importance: 0.0000
   â””â”€ Top-5 Important Features: [0]
      â””â”€ Top-5 Values: ['0.0000']

ðŸ“Š Layer: HF_l4_FDCA.semantic_att
   â”œâ”€ Features: 1
   â”œâ”€ Mean Importance: 0.0811
   â”œâ”€ Max Importance: 0.0811
   â”œâ”€ Min Importance: 0.0811
   â””â”€ Top-5 Important Features: [0]
      â””â”€ Top-5 Values: ['0.0811']

ðŸ“Š Layer: HF_l4_FDCA.positional_att.conv
   â”œâ”€ Features: 1
   â”œâ”€ Mean Importance: 9.4786
   â”œâ”€ Max Importance: 9.4786
   â”œâ”€ Min Importance: 9.4786
   â””â”€ Top-5 Important Features: [0]
      â””â”€ Top-5 Values: ['9.4786']

ðŸ“Š Layer: HF_l4_FDCA.positional_att
   â”œâ”€ Features: 1
   â”œâ”€ Mean Importance: 0.0018
   â”œâ”€ Max Importance: 0.0018
   â”œâ”€ Min Importance: 0.0018
   â””â”€ Top-5 Important Features: [0]
      â””â”€ Top-5 Values: ['0.0018']

ðŸ“Š Layer: HF_l4_FDCA.slice_att.linear.0
   â”œâ”€ Features: 1
   â”œâ”€ Mean Importance: 0.0000
   â”œâ”€ Max Importance: 0.0000
   â”œâ”€ Min Importance: 0.0000
   â””â”€ Top-5 Important Features: [0]
      â””â”€ Top-5 Values: ['0.0000']

ðŸ“Š Layer: HF_l4_FDCA.slice_att.linear.1
   â”œâ”€ Features: 1
   â”œâ”€ Mean Importance: 0.0000
   â”œâ”€ Max Importance: 0.0000
   â”œâ”€ Min Importance: 0.0000
   â””â”€ Top-5 Important Features: [0]
      â””â”€ Top-5 Values: ['0.0000']

ðŸ“Š Layer: HF_l4_FDCA.slice_att.linear.2
   â”œâ”€ Features: 1
   â”œâ”€ Mean Importance: 0.0000
   â”œâ”€ Max Importance: 0.0000
   â”œâ”€ Min Importance: 0.0000
   â””â”€ Top-5 Important Features: [0]
      â””â”€ Top-5 Values: ['0.0000']

ðŸ“Š Layer: HF_l4_FDCA.slice_att.linear
   â”œâ”€ Features: 1
   â”œâ”€ Mean Importance: 0.0000
   â”œâ”€ Max Importance: 0.0000
   â”œâ”€ Min Importance: 0.0000
   â””â”€ Top-5 Important Features: [0]
      â””â”€ Top-5 Values: ['0.0000']

ðŸ“Š Layer: HF_l4_FDCA.slice_att.non_linear
   â”œâ”€ Features: 1
   â”œâ”€ Mean Importance: 0.0000
   â”œâ”€ Max Importance: 0.0000
   â”œâ”€ Min Importance: 0.0000
   â””â”€ Top-5 Important Features: [0]
      â””â”€ Top-5 Values: ['0.0000']

ðŸ“Š Layer: HF_l4_FDCA.slice_att.mean
   â”œâ”€ Features: 1
   â”œâ”€ Mean Importance: 0.0000
   â”œâ”€ Max Importance: 0.0000
   â”œâ”€ Min Importance: 0.0000
   â””â”€ Top-5 Important Features: [0]
      â””â”€ Top-5 Values: ['0.0000']

ðŸ“Š Layer: HF_l4_FDCA.slice_att.log_diag
   â”œâ”€ Features: 1
   â”œâ”€ Mean Importance: 0.0000
   â”œâ”€ Max Importance: 0.0000
   â”œâ”€ Min Importance: 0.0000
   â””â”€ Top-5 Important Features: [0]
      â””â”€ Top-5 Values: ['0.0000']

ðŸ“Š Layer: HF_l4_FDCA.slice_att.factor
   â”œâ”€ Features: 1
   â”œâ”€ Mean Importance: 0.0000
   â”œâ”€ Max Importance: 0.0000
   â”œâ”€ Min Importance: 0.0000
   â””â”€ Top-5 Important Features: [0]
      â””â”€ Top-5 Values: ['0.0000']

ðŸ“Š Layer: HF_l4_FDCA.slice_att
   â”œâ”€ Features: 1
   â”œâ”€ Mean Importance: 0.0077
   â”œâ”€ Max Importance: 0.0077
   â”œâ”€ Min Importance: 0.0077
   â””â”€ Top-5 Important Features: [0]
      â””â”€ Top-5 Values: ['0.0077']

ðŸ“Š Layer: HF_l4_FDCA
   â”œâ”€ Features: 1
   â”œâ”€ Mean Importance: 2.5752
   â”œâ”€ Max Importance: 2.5752
   â”œâ”€ Min Importance: 2.5752
   â””â”€ Top-5 Important Features: [0]
      â””â”€ Top-5 Values: ['2.5752']

ðŸ“Š Layer: HF_l5_FDCA.semantic_att
   â”œâ”€ Features: 1
   â”œâ”€ Mean Importance: 0.0639
   â”œâ”€ Max Importance: 0.0639
   â”œâ”€ Min Importance: 0.0639
   â””â”€ Top-5 Important Features: [0]
      â””â”€ Top-5 Values: ['0.0639']

ðŸ“Š Layer: HF_l5_FDCA.positional_att.conv
   â”œâ”€ Features: 1
   â”œâ”€ Mean Importance: 15.0171
   â”œâ”€ Max Importance: 15.0171
   â”œâ”€ Min Importance: 15.0171
   â””â”€ Top-5 Important Features: [0]
      â””â”€ Top-5 Values: ['15.0171']

ðŸ“Š Layer: HF_l5_FDCA.positional_att
   â”œâ”€ Features: 1
   â”œâ”€ Mean Importance: 0.0001
   â”œâ”€ Max Importance: 0.0001
   â”œâ”€ Min Importance: 0.0001
   â””â”€ Top-5 Important Features: [0]
      â””â”€ Top-5 Values: ['0.0001']

ðŸ“Š Layer: HF_l5_FDCA.slice_att.linear.0
   â”œâ”€ Features: 1
   â”œâ”€ Mean Importance: 0.0000
   â”œâ”€ Max Importance: 0.0000
   â”œâ”€ Min Importance: 0.0000
   â””â”€ Top-5 Important Features: [0]
      â””â”€ Top-5 Values: ['0.0000']

ðŸ“Š Layer: HF_l5_FDCA.slice_att.linear.1
   â”œâ”€ Features: 1
   â”œâ”€ Mean Importance: 0.0000
   â”œâ”€ Max Importance: 0.0000
   â”œâ”€ Min Importance: 0.0000
   â””â”€ Top-5 Important Features: [0]
      â””â”€ Top-5 Values: ['0.0000']

ðŸ“Š Layer: HF_l5_FDCA.slice_att.linear.2
   â”œâ”€ Features: 1
   â”œâ”€ Mean Importance: 0.0000
   â”œâ”€ Max Importance: 0.0000
   â”œâ”€ Min Importance: 0.0000
   â””â”€ Top-5 Important Features: [0]
      â””â”€ Top-5 Values: ['0.0000']

ðŸ“Š Layer: HF_l5_FDCA.slice_att.linear
   â”œâ”€ Features: 1
   â”œâ”€ Mean Importance: 0.0000
   â”œâ”€ Max Importance: 0.0000
   â”œâ”€ Min Importance: 0.0000
   â””â”€ Top-5 Important Features: [0]
      â””â”€ Top-5 Values: ['0.0000']

ðŸ“Š Layer: HF_l5_FDCA.slice_att.non_linear
   â”œâ”€ Features: 1
   â”œâ”€ Mean Importance: 0.0000
   â”œâ”€ Max Importance: 0.0000
   â”œâ”€ Min Importance: 0.0000
   â””â”€ Top-5 Important Features: [0]
      â””â”€ Top-5 Values: ['0.0000']

ðŸ“Š Layer: HF_l5_FDCA.slice_att.mean
   â”œâ”€ Features: 1
   â”œâ”€ Mean Importance: 0.0000
   â”œâ”€ Max Importance: 0.0000
   â”œâ”€ Min Importance: 0.0000
   â””â”€ Top-5 Important Features: [0]
      â””â”€ Top-5 Values: ['0.0000']

ðŸ“Š Layer: HF_l5_FDCA.slice_att.log_diag
   â”œâ”€ Features: 1
   â”œâ”€ Mean Importance: 0.0000
   â”œâ”€ Max Importance: 0.0000
   â”œâ”€ Min Importance: 0.0000
   â””â”€ Top-5 Important Features: [0]
      â””â”€ Top-5 Values: ['0.0000']

ðŸ“Š Layer: HF_l5_FDCA.slice_att.factor
   â”œâ”€ Features: 1
   â”œâ”€ Mean Importance: 0.0000
   â”œâ”€ Max Importance: 0.0000
   â”œâ”€ Min Importance: 0.0000
   â””â”€ Top-5 Important Features: [0]
      â””â”€ Top-5 Values: ['0.0000']

ðŸ“Š Layer: HF_l5_FDCA.slice_att
   â”œâ”€ Features: 1
   â”œâ”€ Mean Importance: 0.0001
   â”œâ”€ Max Importance: 0.0001
   â”œâ”€ Min Importance: 0.0001
   â””â”€ Top-5 Important Features: [0]
      â””â”€ Top-5 Values: ['0.0001']

ðŸ“Š Layer: HF_l5_FDCA
   â”œâ”€ Features: 1
   â”œâ”€ Mean Importance: 0.0003
   â”œâ”€ Max Importance: 0.0003
   â”œâ”€ Min Importance: 0.0003
   â””â”€ Top-5 Important Features: [0]
      â””â”€ Top-5 Values: ['0.0003']

======================================================================
âœ“ Mechanistic analysis complete

[3] Generating Grad-CAM...
Warning: Failed to generate CAM for class 0: element 0 of tensors does not require grad and does not have a grad_fn
Warning: Failed to generate CAM for class 1: element 0 of tensors does not require grad and does not have a grad_fn
Warning: Failed to generate CAM for class 2: element 0 of tensors does not require grad and does not have a grad_fn
Warning: Failed to generate CAM for class 3: element 0 of tensors does not require grad and does not have a grad_fn
[4] Analyzing frequency components...
âœ“ Saved: outputs/xai_2025-11-15_17-25-23/freq_component/sample_0008_freq_comp.png
âœ“ Evaluation complete for sample_0008
Evaluating:  24%|##3       | 9/38 [02:32<08:01, 16.60s/it]
[1] Getting primary prediction...

[METRICS FOR sample_0009]
==================================================
class_0: Dice=0.9964, IoU=0.9928
class_1: Dice=0.3157, IoU=0.1874
class_2: Dice=0.7598, IoU=0.6127
class_3: Dice=0.7793, IoU=0.6384
==================================================

[2] Generating attention maps...
Clipping input data to the valid range for imshow with RGB data ([0..1] for floats or [0..255] for integers).
Clipping input data to the valid range for imshow with RGB data ([0..1] for floats or [0..255] for integers).
âœ“ Saved: outputs/xai_2025-11-15_17-25-23/attention/sample_0009_attention.png

[MECHANISTIC INTERPRETABILITY ANALYSIS]
======================================================================
Sample: sample_0009
======================================================================

ðŸ“Š Layer: LF_l4_FDCA.semantic_att
   â”œâ”€ Features: 1
   â”œâ”€ Mean Importance: 0.1396
   â”œâ”€ Max Importance: 0.1396
   â”œâ”€ Min Importance: 0.1396
   â””â”€ Top-5 Important Features: [0]
      â””â”€ Top-5 Values: ['0.1396']

ðŸ“Š Layer: LF_l4_FDCA.positional_att.conv
   â”œâ”€ Features: 1
   â”œâ”€ Mean Importance: 247.2034
   â”œâ”€ Max Importance: 247.2034
   â”œâ”€ Min Importance: 247.2034
   â””â”€ Top-5 Important Features: [0]
      â””â”€ Top-5 Values: ['247.2034']

ðŸ“Š Layer: LF_l4_FDCA.positional_att
   â”œâ”€ Features: 1
   â”œâ”€ Mean Importance: 53.9457
   â”œâ”€ Max Importance: 53.9457
   â”œâ”€ Min Importance: 53.9457
   â””â”€ Top-5 Important Features: [0]
      â””â”€ Top-5 Values: ['53.9457']

ðŸ“Š Layer: LF_l4_FDCA.slice_att.linear.0
   â”œâ”€ Features: 1
   â”œâ”€ Mean Importance: 64.7267
   â”œâ”€ Max Importance: 64.7267
   â”œâ”€ Min Importance: 64.7267
   â””â”€ Top-5 Important Features: [0]
      â””â”€ Top-5 Values: ['64.7267']

ðŸ“Š Layer: LF_l4_FDCA.slice_att.linear.1
   â”œâ”€ Features: 1
   â”œâ”€ Mean Importance: 54.9134
   â”œâ”€ Max Importance: 54.9134
   â”œâ”€ Min Importance: 54.9134
   â””â”€ Top-5 Important Features: [0]
      â””â”€ Top-5 Values: ['54.9134']

ðŸ“Š Layer: LF_l4_FDCA.slice_att.linear.2
   â”œâ”€ Features: 1
   â”œâ”€ Mean Importance: 52.0826
   â”œâ”€ Max Importance: 52.0826
   â”œâ”€ Min Importance: 52.0826
   â””â”€ Top-5 Important Features: [0]
      â””â”€ Top-5 Values: ['52.0826']

ðŸ“Š Layer: LF_l4_FDCA.slice_att.linear
   â”œâ”€ Features: 1
   â”œâ”€ Mean Importance: 52.0826
   â”œâ”€ Max Importance: 52.0826
   â”œâ”€ Min Importance: 52.0826
   â””â”€ Top-5 Important Features: [0]
      â””â”€ Top-5 Values: ['52.0826']

ðŸ“Š Layer: LF_l4_FDCA.slice_att.non_linear
   â”œâ”€ Features: 1
   â”œâ”€ Mean Importance: 23140112.0000
   â”œâ”€ Max Importance: 23140112.0000
   â”œâ”€ Min Importance: 23140112.0000
   â””â”€ Top-5 Important Features: [0]
      â””â”€ Top-5 Values: ['23140112.0000']

ðŸ“Š Layer: LF_l4_FDCA.slice_att.mean
   â”œâ”€ Features: 1
   â”œâ”€ Mean Importance: 92436024.0000
   â”œâ”€ Max Importance: 92436024.0000
   â”œâ”€ Min Importance: 92436024.0000
   â””â”€ Top-5 Important Features: [0]
      â””â”€ Top-5 Values: ['92436024.0000']

ðŸ“Š Layer: LF_l4_FDCA.slice_att.log_diag
   â”œâ”€ Features: 1
   â”œâ”€ Mean Importance: 5729.2305
   â”œâ”€ Max Importance: 5729.2305
   â”œâ”€ Min Importance: 5729.2305
   â””â”€ Top-5 Important Features: [0]
      â””â”€ Top-5 Values: ['5729.2305']

ðŸ“Š Layer: LF_l4_FDCA.slice_att.factor
   â”œâ”€ Features: 1
   â”œâ”€ Mean Importance: 35804512.0000
   â”œâ”€ Max Importance: 35804512.0000
   â”œâ”€ Min Importance: 35804512.0000
   â””â”€ Top-5 Important Features: [0]
      â””â”€ Top-5 Values: ['35804512.0000']

ðŸ“Š Layer: LF_l4_FDCA.slice_att
   â”œâ”€ Features: 1
   â”œâ”€ Mean Importance: 15817558.0000
   â”œâ”€ Max Importance: 15817558.0000
   â”œâ”€ Min Importance: 15817558.0000
   â””â”€ Top-5 Important Features: [0]
      â””â”€ Top-5 Values: ['15817558.0000']

ðŸ“Š Layer: LF_l4_FDCA
   â”œâ”€ Features: 1
   â”œâ”€ Mean Importance: 1794848828495495168.0000
   â”œâ”€ Max Importance: 1794848828495495168.0000
   â”œâ”€ Min Importance: 1794848828495495168.0000
   â””â”€ Top-5 Important Features: [0]
      â””â”€ Top-5 Values: ['1794848828495495168.0000']

ðŸ“Š Layer: LF_l5_FDCA.semantic_att
   â”œâ”€ Features: 1
   â”œâ”€ Mean Importance: 0.0827
   â”œâ”€ Max Importance: 0.0827
   â”œâ”€ Min Importance: 0.0827
   â””â”€ Top-5 Important Features: [0]
      â””â”€ Top-5 Values: ['0.0827']

ðŸ“Š Layer: LF_l5_FDCA.positional_att.conv
   â”œâ”€ Features: 1
   â”œâ”€ Mean Importance: 64.5705
   â”œâ”€ Max Importance: 64.5705
   â”œâ”€ Min Importance: 64.5705
   â””â”€ Top-5 Important Features: [0]
      â””â”€ Top-5 Values: ['64.5705']

ðŸ“Š Layer: LF_l5_FDCA.positional_att
   â”œâ”€ Features: 1
   â”œâ”€ Mean Importance: 0.0000
   â”œâ”€ Max Importance: 0.0000
   â”œâ”€ Min Importance: 0.0000
   â””â”€ Top-5 Important Features: [0]
      â””â”€ Top-5 Values: ['0.0000']

ðŸ“Š Layer: LF_l5_FDCA.slice_att.linear.0
   â”œâ”€ Features: 1
   â”œâ”€ Mean Importance: 0.0000
   â”œâ”€ Max Importance: 0.0000
   â”œâ”€ Min Importance: 0.0000
   â””â”€ Top-5 Important Features: [0]
      â””â”€ Top-5 Values: ['0.0000']

ðŸ“Š Layer: LF_l5_FDCA.slice_att.linear.1
   â”œâ”€ Features: 1
   â”œâ”€ Mean Importance: 0.0000
   â”œâ”€ Max Importance: 0.0000
   â”œâ”€ Min Importance: 0.0000
   â””â”€ Top-5 Important Features: [0]
      â””â”€ Top-5 Values: ['0.0000']

ðŸ“Š Layer: LF_l5_FDCA.slice_att.linear.2
   â”œâ”€ Features: 1
   â”œâ”€ Mean Importance: 0.0000
   â”œâ”€ Max Importance: 0.0000
   â”œâ”€ Min Importance: 0.0000
   â””â”€ Top-5 Important Features: [0]
      â””â”€ Top-5 Values: ['0.0000']

ðŸ“Š Layer: LF_l5_FDCA.slice_att.linear
   â”œâ”€ Features: 1
   â”œâ”€ Mean Importance: 0.0000
   â”œâ”€ Max Importance: 0.0000
   â”œâ”€ Min Importance: 0.0000
   â””â”€ Top-5 Important Features: [0]
      â””â”€ Top-5 Values: ['0.0000']

ðŸ“Š Layer: LF_l5_FDCA.slice_att.non_linear
   â”œâ”€ Features: 1
   â”œâ”€ Mean Importance: 0.0000
   â”œâ”€ Max Importance: 0.0000
   â”œâ”€ Min Importance: 0.0000
   â””â”€ Top-5 Important Features: [0]
      â””â”€ Top-5 Values: ['0.0000']

ðŸ“Š Layer: LF_l5_FDCA.slice_att.mean
   â”œâ”€ Features: 1
   â”œâ”€ Mean Importance: 0.0017
   â”œâ”€ Max Importance: 0.0017
   â”œâ”€ Min Importance: 0.0017
   â””â”€ Top-5 Important Features: [0]
      â””â”€ Top-5 Values: ['0.0017']

ðŸ“Š Layer: LF_l5_FDCA.slice_att.log_diag
   â”œâ”€ Features: 1
   â”œâ”€ Mean Importance: 0.0000
   â”œâ”€ Max Importance: 0.0000
   â”œâ”€ Min Importance: 0.0000
   â””â”€ Top-5 Important Features: [0]
      â””â”€ Top-5 Values: ['0.0000']

ðŸ“Š Layer: LF_l5_FDCA.slice_att.factor
   â”œâ”€ Features: 1
   â”œâ”€ Mean Importance: 0.0001
   â”œâ”€ Max Importance: 0.0001
   â”œâ”€ Min Importance: 0.0001
   â””â”€ Top-5 Important Features: [0]
      â””â”€ Top-5 Values: ['0.0001']

ðŸ“Š Layer: LF_l5_FDCA.slice_att
   â”œâ”€ Features: 1
   â”œâ”€ Mean Importance: 0.0000
   â”œâ”€ Max Importance: 0.0000
   â”œâ”€ Min Importance: 0.0000
   â””â”€ Top-5 Important Features: [0]
      â””â”€ Top-5 Values: ['0.0000']

ðŸ“Š Layer: LF_l5_FDCA
   â”œâ”€ Features: 1
   â”œâ”€ Mean Importance: 0.0000
   â”œâ”€ Max Importance: 0.0000
   â”œâ”€ Min Importance: 0.0000
   â””â”€ Top-5 Important Features: [0]
      â””â”€ Top-5 Values: ['0.0000']

ðŸ“Š Layer: HF_l4_FDCA.semantic_att
   â”œâ”€ Features: 1
   â”œâ”€ Mean Importance: 0.0819
   â”œâ”€ Max Importance: 0.0819
   â”œâ”€ Min Importance: 0.0819
   â””â”€ Top-5 Important Features: [0]
      â””â”€ Top-5 Values: ['0.0819']

ðŸ“Š Layer: HF_l4_FDCA.positional_att.conv
   â”œâ”€ Features: 1
   â”œâ”€ Mean Importance: 9.5264
   â”œâ”€ Max Importance: 9.5264
   â”œâ”€ Min Importance: 9.5264
   â””â”€ Top-5 Important Features: [0]
      â””â”€ Top-5 Values: ['9.5264']

ðŸ“Š Layer: HF_l4_FDCA.positional_att
   â”œâ”€ Features: 1
   â”œâ”€ Mean Importance: 0.0017
   â”œâ”€ Max Importance: 0.0017
   â”œâ”€ Min Importance: 0.0017
   â””â”€ Top-5 Important Features: [0]
      â””â”€ Top-5 Values: ['0.0017']

ðŸ“Š Layer: HF_l4_FDCA.slice_att.linear.0
   â”œâ”€ Features: 1
   â”œâ”€ Mean Importance: 0.0000
   â”œâ”€ Max Importance: 0.0000
   â”œâ”€ Min Importance: 0.0000
   â””â”€ Top-5 Important Features: [0]
      â””â”€ Top-5 Values: ['0.0000']

ðŸ“Š Layer: HF_l4_FDCA.slice_att.linear.1
   â”œâ”€ Features: 1
   â”œâ”€ Mean Importance: 0.0000
   â”œâ”€ Max Importance: 0.0000
   â”œâ”€ Min Importance: 0.0000
   â””â”€ Top-5 Important Features: [0]
      â””â”€ Top-5 Values: ['0.0000']

ðŸ“Š Layer: HF_l4_FDCA.slice_att.linear.2
   â”œâ”€ Features: 1
   â”œâ”€ Mean Importance: 0.0000
   â”œâ”€ Max Importance: 0.0000
   â”œâ”€ Min Importance: 0.0000
   â””â”€ Top-5 Important Features: [0]
      â””â”€ Top-5 Values: ['0.0000']

ðŸ“Š Layer: HF_l4_FDCA.slice_att.linear
   â”œâ”€ Features: 1
   â”œâ”€ Mean Importance: 0.0000
   â”œâ”€ Max Importance: 0.0000
   â”œâ”€ Min Importance: 0.0000
   â””â”€ Top-5 Important Features: [0]
      â””â”€ Top-5 Values: ['0.0000']

ðŸ“Š Layer: HF_l4_FDCA.slice_att.non_linear
   â”œâ”€ Features: 1
   â”œâ”€ Mean Importance: 0.0000
   â”œâ”€ Max Importance: 0.0000
   â”œâ”€ Min Importance: 0.0000
   â””â”€ Top-5 Important Features: [0]
      â””â”€ Top-5 Values: ['0.0000']

ðŸ“Š Layer: HF_l4_FDCA.slice_att.mean
   â”œâ”€ Features: 1
   â”œâ”€ Mean Importance: 0.0000
   â”œâ”€ Max Importance: 0.0000
   â”œâ”€ Min Importance: 0.0000
   â””â”€ Top-5 Important Features: [0]
      â””â”€ Top-5 Values: ['0.0000']

ðŸ“Š Layer: HF_l4_FDCA.slice_att.log_diag
   â”œâ”€ Features: 1
   â”œâ”€ Mean Importance: 0.0000
   â”œâ”€ Max Importance: 0.0000
   â”œâ”€ Min Importance: 0.0000
   â””â”€ Top-5 Important Features: [0]
      â””â”€ Top-5 Values: ['0.0000']

ðŸ“Š Layer: HF_l4_FDCA.slice_att.factor
   â”œâ”€ Features: 1
   â”œâ”€ Mean Importance: 0.0000
   â”œâ”€ Max Importance: 0.0000
   â”œâ”€ Min Importance: 0.0000
   â””â”€ Top-5 Important Features: [0]
      â””â”€ Top-5 Values: ['0.0000']

ðŸ“Š Layer: HF_l4_FDCA.slice_att
   â”œâ”€ Features: 1
   â”œâ”€ Mean Importance: 0.0051
   â”œâ”€ Max Importance: 0.0051
   â”œâ”€ Min Importance: 0.0051
   â””â”€ Top-5 Important Features: [0]
      â””â”€ Top-5 Values: ['0.0051']

ðŸ“Š Layer: HF_l4_FDCA
   â”œâ”€ Features: 1
   â”œâ”€ Mean Importance: 0.9396
   â”œâ”€ Max Importance: 0.9396
   â”œâ”€ Min Importance: 0.9396
   â””â”€ Top-5 Important Features: [0]
      â””â”€ Top-5 Values: ['0.9396']

ðŸ“Š Layer: HF_l5_FDCA.semantic_att
   â”œâ”€ Features: 1
   â”œâ”€ Mean Importance: 0.0624
   â”œâ”€ Max Importance: 0.0624
   â”œâ”€ Min Importance: 0.0624
   â””â”€ Top-5 Important Features: [0]
      â””â”€ Top-5 Values: ['0.0624']

ðŸ“Š Layer: HF_l5_FDCA.positional_att.conv
   â”œâ”€ Features: 1
   â”œâ”€ Mean Importance: 12.3009
   â”œâ”€ Max Importance: 12.3009
   â”œâ”€ Min Importance: 12.3009
   â””â”€ Top-5 Important Features: [0]
      â””â”€ Top-5 Values: ['12.3009']

ðŸ“Š Layer: HF_l5_FDCA.positional_att
   â”œâ”€ Features: 1
   â”œâ”€ Mean Importance: 0.0001
   â”œâ”€ Max Importance: 0.0001
   â”œâ”€ Min Importance: 0.0001
   â””â”€ Top-5 Important Features: [0]
      â””â”€ Top-5 Values: ['0.0001']

ðŸ“Š Layer: HF_l5_FDCA.slice_att.linear.0
   â”œâ”€ Features: 1
   â”œâ”€ Mean Importance: 0.0000
   â”œâ”€ Max Importance: 0.0000
   â”œâ”€ Min Importance: 0.0000
   â””â”€ Top-5 Important Features: [0]
      â””â”€ Top-5 Values: ['0.0000']

ðŸ“Š Layer: HF_l5_FDCA.slice_att.linear.1
   â”œâ”€ Features: 1
   â”œâ”€ Mean Importance: 0.0000
   â”œâ”€ Max Importance: 0.0000
   â”œâ”€ Min Importance: 0.0000
   â””â”€ Top-5 Important Features: [0]
      â””â”€ Top-5 Values: ['0.0000']

ðŸ“Š Layer: HF_l5_FDCA.slice_att.linear.2
   â”œâ”€ Features: 1
   â”œâ”€ Mean Importance: 0.0000
   â”œâ”€ Max Importance: 0.0000
   â”œâ”€ Min Importance: 0.0000
   â””â”€ Top-5 Important Features: [0]
      â””â”€ Top-5 Values: ['0.0000']

ðŸ“Š Layer: HF_l5_FDCA.slice_att.linear
   â”œâ”€ Features: 1
   â”œâ”€ Mean Importance: 0.0000
   â”œâ”€ Max Importance: 0.0000
   â”œâ”€ Min Importance: 0.0000
   â””â”€ Top-5 Important Features: [0]
      â””â”€ Top-5 Values: ['0.0000']

ðŸ“Š Layer: HF_l5_FDCA.slice_att.non_linear
   â”œâ”€ Features: 1
   â”œâ”€ Mean Importance: 0.0000
   â”œâ”€ Max Importance: 0.0000
   â”œâ”€ Min Importance: 0.0000
   â””â”€ Top-5 Important Features: [0]
      â””â”€ Top-5 Values: ['0.0000']

ðŸ“Š Layer: HF_l5_FDCA.slice_att.mean
   â”œâ”€ Features: 1
   â”œâ”€ Mean Importance: 0.0000
   â”œâ”€ Max Importance: 0.0000
   â”œâ”€ Min Importance: 0.0000
   â””â”€ Top-5 Important Features: [0]
      â””â”€ Top-5 Values: ['0.0000']

ðŸ“Š Layer: HF_l5_FDCA.slice_att.log_diag
   â”œâ”€ Features: 1
   â”œâ”€ Mean Importance: 0.0000
   â”œâ”€ Max Importance: 0.0000
   â”œâ”€ Min Importance: 0.0000
   â””â”€ Top-5 Important Features: [0]
      â””â”€ Top-5 Values: ['0.0000']

ðŸ“Š Layer: HF_l5_FDCA.slice_att.factor
   â”œâ”€ Features: 1
   â”œâ”€ Mean Importance: 0.0000
   â”œâ”€ Max Importance: 0.0000
   â”œâ”€ Min Importance: 0.0000
   â””â”€ Top-5 Important Features: [0]
      â””â”€ Top-5 Values: ['0.0000']

ðŸ“Š Layer: HF_l5_FDCA.slice_att
   â”œâ”€ Features: 1
   â”œâ”€ Mean Importance: 0.0001
   â”œâ”€ Max Importance: 0.0001
   â”œâ”€ Min Importance: 0.0001
   â””â”€ Top-5 Important Features: [0]
      â””â”€ Top-5 Values: ['0.0001']

ðŸ“Š Layer: HF_l5_FDCA
   â”œâ”€ Features: 1
   â”œâ”€ Mean Importance: 0.0003
   â”œâ”€ Max Importance: 0.0003
   â”œâ”€ Min Importance: 0.0003
   â””â”€ Top-5 Important Features: [0]
      â””â”€ Top-5 Values: ['0.0003']

======================================================================
âœ“ Mechanistic analysis complete

[3] Generating Grad-CAM...
Warning: Failed to generate CAM for class 0: element 0 of tensors does not require grad and does not have a grad_fn
Warning: Failed to generate CAM for class 1: element 0 of tensors does not require grad and does not have a grad_fn
Warning: Failed to generate CAM for class 2: element 0 of tensors does not require grad and does not have a grad_fn
Warning: Failed to generate CAM for class 3: element 0 of tensors does not require grad and does not have a grad_fn
[4] Analyzing frequency components...
âœ“ Saved: outputs/xai_2025-11-15_17-25-23/freq_component/sample_0009_freq_comp.png
âœ“ Evaluation complete for sample_0009
Evaluating:  26%|##6       | 10/38 [02:48<07:42, 16.52s/it]
[1] Getting primary prediction...

[METRICS FOR sample_0010]
==================================================
class_0: Dice=0.9958, IoU=0.9916
class_1: Dice=0.7397, IoU=0.5870
class_2: Dice=0.8284, IoU=0.7070
class_3: Dice=0.8722, IoU=0.7734
==================================================

[2] Generating attention maps...
Clipping input data to the valid range for imshow with RGB data ([0..1] for floats or [0..255] for integers).
Clipping input data to the valid range for imshow with RGB data ([0..1] for floats or [0..255] for integers).
âœ“ Saved: outputs/xai_2025-11-15_17-25-23/attention/sample_0010_attention.png

[MECHANISTIC INTERPRETABILITY ANALYSIS]
======================================================================
Sample: sample_0010
======================================================================

ðŸ“Š Layer: LF_l4_FDCA.semantic_att
   â”œâ”€ Features: 1
   â”œâ”€ Mean Importance: 0.1291
   â”œâ”€ Max Importance: 0.1291
   â”œâ”€ Min Importance: 0.1291
   â””â”€ Top-5 Important Features: [0]
      â””â”€ Top-5 Values: ['0.1291']

ðŸ“Š Layer: LF_l4_FDCA.positional_att.conv
   â”œâ”€ Features: 1
   â”œâ”€ Mean Importance: 260.8059
   â”œâ”€ Max Importance: 260.8059
   â”œâ”€ Min Importance: 260.8059
   â””â”€ Top-5 Important Features: [0]
      â””â”€ Top-5 Values: ['260.8059']

ðŸ“Š Layer: LF_l4_FDCA.positional_att
   â”œâ”€ Features: 1
   â”œâ”€ Mean Importance: 49.1813
   â”œâ”€ Max Importance: 49.1813
   â”œâ”€ Min Importance: 49.1813
   â””â”€ Top-5 Important Features: [0]
      â””â”€ Top-5 Values: ['49.1813']

ðŸ“Š Layer: LF_l4_FDCA.slice_att.linear.0
   â”œâ”€ Features: 1
   â”œâ”€ Mean Importance: 80.0276
   â”œâ”€ Max Importance: 80.0276
   â”œâ”€ Min Importance: 80.0276
   â””â”€ Top-5 Important Features: [0]
      â””â”€ Top-5 Values: ['80.0276']

ðŸ“Š Layer: LF_l4_FDCA.slice_att.linear.1
   â”œâ”€ Features: 1
   â”œâ”€ Mean Importance: 67.8905
   â”œâ”€ Max Importance: 67.8905
   â”œâ”€ Min Importance: 67.8905
   â””â”€ Top-5 Important Features: [0]
      â””â”€ Top-5 Values: ['67.8905']

ðŸ“Š Layer: LF_l4_FDCA.slice_att.linear.2
   â”œâ”€ Features: 1
   â”œâ”€ Mean Importance: 64.4162
   â”œâ”€ Max Importance: 64.4162
   â”œâ”€ Min Importance: 64.4162
   â””â”€ Top-5 Important Features: [0]
      â””â”€ Top-5 Values: ['64.4162']

ðŸ“Š Layer: LF_l4_FDCA.slice_att.linear
   â”œâ”€ Features: 1
   â”œâ”€ Mean Importance: 64.4162
   â”œâ”€ Max Importance: 64.4162
   â”œâ”€ Min Importance: 64.4162
   â””â”€ Top-5 Important Features: [0]
      â””â”€ Top-5 Values: ['64.4162']

ðŸ“Š Layer: LF_l4_FDCA.slice_att.non_linear
   â”œâ”€ Features: 1
   â”œâ”€ Mean Importance: 25498448.0000
   â”œâ”€ Max Importance: 25498448.0000
   â”œâ”€ Min Importance: 25498448.0000
   â””â”€ Top-5 Important Features: [0]
      â””â”€ Top-5 Values: ['25498448.0000']

ðŸ“Š Layer: LF_l4_FDCA.slice_att.mean
   â”œâ”€ Features: 1
   â”œâ”€ Mean Importance: 101872528.0000
   â”œâ”€ Max Importance: 101872528.0000
   â”œâ”€ Min Importance: 101872528.0000
   â””â”€ Top-5 Important Features: [0]
      â””â”€ Top-5 Values: ['101872528.0000']

ðŸ“Š Layer: LF_l4_FDCA.slice_att.log_diag
   â”œâ”€ Features: 1
   â”œâ”€ Mean Importance: 6313.9644
   â”œâ”€ Max Importance: 6313.9644
   â”œâ”€ Min Importance: 6313.9644
   â””â”€ Top-5 Important Features: [0]
      â””â”€ Top-5 Values: ['6313.9644']

ðŸ“Š Layer: LF_l4_FDCA.slice_att.factor
   â”œâ”€ Features: 1
   â”œâ”€ Mean Importance: 39459864.0000
   â”œâ”€ Max Importance: 39459864.0000
   â”œâ”€ Min Importance: 39459864.0000
   â””â”€ Top-5 Important Features: [0]
      â””â”€ Top-5 Values: ['39459864.0000']

ðŸ“Š Layer: LF_l4_FDCA.slice_att
   â”œâ”€ Features: 1
   â”œâ”€ Mean Importance: 18517910.0000
   â”œâ”€ Max Importance: 18517910.0000
   â”œâ”€ Min Importance: 18517910.0000
   â””â”€ Top-5 Important Features: [0]
      â””â”€ Top-5 Values: ['18517910.0000']

ðŸ“Š Layer: LF_l4_FDCA
   â”œâ”€ Features: 1
   â”œâ”€ Mean Importance: 2651788949730623488.0000
   â”œâ”€ Max Importance: 2651788949730623488.0000
   â”œâ”€ Min Importance: 2651788949730623488.0000
   â””â”€ Top-5 Important Features: [0]
      â””â”€ Top-5 Values: ['2651788949730623488.0000']

ðŸ“Š Layer: LF_l5_FDCA.semantic_att
   â”œâ”€ Features: 1
   â”œâ”€ Mean Importance: 0.0856
   â”œâ”€ Max Importance: 0.0856
   â”œâ”€ Min Importance: 0.0856
   â””â”€ Top-5 Important Features: [0]
      â””â”€ Top-5 Values: ['0.0856']

ðŸ“Š Layer: LF_l5_FDCA.positional_att.conv
   â”œâ”€ Features: 1
   â”œâ”€ Mean Importance: 64.1742
   â”œâ”€ Max Importance: 64.1742
   â”œâ”€ Min Importance: 64.1742
   â””â”€ Top-5 Important Features: [0]
      â””â”€ Top-5 Values: ['64.1742']

ðŸ“Š Layer: LF_l5_FDCA.positional_att
   â”œâ”€ Features: 1
   â”œâ”€ Mean Importance: 0.0000
   â”œâ”€ Max Importance: 0.0000
   â”œâ”€ Min Importance: 0.0000
   â””â”€ Top-5 Important Features: [0]
      â””â”€ Top-5 Values: ['0.0000']

ðŸ“Š Layer: LF_l5_FDCA.slice_att.linear.0
   â”œâ”€ Features: 1
   â”œâ”€ Mean Importance: 0.0000
   â”œâ”€ Max Importance: 0.0000
   â”œâ”€ Min Importance: 0.0000
   â””â”€ Top-5 Important Features: [0]
      â””â”€ Top-5 Values: ['0.0000']

ðŸ“Š Layer: LF_l5_FDCA.slice_att.linear.1
   â”œâ”€ Features: 1
   â”œâ”€ Mean Importance: 0.0000
   â”œâ”€ Max Importance: 0.0000
   â”œâ”€ Min Importance: 0.0000
   â””â”€ Top-5 Important Features: [0]
      â””â”€ Top-5 Values: ['0.0000']

ðŸ“Š Layer: LF_l5_FDCA.slice_att.linear.2
   â”œâ”€ Features: 1
   â”œâ”€ Mean Importance: 0.0000
   â”œâ”€ Max Importance: 0.0000
   â”œâ”€ Min Importance: 0.0000
   â””â”€ Top-5 Important Features: [0]
      â””â”€ Top-5 Values: ['0.0000']

ðŸ“Š Layer: LF_l5_FDCA.slice_att.linear
   â”œâ”€ Features: 1
   â”œâ”€ Mean Importance: 0.0000
   â”œâ”€ Max Importance: 0.0000
   â”œâ”€ Min Importance: 0.0000
   â””â”€ Top-5 Important Features: [0]
      â””â”€ Top-5 Values: ['0.0000']

ðŸ“Š Layer: LF_l5_FDCA.slice_att.non_linear
   â”œâ”€ Features: 1
   â”œâ”€ Mean Importance: 0.0000
   â”œâ”€ Max Importance: 0.0000
   â”œâ”€ Min Importance: 0.0000
   â””â”€ Top-5 Important Features: [0]
      â””â”€ Top-5 Values: ['0.0000']

ðŸ“Š Layer: LF_l5_FDCA.slice_att.mean
   â”œâ”€ Features: 1
   â”œâ”€ Mean Importance: 0.0017
   â”œâ”€ Max Importance: 0.0017
   â”œâ”€ Min Importance: 0.0017
   â””â”€ Top-5 Important Features: [0]
      â””â”€ Top-5 Values: ['0.0017']

ðŸ“Š Layer: LF_l5_FDCA.slice_att.log_diag
   â”œâ”€ Features: 1
   â”œâ”€ Mean Importance: 0.0000
   â”œâ”€ Max Importance: 0.0000
   â”œâ”€ Min Importance: 0.0000
   â””â”€ Top-5 Important Features: [0]
      â””â”€ Top-5 Values: ['0.0000']

ðŸ“Š Layer: LF_l5_FDCA.slice_att.factor
   â”œâ”€ Features: 1
   â”œâ”€ Mean Importance: 0.0001
   â”œâ”€ Max Importance: 0.0001
   â”œâ”€ Min Importance: 0.0001
   â””â”€ Top-5 Important Features: [0]
      â””â”€ Top-5 Values: ['0.0001']

ðŸ“Š Layer: LF_l5_FDCA.slice_att
   â”œâ”€ Features: 1
   â”œâ”€ Mean Importance: 0.0000
   â”œâ”€ Max Importance: 0.0000
   â”œâ”€ Min Importance: 0.0000
   â””â”€ Top-5 Important Features: [0]
      â””â”€ Top-5 Values: ['0.0000']

ðŸ“Š Layer: LF_l5_FDCA
   â”œâ”€ Features: 1
   â”œâ”€ Mean Importance: 0.0000
   â”œâ”€ Max Importance: 0.0000
   â”œâ”€ Min Importance: 0.0000
   â””â”€ Top-5 Important Features: [0]
      â””â”€ Top-5 Values: ['0.0000']

ðŸ“Š Layer: HF_l4_FDCA.semantic_att
   â”œâ”€ Features: 1
   â”œâ”€ Mean Importance: 0.0813
   â”œâ”€ Max Importance: 0.0813
   â”œâ”€ Min Importance: 0.0813
   â””â”€ Top-5 Important Features: [0]
      â””â”€ Top-5 Values: ['0.0813']

ðŸ“Š Layer: HF_l4_FDCA.positional_att.conv
   â”œâ”€ Features: 1
   â”œâ”€ Mean Importance: 10.7840
   â”œâ”€ Max Importance: 10.7840
   â”œâ”€ Min Importance: 10.7840
   â””â”€ Top-5 Important Features: [0]
      â””â”€ Top-5 Values: ['10.7840']

ðŸ“Š Layer: HF_l4_FDCA.positional_att
   â”œâ”€ Features: 1
   â”œâ”€ Mean Importance: 0.0018
   â”œâ”€ Max Importance: 0.0018
   â”œâ”€ Min Importance: 0.0018
   â””â”€ Top-5 Important Features: [0]
      â””â”€ Top-5 Values: ['0.0018']

ðŸ“Š Layer: HF_l4_FDCA.slice_att.linear.0
   â”œâ”€ Features: 1
   â”œâ”€ Mean Importance: 0.0000
   â”œâ”€ Max Importance: 0.0000
   â”œâ”€ Min Importance: 0.0000
   â””â”€ Top-5 Important Features: [0]
      â””â”€ Top-5 Values: ['0.0000']

ðŸ“Š Layer: HF_l4_FDCA.slice_att.linear.1
   â”œâ”€ Features: 1
   â”œâ”€ Mean Importance: 0.0000
   â”œâ”€ Max Importance: 0.0000
   â”œâ”€ Min Importance: 0.0000
   â””â”€ Top-5 Important Features: [0]
      â””â”€ Top-5 Values: ['0.0000']

ðŸ“Š Layer: HF_l4_FDCA.slice_att.linear.2
   â”œâ”€ Features: 1
   â”œâ”€ Mean Importance: 0.0000
   â”œâ”€ Max Importance: 0.0000
   â”œâ”€ Min Importance: 0.0000
   â””â”€ Top-5 Important Features: [0]
      â””â”€ Top-5 Values: ['0.0000']

ðŸ“Š Layer: HF_l4_FDCA.slice_att.linear
   â”œâ”€ Features: 1
   â”œâ”€ Mean Importance: 0.0000
   â”œâ”€ Max Importance: 0.0000
   â”œâ”€ Min Importance: 0.0000
   â””â”€ Top-5 Important Features: [0]
      â””â”€ Top-5 Values: ['0.0000']

ðŸ“Š Layer: HF_l4_FDCA.slice_att.non_linear
   â”œâ”€ Features: 1
   â”œâ”€ Mean Importance: 0.0000
   â”œâ”€ Max Importance: 0.0000
   â”œâ”€ Min Importance: 0.0000
   â””â”€ Top-5 Important Features: [0]
      â””â”€ Top-5 Values: ['0.0000']

ðŸ“Š Layer: HF_l4_FDCA.slice_att.mean
   â”œâ”€ Features: 1
   â”œâ”€ Mean Importance: 0.0000
   â”œâ”€ Max Importance: 0.0000
   â”œâ”€ Min Importance: 0.0000
   â””â”€ Top-5 Important Features: [0]
      â””â”€ Top-5 Values: ['0.0000']

ðŸ“Š Layer: HF_l4_FDCA.slice_att.log_diag
   â”œâ”€ Features: 1
   â”œâ”€ Mean Importance: 0.0000
   â”œâ”€ Max Importance: 0.0000
   â”œâ”€ Min Importance: 0.0000
   â””â”€ Top-5 Important Features: [0]
      â””â”€ Top-5 Values: ['0.0000']

ðŸ“Š Layer: HF_l4_FDCA.slice_att.factor
   â”œâ”€ Features: 1
   â”œâ”€ Mean Importance: 0.0000
   â”œâ”€ Max Importance: 0.0000
   â”œâ”€ Min Importance: 0.0000
   â””â”€ Top-5 Important Features: [0]
      â””â”€ Top-5 Values: ['0.0000']

ðŸ“Š Layer: HF_l4_FDCA.slice_att
   â”œâ”€ Features: 1
   â”œâ”€ Mean Importance: 0.0067
   â”œâ”€ Max Importance: 0.0067
   â”œâ”€ Min Importance: 0.0067
   â””â”€ Top-5 Important Features: [0]
      â””â”€ Top-5 Values: ['0.0067']

ðŸ“Š Layer: HF_l4_FDCA
   â”œâ”€ Features: 1
   â”œâ”€ Mean Importance: 0.6507
   â”œâ”€ Max Importance: 0.6507
   â”œâ”€ Min Importance: 0.6507
   â””â”€ Top-5 Important Features: [0]
      â””â”€ Top-5 Values: ['0.6507']

ðŸ“Š Layer: HF_l5_FDCA.semantic_att
   â”œâ”€ Features: 1
   â”œâ”€ Mean Importance: 0.0653
   â”œâ”€ Max Importance: 0.0653
   â”œâ”€ Min Importance: 0.0653
   â””â”€ Top-5 Important Features: [0]
      â””â”€ Top-5 Values: ['0.0653']

ðŸ“Š Layer: HF_l5_FDCA.positional_att.conv
   â”œâ”€ Features: 1
   â”œâ”€ Mean Importance: 18.3627
   â”œâ”€ Max Importance: 18.3627
   â”œâ”€ Min Importance: 18.3627
   â””â”€ Top-5 Important Features: [0]
      â””â”€ Top-5 Values: ['18.3627']

ðŸ“Š Layer: HF_l5_FDCA.positional_att
   â”œâ”€ Features: 1
   â”œâ”€ Mean Importance: 0.0001
   â”œâ”€ Max Importance: 0.0001
   â”œâ”€ Min Importance: 0.0001
   â””â”€ Top-5 Important Features: [0]
      â””â”€ Top-5 Values: ['0.0001']

ðŸ“Š Layer: HF_l5_FDCA.slice_att.linear.0
   â”œâ”€ Features: 1
   â”œâ”€ Mean Importance: 0.0000
   â”œâ”€ Max Importance: 0.0000
   â”œâ”€ Min Importance: 0.0000
   â””â”€ Top-5 Important Features: [0]
      â””â”€ Top-5 Values: ['0.0000']

ðŸ“Š Layer: HF_l5_FDCA.slice_att.linear.1
   â”œâ”€ Features: 1
   â”œâ”€ Mean Importance: 0.0000
   â”œâ”€ Max Importance: 0.0000
   â”œâ”€ Min Importance: 0.0000
   â””â”€ Top-5 Important Features: [0]
      â””â”€ Top-5 Values: ['0.0000']

ðŸ“Š Layer: HF_l5_FDCA.slice_att.linear.2
   â”œâ”€ Features: 1
   â”œâ”€ Mean Importance: 0.0000
   â”œâ”€ Max Importance: 0.0000
   â”œâ”€ Min Importance: 0.0000
   â””â”€ Top-5 Important Features: [0]
      â””â”€ Top-5 Values: ['0.0000']

ðŸ“Š Layer: HF_l5_FDCA.slice_att.linear
   â”œâ”€ Features: 1
   â”œâ”€ Mean Importance: 0.0000
   â”œâ”€ Max Importance: 0.0000
   â”œâ”€ Min Importance: 0.0000
   â””â”€ Top-5 Important Features: [0]
      â””â”€ Top-5 Values: ['0.0000']

ðŸ“Š Layer: HF_l5_FDCA.slice_att.non_linear
   â”œâ”€ Features: 1
   â”œâ”€ Mean Importance: 0.0000
   â”œâ”€ Max Importance: 0.0000
   â”œâ”€ Min Importance: 0.0000
   â””â”€ Top-5 Important Features: [0]
      â””â”€ Top-5 Values: ['0.0000']

ðŸ“Š Layer: HF_l5_FDCA.slice_att.mean
   â”œâ”€ Features: 1
   â”œâ”€ Mean Importance: 0.0000
   â”œâ”€ Max Importance: 0.0000
   â”œâ”€ Min Importance: 0.0000
   â””â”€ Top-5 Important Features: [0]
      â””â”€ Top-5 Values: ['0.0000']

ðŸ“Š Layer: HF_l5_FDCA.slice_att.log_diag
   â”œâ”€ Features: 1
   â”œâ”€ Mean Importance: 0.0000
   â”œâ”€ Max Importance: 0.0000
   â”œâ”€ Min Importance: 0.0000
   â””â”€ Top-5 Important Features: [0]
      â””â”€ Top-5 Values: ['0.0000']

ðŸ“Š Layer: HF_l5_FDCA.slice_att.factor
   â”œâ”€ Features: 1
   â”œâ”€ Mean Importance: 0.0000
   â”œâ”€ Max Importance: 0.0000
   â”œâ”€ Min Importance: 0.0000
   â””â”€ Top-5 Important Features: [0]
      â””â”€ Top-5 Values: ['0.0000']

ðŸ“Š Layer: HF_l5_FDCA.slice_att
   â”œâ”€ Features: 1
   â”œâ”€ Mean Importance: 0.0001
   â”œâ”€ Max Importance: 0.0001
   â”œâ”€ Min Importance: 0.0001
   â””â”€ Top-5 Important Features: [0]
      â””â”€ Top-5 Values: ['0.0001']

ðŸ“Š Layer: HF_l5_FDCA
   â”œâ”€ Features: 1
   â”œâ”€ Mean Importance: 0.0002
   â”œâ”€ Max Importance: 0.0002
   â”œâ”€ Min Importance: 0.0002
   â””â”€ Top-5 Important Features: [0]
      â””â”€ Top-5 Values: ['0.0002']

======================================================================
âœ“ Mechanistic analysis complete

[3] Generating Grad-CAM...
Warning: Failed to generate CAM for class 0: element 0 of tensors does not require grad and does not have a grad_fn
Warning: Failed to generate CAM for class 1: element 0 of tensors does not require grad and does not have a grad_fn
Warning: Failed to generate CAM for class 2: element 0 of tensors does not require grad and does not have a grad_fn
Warning: Failed to generate CAM for class 3: element 0 of tensors does not require grad and does not have a grad_fn
[4] Analyzing frequency components...
âœ“ Saved: outputs/xai_2025-11-15_17-25-23/freq_component/sample_0010_freq_comp.png
âœ“ Evaluation complete for sample_0010
Evaluating:  29%|##8       | 11/38 [03:05<07:24, 16.47s/it]
[1] Getting primary prediction...

[METRICS FOR sample_0011]
==================================================
class_0: Dice=0.9915, IoU=0.9831
class_1: Dice=0.6787, IoU=0.5137
class_2: Dice=0.5246, IoU=0.3556
class_3: Dice=0.3360, IoU=0.2019
==================================================

[2] Generating attention maps...
Clipping input data to the valid range for imshow with RGB data ([0..1] for floats or [0..255] for integers).
Clipping input data to the valid range for imshow with RGB data ([0..1] for floats or [0..255] for integers).
âœ“ Saved: outputs/xai_2025-11-15_17-25-23/attention/sample_0011_attention.png

[MECHANISTIC INTERPRETABILITY ANALYSIS]
======================================================================
Sample: sample_0011
======================================================================

ðŸ“Š Layer: LF_l4_FDCA.semantic_att
   â”œâ”€ Features: 1
   â”œâ”€ Mean Importance: 0.1138
   â”œâ”€ Max Importance: 0.1138
   â”œâ”€ Min Importance: 0.1138
   â””â”€ Top-5 Important Features: [0]
      â””â”€ Top-5 Values: ['0.1138']

ðŸ“Š Layer: LF_l4_FDCA.positional_att.conv
   â”œâ”€ Features: 1
   â”œâ”€ Mean Importance: 282.4337
   â”œâ”€ Max Importance: 282.4337
   â”œâ”€ Min Importance: 282.4337
   â””â”€ Top-5 Important Features: [0]
      â””â”€ Top-5 Values: ['282.4337']

ðŸ“Š Layer: LF_l4_FDCA.positional_att
   â”œâ”€ Features: 1
   â”œâ”€ Mean Importance: 44.2738
   â”œâ”€ Max Importance: 44.2738
   â”œâ”€ Min Importance: 44.2738
   â””â”€ Top-5 Important Features: [0]
      â””â”€ Top-5 Values: ['44.2738']

ðŸ“Š Layer: LF_l4_FDCA.slice_att.linear.0
   â”œâ”€ Features: 1
   â”œâ”€ Mean Importance: 88.6802
   â”œâ”€ Max Importance: 88.6802
   â”œâ”€ Min Importance: 88.6802
   â””â”€ Top-5 Important Features: [0]
      â””â”€ Top-5 Values: ['88.6802']

ðŸ“Š Layer: LF_l4_FDCA.slice_att.linear.1
   â”œâ”€ Features: 1
   â”œâ”€ Mean Importance: 75.2245
   â”œâ”€ Max Importance: 75.2245
   â”œâ”€ Min Importance: 75.2245
   â””â”€ Top-5 Important Features: [0]
      â””â”€ Top-5 Values: ['75.2245']

ðŸ“Š Layer: LF_l4_FDCA.slice_att.linear.2
   â”œâ”€ Features: 1
   â”œâ”€ Mean Importance: 71.3936
   â”œâ”€ Max Importance: 71.3936
   â”œâ”€ Min Importance: 71.3936
   â””â”€ Top-5 Important Features: [0]
      â””â”€ Top-5 Values: ['71.3936']

ðŸ“Š Layer: LF_l4_FDCA.slice_att.linear
   â”œâ”€ Features: 1
   â”œâ”€ Mean Importance: 71.3936
   â”œâ”€ Max Importance: 71.3936
   â”œâ”€ Min Importance: 71.3936
   â””â”€ Top-5 Important Features: [0]
      â””â”€ Top-5 Values: ['71.3936']

ðŸ“Š Layer: LF_l4_FDCA.slice_att.non_linear
   â”œâ”€ Features: 1
   â”œâ”€ Mean Importance: 29357112.0000
   â”œâ”€ Max Importance: 29357112.0000
   â”œâ”€ Min Importance: 29357112.0000
   â””â”€ Top-5 Important Features: [0]
      â””â”€ Top-5 Values: ['29357112.0000']

ðŸ“Š Layer: LF_l4_FDCA.slice_att.mean
   â”œâ”€ Features: 1
   â”œâ”€ Mean Importance: 117301944.0000
   â”œâ”€ Max Importance: 117301944.0000
   â”œâ”€ Min Importance: 117301944.0000
   â””â”€ Top-5 Important Features: [0]
      â””â”€ Top-5 Values: ['117301944.0000']

ðŸ“Š Layer: LF_l4_FDCA.slice_att.log_diag
   â”œâ”€ Features: 1
   â”œâ”€ Mean Importance: 7270.1475
   â”œâ”€ Max Importance: 7270.1475
   â”œâ”€ Min Importance: 7270.1475
   â””â”€ Top-5 Important Features: [0]
      â””â”€ Top-5 Values: ['7270.1475']

ðŸ“Š Layer: LF_l4_FDCA.slice_att.factor
   â”œâ”€ Features: 1
   â”œâ”€ Mean Importance: 45436536.0000
   â”œâ”€ Max Importance: 45436536.0000
   â”œâ”€ Min Importance: 45436536.0000
   â””â”€ Top-5 Important Features: [0]
      â””â”€ Top-5 Values: ['45436536.0000']

ðŸ“Š Layer: LF_l4_FDCA.slice_att
   â”œâ”€ Features: 1
   â”œâ”€ Mean Importance: 118712.6719
   â”œâ”€ Max Importance: 118712.6719
   â”œâ”€ Min Importance: 118712.6719
   â””â”€ Top-5 Important Features: [0]
      â””â”€ Top-5 Values: ['118712.6719']

ðŸ“Š Layer: LF_l4_FDCA
   â”œâ”€ Features: 1
   â”œâ”€ Mean Importance: 298161495080960.0000
   â”œâ”€ Max Importance: 298161495080960.0000
   â”œâ”€ Min Importance: 298161495080960.0000
   â””â”€ Top-5 Important Features: [0]
      â””â”€ Top-5 Values: ['298161495080960.0000']

ðŸ“Š Layer: LF_l5_FDCA.semantic_att
   â”œâ”€ Features: 1
   â”œâ”€ Mean Importance: 0.0801
   â”œâ”€ Max Importance: 0.0801
   â”œâ”€ Min Importance: 0.0801
   â””â”€ Top-5 Important Features: [0]
      â””â”€ Top-5 Values: ['0.0801']

ðŸ“Š Layer: LF_l5_FDCA.positional_att.conv
   â”œâ”€ Features: 1
   â”œâ”€ Mean Importance: 74.6691
   â”œâ”€ Max Importance: 74.6691
   â”œâ”€ Min Importance: 74.6691
   â””â”€ Top-5 Important Features: [0]
      â””â”€ Top-5 Values: ['74.6691']

ðŸ“Š Layer: LF_l5_FDCA.positional_att
   â”œâ”€ Features: 1
   â”œâ”€ Mean Importance: 0.0000
   â”œâ”€ Max Importance: 0.0000
   â”œâ”€ Min Importance: 0.0000
   â””â”€ Top-5 Important Features: [0]
      â””â”€ Top-5 Values: ['0.0000']

ðŸ“Š Layer: LF_l5_FDCA.slice_att.linear.0
   â”œâ”€ Features: 1
   â”œâ”€ Mean Importance: 0.0000
   â”œâ”€ Max Importance: 0.0000
   â”œâ”€ Min Importance: 0.0000
   â””â”€ Top-5 Important Features: [0]
      â””â”€ Top-5 Values: ['0.0000']

ðŸ“Š Layer: LF_l5_FDCA.slice_att.linear.1
   â”œâ”€ Features: 1
   â”œâ”€ Mean Importance: 0.0000
   â”œâ”€ Max Importance: 0.0000
   â”œâ”€ Min Importance: 0.0000
   â””â”€ Top-5 Important Features: [0]
      â””â”€ Top-5 Values: ['0.0000']

ðŸ“Š Layer: LF_l5_FDCA.slice_att.linear.2
   â”œâ”€ Features: 1
   â”œâ”€ Mean Importance: 0.0000
   â”œâ”€ Max Importance: 0.0000
   â”œâ”€ Min Importance: 0.0000
   â””â”€ Top-5 Important Features: [0]
      â””â”€ Top-5 Values: ['0.0000']

ðŸ“Š Layer: LF_l5_FDCA.slice_att.linear
   â”œâ”€ Features: 1
   â”œâ”€ Mean Importance: 0.0000
   â”œâ”€ Max Importance: 0.0000
   â”œâ”€ Min Importance: 0.0000
   â””â”€ Top-5 Important Features: [0]
      â””â”€ Top-5 Values: ['0.0000']

ðŸ“Š Layer: LF_l5_FDCA.slice_att.non_linear
   â”œâ”€ Features: 1
   â”œâ”€ Mean Importance: 0.0000
   â”œâ”€ Max Importance: 0.0000
   â”œâ”€ Min Importance: 0.0000
   â””â”€ Top-5 Important Features: [0]
      â””â”€ Top-5 Values: ['0.0000']

ðŸ“Š Layer: LF_l5_FDCA.slice_att.mean
   â”œâ”€ Features: 1
   â”œâ”€ Mean Importance: 0.0017
   â”œâ”€ Max Importance: 0.0017
   â”œâ”€ Min Importance: 0.0017
   â””â”€ Top-5 Important Features: [0]
      â””â”€ Top-5 Values: ['0.0017']

ðŸ“Š Layer: LF_l5_FDCA.slice_att.log_diag
   â”œâ”€ Features: 1
   â”œâ”€ Mean Importance: 0.0000
   â”œâ”€ Max Importance: 0.0000
   â”œâ”€ Min Importance: 0.0000
   â””â”€ Top-5 Important Features: [0]
      â””â”€ Top-5 Values: ['0.0000']

ðŸ“Š Layer: LF_l5_FDCA.slice_att.factor
   â”œâ”€ Features: 1
   â”œâ”€ Mean Importance: 0.0001
   â”œâ”€ Max Importance: 0.0001
   â”œâ”€ Min Importance: 0.0001
   â””â”€ Top-5 Important Features: [0]
      â””â”€ Top-5 Values: ['0.0001']

ðŸ“Š Layer: LF_l5_FDCA.slice_att
   â”œâ”€ Features: 1
   â”œâ”€ Mean Importance: 0.0000
   â”œâ”€ Max Importance: 0.0000
   â”œâ”€ Min Importance: 0.0000
   â””â”€ Top-5 Important Features: [0]
      â””â”€ Top-5 Values: ['0.0000']

ðŸ“Š Layer: LF_l5_FDCA
   â”œâ”€ Features: 1
   â”œâ”€ Mean Importance: 0.0000
   â”œâ”€ Max Importance: 0.0000
   â”œâ”€ Min Importance: 0.0000
   â””â”€ Top-5 Important Features: [0]
      â””â”€ Top-5 Values: ['0.0000']

ðŸ“Š Layer: HF_l4_FDCA.semantic_att
   â”œâ”€ Features: 1
   â”œâ”€ Mean Importance: 0.0826
   â”œâ”€ Max Importance: 0.0826
   â”œâ”€ Min Importance: 0.0826
   â””â”€ Top-5 Important Features: [0]
      â””â”€ Top-5 Values: ['0.0826']

ðŸ“Š Layer: HF_l4_FDCA.positional_att.conv
   â”œâ”€ Features: 1
   â”œâ”€ Mean Importance: 8.4920
   â”œâ”€ Max Importance: 8.4920
   â”œâ”€ Min Importance: 8.4920
   â””â”€ Top-5 Important Features: [0]
      â””â”€ Top-5 Values: ['8.4920']

ðŸ“Š Layer: HF_l4_FDCA.positional_att
   â”œâ”€ Features: 1
   â”œâ”€ Mean Importance: 0.0019
   â”œâ”€ Max Importance: 0.0019
   â”œâ”€ Min Importance: 0.0019
   â””â”€ Top-5 Important Features: [0]
      â””â”€ Top-5 Values: ['0.0019']

ðŸ“Š Layer: HF_l4_FDCA.slice_att.linear.0
   â”œâ”€ Features: 1
   â”œâ”€ Mean Importance: 0.0000
   â”œâ”€ Max Importance: 0.0000
   â”œâ”€ Min Importance: 0.0000
   â””â”€ Top-5 Important Features: [0]
      â””â”€ Top-5 Values: ['0.0000']

ðŸ“Š Layer: HF_l4_FDCA.slice_att.linear.1
   â”œâ”€ Features: 1
   â”œâ”€ Mean Importance: 0.0000
   â”œâ”€ Max Importance: 0.0000
   â”œâ”€ Min Importance: 0.0000
   â””â”€ Top-5 Important Features: [0]
      â””â”€ Top-5 Values: ['0.0000']

ðŸ“Š Layer: HF_l4_FDCA.slice_att.linear.2
   â”œâ”€ Features: 1
   â”œâ”€ Mean Importance: 0.0000
   â”œâ”€ Max Importance: 0.0000
   â”œâ”€ Min Importance: 0.0000
   â””â”€ Top-5 Important Features: [0]
      â””â”€ Top-5 Values: ['0.0000']

ðŸ“Š Layer: HF_l4_FDCA.slice_att.linear
   â”œâ”€ Features: 1
   â”œâ”€ Mean Importance: 0.0000
   â”œâ”€ Max Importance: 0.0000
   â”œâ”€ Min Importance: 0.0000
   â””â”€ Top-5 Important Features: [0]
      â””â”€ Top-5 Values: ['0.0000']

ðŸ“Š Layer: HF_l4_FDCA.slice_att.non_linear
   â”œâ”€ Features: 1
   â”œâ”€ Mean Importance: 0.0000
   â”œâ”€ Max Importance: 0.0000
   â”œâ”€ Min Importance: 0.0000
   â””â”€ Top-5 Important Features: [0]
      â””â”€ Top-5 Values: ['0.0000']

ðŸ“Š Layer: HF_l4_FDCA.slice_att.mean
   â”œâ”€ Features: 1
   â”œâ”€ Mean Importance: 0.0000
   â”œâ”€ Max Importance: 0.0000
   â”œâ”€ Min Importance: 0.0000
   â””â”€ Top-5 Important Features: [0]
      â””â”€ Top-5 Values: ['0.0000']

ðŸ“Š Layer: HF_l4_FDCA.slice_att.log_diag
   â”œâ”€ Features: 1
   â”œâ”€ Mean Importance: 0.0000
   â”œâ”€ Max Importance: 0.0000
   â”œâ”€ Min Importance: 0.0000
   â””â”€ Top-5 Important Features: [0]
      â””â”€ Top-5 Values: ['0.0000']

ðŸ“Š Layer: HF_l4_FDCA.slice_att.factor
   â”œâ”€ Features: 1
   â”œâ”€ Mean Importance: 0.0000
   â”œâ”€ Max Importance: 0.0000
   â”œâ”€ Min Importance: 0.0000
   â””â”€ Top-5 Important Features: [0]
      â””â”€ Top-5 Values: ['0.0000']

ðŸ“Š Layer: HF_l4_FDCA.slice_att
   â”œâ”€ Features: 1
   â”œâ”€ Mean Importance: 0.0046
   â”œâ”€ Max Importance: 0.0046
   â”œâ”€ Min Importance: 0.0046
   â””â”€ Top-5 Important Features: [0]
      â””â”€ Top-5 Values: ['0.0046']

ðŸ“Š Layer: HF_l4_FDCA
   â”œâ”€ Features: 1
   â”œâ”€ Mean Importance: 1.1661
   â”œâ”€ Max Importance: 1.1661
   â”œâ”€ Min Importance: 1.1661
   â””â”€ Top-5 Important Features: [0]
      â””â”€ Top-5 Values: ['1.1661']

ðŸ“Š Layer: HF_l5_FDCA.semantic_att
   â”œâ”€ Features: 1
   â”œâ”€ Mean Importance: 0.0702
   â”œâ”€ Max Importance: 0.0702
   â”œâ”€ Min Importance: 0.0702
   â””â”€ Top-5 Important Features: [0]
      â””â”€ Top-5 Values: ['0.0702']

ðŸ“Š Layer: HF_l5_FDCA.positional_att.conv
   â”œâ”€ Features: 1
   â”œâ”€ Mean Importance: 19.7495
   â”œâ”€ Max Importance: 19.7495
   â”œâ”€ Min Importance: 19.7495
   â””â”€ Top-5 Important Features: [0]
      â””â”€ Top-5 Values: ['19.7495']

ðŸ“Š Layer: HF_l5_FDCA.positional_att
   â”œâ”€ Features: 1
   â”œâ”€ Mean Importance: 0.0001
   â”œâ”€ Max Importance: 0.0001
   â”œâ”€ Min Importance: 0.0001
   â””â”€ Top-5 Important Features: [0]
      â””â”€ Top-5 Values: ['0.0001']

ðŸ“Š Layer: HF_l5_FDCA.slice_att.linear.0
   â”œâ”€ Features: 1
   â”œâ”€ Mean Importance: 0.0000
   â”œâ”€ Max Importance: 0.0000
   â”œâ”€ Min Importance: 0.0000
   â””â”€ Top-5 Important Features: [0]
      â””â”€ Top-5 Values: ['0.0000']

ðŸ“Š Layer: HF_l5_FDCA.slice_att.linear.1
   â”œâ”€ Features: 1
   â”œâ”€ Mean Importance: 0.0000
   â”œâ”€ Max Importance: 0.0000
   â”œâ”€ Min Importance: 0.0000
   â””â”€ Top-5 Important Features: [0]
      â””â”€ Top-5 Values: ['0.0000']

ðŸ“Š Layer: HF_l5_FDCA.slice_att.linear.2
   â”œâ”€ Features: 1
   â”œâ”€ Mean Importance: 0.0000
   â”œâ”€ Max Importance: 0.0000
   â”œâ”€ Min Importance: 0.0000
   â””â”€ Top-5 Important Features: [0]
      â””â”€ Top-5 Values: ['0.0000']

ðŸ“Š Layer: HF_l5_FDCA.slice_att.linear
   â”œâ”€ Features: 1
   â”œâ”€ Mean Importance: 0.0000
   â”œâ”€ Max Importance: 0.0000
   â”œâ”€ Min Importance: 0.0000
   â””â”€ Top-5 Important Features: [0]
      â””â”€ Top-5 Values: ['0.0000']

ðŸ“Š Layer: HF_l5_FDCA.slice_att.non_linear
   â”œâ”€ Features: 1
   â”œâ”€ Mean Importance: 0.0000
   â”œâ”€ Max Importance: 0.0000
   â”œâ”€ Min Importance: 0.0000
   â””â”€ Top-5 Important Features: [0]
      â””â”€ Top-5 Values: ['0.0000']

ðŸ“Š Layer: HF_l5_FDCA.slice_att.mean
   â”œâ”€ Features: 1
   â”œâ”€ Mean Importance: 0.0000
   â”œâ”€ Max Importance: 0.0000
   â”œâ”€ Min Importance: 0.0000
   â””â”€ Top-5 Important Features: [0]
      â””â”€ Top-5 Values: ['0.0000']

ðŸ“Š Layer: HF_l5_FDCA.slice_att.log_diag
   â”œâ”€ Features: 1
   â”œâ”€ Mean Importance: 0.0000
   â”œâ”€ Max Importance: 0.0000
   â”œâ”€ Min Importance: 0.0000
   â””â”€ Top-5 Important Features: [0]
      â””â”€ Top-5 Values: ['0.0000']

ðŸ“Š Layer: HF_l5_FDCA.slice_att.factor
   â”œâ”€ Features: 1
   â”œâ”€ Mean Importance: 0.0000
   â”œâ”€ Max Importance: 0.0000
   â”œâ”€ Min Importance: 0.0000
   â””â”€ Top-5 Important Features: [0]
      â””â”€ Top-5 Values: ['0.0000']

ðŸ“Š Layer: HF_l5_FDCA.slice_att
   â”œâ”€ Features: 1
   â”œâ”€ Mean Importance: 0.0002
   â”œâ”€ Max Importance: 0.0002
   â”œâ”€ Min Importance: 0.0002
   â””â”€ Top-5 Important Features: [0]
      â””â”€ Top-5 Values: ['0.0002']

ðŸ“Š Layer: HF_l5_FDCA
   â”œâ”€ Features: 1
   â”œâ”€ Mean Importance: 0.0008
   â”œâ”€ Max Importance: 0.0008
   â”œâ”€ Min Importance: 0.0008
   â””â”€ Top-5 Important Features: [0]
      â””â”€ Top-5 Values: ['0.0008']

======================================================================
âœ“ Mechanistic analysis complete

[3] Generating Grad-CAM...
Warning: Failed to generate CAM for class 0: element 0 of tensors does not require grad and does not have a grad_fn
Warning: Failed to generate CAM for class 1: element 0 of tensors does not require grad and does not have a grad_fn
Warning: Failed to generate CAM for class 2: element 0 of tensors does not require grad and does not have a grad_fn
Warning: Failed to generate CAM for class 3: element 0 of tensors does not require grad and does not have a grad_fn
[4] Analyzing frequency components...
âœ“ Saved: outputs/xai_2025-11-15_17-25-23/freq_component/sample_0011_freq_comp.png
âœ“ Evaluation complete for sample_0011
Evaluating:  32%|###1      | 12/38 [03:22<07:11, 16.61s/it]
[1] Getting primary prediction...

[METRICS FOR sample_0012]
==================================================
class_0: Dice=0.9946, IoU=0.9893
class_1: Dice=0.7829, IoU=0.6432
class_2: Dice=0.2823, IoU=0.1643
class_3: Dice=0.6807, IoU=0.5160
==================================================

[2] Generating attention maps...
Clipping input data to the valid range for imshow with RGB data ([0..1] for floats or [0..255] for integers).
Clipping input data to the valid range for imshow with RGB data ([0..1] for floats or [0..255] for integers).
âœ“ Saved: outputs/xai_2025-11-15_17-25-23/attention/sample_0012_attention.png

[MECHANISTIC INTERPRETABILITY ANALYSIS]
======================================================================
Sample: sample_0012
======================================================================

ðŸ“Š Layer: LF_l4_FDCA.semantic_att
   â”œâ”€ Features: 1
   â”œâ”€ Mean Importance: 0.1200
   â”œâ”€ Max Importance: 0.1200
   â”œâ”€ Min Importance: 0.1200
   â””â”€ Top-5 Important Features: [0]
      â””â”€ Top-5 Values: ['0.1200']

ðŸ“Š Layer: LF_l4_FDCA.positional_att.conv
   â”œâ”€ Features: 1
   â”œâ”€ Mean Importance: 258.8981
   â”œâ”€ Max Importance: 258.8981
   â”œâ”€ Min Importance: 258.8981
   â””â”€ Top-5 Important Features: [0]
      â””â”€ Top-5 Values: ['258.8981']

ðŸ“Š Layer: LF_l4_FDCA.positional_att
   â”œâ”€ Features: 1
   â”œâ”€ Mean Importance: 46.6646
   â”œâ”€ Max Importance: 46.6646
   â”œâ”€ Min Importance: 46.6646
   â””â”€ Top-5 Important Features: [0]
      â””â”€ Top-5 Values: ['46.6646']

ðŸ“Š Layer: LF_l4_FDCA.slice_att.linear.0
   â”œâ”€ Features: 1
   â”œâ”€ Mean Importance: 88.7394
   â”œâ”€ Max Importance: 88.7394
   â”œâ”€ Min Importance: 88.7394
   â””â”€ Top-5 Important Features: [0]
      â””â”€ Top-5 Values: ['88.7394']

ðŸ“Š Layer: LF_l4_FDCA.slice_att.linear.1
   â”œâ”€ Features: 1
   â”œâ”€ Mean Importance: 75.2770
   â”œâ”€ Max Importance: 75.2770
   â”œâ”€ Min Importance: 75.2770
   â””â”€ Top-5 Important Features: [0]
      â””â”€ Top-5 Values: ['75.2770']

ðŸ“Š Layer: LF_l4_FDCA.slice_att.linear.2
   â”œâ”€ Features: 1
   â”œâ”€ Mean Importance: 71.4376
   â”œâ”€ Max Importance: 71.4376
   â”œâ”€ Min Importance: 71.4376
   â””â”€ Top-5 Important Features: [0]
      â””â”€ Top-5 Values: ['71.4376']

ðŸ“Š Layer: LF_l4_FDCA.slice_att.linear
   â”œâ”€ Features: 1
   â”œâ”€ Mean Importance: 71.4376
   â”œâ”€ Max Importance: 71.4376
   â”œâ”€ Min Importance: 71.4376
   â””â”€ Top-5 Important Features: [0]
      â””â”€ Top-5 Values: ['71.4376']

ðŸ“Š Layer: LF_l4_FDCA.slice_att.non_linear
   â”œâ”€ Features: 1
   â”œâ”€ Mean Importance: 27611010.0000
   â”œâ”€ Max Importance: 27611010.0000
   â”œâ”€ Min Importance: 27611010.0000
   â””â”€ Top-5 Important Features: [0]
      â””â”€ Top-5 Values: ['27611010.0000']

ðŸ“Š Layer: LF_l4_FDCA.slice_att.mean
   â”œâ”€ Features: 1
   â”œâ”€ Mean Importance: 110322880.0000
   â”œâ”€ Max Importance: 110322880.0000
   â”œâ”€ Min Importance: 110322880.0000
   â””â”€ Top-5 Important Features: [0]
      â””â”€ Top-5 Values: ['110322880.0000']

ðŸ“Š Layer: LF_l4_FDCA.slice_att.log_diag
   â”œâ”€ Features: 1
   â”œâ”€ Mean Importance: 6837.6167
   â”œâ”€ Max Importance: 6837.6167
   â”œâ”€ Min Importance: 6837.6167
   â””â”€ Top-5 Important Features: [0]
      â””â”€ Top-5 Values: ['6837.6167']

ðŸ“Š Layer: LF_l4_FDCA.slice_att.factor
   â”œâ”€ Features: 1
   â”œâ”€ Mean Importance: 42733176.0000
   â”œâ”€ Max Importance: 42733176.0000
   â”œâ”€ Min Importance: 42733176.0000
   â””â”€ Top-5 Important Features: [0]
      â””â”€ Top-5 Values: ['42733176.0000']

ðŸ“Š Layer: LF_l4_FDCA.slice_att
   â”œâ”€ Features: 1
   â”œâ”€ Mean Importance: 19604958.0000
   â”œâ”€ Max Importance: 19604958.0000
   â”œâ”€ Min Importance: 19604958.0000
   â””â”€ Top-5 Important Features: [0]
      â””â”€ Top-5 Values: ['19604958.0000']

ðŸ“Š Layer: LF_l4_FDCA
   â”œâ”€ Features: 1
   â”œâ”€ Mean Importance: 3267381870622408704.0000
   â”œâ”€ Max Importance: 3267381870622408704.0000
   â”œâ”€ Min Importance: 3267381870622408704.0000
   â””â”€ Top-5 Important Features: [0]
      â””â”€ Top-5 Values: ['3267381870622408704.0000']

ðŸ“Š Layer: LF_l5_FDCA.semantic_att
   â”œâ”€ Features: 1
   â”œâ”€ Mean Importance: 0.0877
   â”œâ”€ Max Importance: 0.0877
   â”œâ”€ Min Importance: 0.0877
   â””â”€ Top-5 Important Features: [0]
      â””â”€ Top-5 Values: ['0.0877']

ðŸ“Š Layer: LF_l5_FDCA.positional_att.conv
   â”œâ”€ Features: 1
   â”œâ”€ Mean Importance: 73.0017
   â”œâ”€ Max Importance: 73.0017
   â”œâ”€ Min Importance: 73.0017
   â””â”€ Top-5 Important Features: [0]
      â””â”€ Top-5 Values: ['73.0017']

ðŸ“Š Layer: LF_l5_FDCA.positional_att
   â”œâ”€ Features: 1
   â”œâ”€ Mean Importance: 0.0000
   â”œâ”€ Max Importance: 0.0000
   â”œâ”€ Min Importance: 0.0000
   â””â”€ Top-5 Important Features: [0]
      â””â”€ Top-5 Values: ['0.0000']

ðŸ“Š Layer: LF_l5_FDCA.slice_att.linear.0
   â”œâ”€ Features: 1
   â”œâ”€ Mean Importance: 0.0000
   â”œâ”€ Max Importance: 0.0000
   â”œâ”€ Min Importance: 0.0000
   â””â”€ Top-5 Important Features: [0]
      â””â”€ Top-5 Values: ['0.0000']

ðŸ“Š Layer: LF_l5_FDCA.slice_att.linear.1
   â”œâ”€ Features: 1
   â”œâ”€ Mean Importance: 0.0000
   â”œâ”€ Max Importance: 0.0000
   â”œâ”€ Min Importance: 0.0000
   â””â”€ Top-5 Important Features: [0]
      â””â”€ Top-5 Values: ['0.0000']

ðŸ“Š Layer: LF_l5_FDCA.slice_att.linear.2
   â”œâ”€ Features: 1
   â”œâ”€ Mean Importance: 0.0000
   â”œâ”€ Max Importance: 0.0000
   â”œâ”€ Min Importance: 0.0000
   â””â”€ Top-5 Important Features: [0]
      â””â”€ Top-5 Values: ['0.0000']

ðŸ“Š Layer: LF_l5_FDCA.slice_att.linear
   â”œâ”€ Features: 1
   â”œâ”€ Mean Importance: 0.0000
   â”œâ”€ Max Importance: 0.0000
   â”œâ”€ Min Importance: 0.0000
   â””â”€ Top-5 Important Features: [0]
      â””â”€ Top-5 Values: ['0.0000']

ðŸ“Š Layer: LF_l5_FDCA.slice_att.non_linear
   â”œâ”€ Features: 1
   â”œâ”€ Mean Importance: 0.0000
   â”œâ”€ Max Importance: 0.0000
   â”œâ”€ Min Importance: 0.0000
   â””â”€ Top-5 Important Features: [0]
      â””â”€ Top-5 Values: ['0.0000']

ðŸ“Š Layer: LF_l5_FDCA.slice_att.mean
   â”œâ”€ Features: 1
   â”œâ”€ Mean Importance: 0.0017
   â”œâ”€ Max Importance: 0.0017
   â”œâ”€ Min Importance: 0.0017
   â””â”€ Top-5 Important Features: [0]
      â””â”€ Top-5 Values: ['0.0017']

ðŸ“Š Layer: LF_l5_FDCA.slice_att.log_diag
   â”œâ”€ Features: 1
   â”œâ”€ Mean Importance: 0.0000
   â”œâ”€ Max Importance: 0.0000
   â”œâ”€ Min Importance: 0.0000
   â””â”€ Top-5 Important Features: [0]
      â””â”€ Top-5 Values: ['0.0000']

ðŸ“Š Layer: LF_l5_FDCA.slice_att.factor
   â”œâ”€ Features: 1
   â”œâ”€ Mean Importance: 0.0001
   â”œâ”€ Max Importance: 0.0001
   â”œâ”€ Min Importance: 0.0001
   â””â”€ Top-5 Important Features: [0]
      â””â”€ Top-5 Values: ['0.0001']

ðŸ“Š Layer: LF_l5_FDCA.slice_att
   â”œâ”€ Features: 1
   â”œâ”€ Mean Importance: 0.0000
   â”œâ”€ Max Importance: 0.0000
   â”œâ”€ Min Importance: 0.0000
   â””â”€ Top-5 Important Features: [0]
      â””â”€ Top-5 Values: ['0.0000']

ðŸ“Š Layer: LF_l5_FDCA
   â”œâ”€ Features: 1
   â”œâ”€ Mean Importance: 0.0000
   â”œâ”€ Max Importance: 0.0000
   â”œâ”€ Min Importance: 0.0000
   â””â”€ Top-5 Important Features: [0]
      â””â”€ Top-5 Values: ['0.0000']

ðŸ“Š Layer: HF_l4_FDCA.semantic_att
   â”œâ”€ Features: 1
   â”œâ”€ Mean Importance: 0.0844
   â”œâ”€ Max Importance: 0.0844
   â”œâ”€ Min Importance: 0.0844
   â””â”€ Top-5 Important Features: [0]
      â””â”€ Top-5 Values: ['0.0844']

ðŸ“Š Layer: HF_l4_FDCA.positional_att.conv
   â”œâ”€ Features: 1
   â”œâ”€ Mean Importance: 9.1775
   â”œâ”€ Max Importance: 9.1775
   â”œâ”€ Min Importance: 9.1775
   â””â”€ Top-5 Important Features: [0]
      â””â”€ Top-5 Values: ['9.1775']

ðŸ“Š Layer: HF_l4_FDCA.positional_att
   â”œâ”€ Features: 1
   â”œâ”€ Mean Importance: 0.0019
   â”œâ”€ Max Importance: 0.0019
   â”œâ”€ Min Importance: 0.0019
   â””â”€ Top-5 Important Features: [0]
      â””â”€ Top-5 Values: ['0.0019']

ðŸ“Š Layer: HF_l4_FDCA.slice_att.linear.0
   â”œâ”€ Features: 1
   â”œâ”€ Mean Importance: 0.0000
   â”œâ”€ Max Importance: 0.0000
   â”œâ”€ Min Importance: 0.0000
   â””â”€ Top-5 Important Features: [0]
      â””â”€ Top-5 Values: ['0.0000']

ðŸ“Š Layer: HF_l4_FDCA.slice_att.linear.1
   â”œâ”€ Features: 1
   â”œâ”€ Mean Importance: 0.0000
   â”œâ”€ Max Importance: 0.0000
   â”œâ”€ Min Importance: 0.0000
   â””â”€ Top-5 Important Features: [0]
      â””â”€ Top-5 Values: ['0.0000']

ðŸ“Š Layer: HF_l4_FDCA.slice_att.linear.2
   â”œâ”€ Features: 1
   â”œâ”€ Mean Importance: 0.0000
   â”œâ”€ Max Importance: 0.0000
   â”œâ”€ Min Importance: 0.0000
   â””â”€ Top-5 Important Features: [0]
      â””â”€ Top-5 Values: ['0.0000']

ðŸ“Š Layer: HF_l4_FDCA.slice_att.linear
   â”œâ”€ Features: 1
   â”œâ”€ Mean Importance: 0.0000
   â”œâ”€ Max Importance: 0.0000
   â”œâ”€ Min Importance: 0.0000
   â””â”€ Top-5 Important Features: [0]
      â””â”€ Top-5 Values: ['0.0000']

ðŸ“Š Layer: HF_l4_FDCA.slice_att.non_linear
   â”œâ”€ Features: 1
   â”œâ”€ Mean Importance: 0.0000
   â”œâ”€ Max Importance: 0.0000
   â”œâ”€ Min Importance: 0.0000
   â””â”€ Top-5 Important Features: [0]
      â””â”€ Top-5 Values: ['0.0000']

ðŸ“Š Layer: HF_l4_FDCA.slice_att.mean
   â”œâ”€ Features: 1
   â”œâ”€ Mean Importance: 0.0000
   â”œâ”€ Max Importance: 0.0000
   â”œâ”€ Min Importance: 0.0000
   â””â”€ Top-5 Important Features: [0]
      â””â”€ Top-5 Values: ['0.0000']

ðŸ“Š Layer: HF_l4_FDCA.slice_att.log_diag
   â”œâ”€ Features: 1
   â”œâ”€ Mean Importance: 0.0000
   â”œâ”€ Max Importance: 0.0000
   â”œâ”€ Min Importance: 0.0000
   â””â”€ Top-5 Important Features: [0]
      â””â”€ Top-5 Values: ['0.0000']

ðŸ“Š Layer: HF_l4_FDCA.slice_att.factor
   â”œâ”€ Features: 1
   â”œâ”€ Mean Importance: 0.0000
   â”œâ”€ Max Importance: 0.0000
   â”œâ”€ Min Importance: 0.0000
   â””â”€ Top-5 Important Features: [0]
      â””â”€ Top-5 Values: ['0.0000']

ðŸ“Š Layer: HF_l4_FDCA.slice_att
   â”œâ”€ Features: 1
   â”œâ”€ Mean Importance: 0.0076
   â”œâ”€ Max Importance: 0.0076
   â”œâ”€ Min Importance: 0.0076
   â””â”€ Top-5 Important Features: [0]
      â””â”€ Top-5 Values: ['0.0076']

ðŸ“Š Layer: HF_l4_FDCA
   â”œâ”€ Features: 1
   â”œâ”€ Mean Importance: 0.9896
   â”œâ”€ Max Importance: 0.9896
   â”œâ”€ Min Importance: 0.9896
   â””â”€ Top-5 Important Features: [0]
      â””â”€ Top-5 Values: ['0.9896']

ðŸ“Š Layer: HF_l5_FDCA.semantic_att
   â”œâ”€ Features: 1
   â”œâ”€ Mean Importance: 0.0701
   â”œâ”€ Max Importance: 0.0701
   â”œâ”€ Min Importance: 0.0701
   â””â”€ Top-5 Important Features: [0]
      â””â”€ Top-5 Values: ['0.0701']

ðŸ“Š Layer: HF_l5_FDCA.positional_att.conv
   â”œâ”€ Features: 1
   â”œâ”€ Mean Importance: 17.6174
   â”œâ”€ Max Importance: 17.6174
   â”œâ”€ Min Importance: 17.6174
   â””â”€ Top-5 Important Features: [0]
      â””â”€ Top-5 Values: ['17.6174']

ðŸ“Š Layer: HF_l5_FDCA.positional_att
   â”œâ”€ Features: 1
   â”œâ”€ Mean Importance: 0.0001
   â”œâ”€ Max Importance: 0.0001
   â”œâ”€ Min Importance: 0.0001
   â””â”€ Top-5 Important Features: [0]
      â””â”€ Top-5 Values: ['0.0001']

ðŸ“Š Layer: HF_l5_FDCA.slice_att.linear.0
   â”œâ”€ Features: 1
   â”œâ”€ Mean Importance: 0.0000
   â”œâ”€ Max Importance: 0.0000
   â”œâ”€ Min Importance: 0.0000
   â””â”€ Top-5 Important Features: [0]
      â””â”€ Top-5 Values: ['0.0000']

ðŸ“Š Layer: HF_l5_FDCA.slice_att.linear.1
   â”œâ”€ Features: 1
   â”œâ”€ Mean Importance: 0.0000
   â”œâ”€ Max Importance: 0.0000
   â”œâ”€ Min Importance: 0.0000
   â””â”€ Top-5 Important Features: [0]
      â””â”€ Top-5 Values: ['0.0000']

ðŸ“Š Layer: HF_l5_FDCA.slice_att.linear.2
   â”œâ”€ Features: 1
   â”œâ”€ Mean Importance: 0.0000
   â”œâ”€ Max Importance: 0.0000
   â”œâ”€ Min Importance: 0.0000
   â””â”€ Top-5 Important Features: [0]
      â””â”€ Top-5 Values: ['0.0000']

ðŸ“Š Layer: HF_l5_FDCA.slice_att.linear
   â”œâ”€ Features: 1
   â”œâ”€ Mean Importance: 0.0000
   â”œâ”€ Max Importance: 0.0000
   â”œâ”€ Min Importance: 0.0000
   â””â”€ Top-5 Important Features: [0]
      â””â”€ Top-5 Values: ['0.0000']

ðŸ“Š Layer: HF_l5_FDCA.slice_att.non_linear
   â”œâ”€ Features: 1
   â”œâ”€ Mean Importance: 0.0000
   â”œâ”€ Max Importance: 0.0000
   â”œâ”€ Min Importance: 0.0000
   â””â”€ Top-5 Important Features: [0]
      â””â”€ Top-5 Values: ['0.0000']

ðŸ“Š Layer: HF_l5_FDCA.slice_att.mean
   â”œâ”€ Features: 1
   â”œâ”€ Mean Importance: 0.0000
   â”œâ”€ Max Importance: 0.0000
   â”œâ”€ Min Importance: 0.0000
   â””â”€ Top-5 Important Features: [0]
      â””â”€ Top-5 Values: ['0.0000']

ðŸ“Š Layer: HF_l5_FDCA.slice_att.log_diag
   â”œâ”€ Features: 1
   â”œâ”€ Mean Importance: 0.0000
   â”œâ”€ Max Importance: 0.0000
   â”œâ”€ Min Importance: 0.0000
   â””â”€ Top-5 Important Features: [0]
      â””â”€ Top-5 Values: ['0.0000']

ðŸ“Š Layer: HF_l5_FDCA.slice_att.factor
   â”œâ”€ Features: 1
   â”œâ”€ Mean Importance: 0.0000
   â”œâ”€ Max Importance: 0.0000
   â”œâ”€ Min Importance: 0.0000
   â””â”€ Top-5 Important Features: [0]
      â””â”€ Top-5 Values: ['0.0000']

ðŸ“Š Layer: HF_l5_FDCA.slice_att
   â”œâ”€ Features: 1
   â”œâ”€ Mean Importance: 0.0001
   â”œâ”€ Max Importance: 0.0001
   â”œâ”€ Min Importance: 0.0001
   â””â”€ Top-5 Important Features: [0]
      â””â”€ Top-5 Values: ['0.0001']

ðŸ“Š Layer: HF_l5_FDCA
   â”œâ”€ Features: 1
   â”œâ”€ Mean Importance: 0.0002
   â”œâ”€ Max Importance: 0.0002
   â”œâ”€ Min Importance: 0.0002
   â””â”€ Top-5 Important Features: [0]
      â””â”€ Top-5 Values: ['0.0002']

======================================================================
âœ“ Mechanistic analysis complete

[3] Generating Grad-CAM...
Warning: Failed to generate CAM for class 0: element 0 of tensors does not require grad and does not have a grad_fn
Warning: Failed to generate CAM for class 1: element 0 of tensors does not require grad and does not have a grad_fn
Warning: Failed to generate CAM for class 2: element 0 of tensors does not require grad and does not have a grad_fn
Warning: Failed to generate CAM for class 3: element 0 of tensors does not require grad and does not have a grad_fn
[4] Analyzing frequency components...
âœ“ Saved: outputs/xai_2025-11-15_17-25-23/freq_component/sample_0012_freq_comp.png
âœ“ Evaluation complete for sample_0012
Evaluating:  34%|###4      | 13/38 [03:39<06:57, 16.71s/it]
[1] Getting primary prediction...

[METRICS FOR sample_0013]
==================================================
class_0: Dice=0.9969, IoU=0.9938
class_1: Dice=0.1074, IoU=0.0567
class_2: Dice=0.7720, IoU=0.6287
class_3: Dice=0.7675, IoU=0.6227
==================================================

[2] Generating attention maps...
Clipping input data to the valid range for imshow with RGB data ([0..1] for floats or [0..255] for integers).
Clipping input data to the valid range for imshow with RGB data ([0..1] for floats or [0..255] for integers).
âœ“ Saved: outputs/xai_2025-11-15_17-25-23/attention/sample_0013_attention.png

[MECHANISTIC INTERPRETABILITY ANALYSIS]
======================================================================
Sample: sample_0013
======================================================================

ðŸ“Š Layer: LF_l4_FDCA.semantic_att
   â”œâ”€ Features: 1
   â”œâ”€ Mean Importance: 0.0974
   â”œâ”€ Max Importance: 0.0974
   â”œâ”€ Min Importance: 0.0974
   â””â”€ Top-5 Important Features: [0]
      â””â”€ Top-5 Values: ['0.0974']

ðŸ“Š Layer: LF_l4_FDCA.positional_att.conv
   â”œâ”€ Features: 1
   â”œâ”€ Mean Importance: 274.4415
   â”œâ”€ Max Importance: 274.4415
   â”œâ”€ Min Importance: 274.4415
   â””â”€ Top-5 Important Features: [0]
      â””â”€ Top-5 Values: ['274.4415']

ðŸ“Š Layer: LF_l4_FDCA.positional_att
   â”œâ”€ Features: 1
   â”œâ”€ Mean Importance: 39.7978
   â”œâ”€ Max Importance: 39.7978
   â”œâ”€ Min Importance: 39.7978
   â””â”€ Top-5 Important Features: [0]
      â””â”€ Top-5 Values: ['39.7978']

ðŸ“Š Layer: LF_l4_FDCA.slice_att.linear.0
   â”œâ”€ Features: 1
   â”œâ”€ Mean Importance: 73.2643
   â”œâ”€ Max Importance: 73.2643
   â”œâ”€ Min Importance: 73.2643
   â””â”€ Top-5 Important Features: [0]
      â””â”€ Top-5 Values: ['73.2643']

ðŸ“Š Layer: LF_l4_FDCA.slice_att.linear.1
   â”œâ”€ Features: 1
   â”œâ”€ Mean Importance: 62.1472
   â”œâ”€ Max Importance: 62.1472
   â”œâ”€ Min Importance: 62.1472
   â””â”€ Top-5 Important Features: [0]
      â””â”€ Top-5 Values: ['62.1472']

ðŸ“Š Layer: LF_l4_FDCA.slice_att.linear.2
   â”œâ”€ Features: 1
   â”œâ”€ Mean Importance: 58.9834
   â”œâ”€ Max Importance: 58.9834
   â”œâ”€ Min Importance: 58.9834
   â””â”€ Top-5 Important Features: [0]
      â””â”€ Top-5 Values: ['58.9834']

ðŸ“Š Layer: LF_l4_FDCA.slice_att.linear
   â”œâ”€ Features: 1
   â”œâ”€ Mean Importance: 58.9834
   â”œâ”€ Max Importance: 58.9834
   â”œâ”€ Min Importance: 58.9834
   â””â”€ Top-5 Important Features: [0]
      â””â”€ Top-5 Values: ['58.9834']

ðŸ“Š Layer: LF_l4_FDCA.slice_att.non_linear
   â”œâ”€ Features: 1
   â”œâ”€ Mean Importance: 26690560.0000
   â”œâ”€ Max Importance: 26690560.0000
   â”œâ”€ Min Importance: 26690560.0000
   â””â”€ Top-5 Important Features: [0]
      â””â”€ Top-5 Values: ['26690560.0000']

ðŸ“Š Layer: LF_l4_FDCA.slice_att.mean
   â”œâ”€ Features: 1
   â”œâ”€ Mean Importance: 106644200.0000
   â”œâ”€ Max Importance: 106644200.0000
   â”œâ”€ Min Importance: 106644200.0000
   â””â”€ Top-5 Important Features: [0]
      â””â”€ Top-5 Values: ['106644200.0000']

ðŸ“Š Layer: LF_l4_FDCA.slice_att.log_diag
   â”œâ”€ Features: 1
   â”œâ”€ Mean Importance: 6609.6299
   â”œâ”€ Max Importance: 6609.6299
   â”œâ”€ Min Importance: 6609.6299
   â””â”€ Top-5 Important Features: [0]
      â””â”€ Top-5 Values: ['6609.6299']

ðŸ“Š Layer: LF_l4_FDCA.slice_att.factor
   â”œâ”€ Features: 1
   â”œâ”€ Mean Importance: 41308256.0000
   â”œâ”€ Max Importance: 41308256.0000
   â”œâ”€ Min Importance: 41308256.0000
   â””â”€ Top-5 Important Features: [0]
      â””â”€ Top-5 Values: ['41308256.0000']

ðŸ“Š Layer: LF_l4_FDCA.slice_att
   â”œâ”€ Features: 1
   â”œâ”€ Mean Importance: 15971224.0000
   â”œâ”€ Max Importance: 15971224.0000
   â”œâ”€ Min Importance: 15971224.0000
   â””â”€ Top-5 Important Features: [0]
      â””â”€ Top-5 Values: ['15971224.0000']

ðŸ“Š Layer: LF_l4_FDCA
   â”œâ”€ Features: 1
   â”œâ”€ Mean Importance: 2249182426255327232.0000
   â”œâ”€ Max Importance: 2249182426255327232.0000
   â”œâ”€ Min Importance: 2249182426255327232.0000
   â””â”€ Top-5 Important Features: [0]
      â””â”€ Top-5 Values: ['2249182426255327232.0000']

ðŸ“Š Layer: LF_l5_FDCA.semantic_att
   â”œâ”€ Features: 1
   â”œâ”€ Mean Importance: 0.0754
   â”œâ”€ Max Importance: 0.0754
   â”œâ”€ Min Importance: 0.0754
   â””â”€ Top-5 Important Features: [0]
      â””â”€ Top-5 Values: ['0.0754']

ðŸ“Š Layer: LF_l5_FDCA.positional_att.conv
   â”œâ”€ Features: 1
   â”œâ”€ Mean Importance: 87.8201
   â”œâ”€ Max Importance: 87.8201
   â”œâ”€ Min Importance: 87.8201
   â””â”€ Top-5 Important Features: [0]
      â””â”€ Top-5 Values: ['87.8201']

ðŸ“Š Layer: LF_l5_FDCA.positional_att
   â”œâ”€ Features: 1
   â”œâ”€ Mean Importance: 0.0000
   â”œâ”€ Max Importance: 0.0000
   â”œâ”€ Min Importance: 0.0000
   â””â”€ Top-5 Important Features: [0]
      â””â”€ Top-5 Values: ['0.0000']

ðŸ“Š Layer: LF_l5_FDCA.slice_att.linear.0
   â”œâ”€ Features: 1
   â”œâ”€ Mean Importance: 0.0000
   â”œâ”€ Max Importance: 0.0000
   â”œâ”€ Min Importance: 0.0000
   â””â”€ Top-5 Important Features: [0]
      â””â”€ Top-5 Values: ['0.0000']

ðŸ“Š Layer: LF_l5_FDCA.slice_att.linear.1
   â”œâ”€ Features: 1
   â”œâ”€ Mean Importance: 0.0000
   â”œâ”€ Max Importance: 0.0000
   â”œâ”€ Min Importance: 0.0000
   â””â”€ Top-5 Important Features: [0]
      â””â”€ Top-5 Values: ['0.0000']

ðŸ“Š Layer: LF_l5_FDCA.slice_att.linear.2
   â”œâ”€ Features: 1
   â”œâ”€ Mean Importance: 0.0000
   â”œâ”€ Max Importance: 0.0000
   â”œâ”€ Min Importance: 0.0000
   â””â”€ Top-5 Important Features: [0]
      â””â”€ Top-5 Values: ['0.0000']

ðŸ“Š Layer: LF_l5_FDCA.slice_att.linear
   â”œâ”€ Features: 1
   â”œâ”€ Mean Importance: 0.0000
   â”œâ”€ Max Importance: 0.0000
   â”œâ”€ Min Importance: 0.0000
   â””â”€ Top-5 Important Features: [0]
      â””â”€ Top-5 Values: ['0.0000']

ðŸ“Š Layer: LF_l5_FDCA.slice_att.non_linear
   â”œâ”€ Features: 1
   â”œâ”€ Mean Importance: 0.0000
   â”œâ”€ Max Importance: 0.0000
   â”œâ”€ Min Importance: 0.0000
   â””â”€ Top-5 Important Features: [0]
      â””â”€ Top-5 Values: ['0.0000']

ðŸ“Š Layer: LF_l5_FDCA.slice_att.mean
   â”œâ”€ Features: 1
   â”œâ”€ Mean Importance: 0.0017
   â”œâ”€ Max Importance: 0.0017
   â”œâ”€ Min Importance: 0.0017
   â””â”€ Top-5 Important Features: [0]
      â””â”€ Top-5 Values: ['0.0017']

ðŸ“Š Layer: LF_l5_FDCA.slice_att.log_diag
   â”œâ”€ Features: 1
   â”œâ”€ Mean Importance: 0.0000
   â”œâ”€ Max Importance: 0.0000
   â”œâ”€ Min Importance: 0.0000
   â””â”€ Top-5 Important Features: [0]
      â””â”€ Top-5 Values: ['0.0000']

ðŸ“Š Layer: LF_l5_FDCA.slice_att.factor
   â”œâ”€ Features: 1
   â”œâ”€ Mean Importance: 0.0001
   â”œâ”€ Max Importance: 0.0001
   â”œâ”€ Min Importance: 0.0001
   â””â”€ Top-5 Important Features: [0]
      â””â”€ Top-5 Values: ['0.0001']

ðŸ“Š Layer: LF_l5_FDCA.slice_att
   â”œâ”€ Features: 1
   â”œâ”€ Mean Importance: 0.0000
   â”œâ”€ Max Importance: 0.0000
   â”œâ”€ Min Importance: 0.0000
   â””â”€ Top-5 Important Features: [0]
      â””â”€ Top-5 Values: ['0.0000']

ðŸ“Š Layer: LF_l5_FDCA
   â”œâ”€ Features: 1
   â”œâ”€ Mean Importance: 0.0000
   â”œâ”€ Max Importance: 0.0000
   â”œâ”€ Min Importance: 0.0000
   â””â”€ Top-5 Important Features: [0]
      â””â”€ Top-5 Values: ['0.0000']

ðŸ“Š Layer: HF_l4_FDCA.semantic_att
   â”œâ”€ Features: 1
   â”œâ”€ Mean Importance: 0.0808
   â”œâ”€ Max Importance: 0.0808
   â”œâ”€ Min Importance: 0.0808
   â””â”€ Top-5 Important Features: [0]
      â””â”€ Top-5 Values: ['0.0808']

ðŸ“Š Layer: HF_l4_FDCA.positional_att.conv
   â”œâ”€ Features: 1
   â”œâ”€ Mean Importance: 8.6781
   â”œâ”€ Max Importance: 8.6781
   â”œâ”€ Min Importance: 8.6781
   â””â”€ Top-5 Important Features: [0]
      â””â”€ Top-5 Values: ['8.6781']

ðŸ“Š Layer: HF_l4_FDCA.positional_att
   â”œâ”€ Features: 1
   â”œâ”€ Mean Importance: 0.0016
   â”œâ”€ Max Importance: 0.0016
   â”œâ”€ Min Importance: 0.0016
   â””â”€ Top-5 Important Features: [0]
      â””â”€ Top-5 Values: ['0.0016']

ðŸ“Š Layer: HF_l4_FDCA.slice_att.linear.0
   â”œâ”€ Features: 1
   â”œâ”€ Mean Importance: 0.0000
   â”œâ”€ Max Importance: 0.0000
   â”œâ”€ Min Importance: 0.0000
   â””â”€ Top-5 Important Features: [0]
      â””â”€ Top-5 Values: ['0.0000']

ðŸ“Š Layer: HF_l4_FDCA.slice_att.linear.1
   â”œâ”€ Features: 1
   â”œâ”€ Mean Importance: 0.0000
   â”œâ”€ Max Importance: 0.0000
   â”œâ”€ Min Importance: 0.0000
   â””â”€ Top-5 Important Features: [0]
      â””â”€ Top-5 Values: ['0.0000']

ðŸ“Š Layer: HF_l4_FDCA.slice_att.linear.2
   â”œâ”€ Features: 1
   â”œâ”€ Mean Importance: 0.0000
   â”œâ”€ Max Importance: 0.0000
   â”œâ”€ Min Importance: 0.0000
   â””â”€ Top-5 Important Features: [0]
      â””â”€ Top-5 Values: ['0.0000']

ðŸ“Š Layer: HF_l4_FDCA.slice_att.linear
   â”œâ”€ Features: 1
   â”œâ”€ Mean Importance: 0.0000
   â”œâ”€ Max Importance: 0.0000
   â”œâ”€ Min Importance: 0.0000
   â””â”€ Top-5 Important Features: [0]
      â””â”€ Top-5 Values: ['0.0000']

ðŸ“Š Layer: HF_l4_FDCA.slice_att.non_linear
   â”œâ”€ Features: 1
   â”œâ”€ Mean Importance: 0.0000
   â”œâ”€ Max Importance: 0.0000
   â”œâ”€ Min Importance: 0.0000
   â””â”€ Top-5 Important Features: [0]
      â””â”€ Top-5 Values: ['0.0000']

ðŸ“Š Layer: HF_l4_FDCA.slice_att.mean
   â”œâ”€ Features: 1
   â”œâ”€ Mean Importance: 0.0000
   â”œâ”€ Max Importance: 0.0000
   â”œâ”€ Min Importance: 0.0000
   â””â”€ Top-5 Important Features: [0]
      â””â”€ Top-5 Values: ['0.0000']

ðŸ“Š Layer: HF_l4_FDCA.slice_att.log_diag
   â”œâ”€ Features: 1
   â”œâ”€ Mean Importance: 0.0000
   â”œâ”€ Max Importance: 0.0000
   â”œâ”€ Min Importance: 0.0000
   â””â”€ Top-5 Important Features: [0]
      â””â”€ Top-5 Values: ['0.0000']

ðŸ“Š Layer: HF_l4_FDCA.slice_att.factor
   â”œâ”€ Features: 1
   â”œâ”€ Mean Importance: 0.0000
   â”œâ”€ Max Importance: 0.0000
   â”œâ”€ Min Importance: 0.0000
   â””â”€ Top-5 Important Features: [0]
      â””â”€ Top-5 Values: ['0.0000']

ðŸ“Š Layer: HF_l4_FDCA.slice_att
   â”œâ”€ Features: 1
   â”œâ”€ Mean Importance: 0.0088
   â”œâ”€ Max Importance: 0.0088
   â”œâ”€ Min Importance: 0.0088
   â””â”€ Top-5 Important Features: [0]
      â””â”€ Top-5 Values: ['0.0088']

ðŸ“Š Layer: HF_l4_FDCA
   â”œâ”€ Features: 1
   â”œâ”€ Mean Importance: 1.3641
   â”œâ”€ Max Importance: 1.3641
   â”œâ”€ Min Importance: 1.3641
   â””â”€ Top-5 Important Features: [0]
      â””â”€ Top-5 Values: ['1.3641']

ðŸ“Š Layer: HF_l5_FDCA.semantic_att
   â”œâ”€ Features: 1
   â”œâ”€ Mean Importance: 0.0654
   â”œâ”€ Max Importance: 0.0654
   â”œâ”€ Min Importance: 0.0654
   â””â”€ Top-5 Important Features: [0]
      â””â”€ Top-5 Values: ['0.0654']

ðŸ“Š Layer: HF_l5_FDCA.positional_att.conv
   â”œâ”€ Features: 1
   â”œâ”€ Mean Importance: 13.1071
   â”œâ”€ Max Importance: 13.1071
   â”œâ”€ Min Importance: 13.1071
   â””â”€ Top-5 Important Features: [0]
      â””â”€ Top-5 Values: ['13.1071']

ðŸ“Š Layer: HF_l5_FDCA.positional_att
   â”œâ”€ Features: 1
   â”œâ”€ Mean Importance: 0.0001
   â”œâ”€ Max Importance: 0.0001
   â”œâ”€ Min Importance: 0.0001
   â””â”€ Top-5 Important Features: [0]
      â””â”€ Top-5 Values: ['0.0001']

ðŸ“Š Layer: HF_l5_FDCA.slice_att.linear.0
   â”œâ”€ Features: 1
   â”œâ”€ Mean Importance: 0.0000
   â”œâ”€ Max Importance: 0.0000
   â”œâ”€ Min Importance: 0.0000
   â””â”€ Top-5 Important Features: [0]
      â””â”€ Top-5 Values: ['0.0000']

ðŸ“Š Layer: HF_l5_FDCA.slice_att.linear.1
   â”œâ”€ Features: 1
   â”œâ”€ Mean Importance: 0.0000
   â”œâ”€ Max Importance: 0.0000
   â”œâ”€ Min Importance: 0.0000
   â””â”€ Top-5 Important Features: [0]
      â””â”€ Top-5 Values: ['0.0000']

ðŸ“Š Layer: HF_l5_FDCA.slice_att.linear.2
   â”œâ”€ Features: 1
   â”œâ”€ Mean Importance: 0.0000
   â”œâ”€ Max Importance: 0.0000
   â”œâ”€ Min Importance: 0.0000
   â””â”€ Top-5 Important Features: [0]
      â””â”€ Top-5 Values: ['0.0000']

ðŸ“Š Layer: HF_l5_FDCA.slice_att.linear
   â”œâ”€ Features: 1
   â”œâ”€ Mean Importance: 0.0000
   â”œâ”€ Max Importance: 0.0000
   â”œâ”€ Min Importance: 0.0000
   â””â”€ Top-5 Important Features: [0]
      â””â”€ Top-5 Values: ['0.0000']

ðŸ“Š Layer: HF_l5_FDCA.slice_att.non_linear
   â”œâ”€ Features: 1
   â”œâ”€ Mean Importance: 0.0000
   â”œâ”€ Max Importance: 0.0000
   â”œâ”€ Min Importance: 0.0000
   â””â”€ Top-5 Important Features: [0]
      â””â”€ Top-5 Values: ['0.0000']

ðŸ“Š Layer: HF_l5_FDCA.slice_att.mean
   â”œâ”€ Features: 1
   â”œâ”€ Mean Importance: 0.0000
   â”œâ”€ Max Importance: 0.0000
   â”œâ”€ Min Importance: 0.0000
   â””â”€ Top-5 Important Features: [0]
      â””â”€ Top-5 Values: ['0.0000']

ðŸ“Š Layer: HF_l5_FDCA.slice_att.log_diag
   â”œâ”€ Features: 1
   â”œâ”€ Mean Importance: 0.0000
   â”œâ”€ Max Importance: 0.0000
   â”œâ”€ Min Importance: 0.0000
   â””â”€ Top-5 Important Features: [0]
      â””â”€ Top-5 Values: ['0.0000']

ðŸ“Š Layer: HF_l5_FDCA.slice_att.factor
   â”œâ”€ Features: 1
   â”œâ”€ Mean Importance: 0.0000
   â”œâ”€ Max Importance: 0.0000
   â”œâ”€ Min Importance: 0.0000
   â””â”€ Top-5 Important Features: [0]
      â””â”€ Top-5 Values: ['0.0000']

ðŸ“Š Layer: HF_l5_FDCA.slice_att
   â”œâ”€ Features: 1
   â”œâ”€ Mean Importance: 0.0001
   â”œâ”€ Max Importance: 0.0001
   â”œâ”€ Min Importance: 0.0001
   â””â”€ Top-5 Important Features: [0]
      â””â”€ Top-5 Values: ['0.0001']

ðŸ“Š Layer: HF_l5_FDCA
   â”œâ”€ Features: 1
   â”œâ”€ Mean Importance: 0.0003
   â”œâ”€ Max Importance: 0.0003
   â”œâ”€ Min Importance: 0.0003
   â””â”€ Top-5 Important Features: [0]
      â””â”€ Top-5 Values: ['0.0003']

======================================================================
âœ“ Mechanistic analysis complete

[3] Generating Grad-CAM...
Warning: Failed to generate CAM for class 0: element 0 of tensors does not require grad and does not have a grad_fn
Warning: Failed to generate CAM for class 1: element 0 of tensors does not require grad and does not have a grad_fn
Warning: Failed to generate CAM for class 2: element 0 of tensors does not require grad and does not have a grad_fn
Warning: Failed to generate CAM for class 3: element 0 of tensors does not require grad and does not have a grad_fn
[4] Analyzing frequency components...
âœ“ Saved: outputs/xai_2025-11-15_17-25-23/freq_component/sample_0013_freq_comp.png
âœ“ Evaluation complete for sample_0013
Evaluating:  37%|###6      | 14/38 [03:55<06:37, 16.55s/it]
[1] Getting primary prediction...

[METRICS FOR sample_0014]
==================================================
class_0: Dice=0.9922, IoU=0.9846
class_1: Dice=0.8657, IoU=0.7632
class_2: Dice=0.8163, IoU=0.6897
class_3: Dice=0.9105, IoU=0.8357
==================================================

[2] Generating attention maps...
Clipping input data to the valid range for imshow with RGB data ([0..1] for floats or [0..255] for integers).
Clipping input data to the valid range for imshow with RGB data ([0..1] for floats or [0..255] for integers).
âœ“ Saved: outputs/xai_2025-11-15_17-25-23/attention/sample_0014_attention.png

[MECHANISTIC INTERPRETABILITY ANALYSIS]
======================================================================
Sample: sample_0014
======================================================================

ðŸ“Š Layer: LF_l4_FDCA.semantic_att
   â”œâ”€ Features: 1
   â”œâ”€ Mean Importance: 0.1185
   â”œâ”€ Max Importance: 0.1185
   â”œâ”€ Min Importance: 0.1185
   â””â”€ Top-5 Important Features: [0]
      â””â”€ Top-5 Values: ['0.1185']

ðŸ“Š Layer: LF_l4_FDCA.positional_att.conv
   â”œâ”€ Features: 1
   â”œâ”€ Mean Importance: 247.8977
   â”œâ”€ Max Importance: 247.8977
   â”œâ”€ Min Importance: 247.8977
   â””â”€ Top-5 Important Features: [0]
      â””â”€ Top-5 Values: ['247.8977']

ðŸ“Š Layer: LF_l4_FDCA.positional_att
   â”œâ”€ Features: 1
   â”œâ”€ Mean Importance: 42.6814
   â”œâ”€ Max Importance: 42.6814
   â”œâ”€ Min Importance: 42.6814
   â””â”€ Top-5 Important Features: [0]
      â””â”€ Top-5 Values: ['42.6814']

ðŸ“Š Layer: LF_l4_FDCA.slice_att.linear.0
   â”œâ”€ Features: 1
   â”œâ”€ Mean Importance: 87.8412
   â”œâ”€ Max Importance: 87.8412
   â”œâ”€ Min Importance: 87.8412
   â””â”€ Top-5 Important Features: [0]
      â””â”€ Top-5 Values: ['87.8412']

ðŸ“Š Layer: LF_l4_FDCA.slice_att.linear.1
   â”œâ”€ Features: 1
   â”œâ”€ Mean Importance: 74.5114
   â”œâ”€ Max Importance: 74.5114
   â”œâ”€ Min Importance: 74.5114
   â””â”€ Top-5 Important Features: [0]
      â””â”€ Top-5 Values: ['74.5114']

ðŸ“Š Layer: LF_l4_FDCA.slice_att.linear.2
   â”œâ”€ Features: 1
   â”œâ”€ Mean Importance: 70.7203
   â”œâ”€ Max Importance: 70.7203
   â”œâ”€ Min Importance: 70.7203
   â””â”€ Top-5 Important Features: [0]
      â””â”€ Top-5 Values: ['70.7203']

ðŸ“Š Layer: LF_l4_FDCA.slice_att.linear
   â”œâ”€ Features: 1
   â”œâ”€ Mean Importance: 70.7203
   â”œâ”€ Max Importance: 70.7203
   â”œâ”€ Min Importance: 70.7203
   â””â”€ Top-5 Important Features: [0]
      â””â”€ Top-5 Values: ['70.7203']

ðŸ“Š Layer: LF_l4_FDCA.slice_att.non_linear
   â”œâ”€ Features: 1
   â”œâ”€ Mean Importance: 29012864.0000
   â”œâ”€ Max Importance: 29012864.0000
   â”œâ”€ Min Importance: 29012864.0000
   â””â”€ Top-5 Important Features: [0]
      â””â”€ Top-5 Values: ['29012864.0000']

ðŸ“Š Layer: LF_l4_FDCA.slice_att.mean
   â”œâ”€ Features: 1
   â”œâ”€ Mean Importance: 115931216.0000
   â”œâ”€ Max Importance: 115931216.0000
   â”œâ”€ Min Importance: 115931216.0000
   â””â”€ Top-5 Important Features: [0]
      â””â”€ Top-5 Values: ['115931216.0000']

ðŸ“Š Layer: LF_l4_FDCA.slice_att.log_diag
   â”œâ”€ Features: 1
   â”œâ”€ Mean Importance: 7185.1475
   â”œâ”€ Max Importance: 7185.1475
   â”œâ”€ Min Importance: 7185.1475
   â””â”€ Top-5 Important Features: [0]
      â””â”€ Top-5 Values: ['7185.1475']

ðŸ“Š Layer: LF_l4_FDCA.slice_att.factor
   â”œâ”€ Features: 1
   â”œâ”€ Mean Importance: 44905632.0000
   â”œâ”€ Max Importance: 44905632.0000
   â”œâ”€ Min Importance: 44905632.0000
   â””â”€ Top-5 Important Features: [0]
      â””â”€ Top-5 Values: ['44905632.0000']

ðŸ“Š Layer: LF_l4_FDCA.slice_att
   â”œâ”€ Features: 1
   â”œâ”€ Mean Importance: 18702628.0000
   â”œâ”€ Max Importance: 18702628.0000
   â”œâ”€ Min Importance: 18702628.0000
   â””â”€ Top-5 Important Features: [0]
      â””â”€ Top-5 Values: ['18702628.0000']

ðŸ“Š Layer: LF_l4_FDCA
   â”œâ”€ Features: 1
   â”œâ”€ Mean Importance: 3066239687338229760.0000
   â”œâ”€ Max Importance: 3066239687338229760.0000
   â”œâ”€ Min Importance: 3066239687338229760.0000
   â””â”€ Top-5 Important Features: [0]
      â””â”€ Top-5 Values: ['3066239687338229760.0000']

ðŸ“Š Layer: LF_l5_FDCA.semantic_att
   â”œâ”€ Features: 1
   â”œâ”€ Mean Importance: 0.0829
   â”œâ”€ Max Importance: 0.0829
   â”œâ”€ Min Importance: 0.0829
   â””â”€ Top-5 Important Features: [0]
      â””â”€ Top-5 Values: ['0.0829']

ðŸ“Š Layer: LF_l5_FDCA.positional_att.conv
   â”œâ”€ Features: 1
   â”œâ”€ Mean Importance: 73.7522
   â”œâ”€ Max Importance: 73.7522
   â”œâ”€ Min Importance: 73.7522
   â””â”€ Top-5 Important Features: [0]
      â””â”€ Top-5 Values: ['73.7522']

ðŸ“Š Layer: LF_l5_FDCA.positional_att
   â”œâ”€ Features: 1
   â”œâ”€ Mean Importance: 0.0000
   â”œâ”€ Max Importance: 0.0000
   â”œâ”€ Min Importance: 0.0000
   â””â”€ Top-5 Important Features: [0]
      â””â”€ Top-5 Values: ['0.0000']

ðŸ“Š Layer: LF_l5_FDCA.slice_att.linear.0
   â”œâ”€ Features: 1
   â”œâ”€ Mean Importance: 0.0000
   â”œâ”€ Max Importance: 0.0000
   â”œâ”€ Min Importance: 0.0000
   â””â”€ Top-5 Important Features: [0]
      â””â”€ Top-5 Values: ['0.0000']

ðŸ“Š Layer: LF_l5_FDCA.slice_att.linear.1
   â”œâ”€ Features: 1
   â”œâ”€ Mean Importance: 0.0000
   â”œâ”€ Max Importance: 0.0000
   â”œâ”€ Min Importance: 0.0000
   â””â”€ Top-5 Important Features: [0]
      â””â”€ Top-5 Values: ['0.0000']

ðŸ“Š Layer: LF_l5_FDCA.slice_att.linear.2
   â”œâ”€ Features: 1
   â”œâ”€ Mean Importance: 0.0000
   â”œâ”€ Max Importance: 0.0000
   â”œâ”€ Min Importance: 0.0000
   â””â”€ Top-5 Important Features: [0]
      â””â”€ Top-5 Values: ['0.0000']

ðŸ“Š Layer: LF_l5_FDCA.slice_att.linear
   â”œâ”€ Features: 1
   â”œâ”€ Mean Importance: 0.0000
   â”œâ”€ Max Importance: 0.0000
   â”œâ”€ Min Importance: 0.0000
   â””â”€ Top-5 Important Features: [0]
      â””â”€ Top-5 Values: ['0.0000']

ðŸ“Š Layer: LF_l5_FDCA.slice_att.non_linear
   â”œâ”€ Features: 1
   â”œâ”€ Mean Importance: 0.0000
   â”œâ”€ Max Importance: 0.0000
   â”œâ”€ Min Importance: 0.0000
   â””â”€ Top-5 Important Features: [0]
      â””â”€ Top-5 Values: ['0.0000']

ðŸ“Š Layer: LF_l5_FDCA.slice_att.mean
   â”œâ”€ Features: 1
   â”œâ”€ Mean Importance: 0.0017
   â”œâ”€ Max Importance: 0.0017
   â”œâ”€ Min Importance: 0.0017
   â””â”€ Top-5 Important Features: [0]
      â””â”€ Top-5 Values: ['0.0017']

ðŸ“Š Layer: LF_l5_FDCA.slice_att.log_diag
   â”œâ”€ Features: 1
   â”œâ”€ Mean Importance: 0.0000
   â”œâ”€ Max Importance: 0.0000
   â”œâ”€ Min Importance: 0.0000
   â””â”€ Top-5 Important Features: [0]
      â””â”€ Top-5 Values: ['0.0000']

ðŸ“Š Layer: LF_l5_FDCA.slice_att.factor
   â”œâ”€ Features: 1
   â”œâ”€ Mean Importance: 0.0001
   â”œâ”€ Max Importance: 0.0001
   â”œâ”€ Min Importance: 0.0001
   â””â”€ Top-5 Important Features: [0]
      â””â”€ Top-5 Values: ['0.0001']

ðŸ“Š Layer: LF_l5_FDCA.slice_att
   â”œâ”€ Features: 1
   â”œâ”€ Mean Importance: 0.0000
   â”œâ”€ Max Importance: 0.0000
   â”œâ”€ Min Importance: 0.0000
   â””â”€ Top-5 Important Features: [0]
      â””â”€ Top-5 Values: ['0.0000']

ðŸ“Š Layer: LF_l5_FDCA
   â”œâ”€ Features: 1
   â”œâ”€ Mean Importance: 0.0000
   â”œâ”€ Max Importance: 0.0000
   â”œâ”€ Min Importance: 0.0000
   â””â”€ Top-5 Important Features: [0]
      â””â”€ Top-5 Values: ['0.0000']

ðŸ“Š Layer: HF_l4_FDCA.semantic_att
   â”œâ”€ Features: 1
   â”œâ”€ Mean Importance: 0.0833
   â”œâ”€ Max Importance: 0.0833
   â”œâ”€ Min Importance: 0.0833
   â””â”€ Top-5 Important Features: [0]
      â””â”€ Top-5 Values: ['0.0833']

ðŸ“Š Layer: HF_l4_FDCA.positional_att.conv
   â”œâ”€ Features: 1
   â”œâ”€ Mean Importance: 9.4788
   â”œâ”€ Max Importance: 9.4788
   â”œâ”€ Min Importance: 9.4788
   â””â”€ Top-5 Important Features: [0]
      â””â”€ Top-5 Values: ['9.4788']

ðŸ“Š Layer: HF_l4_FDCA.positional_att
   â”œâ”€ Features: 1
   â”œâ”€ Mean Importance: 0.0015
   â”œâ”€ Max Importance: 0.0015
   â”œâ”€ Min Importance: 0.0015
   â””â”€ Top-5 Important Features: [0]
      â””â”€ Top-5 Values: ['0.0015']

ðŸ“Š Layer: HF_l4_FDCA.slice_att.linear.0
   â”œâ”€ Features: 1
   â”œâ”€ Mean Importance: 0.0000
   â”œâ”€ Max Importance: 0.0000
   â”œâ”€ Min Importance: 0.0000
   â””â”€ Top-5 Important Features: [0]
      â””â”€ Top-5 Values: ['0.0000']

ðŸ“Š Layer: HF_l4_FDCA.slice_att.linear.1
   â”œâ”€ Features: 1
   â”œâ”€ Mean Importance: 0.0000
   â”œâ”€ Max Importance: 0.0000
   â”œâ”€ Min Importance: 0.0000
   â””â”€ Top-5 Important Features: [0]
      â””â”€ Top-5 Values: ['0.0000']

ðŸ“Š Layer: HF_l4_FDCA.slice_att.linear.2
   â”œâ”€ Features: 1
   â”œâ”€ Mean Importance: 0.0000
   â”œâ”€ Max Importance: 0.0000
   â”œâ”€ Min Importance: 0.0000
   â””â”€ Top-5 Important Features: [0]
      â””â”€ Top-5 Values: ['0.0000']

ðŸ“Š Layer: HF_l4_FDCA.slice_att.linear
   â”œâ”€ Features: 1
   â”œâ”€ Mean Importance: 0.0000
   â”œâ”€ Max Importance: 0.0000
   â”œâ”€ Min Importance: 0.0000
   â””â”€ Top-5 Important Features: [0]
      â””â”€ Top-5 Values: ['0.0000']

ðŸ“Š Layer: HF_l4_FDCA.slice_att.non_linear
   â”œâ”€ Features: 1
   â”œâ”€ Mean Importance: 0.0000
   â”œâ”€ Max Importance: 0.0000
   â”œâ”€ Min Importance: 0.0000
   â””â”€ Top-5 Important Features: [0]
      â””â”€ Top-5 Values: ['0.0000']

ðŸ“Š Layer: HF_l4_FDCA.slice_att.mean
   â”œâ”€ Features: 1
   â”œâ”€ Mean Importance: 0.0000
   â”œâ”€ Max Importance: 0.0000
   â”œâ”€ Min Importance: 0.0000
   â””â”€ Top-5 Important Features: [0]
      â””â”€ Top-5 Values: ['0.0000']

ðŸ“Š Layer: HF_l4_FDCA.slice_att.log_diag
   â”œâ”€ Features: 1
   â”œâ”€ Mean Importance: 0.0000
   â”œâ”€ Max Importance: 0.0000
   â”œâ”€ Min Importance: 0.0000
   â””â”€ Top-5 Important Features: [0]
      â””â”€ Top-5 Values: ['0.0000']

ðŸ“Š Layer: HF_l4_FDCA.slice_att.factor
   â”œâ”€ Features: 1
   â”œâ”€ Mean Importance: 0.0000
   â”œâ”€ Max Importance: 0.0000
   â”œâ”€ Min Importance: 0.0000
   â””â”€ Top-5 Important Features: [0]
      â””â”€ Top-5 Values: ['0.0000']

ðŸ“Š Layer: HF_l4_FDCA.slice_att
   â”œâ”€ Features: 1
   â”œâ”€ Mean Importance: 0.0106
   â”œâ”€ Max Importance: 0.0106
   â”œâ”€ Min Importance: 0.0106
   â””â”€ Top-5 Important Features: [0]
      â””â”€ Top-5 Values: ['0.0106']

ðŸ“Š Layer: HF_l4_FDCA
   â”œâ”€ Features: 1
   â”œâ”€ Mean Importance: 2.2435
   â”œâ”€ Max Importance: 2.2435
   â”œâ”€ Min Importance: 2.2435
   â””â”€ Top-5 Important Features: [0]
      â””â”€ Top-5 Values: ['2.2435']

ðŸ“Š Layer: HF_l5_FDCA.semantic_att
   â”œâ”€ Features: 1
   â”œâ”€ Mean Importance: 0.0643
   â”œâ”€ Max Importance: 0.0643
   â”œâ”€ Min Importance: 0.0643
   â””â”€ Top-5 Important Features: [0]
      â””â”€ Top-5 Values: ['0.0643']

ðŸ“Š Layer: HF_l5_FDCA.positional_att.conv
   â”œâ”€ Features: 1
   â”œâ”€ Mean Importance: 15.8415
   â”œâ”€ Max Importance: 15.8415
   â”œâ”€ Min Importance: 15.8415
   â””â”€ Top-5 Important Features: [0]
      â””â”€ Top-5 Values: ['15.8415']

ðŸ“Š Layer: HF_l5_FDCA.positional_att
   â”œâ”€ Features: 1
   â”œâ”€ Mean Importance: 0.0001
   â”œâ”€ Max Importance: 0.0001
   â”œâ”€ Min Importance: 0.0001
   â””â”€ Top-5 Important Features: [0]
      â””â”€ Top-5 Values: ['0.0001']

ðŸ“Š Layer: HF_l5_FDCA.slice_att.linear.0
   â”œâ”€ Features: 1
   â”œâ”€ Mean Importance: 0.0000
   â”œâ”€ Max Importance: 0.0000
   â”œâ”€ Min Importance: 0.0000
   â””â”€ Top-5 Important Features: [0]
      â””â”€ Top-5 Values: ['0.0000']

ðŸ“Š Layer: HF_l5_FDCA.slice_att.linear.1
   â”œâ”€ Features: 1
   â”œâ”€ Mean Importance: 0.0000
   â”œâ”€ Max Importance: 0.0000
   â”œâ”€ Min Importance: 0.0000
   â””â”€ Top-5 Important Features: [0]
      â””â”€ Top-5 Values: ['0.0000']

ðŸ“Š Layer: HF_l5_FDCA.slice_att.linear.2
   â”œâ”€ Features: 1
   â”œâ”€ Mean Importance: 0.0000
   â”œâ”€ Max Importance: 0.0000
   â”œâ”€ Min Importance: 0.0000
   â””â”€ Top-5 Important Features: [0]
      â””â”€ Top-5 Values: ['0.0000']

ðŸ“Š Layer: HF_l5_FDCA.slice_att.linear
   â”œâ”€ Features: 1
   â”œâ”€ Mean Importance: 0.0000
   â”œâ”€ Max Importance: 0.0000
   â”œâ”€ Min Importance: 0.0000
   â””â”€ Top-5 Important Features: [0]
      â””â”€ Top-5 Values: ['0.0000']

ðŸ“Š Layer: HF_l5_FDCA.slice_att.non_linear
   â”œâ”€ Features: 1
   â”œâ”€ Mean Importance: 0.0000
   â”œâ”€ Max Importance: 0.0000
   â”œâ”€ Min Importance: 0.0000
   â””â”€ Top-5 Important Features: [0]
      â””â”€ Top-5 Values: ['0.0000']

ðŸ“Š Layer: HF_l5_FDCA.slice_att.mean
   â”œâ”€ Features: 1
   â”œâ”€ Mean Importance: 0.0000
   â”œâ”€ Max Importance: 0.0000
   â”œâ”€ Min Importance: 0.0000
   â””â”€ Top-5 Important Features: [0]
      â””â”€ Top-5 Values: ['0.0000']

ðŸ“Š Layer: HF_l5_FDCA.slice_att.log_diag
   â”œâ”€ Features: 1
   â”œâ”€ Mean Importance: 0.0000
   â”œâ”€ Max Importance: 0.0000
   â”œâ”€ Min Importance: 0.0000
   â””â”€ Top-5 Important Features: [0]
      â””â”€ Top-5 Values: ['0.0000']

ðŸ“Š Layer: HF_l5_FDCA.slice_att.factor
   â”œâ”€ Features: 1
   â”œâ”€ Mean Importance: 0.0000
   â”œâ”€ Max Importance: 0.0000
   â”œâ”€ Min Importance: 0.0000
   â””â”€ Top-5 Important Features: [0]
      â””â”€ Top-5 Values: ['0.0000']

ðŸ“Š Layer: HF_l5_FDCA.slice_att
   â”œâ”€ Features: 1
   â”œâ”€ Mean Importance: 0.0003
   â”œâ”€ Max Importance: 0.0003
   â”œâ”€ Min Importance: 0.0003
   â””â”€ Top-5 Important Features: [0]
      â””â”€ Top-5 Values: ['0.0003']

ðŸ“Š Layer: HF_l5_FDCA
   â”œâ”€ Features: 1
   â”œâ”€ Mean Importance: 0.0009
   â”œâ”€ Max Importance: 0.0009
   â”œâ”€ Min Importance: 0.0009
   â””â”€ Top-5 Important Features: [0]
      â””â”€ Top-5 Values: ['0.0009']

======================================================================
âœ“ Mechanistic analysis complete

[3] Generating Grad-CAM...
Warning: Failed to generate CAM for class 0: element 0 of tensors does not require grad and does not have a grad_fn
Warning: Failed to generate CAM for class 1: element 0 of tensors does not require grad and does not have a grad_fn
Warning: Failed to generate CAM for class 2: element 0 of tensors does not require grad and does not have a grad_fn
Warning: Failed to generate CAM for class 3: element 0 of tensors does not require grad and does not have a grad_fn
[4] Analyzing frequency components...
âœ“ Saved: outputs/xai_2025-11-15_17-25-23/freq_component/sample_0014_freq_comp.png
âœ“ Evaluation complete for sample_0014
Evaluating:  39%|###9      | 15/38 [04:11<06:18, 16.48s/it]
[1] Getting primary prediction...

[METRICS FOR sample_0015]
==================================================
class_0: Dice=0.9945, IoU=0.9891
class_1: Dice=0.7750, IoU=0.6327
class_2: Dice=0.7024, IoU=0.5413
class_3: Dice=0.0000, IoU=0.0000
==================================================

[2] Generating attention maps...
Clipping input data to the valid range for imshow with RGB data ([0..1] for floats or [0..255] for integers).
Clipping input data to the valid range for imshow with RGB data ([0..1] for floats or [0..255] for integers).
âœ“ Saved: outputs/xai_2025-11-15_17-25-23/attention/sample_0015_attention.png

[MECHANISTIC INTERPRETABILITY ANALYSIS]
======================================================================
Sample: sample_0015
======================================================================

ðŸ“Š Layer: LF_l4_FDCA.semantic_att
   â”œâ”€ Features: 1
   â”œâ”€ Mean Importance: 0.1149
   â”œâ”€ Max Importance: 0.1149
   â”œâ”€ Min Importance: 0.1149
   â””â”€ Top-5 Important Features: [0]
      â””â”€ Top-5 Values: ['0.1149']

ðŸ“Š Layer: LF_l4_FDCA.positional_att.conv
   â”œâ”€ Features: 1
   â”œâ”€ Mean Importance: 297.9039
   â”œâ”€ Max Importance: 297.9039
   â”œâ”€ Min Importance: 297.9039
   â””â”€ Top-5 Important Features: [0]
      â””â”€ Top-5 Values: ['297.9039']

ðŸ“Š Layer: LF_l4_FDCA.positional_att
   â”œâ”€ Features: 1
   â”œâ”€ Mean Importance: 47.9152
   â”œâ”€ Max Importance: 47.9152
   â”œâ”€ Min Importance: 47.9152
   â””â”€ Top-5 Important Features: [0]
      â””â”€ Top-5 Values: ['47.9152']

ðŸ“Š Layer: LF_l4_FDCA.slice_att.linear.0
   â”œâ”€ Features: 1
   â”œâ”€ Mean Importance: 109.3358
   â”œâ”€ Max Importance: 109.3358
   â”œâ”€ Min Importance: 109.3358
   â””â”€ Top-5 Important Features: [0]
      â””â”€ Top-5 Values: ['109.3358']

ðŸ“Š Layer: LF_l4_FDCA.slice_att.linear.1
   â”œâ”€ Features: 1
   â”œâ”€ Mean Importance: 92.7446
   â”œâ”€ Max Importance: 92.7446
   â”œâ”€ Min Importance: 92.7446
   â””â”€ Top-5 Important Features: [0]
      â””â”€ Top-5 Values: ['92.7446']

ðŸ“Š Layer: LF_l4_FDCA.slice_att.linear.2
   â”œâ”€ Features: 1
   â”œâ”€ Mean Importance: 88.0252
   â”œâ”€ Max Importance: 88.0252
   â”œâ”€ Min Importance: 88.0252
   â””â”€ Top-5 Important Features: [0]
      â””â”€ Top-5 Values: ['88.0252']

ðŸ“Š Layer: LF_l4_FDCA.slice_att.linear
   â”œâ”€ Features: 1
   â”œâ”€ Mean Importance: 88.0252
   â”œâ”€ Max Importance: 88.0252
   â”œâ”€ Min Importance: 88.0252
   â””â”€ Top-5 Important Features: [0]
      â””â”€ Top-5 Values: ['88.0252']

ðŸ“Š Layer: LF_l4_FDCA.slice_att.non_linear
   â”œâ”€ Features: 1
   â”œâ”€ Mean Importance: 34761308.0000
   â”œâ”€ Max Importance: 34761308.0000
   â”œâ”€ Min Importance: 34761308.0000
   â””â”€ Top-5 Important Features: [0]
      â””â”€ Top-5 Values: ['34761308.0000']

ðŸ“Š Layer: LF_l4_FDCA.slice_att.mean
   â”œâ”€ Features: 1
   â”œâ”€ Mean Importance: 138901424.0000
   â”œâ”€ Max Importance: 138901424.0000
   â”œâ”€ Min Importance: 138901424.0000
   â””â”€ Top-5 Important Features: [0]
      â””â”€ Top-5 Values: ['138901424.0000']

ðŸ“Š Layer: LF_l4_FDCA.slice_att.log_diag
   â”œâ”€ Features: 1
   â”œâ”€ Mean Importance: 8608.7832
   â”œâ”€ Max Importance: 8608.7832
   â”œâ”€ Min Importance: 8608.7832
   â””â”€ Top-5 Important Features: [0]
      â””â”€ Top-5 Values: ['8608.7832']

ðŸ“Š Layer: LF_l4_FDCA.slice_att.factor
   â”œâ”€ Features: 1
   â”œâ”€ Mean Importance: 53803084.0000
   â”œâ”€ Max Importance: 53803084.0000
   â”œâ”€ Min Importance: 53803084.0000
   â””â”€ Top-5 Important Features: [0]
      â””â”€ Top-5 Values: ['53803084.0000']

ðŸ“Š Layer: LF_l4_FDCA.slice_att
   â”œâ”€ Features: 1
   â”œâ”€ Mean Importance: 23793368.0000
   â”œâ”€ Max Importance: 23793368.0000
   â”œâ”€ Min Importance: 23793368.0000
   â””â”€ Top-5 Important Features: [0]
      â””â”€ Top-5 Values: ['23793368.0000']

ðŸ“Š Layer: LF_l4_FDCA
   â”œâ”€ Features: 1
   â”œâ”€ Mean Importance: 5016020974181548032.0000
   â”œâ”€ Max Importance: 5016020974181548032.0000
   â”œâ”€ Min Importance: 5016020974181548032.0000
   â””â”€ Top-5 Important Features: [0]
      â””â”€ Top-5 Values: ['5016020974181548032.0000']

ðŸ“Š Layer: LF_l5_FDCA.semantic_att
   â”œâ”€ Features: 1
   â”œâ”€ Mean Importance: 0.0792
   â”œâ”€ Max Importance: 0.0792
   â”œâ”€ Min Importance: 0.0792
   â””â”€ Top-5 Important Features: [0]
      â””â”€ Top-5 Values: ['0.0792']

ðŸ“Š Layer: LF_l5_FDCA.positional_att.conv
   â”œâ”€ Features: 1
   â”œâ”€ Mean Importance: 75.8790
   â”œâ”€ Max Importance: 75.8790
   â”œâ”€ Min Importance: 75.8790
   â””â”€ Top-5 Important Features: [0]
      â””â”€ Top-5 Values: ['75.8790']

ðŸ“Š Layer: LF_l5_FDCA.positional_att
   â”œâ”€ Features: 1
   â”œâ”€ Mean Importance: 0.0000
   â”œâ”€ Max Importance: 0.0000
   â”œâ”€ Min Importance: 0.0000
   â””â”€ Top-5 Important Features: [0]
      â””â”€ Top-5 Values: ['0.0000']

ðŸ“Š Layer: LF_l5_FDCA.slice_att.linear.0
   â”œâ”€ Features: 1
   â”œâ”€ Mean Importance: 0.0000
   â”œâ”€ Max Importance: 0.0000
   â”œâ”€ Min Importance: 0.0000
   â””â”€ Top-5 Important Features: [0]
      â””â”€ Top-5 Values: ['0.0000']

ðŸ“Š Layer: LF_l5_FDCA.slice_att.linear.1
   â”œâ”€ Features: 1
   â”œâ”€ Mean Importance: 0.0000
   â”œâ”€ Max Importance: 0.0000
   â”œâ”€ Min Importance: 0.0000
   â””â”€ Top-5 Important Features: [0]
      â””â”€ Top-5 Values: ['0.0000']

ðŸ“Š Layer: LF_l5_FDCA.slice_att.linear.2
   â”œâ”€ Features: 1
   â”œâ”€ Mean Importance: 0.0000
   â”œâ”€ Max Importance: 0.0000
   â”œâ”€ Min Importance: 0.0000
   â””â”€ Top-5 Important Features: [0]
      â””â”€ Top-5 Values: ['0.0000']

ðŸ“Š Layer: LF_l5_FDCA.slice_att.linear
   â”œâ”€ Features: 1
   â”œâ”€ Mean Importance: 0.0000
   â”œâ”€ Max Importance: 0.0000
   â”œâ”€ Min Importance: 0.0000
   â””â”€ Top-5 Important Features: [0]
      â””â”€ Top-5 Values: ['0.0000']

ðŸ“Š Layer: LF_l5_FDCA.slice_att.non_linear
   â”œâ”€ Features: 1
   â”œâ”€ Mean Importance: 0.0000
   â”œâ”€ Max Importance: 0.0000
   â”œâ”€ Min Importance: 0.0000
   â””â”€ Top-5 Important Features: [0]
      â””â”€ Top-5 Values: ['0.0000']

ðŸ“Š Layer: LF_l5_FDCA.slice_att.mean
   â”œâ”€ Features: 1
   â”œâ”€ Mean Importance: 0.0017
   â”œâ”€ Max Importance: 0.0017
   â”œâ”€ Min Importance: 0.0017
   â””â”€ Top-5 Important Features: [0]
      â””â”€ Top-5 Values: ['0.0017']

ðŸ“Š Layer: LF_l5_FDCA.slice_att.log_diag
   â”œâ”€ Features: 1
   â”œâ”€ Mean Importance: 0.0000
   â”œâ”€ Max Importance: 0.0000
   â”œâ”€ Min Importance: 0.0000
   â””â”€ Top-5 Important Features: [0]
      â””â”€ Top-5 Values: ['0.0000']

ðŸ“Š Layer: LF_l5_FDCA.slice_att.factor
   â”œâ”€ Features: 1
   â”œâ”€ Mean Importance: 0.0001
   â”œâ”€ Max Importance: 0.0001
   â”œâ”€ Min Importance: 0.0001
   â””â”€ Top-5 Important Features: [0]
      â””â”€ Top-5 Values: ['0.0001']

ðŸ“Š Layer: LF_l5_FDCA.slice_att
   â”œâ”€ Features: 1
   â”œâ”€ Mean Importance: 0.0000
   â”œâ”€ Max Importance: 0.0000
   â”œâ”€ Min Importance: 0.0000
   â””â”€ Top-5 Important Features: [0]
      â””â”€ Top-5 Values: ['0.0000']

ðŸ“Š Layer: LF_l5_FDCA
   â”œâ”€ Features: 1
   â”œâ”€ Mean Importance: 0.0000
   â”œâ”€ Max Importance: 0.0000
   â”œâ”€ Min Importance: 0.0000
   â””â”€ Top-5 Important Features: [0]
      â””â”€ Top-5 Values: ['0.0000']

ðŸ“Š Layer: HF_l4_FDCA.semantic_att
   â”œâ”€ Features: 1
   â”œâ”€ Mean Importance: 0.0835
   â”œâ”€ Max Importance: 0.0835
   â”œâ”€ Min Importance: 0.0835
   â””â”€ Top-5 Important Features: [0]
      â””â”€ Top-5 Values: ['0.0835']

ðŸ“Š Layer: HF_l4_FDCA.positional_att.conv
   â”œâ”€ Features: 1
   â”œâ”€ Mean Importance: 9.8929
   â”œâ”€ Max Importance: 9.8929
   â”œâ”€ Min Importance: 9.8929
   â””â”€ Top-5 Important Features: [0]
      â””â”€ Top-5 Values: ['9.8929']

ðŸ“Š Layer: HF_l4_FDCA.positional_att
   â”œâ”€ Features: 1
   â”œâ”€ Mean Importance: 0.0017
   â”œâ”€ Max Importance: 0.0017
   â”œâ”€ Min Importance: 0.0017
   â””â”€ Top-5 Important Features: [0]
      â””â”€ Top-5 Values: ['0.0017']

ðŸ“Š Layer: HF_l4_FDCA.slice_att.linear.0
   â”œâ”€ Features: 1
   â”œâ”€ Mean Importance: 0.0000
   â”œâ”€ Max Importance: 0.0000
   â”œâ”€ Min Importance: 0.0000
   â””â”€ Top-5 Important Features: [0]
      â””â”€ Top-5 Values: ['0.0000']

ðŸ“Š Layer: HF_l4_FDCA.slice_att.linear.1
   â”œâ”€ Features: 1
   â”œâ”€ Mean Importance: 0.0000
   â”œâ”€ Max Importance: 0.0000
   â”œâ”€ Min Importance: 0.0000
   â””â”€ Top-5 Important Features: [0]
      â””â”€ Top-5 Values: ['0.0000']

ðŸ“Š Layer: HF_l4_FDCA.slice_att.linear.2
   â”œâ”€ Features: 1
   â”œâ”€ Mean Importance: 0.0000
   â”œâ”€ Max Importance: 0.0000
   â”œâ”€ Min Importance: 0.0000
   â””â”€ Top-5 Important Features: [0]
      â””â”€ Top-5 Values: ['0.0000']

ðŸ“Š Layer: HF_l4_FDCA.slice_att.linear
   â”œâ”€ Features: 1
   â”œâ”€ Mean Importance: 0.0000
   â”œâ”€ Max Importance: 0.0000
   â”œâ”€ Min Importance: 0.0000
   â””â”€ Top-5 Important Features: [0]
      â””â”€ Top-5 Values: ['0.0000']

ðŸ“Š Layer: HF_l4_FDCA.slice_att.non_linear
   â”œâ”€ Features: 1
   â”œâ”€ Mean Importance: 0.0000
   â”œâ”€ Max Importance: 0.0000
   â”œâ”€ Min Importance: 0.0000
   â””â”€ Top-5 Important Features: [0]
      â””â”€ Top-5 Values: ['0.0000']

ðŸ“Š Layer: HF_l4_FDCA.slice_att.mean
   â”œâ”€ Features: 1
   â”œâ”€ Mean Importance: 0.0000
   â”œâ”€ Max Importance: 0.0000
   â”œâ”€ Min Importance: 0.0000
   â””â”€ Top-5 Important Features: [0]
      â””â”€ Top-5 Values: ['0.0000']

ðŸ“Š Layer: HF_l4_FDCA.slice_att.log_diag
   â”œâ”€ Features: 1
   â”œâ”€ Mean Importance: 0.0000
   â”œâ”€ Max Importance: 0.0000
   â”œâ”€ Min Importance: 0.0000
   â””â”€ Top-5 Important Features: [0]
      â””â”€ Top-5 Values: ['0.0000']

ðŸ“Š Layer: HF_l4_FDCA.slice_att.factor
   â”œâ”€ Features: 1
   â”œâ”€ Mean Importance: 0.0000
   â”œâ”€ Max Importance: 0.0000
   â”œâ”€ Min Importance: 0.0000
   â””â”€ Top-5 Important Features: [0]
      â””â”€ Top-5 Values: ['0.0000']

ðŸ“Š Layer: HF_l4_FDCA.slice_att
   â”œâ”€ Features: 1
   â”œâ”€ Mean Importance: 0.0093
   â”œâ”€ Max Importance: 0.0093
   â”œâ”€ Min Importance: 0.0093
   â””â”€ Top-5 Important Features: [0]
      â””â”€ Top-5 Values: ['0.0093']

ðŸ“Š Layer: HF_l4_FDCA
   â”œâ”€ Features: 1
   â”œâ”€ Mean Importance: 1.8722
   â”œâ”€ Max Importance: 1.8722
   â”œâ”€ Min Importance: 1.8722
   â””â”€ Top-5 Important Features: [0]
      â””â”€ Top-5 Values: ['1.8722']

ðŸ“Š Layer: HF_l5_FDCA.semantic_att
   â”œâ”€ Features: 1
   â”œâ”€ Mean Importance: 0.0761
   â”œâ”€ Max Importance: 0.0761
   â”œâ”€ Min Importance: 0.0761
   â””â”€ Top-5 Important Features: [0]
      â””â”€ Top-5 Values: ['0.0761']

ðŸ“Š Layer: HF_l5_FDCA.positional_att.conv
   â”œâ”€ Features: 1
   â”œâ”€ Mean Importance: 18.6788
   â”œâ”€ Max Importance: 18.6788
   â”œâ”€ Min Importance: 18.6788
   â””â”€ Top-5 Important Features: [0]
      â””â”€ Top-5 Values: ['18.6788']

ðŸ“Š Layer: HF_l5_FDCA.positional_att
   â”œâ”€ Features: 1
   â”œâ”€ Mean Importance: 0.0001
   â”œâ”€ Max Importance: 0.0001
   â”œâ”€ Min Importance: 0.0001
   â””â”€ Top-5 Important Features: [0]
      â””â”€ Top-5 Values: ['0.0001']

ðŸ“Š Layer: HF_l5_FDCA.slice_att.linear.0
   â”œâ”€ Features: 1
   â”œâ”€ Mean Importance: 0.0000
   â”œâ”€ Max Importance: 0.0000
   â”œâ”€ Min Importance: 0.0000
   â””â”€ Top-5 Important Features: [0]
      â””â”€ Top-5 Values: ['0.0000']

ðŸ“Š Layer: HF_l5_FDCA.slice_att.linear.1
   â”œâ”€ Features: 1
   â”œâ”€ Mean Importance: 0.0000
   â”œâ”€ Max Importance: 0.0000
   â”œâ”€ Min Importance: 0.0000
   â””â”€ Top-5 Important Features: [0]
      â””â”€ Top-5 Values: ['0.0000']

ðŸ“Š Layer: HF_l5_FDCA.slice_att.linear.2
   â”œâ”€ Features: 1
   â”œâ”€ Mean Importance: 0.0000
   â”œâ”€ Max Importance: 0.0000
   â”œâ”€ Min Importance: 0.0000
   â””â”€ Top-5 Important Features: [0]
      â””â”€ Top-5 Values: ['0.0000']

ðŸ“Š Layer: HF_l5_FDCA.slice_att.linear
   â”œâ”€ Features: 1
   â”œâ”€ Mean Importance: 0.0000
   â”œâ”€ Max Importance: 0.0000
   â”œâ”€ Min Importance: 0.0000
   â””â”€ Top-5 Important Features: [0]
      â””â”€ Top-5 Values: ['0.0000']

ðŸ“Š Layer: HF_l5_FDCA.slice_att.non_linear
   â”œâ”€ Features: 1
   â”œâ”€ Mean Importance: 0.0000
   â”œâ”€ Max Importance: 0.0000
   â”œâ”€ Min Importance: 0.0000
   â””â”€ Top-5 Important Features: [0]
      â””â”€ Top-5 Values: ['0.0000']

ðŸ“Š Layer: HF_l5_FDCA.slice_att.mean
   â”œâ”€ Features: 1
   â”œâ”€ Mean Importance: 0.0000
   â”œâ”€ Max Importance: 0.0000
   â”œâ”€ Min Importance: 0.0000
   â””â”€ Top-5 Important Features: [0]
      â””â”€ Top-5 Values: ['0.0000']

ðŸ“Š Layer: HF_l5_FDCA.slice_att.log_diag
   â”œâ”€ Features: 1
   â”œâ”€ Mean Importance: 0.0000
   â”œâ”€ Max Importance: 0.0000
   â”œâ”€ Min Importance: 0.0000
   â””â”€ Top-5 Important Features: [0]
      â””â”€ Top-5 Values: ['0.0000']

ðŸ“Š Layer: HF_l5_FDCA.slice_att.factor
   â”œâ”€ Features: 1
   â”œâ”€ Mean Importance: 0.0000
   â”œâ”€ Max Importance: 0.0000
   â”œâ”€ Min Importance: 0.0000
   â””â”€ Top-5 Important Features: [0]
      â””â”€ Top-5 Values: ['0.0000']

ðŸ“Š Layer: HF_l5_FDCA.slice_att
   â”œâ”€ Features: 1
   â”œâ”€ Mean Importance: 0.0007
   â”œâ”€ Max Importance: 0.0007
   â”œâ”€ Min Importance: 0.0007
   â””â”€ Top-5 Important Features: [0]
      â””â”€ Top-5 Values: ['0.0007']

ðŸ“Š Layer: HF_l5_FDCA
   â”œâ”€ Features: 1
   â”œâ”€ Mean Importance: 0.0023
   â”œâ”€ Max Importance: 0.0023
   â”œâ”€ Min Importance: 0.0023
   â””â”€ Top-5 Important Features: [0]
      â””â”€ Top-5 Values: ['0.0023']

======================================================================
âœ“ Mechanistic analysis complete

[3] Generating Grad-CAM...
Warning: Failed to generate CAM for class 0: element 0 of tensors does not require grad and does not have a grad_fn
Warning: Failed to generate CAM for class 1: element 0 of tensors does not require grad and does not have a grad_fn
Warning: Failed to generate CAM for class 2: element 0 of tensors does not require grad and does not have a grad_fn
Warning: Failed to generate CAM for class 3: element 0 of tensors does not require grad and does not have a grad_fn
[4] Analyzing frequency components...
âœ“ Saved: outputs/xai_2025-11-15_17-25-23/freq_component/sample_0015_freq_comp.png
âœ“ Evaluation complete for sample_0015
Evaluating:  42%|####2     | 16/38 [04:27<06:00, 16.37s/it]
[1] Getting primary prediction...

[METRICS FOR sample_0016]
==================================================
class_0: Dice=0.9869, IoU=0.9741
class_1: Dice=0.8852, IoU=0.7941
class_2: Dice=0.7237, IoU=0.5671
class_3: Dice=0.0007, IoU=0.0003
==================================================

[2] Generating attention maps...
Clipping input data to the valid range for imshow with RGB data ([0..1] for floats or [0..255] for integers).
Clipping input data to the valid range for imshow with RGB data ([0..1] for floats or [0..255] for integers).
âœ“ Saved: outputs/xai_2025-11-15_17-25-23/attention/sample_0016_attention.png

[MECHANISTIC INTERPRETABILITY ANALYSIS]
======================================================================
Sample: sample_0016
======================================================================

ðŸ“Š Layer: LF_l4_FDCA.semantic_att
   â”œâ”€ Features: 1
   â”œâ”€ Mean Importance: 0.1254
   â”œâ”€ Max Importance: 0.1254
   â”œâ”€ Min Importance: 0.1254
   â””â”€ Top-5 Important Features: [0]
      â””â”€ Top-5 Values: ['0.1254']

ðŸ“Š Layer: LF_l4_FDCA.positional_att.conv
   â”œâ”€ Features: 1
   â”œâ”€ Mean Importance: 222.3963
   â”œâ”€ Max Importance: 222.3963
   â”œâ”€ Min Importance: 222.3963
   â””â”€ Top-5 Important Features: [0]
      â””â”€ Top-5 Values: ['222.3963']

ðŸ“Š Layer: LF_l4_FDCA.positional_att
   â”œâ”€ Features: 1
   â”œâ”€ Mean Importance: 43.4289
   â”œâ”€ Max Importance: 43.4289
   â”œâ”€ Min Importance: 43.4289
   â””â”€ Top-5 Important Features: [0]
      â””â”€ Top-5 Values: ['43.4289']

ðŸ“Š Layer: LF_l4_FDCA.slice_att.linear.0
   â”œâ”€ Features: 1
   â”œâ”€ Mean Importance: 58.2503
   â”œâ”€ Max Importance: 58.2503
   â”œâ”€ Min Importance: 58.2503
   â””â”€ Top-5 Important Features: [0]
      â””â”€ Top-5 Values: ['58.2503']

ðŸ“Š Layer: LF_l4_FDCA.slice_att.linear.1
   â”œâ”€ Features: 1
   â”œâ”€ Mean Importance: 49.4166
   â”œâ”€ Max Importance: 49.4166
   â”œâ”€ Min Importance: 49.4166
   â””â”€ Top-5 Important Features: [0]
      â””â”€ Top-5 Values: ['49.4166']

ðŸ“Š Layer: LF_l4_FDCA.slice_att.linear.2
   â”œâ”€ Features: 1
   â”œâ”€ Mean Importance: 46.8855
   â”œâ”€ Max Importance: 46.8855
   â”œâ”€ Min Importance: 46.8855
   â””â”€ Top-5 Important Features: [0]
      â””â”€ Top-5 Values: ['46.8855']

ðŸ“Š Layer: LF_l4_FDCA.slice_att.linear
   â”œâ”€ Features: 1
   â”œâ”€ Mean Importance: 46.8855
   â”œâ”€ Max Importance: 46.8855
   â”œâ”€ Min Importance: 46.8855
   â””â”€ Top-5 Important Features: [0]
      â””â”€ Top-5 Values: ['46.8855']

ðŸ“Š Layer: LF_l4_FDCA.slice_att.non_linear
   â”œâ”€ Features: 1
   â”œâ”€ Mean Importance: 20515618.0000
   â”œâ”€ Max Importance: 20515618.0000
   â”œâ”€ Min Importance: 20515618.0000
   â””â”€ Top-5 Important Features: [0]
      â””â”€ Top-5 Values: ['20515618.0000']

ðŸ“Š Layer: LF_l4_FDCA.slice_att.mean
   â”œâ”€ Features: 1
   â”œâ”€ Mean Importance: 81963808.0000
   â”œâ”€ Max Importance: 81963808.0000
   â”œâ”€ Min Importance: 81963808.0000
   â””â”€ Top-5 Important Features: [0]
      â””â”€ Top-5 Values: ['81963808.0000']

ðŸ“Š Layer: LF_l4_FDCA.slice_att.log_diag
   â”œâ”€ Features: 1
   â”œâ”€ Mean Importance: 5080.0522
   â”œâ”€ Max Importance: 5080.0522
   â”œâ”€ Min Importance: 5080.0522
   â””â”€ Top-5 Important Features: [0]
      â””â”€ Top-5 Values: ['5080.0522']

ðŸ“Š Layer: LF_l4_FDCA.slice_att.factor
   â”œâ”€ Features: 1
   â”œâ”€ Mean Importance: 31748294.0000
   â”œâ”€ Max Importance: 31748294.0000
   â”œâ”€ Min Importance: 31748294.0000
   â””â”€ Top-5 Important Features: [0]
      â””â”€ Top-5 Values: ['31748294.0000']

ðŸ“Š Layer: LF_l4_FDCA.slice_att
   â”œâ”€ Features: 1
   â”œâ”€ Mean Importance: 639287.2500
   â”œâ”€ Max Importance: 639287.2500
   â”œâ”€ Min Importance: 639287.2500
   â””â”€ Top-5 Important Features: [0]
      â””â”€ Top-5 Values: ['639287.2500']

ðŸ“Š Layer: LF_l4_FDCA
   â”œâ”€ Features: 1
   â”œâ”€ Mean Importance: 5890550867689472.0000
   â”œâ”€ Max Importance: 5890550867689472.0000
   â”œâ”€ Min Importance: 5890550867689472.0000
   â””â”€ Top-5 Important Features: [0]
      â””â”€ Top-5 Values: ['5890550867689472.0000']

ðŸ“Š Layer: LF_l5_FDCA.semantic_att
   â”œâ”€ Features: 1
   â”œâ”€ Mean Importance: 0.0828
   â”œâ”€ Max Importance: 0.0828
   â”œâ”€ Min Importance: 0.0828
   â””â”€ Top-5 Important Features: [0]
      â””â”€ Top-5 Values: ['0.0828']

ðŸ“Š Layer: LF_l5_FDCA.positional_att.conv
   â”œâ”€ Features: 1
   â”œâ”€ Mean Importance: 69.6368
   â”œâ”€ Max Importance: 69.6368
   â”œâ”€ Min Importance: 69.6368
   â””â”€ Top-5 Important Features: [0]
      â””â”€ Top-5 Values: ['69.6368']

ðŸ“Š Layer: LF_l5_FDCA.positional_att
   â”œâ”€ Features: 1
   â”œâ”€ Mean Importance: 0.0000
   â”œâ”€ Max Importance: 0.0000
   â”œâ”€ Min Importance: 0.0000
   â””â”€ Top-5 Important Features: [0]
      â””â”€ Top-5 Values: ['0.0000']

ðŸ“Š Layer: LF_l5_FDCA.slice_att.linear.0
   â”œâ”€ Features: 1
   â”œâ”€ Mean Importance: 0.0000
   â”œâ”€ Max Importance: 0.0000
   â”œâ”€ Min Importance: 0.0000
   â””â”€ Top-5 Important Features: [0]
      â””â”€ Top-5 Values: ['0.0000']

ðŸ“Š Layer: LF_l5_FDCA.slice_att.linear.1
   â”œâ”€ Features: 1
   â”œâ”€ Mean Importance: 0.0000
   â”œâ”€ Max Importance: 0.0000
   â”œâ”€ Min Importance: 0.0000
   â””â”€ Top-5 Important Features: [0]
      â””â”€ Top-5 Values: ['0.0000']

ðŸ“Š Layer: LF_l5_FDCA.slice_att.linear.2
   â”œâ”€ Features: 1
   â”œâ”€ Mean Importance: 0.0000
   â”œâ”€ Max Importance: 0.0000
   â”œâ”€ Min Importance: 0.0000
   â””â”€ Top-5 Important Features: [0]
      â””â”€ Top-5 Values: ['0.0000']

ðŸ“Š Layer: LF_l5_FDCA.slice_att.linear
   â”œâ”€ Features: 1
   â”œâ”€ Mean Importance: 0.0000
   â”œâ”€ Max Importance: 0.0000
   â”œâ”€ Min Importance: 0.0000
   â””â”€ Top-5 Important Features: [0]
      â””â”€ Top-5 Values: ['0.0000']

ðŸ“Š Layer: LF_l5_FDCA.slice_att.non_linear
   â”œâ”€ Features: 1
   â”œâ”€ Mean Importance: 0.0000
   â”œâ”€ Max Importance: 0.0000
   â”œâ”€ Min Importance: 0.0000
   â””â”€ Top-5 Important Features: [0]
      â””â”€ Top-5 Values: ['0.0000']

ðŸ“Š Layer: LF_l5_FDCA.slice_att.mean
   â”œâ”€ Features: 1
   â”œâ”€ Mean Importance: 0.0017
   â”œâ”€ Max Importance: 0.0017
   â”œâ”€ Min Importance: 0.0017
   â””â”€ Top-5 Important Features: [0]
      â””â”€ Top-5 Values: ['0.0017']

ðŸ“Š Layer: LF_l5_FDCA.slice_att.log_diag
   â”œâ”€ Features: 1
   â”œâ”€ Mean Importance: 0.0000
   â”œâ”€ Max Importance: 0.0000
   â”œâ”€ Min Importance: 0.0000
   â””â”€ Top-5 Important Features: [0]
      â””â”€ Top-5 Values: ['0.0000']

ðŸ“Š Layer: LF_l5_FDCA.slice_att.factor
   â”œâ”€ Features: 1
   â”œâ”€ Mean Importance: 0.0001
   â”œâ”€ Max Importance: 0.0001
   â”œâ”€ Min Importance: 0.0001
   â””â”€ Top-5 Important Features: [0]
      â””â”€ Top-5 Values: ['0.0001']

ðŸ“Š Layer: LF_l5_FDCA.slice_att
   â”œâ”€ Features: 1
   â”œâ”€ Mean Importance: 0.0000
   â”œâ”€ Max Importance: 0.0000
   â”œâ”€ Min Importance: 0.0000
   â””â”€ Top-5 Important Features: [0]
      â””â”€ Top-5 Values: ['0.0000']

ðŸ“Š Layer: LF_l5_FDCA
   â”œâ”€ Features: 1
   â”œâ”€ Mean Importance: 0.0000
   â”œâ”€ Max Importance: 0.0000
   â”œâ”€ Min Importance: 0.0000
   â””â”€ Top-5 Important Features: [0]
      â””â”€ Top-5 Values: ['0.0000']

ðŸ“Š Layer: HF_l4_FDCA.semantic_att
   â”œâ”€ Features: 1
   â”œâ”€ Mean Importance: 0.0832
   â”œâ”€ Max Importance: 0.0832
   â”œâ”€ Min Importance: 0.0832
   â””â”€ Top-5 Important Features: [0]
      â””â”€ Top-5 Values: ['0.0832']

ðŸ“Š Layer: HF_l4_FDCA.positional_att.conv
   â”œâ”€ Features: 1
   â”œâ”€ Mean Importance: 8.8695
   â”œâ”€ Max Importance: 8.8695
   â”œâ”€ Min Importance: 8.8695
   â””â”€ Top-5 Important Features: [0]
      â””â”€ Top-5 Values: ['8.8695']

ðŸ“Š Layer: HF_l4_FDCA.positional_att
   â”œâ”€ Features: 1
   â”œâ”€ Mean Importance: 0.0019
   â”œâ”€ Max Importance: 0.0019
   â”œâ”€ Min Importance: 0.0019
   â””â”€ Top-5 Important Features: [0]
      â””â”€ Top-5 Values: ['0.0019']

ðŸ“Š Layer: HF_l4_FDCA.slice_att.linear.0
   â”œâ”€ Features: 1
   â”œâ”€ Mean Importance: 0.0000
   â”œâ”€ Max Importance: 0.0000
   â”œâ”€ Min Importance: 0.0000
   â””â”€ Top-5 Important Features: [0]
      â””â”€ Top-5 Values: ['0.0000']

ðŸ“Š Layer: HF_l4_FDCA.slice_att.linear.1
   â”œâ”€ Features: 1
   â”œâ”€ Mean Importance: 0.0000
   â”œâ”€ Max Importance: 0.0000
   â”œâ”€ Min Importance: 0.0000
   â””â”€ Top-5 Important Features: [0]
      â””â”€ Top-5 Values: ['0.0000']

ðŸ“Š Layer: HF_l4_FDCA.slice_att.linear.2
   â”œâ”€ Features: 1
   â”œâ”€ Mean Importance: 0.0000
   â”œâ”€ Max Importance: 0.0000
   â”œâ”€ Min Importance: 0.0000
   â””â”€ Top-5 Important Features: [0]
      â””â”€ Top-5 Values: ['0.0000']

ðŸ“Š Layer: HF_l4_FDCA.slice_att.linear
   â”œâ”€ Features: 1
   â”œâ”€ Mean Importance: 0.0000
   â”œâ”€ Max Importance: 0.0000
   â”œâ”€ Min Importance: 0.0000
   â””â”€ Top-5 Important Features: [0]
      â””â”€ Top-5 Values: ['0.0000']

ðŸ“Š Layer: HF_l4_FDCA.slice_att.non_linear
   â”œâ”€ Features: 1
   â”œâ”€ Mean Importance: 0.0000
   â”œâ”€ Max Importance: 0.0000
   â”œâ”€ Min Importance: 0.0000
   â””â”€ Top-5 Important Features: [0]
      â””â”€ Top-5 Values: ['0.0000']

ðŸ“Š Layer: HF_l4_FDCA.slice_att.mean
   â”œâ”€ Features: 1
   â”œâ”€ Mean Importance: 0.0000
   â”œâ”€ Max Importance: 0.0000
   â”œâ”€ Min Importance: 0.0000
   â””â”€ Top-5 Important Features: [0]
      â””â”€ Top-5 Values: ['0.0000']

ðŸ“Š Layer: HF_l4_FDCA.slice_att.log_diag
   â”œâ”€ Features: 1
   â”œâ”€ Mean Importance: 0.0000
   â”œâ”€ Max Importance: 0.0000
   â”œâ”€ Min Importance: 0.0000
   â””â”€ Top-5 Important Features: [0]
      â””â”€ Top-5 Values: ['0.0000']

ðŸ“Š Layer: HF_l4_FDCA.slice_att.factor
   â”œâ”€ Features: 1
   â”œâ”€ Mean Importance: 0.0000
   â”œâ”€ Max Importance: 0.0000
   â”œâ”€ Min Importance: 0.0000
   â””â”€ Top-5 Important Features: [0]
      â””â”€ Top-5 Values: ['0.0000']

ðŸ“Š Layer: HF_l4_FDCA.slice_att
   â”œâ”€ Features: 1
   â”œâ”€ Mean Importance: 0.0072
   â”œâ”€ Max Importance: 0.0072
   â”œâ”€ Min Importance: 0.0072
   â””â”€ Top-5 Important Features: [0]
      â””â”€ Top-5 Values: ['0.0072']

ðŸ“Š Layer: HF_l4_FDCA
   â”œâ”€ Features: 1
   â”œâ”€ Mean Importance: 0.8120
   â”œâ”€ Max Importance: 0.8120
   â”œâ”€ Min Importance: 0.8120
   â””â”€ Top-5 Important Features: [0]
      â””â”€ Top-5 Values: ['0.8120']

ðŸ“Š Layer: HF_l5_FDCA.semantic_att
   â”œâ”€ Features: 1
   â”œâ”€ Mean Importance: 0.0733
   â”œâ”€ Max Importance: 0.0733
   â”œâ”€ Min Importance: 0.0733
   â””â”€ Top-5 Important Features: [0]
      â””â”€ Top-5 Values: ['0.0733']

ðŸ“Š Layer: HF_l5_FDCA.positional_att.conv
   â”œâ”€ Features: 1
   â”œâ”€ Mean Importance: 13.9317
   â”œâ”€ Max Importance: 13.9317
   â”œâ”€ Min Importance: 13.9317
   â””â”€ Top-5 Important Features: [0]
      â””â”€ Top-5 Values: ['13.9317']

ðŸ“Š Layer: HF_l5_FDCA.positional_att
   â”œâ”€ Features: 1
   â”œâ”€ Mean Importance: 0.0001
   â”œâ”€ Max Importance: 0.0001
   â”œâ”€ Min Importance: 0.0001
   â””â”€ Top-5 Important Features: [0]
      â””â”€ Top-5 Values: ['0.0001']

ðŸ“Š Layer: HF_l5_FDCA.slice_att.linear.0
   â”œâ”€ Features: 1
   â”œâ”€ Mean Importance: 0.0000
   â”œâ”€ Max Importance: 0.0000
   â”œâ”€ Min Importance: 0.0000
   â””â”€ Top-5 Important Features: [0]
      â””â”€ Top-5 Values: ['0.0000']

ðŸ“Š Layer: HF_l5_FDCA.slice_att.linear.1
   â”œâ”€ Features: 1
   â”œâ”€ Mean Importance: 0.0000
   â”œâ”€ Max Importance: 0.0000
   â”œâ”€ Min Importance: 0.0000
   â””â”€ Top-5 Important Features: [0]
      â””â”€ Top-5 Values: ['0.0000']

ðŸ“Š Layer: HF_l5_FDCA.slice_att.linear.2
   â”œâ”€ Features: 1
   â”œâ”€ Mean Importance: 0.0000
   â”œâ”€ Max Importance: 0.0000
   â”œâ”€ Min Importance: 0.0000
   â””â”€ Top-5 Important Features: [0]
      â””â”€ Top-5 Values: ['0.0000']

ðŸ“Š Layer: HF_l5_FDCA.slice_att.linear
   â”œâ”€ Features: 1
   â”œâ”€ Mean Importance: 0.0000
   â”œâ”€ Max Importance: 0.0000
   â”œâ”€ Min Importance: 0.0000
   â””â”€ Top-5 Important Features: [0]
      â””â”€ Top-5 Values: ['0.0000']

ðŸ“Š Layer: HF_l5_FDCA.slice_att.non_linear
   â”œâ”€ Features: 1
   â”œâ”€ Mean Importance: 0.0000
   â”œâ”€ Max Importance: 0.0000
   â”œâ”€ Min Importance: 0.0000
   â””â”€ Top-5 Important Features: [0]
      â””â”€ Top-5 Values: ['0.0000']

ðŸ“Š Layer: HF_l5_FDCA.slice_att.mean
   â”œâ”€ Features: 1
   â”œâ”€ Mean Importance: 0.0000
   â”œâ”€ Max Importance: 0.0000
   â”œâ”€ Min Importance: 0.0000
   â””â”€ Top-5 Important Features: [0]
      â””â”€ Top-5 Values: ['0.0000']

ðŸ“Š Layer: HF_l5_FDCA.slice_att.log_diag
   â”œâ”€ Features: 1
   â”œâ”€ Mean Importance: 0.0000
   â”œâ”€ Max Importance: 0.0000
   â”œâ”€ Min Importance: 0.0000
   â””â”€ Top-5 Important Features: [0]
      â””â”€ Top-5 Values: ['0.0000']

ðŸ“Š Layer: HF_l5_FDCA.slice_att.factor
   â”œâ”€ Features: 1
   â”œâ”€ Mean Importance: 0.0000
   â”œâ”€ Max Importance: 0.0000
   â”œâ”€ Min Importance: 0.0000
   â””â”€ Top-5 Important Features: [0]
      â””â”€ Top-5 Values: ['0.0000']

ðŸ“Š Layer: HF_l5_FDCA.slice_att
   â”œâ”€ Features: 1
   â”œâ”€ Mean Importance: 0.0001
   â”œâ”€ Max Importance: 0.0001
   â”œâ”€ Min Importance: 0.0001
   â””â”€ Top-5 Important Features: [0]
      â””â”€ Top-5 Values: ['0.0001']

ðŸ“Š Layer: HF_l5_FDCA
   â”œâ”€ Features: 1
   â”œâ”€ Mean Importance: 0.0001
   â”œâ”€ Max Importance: 0.0001
   â”œâ”€ Min Importance: 0.0001
   â””â”€ Top-5 Important Features: [0]
      â””â”€ Top-5 Values: ['0.0001']

======================================================================
âœ“ Mechanistic analysis complete

[3] Generating Grad-CAM...
Warning: Failed to generate CAM for class 0: element 0 of tensors does not require grad and does not have a grad_fn
Warning: Failed to generate CAM for class 1: element 0 of tensors does not require grad and does not have a grad_fn
Warning: Failed to generate CAM for class 2: element 0 of tensors does not require grad and does not have a grad_fn
Warning: Failed to generate CAM for class 3: element 0 of tensors does not require grad and does not have a grad_fn
[4] Analyzing frequency components...
âœ“ Saved: outputs/xai_2025-11-15_17-25-23/freq_component/sample_0016_freq_comp.png
âœ“ Evaluation complete for sample_0016
Evaluating:  45%|####4     | 17/38 [04:44<05:48, 16.59s/it]
[1] Getting primary prediction...

[METRICS FOR sample_0017]
==================================================
class_0: Dice=0.9983, IoU=0.9966
class_1: Dice=0.2204, IoU=0.1239
class_2: Dice=0.5579, IoU=0.3869
class_3: Dice=0.6857, IoU=0.5217
==================================================

[2] Generating attention maps...
Clipping input data to the valid range for imshow with RGB data ([0..1] for floats or [0..255] for integers).
Clipping input data to the valid range for imshow with RGB data ([0..1] for floats or [0..255] for integers).
âœ“ Saved: outputs/xai_2025-11-15_17-25-23/attention/sample_0017_attention.png

[MECHANISTIC INTERPRETABILITY ANALYSIS]
======================================================================
Sample: sample_0017
======================================================================

ðŸ“Š Layer: LF_l4_FDCA.semantic_att
   â”œâ”€ Features: 1
   â”œâ”€ Mean Importance: 0.1471
   â”œâ”€ Max Importance: 0.1471
   â”œâ”€ Min Importance: 0.1471
   â””â”€ Top-5 Important Features: [0]
      â””â”€ Top-5 Values: ['0.1471']

ðŸ“Š Layer: LF_l4_FDCA.positional_att.conv
   â”œâ”€ Features: 1
   â”œâ”€ Mean Importance: 294.9313
   â”œâ”€ Max Importance: 294.9313
   â”œâ”€ Min Importance: 294.9313
   â””â”€ Top-5 Important Features: [0]
      â””â”€ Top-5 Values: ['294.9313']

ðŸ“Š Layer: LF_l4_FDCA.positional_att
   â”œâ”€ Features: 1
   â”œâ”€ Mean Importance: 60.6900
   â”œâ”€ Max Importance: 60.6900
   â”œâ”€ Min Importance: 60.6900
   â””â”€ Top-5 Important Features: [0]
      â””â”€ Top-5 Values: ['60.6900']

ðŸ“Š Layer: LF_l4_FDCA.slice_att.linear.0
   â”œâ”€ Features: 1
   â”œâ”€ Mean Importance: 81.8723
   â”œâ”€ Max Importance: 81.8723
   â”œâ”€ Min Importance: 81.8723
   â””â”€ Top-5 Important Features: [0]
      â””â”€ Top-5 Values: ['81.8723']

ðŸ“Š Layer: LF_l4_FDCA.slice_att.linear.1
   â”œâ”€ Features: 1
   â”œâ”€ Mean Importance: 69.4604
   â”œâ”€ Max Importance: 69.4604
   â”œâ”€ Min Importance: 69.4604
   â””â”€ Top-5 Important Features: [0]
      â””â”€ Top-5 Values: ['69.4604']

ðŸ“Š Layer: LF_l4_FDCA.slice_att.linear.2
   â”œâ”€ Features: 1
   â”œâ”€ Mean Importance: 65.8790
   â”œâ”€ Max Importance: 65.8790
   â”œâ”€ Min Importance: 65.8790
   â””â”€ Top-5 Important Features: [0]
      â””â”€ Top-5 Values: ['65.8790']

ðŸ“Š Layer: LF_l4_FDCA.slice_att.linear
   â”œâ”€ Features: 1
   â”œâ”€ Mean Importance: 65.8790
   â”œâ”€ Max Importance: 65.8790
   â”œâ”€ Min Importance: 65.8790
   â””â”€ Top-5 Important Features: [0]
      â””â”€ Top-5 Values: ['65.8790']

ðŸ“Š Layer: LF_l4_FDCA.slice_att.non_linear
   â”œâ”€ Features: 1
   â”œâ”€ Mean Importance: 33127012.0000
   â”œâ”€ Max Importance: 33127012.0000
   â”œâ”€ Min Importance: 33127012.0000
   â””â”€ Top-5 Important Features: [0]
      â””â”€ Top-5 Values: ['33127012.0000']

ðŸ“Š Layer: LF_l4_FDCA.slice_att.mean
   â”œâ”€ Features: 1
   â”œâ”€ Mean Importance: 132339568.0000
   â”œâ”€ Max Importance: 132339568.0000
   â”œâ”€ Min Importance: 132339568.0000
   â””â”€ Top-5 Important Features: [0]
      â””â”€ Top-5 Values: ['132339568.0000']

ðŸ“Š Layer: LF_l4_FDCA.slice_att.log_diag
   â”œâ”€ Features: 1
   â”œâ”€ Mean Importance: 8202.3799
   â”œâ”€ Max Importance: 8202.3799
   â”œâ”€ Min Importance: 8202.3799
   â””â”€ Top-5 Important Features: [0]
      â””â”€ Top-5 Values: ['8202.3799']

ðŸ“Š Layer: LF_l4_FDCA.slice_att.factor
   â”œâ”€ Features: 1
   â”œâ”€ Mean Importance: 51261016.0000
   â”œâ”€ Max Importance: 51261016.0000
   â”œâ”€ Min Importance: 51261016.0000
   â””â”€ Top-5 Important Features: [0]
      â””â”€ Top-5 Values: ['51261016.0000']

ðŸ“Š Layer: LF_l4_FDCA.slice_att
   â”œâ”€ Features: 1
   â”œâ”€ Mean Importance: 19787906.0000
   â”œâ”€ Max Importance: 19787906.0000
   â”œâ”€ Min Importance: 19787906.0000
   â””â”€ Top-5 Important Features: [0]
      â””â”€ Top-5 Values: ['19787906.0000']

ðŸ“Š Layer: LF_l4_FDCA
   â”œâ”€ Features: 1
   â”œâ”€ Mean Importance: 2877962889610657792.0000
   â”œâ”€ Max Importance: 2877962889610657792.0000
   â”œâ”€ Min Importance: 2877962889610657792.0000
   â””â”€ Top-5 Important Features: [0]
      â””â”€ Top-5 Values: ['2877962889610657792.0000']

ðŸ“Š Layer: LF_l5_FDCA.semantic_att
   â”œâ”€ Features: 1
   â”œâ”€ Mean Importance: 0.0870
   â”œâ”€ Max Importance: 0.0870
   â”œâ”€ Min Importance: 0.0870
   â””â”€ Top-5 Important Features: [0]
      â””â”€ Top-5 Values: ['0.0870']

ðŸ“Š Layer: LF_l5_FDCA.positional_att.conv
   â”œâ”€ Features: 1
   â”œâ”€ Mean Importance: 67.5785
   â”œâ”€ Max Importance: 67.5785
   â”œâ”€ Min Importance: 67.5785
   â””â”€ Top-5 Important Features: [0]
      â””â”€ Top-5 Values: ['67.5785']

ðŸ“Š Layer: LF_l5_FDCA.positional_att
   â”œâ”€ Features: 1
   â”œâ”€ Mean Importance: 0.0000
   â”œâ”€ Max Importance: 0.0000
   â”œâ”€ Min Importance: 0.0000
   â””â”€ Top-5 Important Features: [0]
      â””â”€ Top-5 Values: ['0.0000']

ðŸ“Š Layer: LF_l5_FDCA.slice_att.linear.0
   â”œâ”€ Features: 1
   â”œâ”€ Mean Importance: 0.0000
   â”œâ”€ Max Importance: 0.0000
   â”œâ”€ Min Importance: 0.0000
   â””â”€ Top-5 Important Features: [0]
      â””â”€ Top-5 Values: ['0.0000']

ðŸ“Š Layer: LF_l5_FDCA.slice_att.linear.1
   â”œâ”€ Features: 1
   â”œâ”€ Mean Importance: 0.0000
   â”œâ”€ Max Importance: 0.0000
   â”œâ”€ Min Importance: 0.0000
   â””â”€ Top-5 Important Features: [0]
      â””â”€ Top-5 Values: ['0.0000']

ðŸ“Š Layer: LF_l5_FDCA.slice_att.linear.2
   â”œâ”€ Features: 1
   â”œâ”€ Mean Importance: 0.0000
   â”œâ”€ Max Importance: 0.0000
   â”œâ”€ Min Importance: 0.0000
   â””â”€ Top-5 Important Features: [0]
      â””â”€ Top-5 Values: ['0.0000']

ðŸ“Š Layer: LF_l5_FDCA.slice_att.linear
   â”œâ”€ Features: 1
   â”œâ”€ Mean Importance: 0.0000
   â”œâ”€ Max Importance: 0.0000
   â”œâ”€ Min Importance: 0.0000
   â””â”€ Top-5 Important Features: [0]
      â””â”€ Top-5 Values: ['0.0000']

ðŸ“Š Layer: LF_l5_FDCA.slice_att.non_linear
   â”œâ”€ Features: 1
   â”œâ”€ Mean Importance: 0.0000
   â”œâ”€ Max Importance: 0.0000
   â”œâ”€ Min Importance: 0.0000
   â””â”€ Top-5 Important Features: [0]
      â””â”€ Top-5 Values: ['0.0000']

ðŸ“Š Layer: LF_l5_FDCA.slice_att.mean
   â”œâ”€ Features: 1
   â”œâ”€ Mean Importance: 0.0017
   â”œâ”€ Max Importance: 0.0017
   â”œâ”€ Min Importance: 0.0017
   â””â”€ Top-5 Important Features: [0]
      â””â”€ Top-5 Values: ['0.0017']

ðŸ“Š Layer: LF_l5_FDCA.slice_att.log_diag
   â”œâ”€ Features: 1
   â”œâ”€ Mean Importance: 0.0000
   â”œâ”€ Max Importance: 0.0000
   â”œâ”€ Min Importance: 0.0000
   â””â”€ Top-5 Important Features: [0]
      â””â”€ Top-5 Values: ['0.0000']

ðŸ“Š Layer: LF_l5_FDCA.slice_att.factor
   â”œâ”€ Features: 1
   â”œâ”€ Mean Importance: 0.0001
   â”œâ”€ Max Importance: 0.0001
   â”œâ”€ Min Importance: 0.0001
   â””â”€ Top-5 Important Features: [0]
      â””â”€ Top-5 Values: ['0.0001']

ðŸ“Š Layer: LF_l5_FDCA.slice_att
   â”œâ”€ Features: 1
   â”œâ”€ Mean Importance: 0.0000
   â”œâ”€ Max Importance: 0.0000
   â”œâ”€ Min Importance: 0.0000
   â””â”€ Top-5 Important Features: [0]
      â””â”€ Top-5 Values: ['0.0000']

ðŸ“Š Layer: LF_l5_FDCA
   â”œâ”€ Features: 1
   â”œâ”€ Mean Importance: 0.0000
   â”œâ”€ Max Importance: 0.0000
   â”œâ”€ Min Importance: 0.0000
   â””â”€ Top-5 Important Features: [0]
      â””â”€ Top-5 Values: ['0.0000']

ðŸ“Š Layer: HF_l4_FDCA.semantic_att
   â”œâ”€ Features: 1
   â”œâ”€ Mean Importance: 0.0836
   â”œâ”€ Max Importance: 0.0836
   â”œâ”€ Min Importance: 0.0836
   â””â”€ Top-5 Important Features: [0]
      â””â”€ Top-5 Values: ['0.0836']

ðŸ“Š Layer: HF_l4_FDCA.positional_att.conv
   â”œâ”€ Features: 1
   â”œâ”€ Mean Importance: 8.9572
   â”œâ”€ Max Importance: 8.9572
   â”œâ”€ Min Importance: 8.9572
   â””â”€ Top-5 Important Features: [0]
      â””â”€ Top-5 Values: ['8.9572']

ðŸ“Š Layer: HF_l4_FDCA.positional_att
   â”œâ”€ Features: 1
   â”œâ”€ Mean Importance: 0.0018
   â”œâ”€ Max Importance: 0.0018
   â”œâ”€ Min Importance: 0.0018
   â””â”€ Top-5 Important Features: [0]
      â””â”€ Top-5 Values: ['0.0018']

ðŸ“Š Layer: HF_l4_FDCA.slice_att.linear.0
   â”œâ”€ Features: 1
   â”œâ”€ Mean Importance: 0.0000
   â”œâ”€ Max Importance: 0.0000
   â”œâ”€ Min Importance: 0.0000
   â””â”€ Top-5 Important Features: [0]
      â””â”€ Top-5 Values: ['0.0000']

ðŸ“Š Layer: HF_l4_FDCA.slice_att.linear.1
   â”œâ”€ Features: 1
   â”œâ”€ Mean Importance: 0.0000
   â”œâ”€ Max Importance: 0.0000
   â”œâ”€ Min Importance: 0.0000
   â””â”€ Top-5 Important Features: [0]
      â””â”€ Top-5 Values: ['0.0000']

ðŸ“Š Layer: HF_l4_FDCA.slice_att.linear.2
   â”œâ”€ Features: 1
   â”œâ”€ Mean Importance: 0.0000
   â”œâ”€ Max Importance: 0.0000
   â”œâ”€ Min Importance: 0.0000
   â””â”€ Top-5 Important Features: [0]
      â””â”€ Top-5 Values: ['0.0000']

ðŸ“Š Layer: HF_l4_FDCA.slice_att.linear
   â”œâ”€ Features: 1
   â”œâ”€ Mean Importance: 0.0000
   â”œâ”€ Max Importance: 0.0000
   â”œâ”€ Min Importance: 0.0000
   â””â”€ Top-5 Important Features: [0]
      â””â”€ Top-5 Values: ['0.0000']

ðŸ“Š Layer: HF_l4_FDCA.slice_att.non_linear
   â”œâ”€ Features: 1
   â”œâ”€ Mean Importance: 0.0000
   â”œâ”€ Max Importance: 0.0000
   â”œâ”€ Min Importance: 0.0000
   â””â”€ Top-5 Important Features: [0]
      â””â”€ Top-5 Values: ['0.0000']

ðŸ“Š Layer: HF_l4_FDCA.slice_att.mean
   â”œâ”€ Features: 1
   â”œâ”€ Mean Importance: 0.0000
   â”œâ”€ Max Importance: 0.0000
   â”œâ”€ Min Importance: 0.0000
   â””â”€ Top-5 Important Features: [0]
      â””â”€ Top-5 Values: ['0.0000']

ðŸ“Š Layer: HF_l4_FDCA.slice_att.log_diag
   â”œâ”€ Features: 1
   â”œâ”€ Mean Importance: 0.0000
   â”œâ”€ Max Importance: 0.0000
   â”œâ”€ Min Importance: 0.0000
   â””â”€ Top-5 Important Features: [0]
      â””â”€ Top-5 Values: ['0.0000']

ðŸ“Š Layer: HF_l4_FDCA.slice_att.factor
   â”œâ”€ Features: 1
   â”œâ”€ Mean Importance: 0.0000
   â”œâ”€ Max Importance: 0.0000
   â”œâ”€ Min Importance: 0.0000
   â””â”€ Top-5 Important Features: [0]
      â””â”€ Top-5 Values: ['0.0000']

ðŸ“Š Layer: HF_l4_FDCA.slice_att
   â”œâ”€ Features: 1
   â”œâ”€ Mean Importance: 0.0031
   â”œâ”€ Max Importance: 0.0031
   â”œâ”€ Min Importance: 0.0031
   â””â”€ Top-5 Important Features: [0]
      â””â”€ Top-5 Values: ['0.0031']

ðŸ“Š Layer: HF_l4_FDCA
   â”œâ”€ Features: 1
   â”œâ”€ Mean Importance: 0.3514
   â”œâ”€ Max Importance: 0.3514
   â”œâ”€ Min Importance: 0.3514
   â””â”€ Top-5 Important Features: [0]
      â””â”€ Top-5 Values: ['0.3514']

ðŸ“Š Layer: HF_l5_FDCA.semantic_att
   â”œâ”€ Features: 1
   â”œâ”€ Mean Importance: 0.0721
   â”œâ”€ Max Importance: 0.0721
   â”œâ”€ Min Importance: 0.0721
   â””â”€ Top-5 Important Features: [0]
      â””â”€ Top-5 Values: ['0.0721']

ðŸ“Š Layer: HF_l5_FDCA.positional_att.conv
   â”œâ”€ Features: 1
   â”œâ”€ Mean Importance: 17.3520
   â”œâ”€ Max Importance: 17.3520
   â”œâ”€ Min Importance: 17.3520
   â””â”€ Top-5 Important Features: [0]
      â””â”€ Top-5 Values: ['17.3520']

ðŸ“Š Layer: HF_l5_FDCA.positional_att
   â”œâ”€ Features: 1
   â”œâ”€ Mean Importance: 0.0001
   â”œâ”€ Max Importance: 0.0001
   â”œâ”€ Min Importance: 0.0001
   â””â”€ Top-5 Important Features: [0]
      â””â”€ Top-5 Values: ['0.0001']

ðŸ“Š Layer: HF_l5_FDCA.slice_att.linear.0
   â”œâ”€ Features: 1
   â”œâ”€ Mean Importance: 0.0000
   â”œâ”€ Max Importance: 0.0000
   â”œâ”€ Min Importance: 0.0000
   â””â”€ Top-5 Important Features: [0]
      â””â”€ Top-5 Values: ['0.0000']

ðŸ“Š Layer: HF_l5_FDCA.slice_att.linear.1
   â”œâ”€ Features: 1
   â”œâ”€ Mean Importance: 0.0000
   â”œâ”€ Max Importance: 0.0000
   â”œâ”€ Min Importance: 0.0000
   â””â”€ Top-5 Important Features: [0]
      â””â”€ Top-5 Values: ['0.0000']

ðŸ“Š Layer: HF_l5_FDCA.slice_att.linear.2
   â”œâ”€ Features: 1
   â”œâ”€ Mean Importance: 0.0000
   â”œâ”€ Max Importance: 0.0000
   â”œâ”€ Min Importance: 0.0000
   â””â”€ Top-5 Important Features: [0]
      â””â”€ Top-5 Values: ['0.0000']

ðŸ“Š Layer: HF_l5_FDCA.slice_att.linear
   â”œâ”€ Features: 1
   â”œâ”€ Mean Importance: 0.0000
   â”œâ”€ Max Importance: 0.0000
   â”œâ”€ Min Importance: 0.0000
   â””â”€ Top-5 Important Features: [0]
      â””â”€ Top-5 Values: ['0.0000']

ðŸ“Š Layer: HF_l5_FDCA.slice_att.non_linear
   â”œâ”€ Features: 1
   â”œâ”€ Mean Importance: 0.0000
   â”œâ”€ Max Importance: 0.0000
   â”œâ”€ Min Importance: 0.0000
   â””â”€ Top-5 Important Features: [0]
      â””â”€ Top-5 Values: ['0.0000']

ðŸ“Š Layer: HF_l5_FDCA.slice_att.mean
   â”œâ”€ Features: 1
   â”œâ”€ Mean Importance: 0.0000
   â”œâ”€ Max Importance: 0.0000
   â”œâ”€ Min Importance: 0.0000
   â””â”€ Top-5 Important Features: [0]
      â””â”€ Top-5 Values: ['0.0000']

ðŸ“Š Layer: HF_l5_FDCA.slice_att.log_diag
   â”œâ”€ Features: 1
   â”œâ”€ Mean Importance: 0.0000
   â”œâ”€ Max Importance: 0.0000
   â”œâ”€ Min Importance: 0.0000
   â””â”€ Top-5 Important Features: [0]
      â””â”€ Top-5 Values: ['0.0000']

ðŸ“Š Layer: HF_l5_FDCA.slice_att.factor
   â”œâ”€ Features: 1
   â”œâ”€ Mean Importance: 0.0000
   â”œâ”€ Max Importance: 0.0000
   â”œâ”€ Min Importance: 0.0000
   â””â”€ Top-5 Important Features: [0]
      â””â”€ Top-5 Values: ['0.0000']

ðŸ“Š Layer: HF_l5_FDCA.slice_att
   â”œâ”€ Features: 1
   â”œâ”€ Mean Importance: 0.0003
   â”œâ”€ Max Importance: 0.0003
   â”œâ”€ Min Importance: 0.0003
   â””â”€ Top-5 Important Features: [0]
      â””â”€ Top-5 Values: ['0.0003']

ðŸ“Š Layer: HF_l5_FDCA
   â”œâ”€ Features: 1
   â”œâ”€ Mean Importance: 0.0004
   â”œâ”€ Max Importance: 0.0004
   â”œâ”€ Min Importance: 0.0004
   â””â”€ Top-5 Important Features: [0]
      â””â”€ Top-5 Values: ['0.0004']

======================================================================
âœ“ Mechanistic analysis complete

[3] Generating Grad-CAM...
Warning: Failed to generate CAM for class 0: element 0 of tensors does not require grad and does not have a grad_fn
Warning: Failed to generate CAM for class 1: element 0 of tensors does not require grad and does not have a grad_fn
Warning: Failed to generate CAM for class 2: element 0 of tensors does not require grad and does not have a grad_fn
Warning: Failed to generate CAM for class 3: element 0 of tensors does not require grad and does not have a grad_fn
[4] Analyzing frequency components...
âœ“ Saved: outputs/xai_2025-11-15_17-25-23/freq_component/sample_0017_freq_comp.png
âœ“ Evaluation complete for sample_0017
Evaluating:  47%|####7     | 18/38 [05:00<05:29, 16.47s/it]
[1] Getting primary prediction...

[METRICS FOR sample_0018]
==================================================
class_0: Dice=0.9918, IoU=0.9837
class_1: Dice=0.6611, IoU=0.4937
class_2: Dice=0.5253, IoU=0.3562
class_3: Dice=0.6018, IoU=0.4304
==================================================

[2] Generating attention maps...
Clipping input data to the valid range for imshow with RGB data ([0..1] for floats or [0..255] for integers).
Clipping input data to the valid range for imshow with RGB data ([0..1] for floats or [0..255] for integers).
âœ“ Saved: outputs/xai_2025-11-15_17-25-23/attention/sample_0018_attention.png

[MECHANISTIC INTERPRETABILITY ANALYSIS]
======================================================================
Sample: sample_0018
======================================================================

ðŸ“Š Layer: LF_l4_FDCA.semantic_att
   â”œâ”€ Features: 1
   â”œâ”€ Mean Importance: 0.1147
   â”œâ”€ Max Importance: 0.1147
   â”œâ”€ Min Importance: 0.1147
   â””â”€ Top-5 Important Features: [0]
      â””â”€ Top-5 Values: ['0.1147']

ðŸ“Š Layer: LF_l4_FDCA.positional_att.conv
   â”œâ”€ Features: 1
   â”œâ”€ Mean Importance: 238.5341
   â”œâ”€ Max Importance: 238.5341
   â”œâ”€ Min Importance: 238.5341
   â””â”€ Top-5 Important Features: [0]
      â””â”€ Top-5 Values: ['238.5341']

ðŸ“Š Layer: LF_l4_FDCA.positional_att
   â”œâ”€ Features: 1
   â”œâ”€ Mean Importance: 43.6002
   â”œâ”€ Max Importance: 43.6002
   â”œâ”€ Min Importance: 43.6002
   â””â”€ Top-5 Important Features: [0]
      â””â”€ Top-5 Values: ['43.6002']

ðŸ“Š Layer: LF_l4_FDCA.slice_att.linear.0
   â”œâ”€ Features: 1
   â”œâ”€ Mean Importance: 68.8041
   â”œâ”€ Max Importance: 68.8041
   â”œâ”€ Min Importance: 68.8041
   â””â”€ Top-5 Important Features: [0]
      â””â”€ Top-5 Values: ['68.8041']

ðŸ“Š Layer: LF_l4_FDCA.slice_att.linear.1
   â”œâ”€ Features: 1
   â”œâ”€ Mean Importance: 58.3679
   â”œâ”€ Max Importance: 58.3679
   â”œâ”€ Min Importance: 58.3679
   â””â”€ Top-5 Important Features: [0]
      â””â”€ Top-5 Values: ['58.3679']

ðŸ“Š Layer: LF_l4_FDCA.slice_att.linear.2
   â”œâ”€ Features: 1
   â”œâ”€ Mean Importance: 55.3852
   â”œâ”€ Max Importance: 55.3852
   â”œâ”€ Min Importance: 55.3852
   â””â”€ Top-5 Important Features: [0]
      â””â”€ Top-5 Values: ['55.3852']

ðŸ“Š Layer: LF_l4_FDCA.slice_att.linear
   â”œâ”€ Features: 1
   â”œâ”€ Mean Importance: 55.3852
   â”œâ”€ Max Importance: 55.3852
   â”œâ”€ Min Importance: 55.3852
   â””â”€ Top-5 Important Features: [0]
      â””â”€ Top-5 Values: ['55.3852']

ðŸ“Š Layer: LF_l4_FDCA.slice_att.non_linear
   â”œâ”€ Features: 1
   â”œâ”€ Mean Importance: 23763978.0000
   â”œâ”€ Max Importance: 23763978.0000
   â”œâ”€ Min Importance: 23763978.0000
   â””â”€ Top-5 Important Features: [0]
      â””â”€ Top-5 Values: ['23763978.0000']

ðŸ“Š Layer: LF_l4_FDCA.slice_att.mean
   â”œâ”€ Features: 1
   â”œâ”€ Mean Importance: 94944816.0000
   â”œâ”€ Max Importance: 94944816.0000
   â”œâ”€ Min Importance: 94944816.0000
   â””â”€ Top-5 Important Features: [0]
      â””â”€ Top-5 Values: ['94944816.0000']

ðŸ“Š Layer: LF_l4_FDCA.slice_att.log_diag
   â”œâ”€ Features: 1
   â”œâ”€ Mean Importance: 5884.5762
   â”œâ”€ Max Importance: 5884.5762
   â”œâ”€ Min Importance: 5884.5762
   â””â”€ Top-5 Important Features: [0]
      â””â”€ Top-5 Values: ['5884.5762']

ðŸ“Š Layer: LF_l4_FDCA.slice_att.factor
   â”œâ”€ Features: 1
   â”œâ”€ Mean Importance: 36776468.0000
   â”œâ”€ Max Importance: 36776468.0000
   â”œâ”€ Min Importance: 36776468.0000
   â””â”€ Top-5 Important Features: [0]
      â””â”€ Top-5 Values: ['36776468.0000']

ðŸ“Š Layer: LF_l4_FDCA.slice_att
   â”œâ”€ Features: 1
   â”œâ”€ Mean Importance: 15343784.0000
   â”œâ”€ Max Importance: 15343784.0000
   â”œâ”€ Min Importance: 15343784.0000
   â””â”€ Top-5 Important Features: [0]
      â””â”€ Top-5 Values: ['15343784.0000']

ðŸ“Š Layer: LF_l4_FDCA
   â”œâ”€ Features: 1
   â”œâ”€ Mean Importance: 1974344788924694528.0000
   â”œâ”€ Max Importance: 1974344788924694528.0000
   â”œâ”€ Min Importance: 1974344788924694528.0000
   â””â”€ Top-5 Important Features: [0]
      â””â”€ Top-5 Values: ['1974344788924694528.0000']

ðŸ“Š Layer: LF_l5_FDCA.semantic_att
   â”œâ”€ Features: 1
   â”œâ”€ Mean Importance: 0.0786
   â”œâ”€ Max Importance: 0.0786
   â”œâ”€ Min Importance: 0.0786
   â””â”€ Top-5 Important Features: [0]
      â””â”€ Top-5 Values: ['0.0786']

ðŸ“Š Layer: LF_l5_FDCA.positional_att.conv
   â”œâ”€ Features: 1
   â”œâ”€ Mean Importance: 71.7318
   â”œâ”€ Max Importance: 71.7318
   â”œâ”€ Min Importance: 71.7318
   â””â”€ Top-5 Important Features: [0]
      â””â”€ Top-5 Values: ['71.7318']

ðŸ“Š Layer: LF_l5_FDCA.positional_att
   â”œâ”€ Features: 1
   â”œâ”€ Mean Importance: 0.0000
   â”œâ”€ Max Importance: 0.0000
   â”œâ”€ Min Importance: 0.0000
   â””â”€ Top-5 Important Features: [0]
      â””â”€ Top-5 Values: ['0.0000']

ðŸ“Š Layer: LF_l5_FDCA.slice_att.linear.0
   â”œâ”€ Features: 1
   â”œâ”€ Mean Importance: 0.0000
   â”œâ”€ Max Importance: 0.0000
   â”œâ”€ Min Importance: 0.0000
   â””â”€ Top-5 Important Features: [0]
      â””â”€ Top-5 Values: ['0.0000']

ðŸ“Š Layer: LF_l5_FDCA.slice_att.linear.1
   â”œâ”€ Features: 1
   â”œâ”€ Mean Importance: 0.0000
   â”œâ”€ Max Importance: 0.0000
   â”œâ”€ Min Importance: 0.0000
   â””â”€ Top-5 Important Features: [0]
      â””â”€ Top-5 Values: ['0.0000']

ðŸ“Š Layer: LF_l5_FDCA.slice_att.linear.2
   â”œâ”€ Features: 1
   â”œâ”€ Mean Importance: 0.0000
   â”œâ”€ Max Importance: 0.0000
   â”œâ”€ Min Importance: 0.0000
   â””â”€ Top-5 Important Features: [0]
      â””â”€ Top-5 Values: ['0.0000']

ðŸ“Š Layer: LF_l5_FDCA.slice_att.linear
   â”œâ”€ Features: 1
   â”œâ”€ Mean Importance: 0.0000
   â”œâ”€ Max Importance: 0.0000
   â”œâ”€ Min Importance: 0.0000
   â””â”€ Top-5 Important Features: [0]
      â””â”€ Top-5 Values: ['0.0000']

ðŸ“Š Layer: LF_l5_FDCA.slice_att.non_linear
   â”œâ”€ Features: 1
   â”œâ”€ Mean Importance: 0.0000
   â”œâ”€ Max Importance: 0.0000
   â”œâ”€ Min Importance: 0.0000
   â””â”€ Top-5 Important Features: [0]
      â””â”€ Top-5 Values: ['0.0000']

ðŸ“Š Layer: LF_l5_FDCA.slice_att.mean
   â”œâ”€ Features: 1
   â”œâ”€ Mean Importance: 0.0017
   â”œâ”€ Max Importance: 0.0017
   â”œâ”€ Min Importance: 0.0017
   â””â”€ Top-5 Important Features: [0]
      â””â”€ Top-5 Values: ['0.0017']

ðŸ“Š Layer: LF_l5_FDCA.slice_att.log_diag
   â”œâ”€ Features: 1
   â”œâ”€ Mean Importance: 0.0000
   â”œâ”€ Max Importance: 0.0000
   â”œâ”€ Min Importance: 0.0000
   â””â”€ Top-5 Important Features: [0]
      â””â”€ Top-5 Values: ['0.0000']

ðŸ“Š Layer: LF_l5_FDCA.slice_att.factor
   â”œâ”€ Features: 1
   â”œâ”€ Mean Importance: 0.0001
   â”œâ”€ Max Importance: 0.0001
   â”œâ”€ Min Importance: 0.0001
   â””â”€ Top-5 Important Features: [0]
      â””â”€ Top-5 Values: ['0.0001']

ðŸ“Š Layer: LF_l5_FDCA.slice_att
   â”œâ”€ Features: 1
   â”œâ”€ Mean Importance: 0.0000
   â”œâ”€ Max Importance: 0.0000
   â”œâ”€ Min Importance: 0.0000
   â””â”€ Top-5 Important Features: [0]
      â””â”€ Top-5 Values: ['0.0000']

ðŸ“Š Layer: LF_l5_FDCA
   â”œâ”€ Features: 1
   â”œâ”€ Mean Importance: 0.0000
   â”œâ”€ Max Importance: 0.0000
   â”œâ”€ Min Importance: 0.0000
   â””â”€ Top-5 Important Features: [0]
      â””â”€ Top-5 Values: ['0.0000']

ðŸ“Š Layer: HF_l4_FDCA.semantic_att
   â”œâ”€ Features: 1
   â”œâ”€ Mean Importance: 0.0816
   â”œâ”€ Max Importance: 0.0816
   â”œâ”€ Min Importance: 0.0816
   â””â”€ Top-5 Important Features: [0]
      â””â”€ Top-5 Values: ['0.0816']

ðŸ“Š Layer: HF_l4_FDCA.positional_att.conv
   â”œâ”€ Features: 1
   â”œâ”€ Mean Importance: 9.1420
   â”œâ”€ Max Importance: 9.1420
   â”œâ”€ Min Importance: 9.1420
   â””â”€ Top-5 Important Features: [0]
      â””â”€ Top-5 Values: ['9.1420']

ðŸ“Š Layer: HF_l4_FDCA.positional_att
   â”œâ”€ Features: 1
   â”œâ”€ Mean Importance: 0.0017
   â”œâ”€ Max Importance: 0.0017
   â”œâ”€ Min Importance: 0.0017
   â””â”€ Top-5 Important Features: [0]
      â””â”€ Top-5 Values: ['0.0017']

ðŸ“Š Layer: HF_l4_FDCA.slice_att.linear.0
   â”œâ”€ Features: 1
   â”œâ”€ Mean Importance: 0.0000
   â”œâ”€ Max Importance: 0.0000
   â”œâ”€ Min Importance: 0.0000
   â””â”€ Top-5 Important Features: [0]
      â””â”€ Top-5 Values: ['0.0000']

ðŸ“Š Layer: HF_l4_FDCA.slice_att.linear.1
   â”œâ”€ Features: 1
   â”œâ”€ Mean Importance: 0.0000
   â”œâ”€ Max Importance: 0.0000
   â”œâ”€ Min Importance: 0.0000
   â””â”€ Top-5 Important Features: [0]
      â””â”€ Top-5 Values: ['0.0000']

ðŸ“Š Layer: HF_l4_FDCA.slice_att.linear.2
   â”œâ”€ Features: 1
   â”œâ”€ Mean Importance: 0.0000
   â”œâ”€ Max Importance: 0.0000
   â”œâ”€ Min Importance: 0.0000
   â””â”€ Top-5 Important Features: [0]
      â””â”€ Top-5 Values: ['0.0000']

ðŸ“Š Layer: HF_l4_FDCA.slice_att.linear
   â”œâ”€ Features: 1
   â”œâ”€ Mean Importance: 0.0000
   â”œâ”€ Max Importance: 0.0000
   â”œâ”€ Min Importance: 0.0000
   â””â”€ Top-5 Important Features: [0]
      â””â”€ Top-5 Values: ['0.0000']

ðŸ“Š Layer: HF_l4_FDCA.slice_att.non_linear
   â”œâ”€ Features: 1
   â”œâ”€ Mean Importance: 0.0000
   â”œâ”€ Max Importance: 0.0000
   â”œâ”€ Min Importance: 0.0000
   â””â”€ Top-5 Important Features: [0]
      â””â”€ Top-5 Values: ['0.0000']

ðŸ“Š Layer: HF_l4_FDCA.slice_att.mean
   â”œâ”€ Features: 1
   â”œâ”€ Mean Importance: 0.0000
   â”œâ”€ Max Importance: 0.0000
   â”œâ”€ Min Importance: 0.0000
   â””â”€ Top-5 Important Features: [0]
      â””â”€ Top-5 Values: ['0.0000']

ðŸ“Š Layer: HF_l4_FDCA.slice_att.log_diag
   â”œâ”€ Features: 1
   â”œâ”€ Mean Importance: 0.0000
   â”œâ”€ Max Importance: 0.0000
   â”œâ”€ Min Importance: 0.0000
   â””â”€ Top-5 Important Features: [0]
      â””â”€ Top-5 Values: ['0.0000']

ðŸ“Š Layer: HF_l4_FDCA.slice_att.factor
   â”œâ”€ Features: 1
   â”œâ”€ Mean Importance: 0.0000
   â”œâ”€ Max Importance: 0.0000
   â”œâ”€ Min Importance: 0.0000
   â””â”€ Top-5 Important Features: [0]
      â””â”€ Top-5 Values: ['0.0000']

ðŸ“Š Layer: HF_l4_FDCA.slice_att
   â”œâ”€ Features: 1
   â”œâ”€ Mean Importance: 0.0064
   â”œâ”€ Max Importance: 0.0064
   â”œâ”€ Min Importance: 0.0064
   â””â”€ Top-5 Important Features: [0]
      â””â”€ Top-5 Values: ['0.0064']

ðŸ“Š Layer: HF_l4_FDCA
   â”œâ”€ Features: 1
   â”œâ”€ Mean Importance: 1.0553
   â”œâ”€ Max Importance: 1.0553
   â”œâ”€ Min Importance: 1.0553
   â””â”€ Top-5 Important Features: [0]
      â””â”€ Top-5 Values: ['1.0553']

ðŸ“Š Layer: HF_l5_FDCA.semantic_att
   â”œâ”€ Features: 1
   â”œâ”€ Mean Importance: 0.0715
   â”œâ”€ Max Importance: 0.0715
   â”œâ”€ Min Importance: 0.0715
   â””â”€ Top-5 Important Features: [0]
      â””â”€ Top-5 Values: ['0.0715']

ðŸ“Š Layer: HF_l5_FDCA.positional_att.conv
   â”œâ”€ Features: 1
   â”œâ”€ Mean Importance: 15.0673
   â”œâ”€ Max Importance: 15.0673
   â”œâ”€ Min Importance: 15.0673
   â””â”€ Top-5 Important Features: [0]
      â””â”€ Top-5 Values: ['15.0673']

ðŸ“Š Layer: HF_l5_FDCA.positional_att
   â”œâ”€ Features: 1
   â”œâ”€ Mean Importance: 0.0001
   â”œâ”€ Max Importance: 0.0001
   â”œâ”€ Min Importance: 0.0001
   â””â”€ Top-5 Important Features: [0]
      â””â”€ Top-5 Values: ['0.0001']

ðŸ“Š Layer: HF_l5_FDCA.slice_att.linear.0
   â”œâ”€ Features: 1
   â”œâ”€ Mean Importance: 0.0000
   â”œâ”€ Max Importance: 0.0000
   â”œâ”€ Min Importance: 0.0000
   â””â”€ Top-5 Important Features: [0]
      â””â”€ Top-5 Values: ['0.0000']

ðŸ“Š Layer: HF_l5_FDCA.slice_att.linear.1
   â”œâ”€ Features: 1
   â”œâ”€ Mean Importance: 0.0000
   â”œâ”€ Max Importance: 0.0000
   â”œâ”€ Min Importance: 0.0000
   â””â”€ Top-5 Important Features: [0]
      â””â”€ Top-5 Values: ['0.0000']

ðŸ“Š Layer: HF_l5_FDCA.slice_att.linear.2
   â”œâ”€ Features: 1
   â”œâ”€ Mean Importance: 0.0000
   â”œâ”€ Max Importance: 0.0000
   â”œâ”€ Min Importance: 0.0000
   â””â”€ Top-5 Important Features: [0]
      â””â”€ Top-5 Values: ['0.0000']

ðŸ“Š Layer: HF_l5_FDCA.slice_att.linear
   â”œâ”€ Features: 1
   â”œâ”€ Mean Importance: 0.0000
   â”œâ”€ Max Importance: 0.0000
   â”œâ”€ Min Importance: 0.0000
   â””â”€ Top-5 Important Features: [0]
      â””â”€ Top-5 Values: ['0.0000']

ðŸ“Š Layer: HF_l5_FDCA.slice_att.non_linear
   â”œâ”€ Features: 1
   â”œâ”€ Mean Importance: 0.0000
   â”œâ”€ Max Importance: 0.0000
   â”œâ”€ Min Importance: 0.0000
   â””â”€ Top-5 Important Features: [0]
      â””â”€ Top-5 Values: ['0.0000']

ðŸ“Š Layer: HF_l5_FDCA.slice_att.mean
   â”œâ”€ Features: 1
   â”œâ”€ Mean Importance: 0.0000
   â”œâ”€ Max Importance: 0.0000
   â”œâ”€ Min Importance: 0.0000
   â””â”€ Top-5 Important Features: [0]
      â””â”€ Top-5 Values: ['0.0000']

ðŸ“Š Layer: HF_l5_FDCA.slice_att.log_diag
   â”œâ”€ Features: 1
   â”œâ”€ Mean Importance: 0.0000
   â”œâ”€ Max Importance: 0.0000
   â”œâ”€ Min Importance: 0.0000
   â””â”€ Top-5 Important Features: [0]
      â””â”€ Top-5 Values: ['0.0000']

ðŸ“Š Layer: HF_l5_FDCA.slice_att.factor
   â”œâ”€ Features: 1
   â”œâ”€ Mean Importance: 0.0000
   â”œâ”€ Max Importance: 0.0000
   â”œâ”€ Min Importance: 0.0000
   â””â”€ Top-5 Important Features: [0]
      â””â”€ Top-5 Values: ['0.0000']

ðŸ“Š Layer: HF_l5_FDCA.slice_att
   â”œâ”€ Features: 1
   â”œâ”€ Mean Importance: 0.0000
   â”œâ”€ Max Importance: 0.0000
   â”œâ”€ Min Importance: 0.0000
   â””â”€ Top-5 Important Features: [0]
      â””â”€ Top-5 Values: ['0.0000']

ðŸ“Š Layer: HF_l5_FDCA
   â”œâ”€ Features: 1
   â”œâ”€ Mean Importance: 0.0001
   â”œâ”€ Max Importance: 0.0001
   â”œâ”€ Min Importance: 0.0001
   â””â”€ Top-5 Important Features: [0]
      â””â”€ Top-5 Values: ['0.0001']

======================================================================
âœ“ Mechanistic analysis complete

[3] Generating Grad-CAM...
Warning: Failed to generate CAM for class 0: element 0 of tensors does not require grad and does not have a grad_fn
Warning: Failed to generate CAM for class 1: element 0 of tensors does not require grad and does not have a grad_fn
Warning: Failed to generate CAM for class 2: element 0 of tensors does not require grad and does not have a grad_fn
Warning: Failed to generate CAM for class 3: element 0 of tensors does not require grad and does not have a grad_fn
[4] Analyzing frequency components...
âœ“ Saved: outputs/xai_2025-11-15_17-25-23/freq_component/sample_0018_freq_comp.png
âœ“ Evaluation complete for sample_0018
Evaluating:  50%|#####     | 19/38 [05:17<05:11, 16.39s/it]
[1] Getting primary prediction...

[METRICS FOR sample_0019]
==================================================
class_0: Dice=0.9968, IoU=0.9937
class_1: Dice=0.8787, IoU=0.7837
class_2: Dice=0.9359, IoU=0.8796
class_3: Dice=0.9121, IoU=0.8384
==================================================

[2] Generating attention maps...
Clipping input data to the valid range for imshow with RGB data ([0..1] for floats or [0..255] for integers).
Clipping input data to the valid range for imshow with RGB data ([0..1] for floats or [0..255] for integers).
âœ“ Saved: outputs/xai_2025-11-15_17-25-23/attention/sample_0019_attention.png

[MECHANISTIC INTERPRETABILITY ANALYSIS]
======================================================================
Sample: sample_0019
======================================================================

ðŸ“Š Layer: LF_l4_FDCA.semantic_att
   â”œâ”€ Features: 1
   â”œâ”€ Mean Importance: 0.1184
   â”œâ”€ Max Importance: 0.1184
   â”œâ”€ Min Importance: 0.1184
   â””â”€ Top-5 Important Features: [0]
      â””â”€ Top-5 Values: ['0.1184']

ðŸ“Š Layer: LF_l4_FDCA.positional_att.conv
   â”œâ”€ Features: 1
   â”œâ”€ Mean Importance: 264.7567
   â”œâ”€ Max Importance: 264.7567
   â”œâ”€ Min Importance: 264.7567
   â””â”€ Top-5 Important Features: [0]
      â””â”€ Top-5 Values: ['264.7567']

ðŸ“Š Layer: LF_l4_FDCA.positional_att
   â”œâ”€ Features: 1
   â”œâ”€ Mean Importance: 44.7213
   â”œâ”€ Max Importance: 44.7213
   â”œâ”€ Min Importance: 44.7213
   â””â”€ Top-5 Important Features: [0]
      â””â”€ Top-5 Values: ['44.7213']

ðŸ“Š Layer: LF_l4_FDCA.slice_att.linear.0
   â”œâ”€ Features: 1
   â”œâ”€ Mean Importance: 93.0310
   â”œâ”€ Max Importance: 93.0310
   â”œâ”€ Min Importance: 93.0310
   â””â”€ Top-5 Important Features: [0]
      â””â”€ Top-5 Values: ['93.0310']

ðŸ“Š Layer: LF_l4_FDCA.slice_att.linear.1
   â”œâ”€ Features: 1
   â”œâ”€ Mean Importance: 78.9145
   â”œâ”€ Max Importance: 78.9145
   â”œâ”€ Min Importance: 78.9145
   â””â”€ Top-5 Important Features: [0]
      â””â”€ Top-5 Values: ['78.9145']

ðŸ“Š Layer: LF_l4_FDCA.slice_att.linear.2
   â”œâ”€ Features: 1
   â”œâ”€ Mean Importance: 74.8974
   â”œâ”€ Max Importance: 74.8974
   â”œâ”€ Min Importance: 74.8974
   â””â”€ Top-5 Important Features: [0]
      â””â”€ Top-5 Values: ['74.8974']

ðŸ“Š Layer: LF_l4_FDCA.slice_att.linear
   â”œâ”€ Features: 1
   â”œâ”€ Mean Importance: 74.8974
   â”œâ”€ Max Importance: 74.8974
   â”œâ”€ Min Importance: 74.8974
   â””â”€ Top-5 Important Features: [0]
      â””â”€ Top-5 Values: ['74.8974']

ðŸ“Š Layer: LF_l4_FDCA.slice_att.non_linear
   â”œâ”€ Features: 1
   â”œâ”€ Mean Importance: 29446458.0000
   â”œâ”€ Max Importance: 29446458.0000
   â”œâ”€ Min Importance: 29446458.0000
   â””â”€ Top-5 Important Features: [0]
      â””â”€ Top-5 Values: ['29446458.0000']

ðŸ“Š Layer: LF_l4_FDCA.slice_att.mean
   â”œâ”€ Features: 1
   â”œâ”€ Mean Importance: 117664048.0000
   â”œâ”€ Max Importance: 117664048.0000
   â”œâ”€ Min Importance: 117664048.0000
   â””â”€ Top-5 Important Features: [0]
      â””â”€ Top-5 Values: ['117664048.0000']

ðŸ“Š Layer: LF_l4_FDCA.slice_att.log_diag
   â”œâ”€ Features: 1
   â”œâ”€ Mean Importance: 7292.5425
   â”œâ”€ Max Importance: 7292.5425
   â”œâ”€ Min Importance: 7292.5425
   â””â”€ Top-5 Important Features: [0]
      â””â”€ Top-5 Values: ['7292.5425']

ðŸ“Š Layer: LF_l4_FDCA.slice_att.factor
   â”œâ”€ Features: 1
   â”œâ”€ Mean Importance: 45576852.0000
   â”œâ”€ Max Importance: 45576852.0000
   â”œâ”€ Min Importance: 45576852.0000
   â””â”€ Top-5 Important Features: [0]
      â””â”€ Top-5 Values: ['45576852.0000']

ðŸ“Š Layer: LF_l4_FDCA.slice_att
   â”œâ”€ Features: 1
   â”œâ”€ Mean Importance: 20223288.0000
   â”œâ”€ Max Importance: 20223288.0000
   â”œâ”€ Min Importance: 20223288.0000
   â””â”€ Top-5 Important Features: [0]
      â””â”€ Top-5 Values: ['20223288.0000']

ðŸ“Š Layer: LF_l4_FDCA
   â”œâ”€ Features: 1
   â”œâ”€ Mean Importance: 3537597573386731520.0000
   â”œâ”€ Max Importance: 3537597573386731520.0000
   â”œâ”€ Min Importance: 3537597573386731520.0000
   â””â”€ Top-5 Important Features: [0]
      â””â”€ Top-5 Values: ['3537597573386731520.0000']

ðŸ“Š Layer: LF_l5_FDCA.semantic_att
   â”œâ”€ Features: 1
   â”œâ”€ Mean Importance: 0.0829
   â”œâ”€ Max Importance: 0.0829
   â”œâ”€ Min Importance: 0.0829
   â””â”€ Top-5 Important Features: [0]
      â””â”€ Top-5 Values: ['0.0829']

ðŸ“Š Layer: LF_l5_FDCA.positional_att.conv
   â”œâ”€ Features: 1
   â”œâ”€ Mean Importance: 71.8700
   â”œâ”€ Max Importance: 71.8700
   â”œâ”€ Min Importance: 71.8700
   â””â”€ Top-5 Important Features: [0]
      â””â”€ Top-5 Values: ['71.8700']

ðŸ“Š Layer: LF_l5_FDCA.positional_att
   â”œâ”€ Features: 1
   â”œâ”€ Mean Importance: 0.0000
   â”œâ”€ Max Importance: 0.0000
   â”œâ”€ Min Importance: 0.0000
   â””â”€ Top-5 Important Features: [0]
      â””â”€ Top-5 Values: ['0.0000']

ðŸ“Š Layer: LF_l5_FDCA.slice_att.linear.0
   â”œâ”€ Features: 1
   â”œâ”€ Mean Importance: 0.0000
   â”œâ”€ Max Importance: 0.0000
   â”œâ”€ Min Importance: 0.0000
   â””â”€ Top-5 Important Features: [0]
      â””â”€ Top-5 Values: ['0.0000']

ðŸ“Š Layer: LF_l5_FDCA.slice_att.linear.1
   â”œâ”€ Features: 1
   â”œâ”€ Mean Importance: 0.0000
   â”œâ”€ Max Importance: 0.0000
   â”œâ”€ Min Importance: 0.0000
   â””â”€ Top-5 Important Features: [0]
      â””â”€ Top-5 Values: ['0.0000']

ðŸ“Š Layer: LF_l5_FDCA.slice_att.linear.2
   â”œâ”€ Features: 1
   â”œâ”€ Mean Importance: 0.0000
   â”œâ”€ Max Importance: 0.0000
   â”œâ”€ Min Importance: 0.0000
   â””â”€ Top-5 Important Features: [0]
      â””â”€ Top-5 Values: ['0.0000']

ðŸ“Š Layer: LF_l5_FDCA.slice_att.linear
   â”œâ”€ Features: 1
   â”œâ”€ Mean Importance: 0.0000
   â”œâ”€ Max Importance: 0.0000
   â”œâ”€ Min Importance: 0.0000
   â””â”€ Top-5 Important Features: [0]
      â””â”€ Top-5 Values: ['0.0000']

ðŸ“Š Layer: LF_l5_FDCA.slice_att.non_linear
   â”œâ”€ Features: 1
   â”œâ”€ Mean Importance: 0.0000
   â”œâ”€ Max Importance: 0.0000
   â”œâ”€ Min Importance: 0.0000
   â””â”€ Top-5 Important Features: [0]
      â””â”€ Top-5 Values: ['0.0000']

ðŸ“Š Layer: LF_l5_FDCA.slice_att.mean
   â”œâ”€ Features: 1
   â”œâ”€ Mean Importance: 0.0017
   â”œâ”€ Max Importance: 0.0017
   â”œâ”€ Min Importance: 0.0017
   â””â”€ Top-5 Important Features: [0]
      â””â”€ Top-5 Values: ['0.0017']

ðŸ“Š Layer: LF_l5_FDCA.slice_att.log_diag
   â”œâ”€ Features: 1
   â”œâ”€ Mean Importance: 0.0000
   â”œâ”€ Max Importance: 0.0000
   â”œâ”€ Min Importance: 0.0000
   â””â”€ Top-5 Important Features: [0]
      â””â”€ Top-5 Values: ['0.0000']

ðŸ“Š Layer: LF_l5_FDCA.slice_att.factor
   â”œâ”€ Features: 1
   â”œâ”€ Mean Importance: 0.0001
   â”œâ”€ Max Importance: 0.0001
   â”œâ”€ Min Importance: 0.0001
   â””â”€ Top-5 Important Features: [0]
      â””â”€ Top-5 Values: ['0.0001']

ðŸ“Š Layer: LF_l5_FDCA.slice_att
   â”œâ”€ Features: 1
   â”œâ”€ Mean Importance: 0.0000
   â”œâ”€ Max Importance: 0.0000
   â”œâ”€ Min Importance: 0.0000
   â””â”€ Top-5 Important Features: [0]
      â””â”€ Top-5 Values: ['0.0000']

ðŸ“Š Layer: LF_l5_FDCA
   â”œâ”€ Features: 1
   â”œâ”€ Mean Importance: 0.0000
   â”œâ”€ Max Importance: 0.0000
   â”œâ”€ Min Importance: 0.0000
   â””â”€ Top-5 Important Features: [0]
      â””â”€ Top-5 Values: ['0.0000']

ðŸ“Š Layer: HF_l4_FDCA.semantic_att
   â”œâ”€ Features: 1
   â”œâ”€ Mean Importance: 0.0831
   â”œâ”€ Max Importance: 0.0831
   â”œâ”€ Min Importance: 0.0831
   â””â”€ Top-5 Important Features: [0]
      â””â”€ Top-5 Values: ['0.0831']

ðŸ“Š Layer: HF_l4_FDCA.positional_att.conv
   â”œâ”€ Features: 1
   â”œâ”€ Mean Importance: 9.1252
   â”œâ”€ Max Importance: 9.1252
   â”œâ”€ Min Importance: 9.1252
   â””â”€ Top-5 Important Features: [0]
      â””â”€ Top-5 Values: ['9.1252']

ðŸ“Š Layer: HF_l4_FDCA.positional_att
   â”œâ”€ Features: 1
   â”œâ”€ Mean Importance: 0.0019
   â”œâ”€ Max Importance: 0.0019
   â”œâ”€ Min Importance: 0.0019
   â””â”€ Top-5 Important Features: [0]
      â””â”€ Top-5 Values: ['0.0019']

ðŸ“Š Layer: HF_l4_FDCA.slice_att.linear.0
   â”œâ”€ Features: 1
   â”œâ”€ Mean Importance: 0.0000
   â”œâ”€ Max Importance: 0.0000
   â”œâ”€ Min Importance: 0.0000
   â””â”€ Top-5 Important Features: [0]
      â””â”€ Top-5 Values: ['0.0000']

ðŸ“Š Layer: HF_l4_FDCA.slice_att.linear.1
   â”œâ”€ Features: 1
   â”œâ”€ Mean Importance: 0.0000
   â”œâ”€ Max Importance: 0.0000
   â”œâ”€ Min Importance: 0.0000
   â””â”€ Top-5 Important Features: [0]
      â””â”€ Top-5 Values: ['0.0000']

ðŸ“Š Layer: HF_l4_FDCA.slice_att.linear.2
   â”œâ”€ Features: 1
   â”œâ”€ Mean Importance: 0.0000
   â”œâ”€ Max Importance: 0.0000
   â”œâ”€ Min Importance: 0.0000
   â””â”€ Top-5 Important Features: [0]
      â””â”€ Top-5 Values: ['0.0000']

ðŸ“Š Layer: HF_l4_FDCA.slice_att.linear
   â”œâ”€ Features: 1
   â”œâ”€ Mean Importance: 0.0000
   â”œâ”€ Max Importance: 0.0000
   â”œâ”€ Min Importance: 0.0000
   â””â”€ Top-5 Important Features: [0]
      â””â”€ Top-5 Values: ['0.0000']

ðŸ“Š Layer: HF_l4_FDCA.slice_att.non_linear
   â”œâ”€ Features: 1
   â”œâ”€ Mean Importance: 0.0000
   â”œâ”€ Max Importance: 0.0000
   â”œâ”€ Min Importance: 0.0000
   â””â”€ Top-5 Important Features: [0]
      â””â”€ Top-5 Values: ['0.0000']

ðŸ“Š Layer: HF_l4_FDCA.slice_att.mean
   â”œâ”€ Features: 1
   â”œâ”€ Mean Importance: 0.0000
   â”œâ”€ Max Importance: 0.0000
   â”œâ”€ Min Importance: 0.0000
   â””â”€ Top-5 Important Features: [0]
      â””â”€ Top-5 Values: ['0.0000']

ðŸ“Š Layer: HF_l4_FDCA.slice_att.log_diag
   â”œâ”€ Features: 1
   â”œâ”€ Mean Importance: 0.0000
   â”œâ”€ Max Importance: 0.0000
   â”œâ”€ Min Importance: 0.0000
   â””â”€ Top-5 Important Features: [0]
      â””â”€ Top-5 Values: ['0.0000']

ðŸ“Š Layer: HF_l4_FDCA.slice_att.factor
   â”œâ”€ Features: 1
   â”œâ”€ Mean Importance: 0.0000
   â”œâ”€ Max Importance: 0.0000
   â”œâ”€ Min Importance: 0.0000
   â””â”€ Top-5 Important Features: [0]
      â””â”€ Top-5 Values: ['0.0000']

ðŸ“Š Layer: HF_l4_FDCA.slice_att
   â”œâ”€ Features: 1
   â”œâ”€ Mean Importance: 0.0096
   â”œâ”€ Max Importance: 0.0096
   â”œâ”€ Min Importance: 0.0096
   â””â”€ Top-5 Important Features: [0]
      â””â”€ Top-5 Values: ['0.0096']

ðŸ“Š Layer: HF_l4_FDCA
   â”œâ”€ Features: 1
   â”œâ”€ Mean Importance: 0.7011
   â”œâ”€ Max Importance: 0.7011
   â”œâ”€ Min Importance: 0.7011
   â””â”€ Top-5 Important Features: [0]
      â””â”€ Top-5 Values: ['0.7011']

ðŸ“Š Layer: HF_l5_FDCA.semantic_att
   â”œâ”€ Features: 1
   â”œâ”€ Mean Importance: 0.0657
   â”œâ”€ Max Importance: 0.0657
   â”œâ”€ Min Importance: 0.0657
   â””â”€ Top-5 Important Features: [0]
      â””â”€ Top-5 Values: ['0.0657']

ðŸ“Š Layer: HF_l5_FDCA.positional_att.conv
   â”œâ”€ Features: 1
   â”œâ”€ Mean Importance: 12.7103
   â”œâ”€ Max Importance: 12.7103
   â”œâ”€ Min Importance: 12.7103
   â””â”€ Top-5 Important Features: [0]
      â””â”€ Top-5 Values: ['12.7103']

ðŸ“Š Layer: HF_l5_FDCA.positional_att
   â”œâ”€ Features: 1
   â”œâ”€ Mean Importance: 0.0001
   â”œâ”€ Max Importance: 0.0001
   â”œâ”€ Min Importance: 0.0001
   â””â”€ Top-5 Important Features: [0]
      â””â”€ Top-5 Values: ['0.0001']

ðŸ“Š Layer: HF_l5_FDCA.slice_att.linear.0
   â”œâ”€ Features: 1
   â”œâ”€ Mean Importance: 0.0000
   â”œâ”€ Max Importance: 0.0000
   â”œâ”€ Min Importance: 0.0000
   â””â”€ Top-5 Important Features: [0]
      â””â”€ Top-5 Values: ['0.0000']

ðŸ“Š Layer: HF_l5_FDCA.slice_att.linear.1
   â”œâ”€ Features: 1
   â”œâ”€ Mean Importance: 0.0000
   â”œâ”€ Max Importance: 0.0000
   â”œâ”€ Min Importance: 0.0000
   â””â”€ Top-5 Important Features: [0]
      â””â”€ Top-5 Values: ['0.0000']

ðŸ“Š Layer: HF_l5_FDCA.slice_att.linear.2
   â”œâ”€ Features: 1
   â”œâ”€ Mean Importance: 0.0000
   â”œâ”€ Max Importance: 0.0000
   â”œâ”€ Min Importance: 0.0000
   â””â”€ Top-5 Important Features: [0]
      â””â”€ Top-5 Values: ['0.0000']

ðŸ“Š Layer: HF_l5_FDCA.slice_att.linear
   â”œâ”€ Features: 1
   â”œâ”€ Mean Importance: 0.0000
   â”œâ”€ Max Importance: 0.0000
   â”œâ”€ Min Importance: 0.0000
   â””â”€ Top-5 Important Features: [0]
      â””â”€ Top-5 Values: ['0.0000']

ðŸ“Š Layer: HF_l5_FDCA.slice_att.non_linear
   â”œâ”€ Features: 1
   â”œâ”€ Mean Importance: 0.0000
   â”œâ”€ Max Importance: 0.0000
   â”œâ”€ Min Importance: 0.0000
   â””â”€ Top-5 Important Features: [0]
      â””â”€ Top-5 Values: ['0.0000']

ðŸ“Š Layer: HF_l5_FDCA.slice_att.mean
   â”œâ”€ Features: 1
   â”œâ”€ Mean Importance: 0.0000
   â”œâ”€ Max Importance: 0.0000
   â”œâ”€ Min Importance: 0.0000
   â””â”€ Top-5 Important Features: [0]
      â””â”€ Top-5 Values: ['0.0000']

ðŸ“Š Layer: HF_l5_FDCA.slice_att.log_diag
   â”œâ”€ Features: 1
   â”œâ”€ Mean Importance: 0.0000
   â”œâ”€ Max Importance: 0.0000
   â”œâ”€ Min Importance: 0.0000
   â””â”€ Top-5 Important Features: [0]
      â””â”€ Top-5 Values: ['0.0000']

ðŸ“Š Layer: HF_l5_FDCA.slice_att.factor
   â”œâ”€ Features: 1
   â”œâ”€ Mean Importance: 0.0000
   â”œâ”€ Max Importance: 0.0000
   â”œâ”€ Min Importance: 0.0000
   â””â”€ Top-5 Important Features: [0]
      â””â”€ Top-5 Values: ['0.0000']

ðŸ“Š Layer: HF_l5_FDCA.slice_att
   â”œâ”€ Features: 1
   â”œâ”€ Mean Importance: 0.0002
   â”œâ”€ Max Importance: 0.0002
   â”œâ”€ Min Importance: 0.0002
   â””â”€ Top-5 Important Features: [0]
      â””â”€ Top-5 Values: ['0.0002']

ðŸ“Š Layer: HF_l5_FDCA
   â”œâ”€ Features: 1
   â”œâ”€ Mean Importance: 0.0002
   â”œâ”€ Max Importance: 0.0002
   â”œâ”€ Min Importance: 0.0002
   â””â”€ Top-5 Important Features: [0]
      â””â”€ Top-5 Values: ['0.0002']

======================================================================
âœ“ Mechanistic analysis complete

[3] Generating Grad-CAM...
Warning: Failed to generate CAM for class 0: element 0 of tensors does not require grad and does not have a grad_fn
Warning: Failed to generate CAM for class 1: element 0 of tensors does not require grad and does not have a grad_fn
Warning: Failed to generate CAM for class 2: element 0 of tensors does not require grad and does not have a grad_fn
Warning: Failed to generate CAM for class 3: element 0 of tensors does not require grad and does not have a grad_fn
[4] Analyzing frequency components...
âœ“ Saved: outputs/xai_2025-11-15_17-25-23/freq_component/sample_0019_freq_comp.png
âœ“ Evaluation complete for sample_0019
Evaluating:  53%|#####2    | 20/38 [05:34<04:58, 16.56s/it]
[1] Getting primary prediction...

[METRICS FOR sample_0020]
==================================================
class_0: Dice=0.9968, IoU=0.9937
class_1: Dice=0.7849, IoU=0.6460
class_2: Dice=0.8693, IoU=0.7688
class_3: Dice=0.8883, IoU=0.7990
==================================================

[2] Generating attention maps...
Clipping input data to the valid range for imshow with RGB data ([0..1] for floats or [0..255] for integers).
Clipping input data to the valid range for imshow with RGB data ([0..1] for floats or [0..255] for integers).
âœ“ Saved: outputs/xai_2025-11-15_17-25-23/attention/sample_0020_attention.png

[MECHANISTIC INTERPRETABILITY ANALYSIS]
======================================================================
Sample: sample_0020
======================================================================

ðŸ“Š Layer: LF_l4_FDCA.semantic_att
   â”œâ”€ Features: 1
   â”œâ”€ Mean Importance: 0.1166
   â”œâ”€ Max Importance: 0.1166
   â”œâ”€ Min Importance: 0.1166
   â””â”€ Top-5 Important Features: [0]
      â””â”€ Top-5 Values: ['0.1166']

ðŸ“Š Layer: LF_l4_FDCA.positional_att.conv
   â”œâ”€ Features: 1
   â”œâ”€ Mean Importance: 248.9353
   â”œâ”€ Max Importance: 248.9353
   â”œâ”€ Min Importance: 248.9353
   â””â”€ Top-5 Important Features: [0]
      â””â”€ Top-5 Values: ['248.9353']

ðŸ“Š Layer: LF_l4_FDCA.positional_att
   â”œâ”€ Features: 1
   â”œâ”€ Mean Importance: 40.7295
   â”œâ”€ Max Importance: 40.7295
   â”œâ”€ Min Importance: 40.7295
   â””â”€ Top-5 Important Features: [0]
      â””â”€ Top-5 Values: ['40.7295']

ðŸ“Š Layer: LF_l4_FDCA.slice_att.linear.0
   â”œâ”€ Features: 1
   â”œâ”€ Mean Importance: 66.6573
   â”œâ”€ Max Importance: 66.6573
   â”œâ”€ Min Importance: 66.6573
   â””â”€ Top-5 Important Features: [0]
      â””â”€ Top-5 Values: ['66.6573']

ðŸ“Š Layer: LF_l4_FDCA.slice_att.linear.1
   â”œâ”€ Features: 1
   â”œâ”€ Mean Importance: 56.5450
   â”œâ”€ Max Importance: 56.5450
   â”œâ”€ Min Importance: 56.5450
   â””â”€ Top-5 Important Features: [0]
      â””â”€ Top-5 Values: ['56.5450']

ðŸ“Š Layer: LF_l4_FDCA.slice_att.linear.2
   â”œâ”€ Features: 1
   â”œâ”€ Mean Importance: 53.6604
   â”œâ”€ Max Importance: 53.6604
   â”œâ”€ Min Importance: 53.6604
   â””â”€ Top-5 Important Features: [0]
      â””â”€ Top-5 Values: ['53.6604']

ðŸ“Š Layer: LF_l4_FDCA.slice_att.linear
   â”œâ”€ Features: 1
   â”œâ”€ Mean Importance: 53.6604
   â”œâ”€ Max Importance: 53.6604
   â”œâ”€ Min Importance: 53.6604
   â””â”€ Top-5 Important Features: [0]
      â””â”€ Top-5 Values: ['53.6604']

ðŸ“Š Layer: LF_l4_FDCA.slice_att.non_linear
   â”œâ”€ Features: 1
   â”œâ”€ Mean Importance: 25679216.0000
   â”œâ”€ Max Importance: 25679216.0000
   â”œâ”€ Min Importance: 25679216.0000
   â””â”€ Top-5 Important Features: [0]
      â””â”€ Top-5 Values: ['25679216.0000']

ðŸ“Š Layer: LF_l4_FDCA.slice_att.mean
   â”œâ”€ Features: 1
   â”œâ”€ Mean Importance: 102602336.0000
   â”œâ”€ Max Importance: 102602336.0000
   â”œâ”€ Min Importance: 102602336.0000
   â””â”€ Top-5 Important Features: [0]
      â””â”€ Top-5 Values: ['102602336.0000']

ðŸ“Š Layer: LF_l4_FDCA.slice_att.log_diag
   â”œâ”€ Features: 1
   â”œâ”€ Mean Importance: 6359.1299
   â”œâ”€ Max Importance: 6359.1299
   â”œâ”€ Min Importance: 6359.1299
   â””â”€ Top-5 Important Features: [0]
      â””â”€ Top-5 Values: ['6359.1299']

ðŸ“Š Layer: LF_l4_FDCA.slice_att.factor
   â”œâ”€ Features: 1
   â”œâ”€ Mean Importance: 39742636.0000
   â”œâ”€ Max Importance: 39742636.0000
   â”œâ”€ Min Importance: 39742636.0000
   â””â”€ Top-5 Important Features: [0]
      â””â”€ Top-5 Values: ['39742636.0000']

ðŸ“Š Layer: LF_l4_FDCA.slice_att
   â”œâ”€ Features: 1
   â”œâ”€ Mean Importance: 14603932.0000
   â”œâ”€ Max Importance: 14603932.0000
   â”œâ”€ Min Importance: 14603932.0000
   â””â”€ Top-5 Important Features: [0]
      â””â”€ Top-5 Values: ['14603932.0000']

ðŸ“Š Layer: LF_l4_FDCA
   â”œâ”€ Features: 1
   â”œâ”€ Mean Importance: 1856258614491086848.0000
   â”œâ”€ Max Importance: 1856258614491086848.0000
   â”œâ”€ Min Importance: 1856258614491086848.0000
   â””â”€ Top-5 Important Features: [0]
      â””â”€ Top-5 Values: ['1856258614491086848.0000']

ðŸ“Š Layer: LF_l5_FDCA.semantic_att
   â”œâ”€ Features: 1
   â”œâ”€ Mean Importance: 0.0814
   â”œâ”€ Max Importance: 0.0814
   â”œâ”€ Min Importance: 0.0814
   â””â”€ Top-5 Important Features: [0]
      â””â”€ Top-5 Values: ['0.0814']

ðŸ“Š Layer: LF_l5_FDCA.positional_att.conv
   â”œâ”€ Features: 1
   â”œâ”€ Mean Importance: 67.9281
   â”œâ”€ Max Importance: 67.9281
   â”œâ”€ Min Importance: 67.9281
   â””â”€ Top-5 Important Features: [0]
      â””â”€ Top-5 Values: ['67.9281']

ðŸ“Š Layer: LF_l5_FDCA.positional_att
   â”œâ”€ Features: 1
   â”œâ”€ Mean Importance: 0.0000
   â”œâ”€ Max Importance: 0.0000
   â”œâ”€ Min Importance: 0.0000
   â””â”€ Top-5 Important Features: [0]
      â””â”€ Top-5 Values: ['0.0000']

ðŸ“Š Layer: LF_l5_FDCA.slice_att.linear.0
   â”œâ”€ Features: 1
   â”œâ”€ Mean Importance: 0.0000
   â”œâ”€ Max Importance: 0.0000
   â”œâ”€ Min Importance: 0.0000
   â””â”€ Top-5 Important Features: [0]
      â””â”€ Top-5 Values: ['0.0000']

ðŸ“Š Layer: LF_l5_FDCA.slice_att.linear.1
   â”œâ”€ Features: 1
   â”œâ”€ Mean Importance: 0.0000
   â”œâ”€ Max Importance: 0.0000
   â”œâ”€ Min Importance: 0.0000
   â””â”€ Top-5 Important Features: [0]
      â””â”€ Top-5 Values: ['0.0000']

ðŸ“Š Layer: LF_l5_FDCA.slice_att.linear.2
   â”œâ”€ Features: 1
   â”œâ”€ Mean Importance: 0.0000
   â”œâ”€ Max Importance: 0.0000
   â”œâ”€ Min Importance: 0.0000
   â””â”€ Top-5 Important Features: [0]
      â””â”€ Top-5 Values: ['0.0000']

ðŸ“Š Layer: LF_l5_FDCA.slice_att.linear
   â”œâ”€ Features: 1
   â”œâ”€ Mean Importance: 0.0000
   â”œâ”€ Max Importance: 0.0000
   â”œâ”€ Min Importance: 0.0000
   â””â”€ Top-5 Important Features: [0]
      â””â”€ Top-5 Values: ['0.0000']

ðŸ“Š Layer: LF_l5_FDCA.slice_att.non_linear
   â”œâ”€ Features: 1
   â”œâ”€ Mean Importance: 0.0000
   â”œâ”€ Max Importance: 0.0000
   â”œâ”€ Min Importance: 0.0000
   â””â”€ Top-5 Important Features: [0]
      â””â”€ Top-5 Values: ['0.0000']

ðŸ“Š Layer: LF_l5_FDCA.slice_att.mean
   â”œâ”€ Features: 1
   â”œâ”€ Mean Importance: 0.0017
   â”œâ”€ Max Importance: 0.0017
   â”œâ”€ Min Importance: 0.0017
   â””â”€ Top-5 Important Features: [0]
      â””â”€ Top-5 Values: ['0.0017']

ðŸ“Š Layer: LF_l5_FDCA.slice_att.log_diag
   â”œâ”€ Features: 1
   â”œâ”€ Mean Importance: 0.0000
   â”œâ”€ Max Importance: 0.0000
   â”œâ”€ Min Importance: 0.0000
   â””â”€ Top-5 Important Features: [0]
      â””â”€ Top-5 Values: ['0.0000']

ðŸ“Š Layer: LF_l5_FDCA.slice_att.factor
   â”œâ”€ Features: 1
   â”œâ”€ Mean Importance: 0.0001
   â”œâ”€ Max Importance: 0.0001
   â”œâ”€ Min Importance: 0.0001
   â””â”€ Top-5 Important Features: [0]
      â””â”€ Top-5 Values: ['0.0001']

ðŸ“Š Layer: LF_l5_FDCA.slice_att
   â”œâ”€ Features: 1
   â”œâ”€ Mean Importance: 0.0000
   â”œâ”€ Max Importance: 0.0000
   â”œâ”€ Min Importance: 0.0000
   â””â”€ Top-5 Important Features: [0]
      â””â”€ Top-5 Values: ['0.0000']

ðŸ“Š Layer: LF_l5_FDCA
   â”œâ”€ Features: 1
   â”œâ”€ Mean Importance: 0.0000
   â”œâ”€ Max Importance: 0.0000
   â”œâ”€ Min Importance: 0.0000
   â””â”€ Top-5 Important Features: [0]
      â””â”€ Top-5 Values: ['0.0000']

ðŸ“Š Layer: HF_l4_FDCA.semantic_att
   â”œâ”€ Features: 1
   â”œâ”€ Mean Importance: 0.0821
   â”œâ”€ Max Importance: 0.0821
   â”œâ”€ Min Importance: 0.0821
   â””â”€ Top-5 Important Features: [0]
      â””â”€ Top-5 Values: ['0.0821']

ðŸ“Š Layer: HF_l4_FDCA.positional_att.conv
   â”œâ”€ Features: 1
   â”œâ”€ Mean Importance: 8.4985
   â”œâ”€ Max Importance: 8.4985
   â”œâ”€ Min Importance: 8.4985
   â””â”€ Top-5 Important Features: [0]
      â””â”€ Top-5 Values: ['8.4985']

ðŸ“Š Layer: HF_l4_FDCA.positional_att
   â”œâ”€ Features: 1
   â”œâ”€ Mean Importance: 0.0017
   â”œâ”€ Max Importance: 0.0017
   â”œâ”€ Min Importance: 0.0017
   â””â”€ Top-5 Important Features: [0]
      â””â”€ Top-5 Values: ['0.0017']

ðŸ“Š Layer: HF_l4_FDCA.slice_att.linear.0
   â”œâ”€ Features: 1
   â”œâ”€ Mean Importance: 0.0000
   â”œâ”€ Max Importance: 0.0000
   â”œâ”€ Min Importance: 0.0000
   â””â”€ Top-5 Important Features: [0]
      â””â”€ Top-5 Values: ['0.0000']

ðŸ“Š Layer: HF_l4_FDCA.slice_att.linear.1
   â”œâ”€ Features: 1
   â”œâ”€ Mean Importance: 0.0000
   â”œâ”€ Max Importance: 0.0000
   â”œâ”€ Min Importance: 0.0000
   â””â”€ Top-5 Important Features: [0]
      â””â”€ Top-5 Values: ['0.0000']

ðŸ“Š Layer: HF_l4_FDCA.slice_att.linear.2
   â”œâ”€ Features: 1
   â”œâ”€ Mean Importance: 0.0000
   â”œâ”€ Max Importance: 0.0000
   â”œâ”€ Min Importance: 0.0000
   â””â”€ Top-5 Important Features: [0]
      â””â”€ Top-5 Values: ['0.0000']

ðŸ“Š Layer: HF_l4_FDCA.slice_att.linear
   â”œâ”€ Features: 1
   â”œâ”€ Mean Importance: 0.0000
   â”œâ”€ Max Importance: 0.0000
   â”œâ”€ Min Importance: 0.0000
   â””â”€ Top-5 Important Features: [0]
      â””â”€ Top-5 Values: ['0.0000']

ðŸ“Š Layer: HF_l4_FDCA.slice_att.non_linear
   â”œâ”€ Features: 1
   â”œâ”€ Mean Importance: 0.0000
   â”œâ”€ Max Importance: 0.0000
   â”œâ”€ Min Importance: 0.0000
   â””â”€ Top-5 Important Features: [0]
      â””â”€ Top-5 Values: ['0.0000']

ðŸ“Š Layer: HF_l4_FDCA.slice_att.mean
   â”œâ”€ Features: 1
   â”œâ”€ Mean Importance: 0.0000
   â”œâ”€ Max Importance: 0.0000
   â”œâ”€ Min Importance: 0.0000
   â””â”€ Top-5 Important Features: [0]
      â””â”€ Top-5 Values: ['0.0000']

ðŸ“Š Layer: HF_l4_FDCA.slice_att.log_diag
   â”œâ”€ Features: 1
   â”œâ”€ Mean Importance: 0.0000
   â”œâ”€ Max Importance: 0.0000
   â”œâ”€ Min Importance: 0.0000
   â””â”€ Top-5 Important Features: [0]
      â””â”€ Top-5 Values: ['0.0000']

ðŸ“Š Layer: HF_l4_FDCA.slice_att.factor
   â”œâ”€ Features: 1
   â”œâ”€ Mean Importance: 0.0000
   â”œâ”€ Max Importance: 0.0000
   â”œâ”€ Min Importance: 0.0000
   â””â”€ Top-5 Important Features: [0]
      â””â”€ Top-5 Values: ['0.0000']

ðŸ“Š Layer: HF_l4_FDCA.slice_att
   â”œâ”€ Features: 1
   â”œâ”€ Mean Importance: 0.0034
   â”œâ”€ Max Importance: 0.0034
   â”œâ”€ Min Importance: 0.0034
   â””â”€ Top-5 Important Features: [0]
      â””â”€ Top-5 Values: ['0.0034']

ðŸ“Š Layer: HF_l4_FDCA
   â”œâ”€ Features: 1
   â”œâ”€ Mean Importance: 0.4210
   â”œâ”€ Max Importance: 0.4210
   â”œâ”€ Min Importance: 0.4210
   â””â”€ Top-5 Important Features: [0]
      â””â”€ Top-5 Values: ['0.4210']

ðŸ“Š Layer: HF_l5_FDCA.semantic_att
   â”œâ”€ Features: 1
   â”œâ”€ Mean Importance: 0.0660
   â”œâ”€ Max Importance: 0.0660
   â”œâ”€ Min Importance: 0.0660
   â””â”€ Top-5 Important Features: [0]
      â””â”€ Top-5 Values: ['0.0660']

ðŸ“Š Layer: HF_l5_FDCA.positional_att.conv
   â”œâ”€ Features: 1
   â”œâ”€ Mean Importance: 15.6528
   â”œâ”€ Max Importance: 15.6528
   â”œâ”€ Min Importance: 15.6528
   â””â”€ Top-5 Important Features: [0]
      â””â”€ Top-5 Values: ['15.6528']

ðŸ“Š Layer: HF_l5_FDCA.positional_att
   â”œâ”€ Features: 1
   â”œâ”€ Mean Importance: 0.0001
   â”œâ”€ Max Importance: 0.0001
   â”œâ”€ Min Importance: 0.0001
   â””â”€ Top-5 Important Features: [0]
      â””â”€ Top-5 Values: ['0.0001']

ðŸ“Š Layer: HF_l5_FDCA.slice_att.linear.0
   â”œâ”€ Features: 1
   â”œâ”€ Mean Importance: 0.0000
   â”œâ”€ Max Importance: 0.0000
   â”œâ”€ Min Importance: 0.0000
   â””â”€ Top-5 Important Features: [0]
      â””â”€ Top-5 Values: ['0.0000']

ðŸ“Š Layer: HF_l5_FDCA.slice_att.linear.1
   â”œâ”€ Features: 1
   â”œâ”€ Mean Importance: 0.0000
   â”œâ”€ Max Importance: 0.0000
   â”œâ”€ Min Importance: 0.0000
   â””â”€ Top-5 Important Features: [0]
      â””â”€ Top-5 Values: ['0.0000']

ðŸ“Š Layer: HF_l5_FDCA.slice_att.linear.2
   â”œâ”€ Features: 1
   â”œâ”€ Mean Importance: 0.0000
   â”œâ”€ Max Importance: 0.0000
   â”œâ”€ Min Importance: 0.0000
   â””â”€ Top-5 Important Features: [0]
      â””â”€ Top-5 Values: ['0.0000']

ðŸ“Š Layer: HF_l5_FDCA.slice_att.linear
   â”œâ”€ Features: 1
   â”œâ”€ Mean Importance: 0.0000
   â”œâ”€ Max Importance: 0.0000
   â”œâ”€ Min Importance: 0.0000
   â””â”€ Top-5 Important Features: [0]
      â””â”€ Top-5 Values: ['0.0000']

ðŸ“Š Layer: HF_l5_FDCA.slice_att.non_linear
   â”œâ”€ Features: 1
   â”œâ”€ Mean Importance: 0.0000
   â”œâ”€ Max Importance: 0.0000
   â”œâ”€ Min Importance: 0.0000
   â””â”€ Top-5 Important Features: [0]
      â””â”€ Top-5 Values: ['0.0000']

ðŸ“Š Layer: HF_l5_FDCA.slice_att.mean
   â”œâ”€ Features: 1
   â”œâ”€ Mean Importance: 0.0000
   â”œâ”€ Max Importance: 0.0000
   â”œâ”€ Min Importance: 0.0000
   â””â”€ Top-5 Important Features: [0]
      â””â”€ Top-5 Values: ['0.0000']

ðŸ“Š Layer: HF_l5_FDCA.slice_att.log_diag
   â”œâ”€ Features: 1
   â”œâ”€ Mean Importance: 0.0000
   â”œâ”€ Max Importance: 0.0000
   â”œâ”€ Min Importance: 0.0000
   â””â”€ Top-5 Important Features: [0]
      â””â”€ Top-5 Values: ['0.0000']

ðŸ“Š Layer: HF_l5_FDCA.slice_att.factor
   â”œâ”€ Features: 1
   â”œâ”€ Mean Importance: 0.0000
   â”œâ”€ Max Importance: 0.0000
   â”œâ”€ Min Importance: 0.0000
   â””â”€ Top-5 Important Features: [0]
      â””â”€ Top-5 Values: ['0.0000']

ðŸ“Š Layer: HF_l5_FDCA.slice_att
   â”œâ”€ Features: 1
   â”œâ”€ Mean Importance: 0.0004
   â”œâ”€ Max Importance: 0.0004
   â”œâ”€ Min Importance: 0.0004
   â””â”€ Top-5 Important Features: [0]
      â””â”€ Top-5 Values: ['0.0004']

ðŸ“Š Layer: HF_l5_FDCA
   â”œâ”€ Features: 1
   â”œâ”€ Mean Importance: 0.0016
   â”œâ”€ Max Importance: 0.0016
   â”œâ”€ Min Importance: 0.0016
   â””â”€ Top-5 Important Features: [0]
      â””â”€ Top-5 Values: ['0.0016']

======================================================================
âœ“ Mechanistic analysis complete

[3] Generating Grad-CAM...
Warning: Failed to generate CAM for class 0: element 0 of tensors does not require grad and does not have a grad_fn
Warning: Failed to generate CAM for class 1: element 0 of tensors does not require grad and does not have a grad_fn
Warning: Failed to generate CAM for class 2: element 0 of tensors does not require grad and does not have a grad_fn
Warning: Failed to generate CAM for class 3: element 0 of tensors does not require grad and does not have a grad_fn
[4] Analyzing frequency components...
âœ“ Saved: outputs/xai_2025-11-15_17-25-23/freq_component/sample_0020_freq_comp.png
âœ“ Evaluation complete for sample_0020
Evaluating:  55%|#####5    | 21/38 [05:50<04:40, 16.48s/it]
[1] Getting primary prediction...

[METRICS FOR sample_0021]
==================================================
class_0: Dice=0.9971, IoU=0.9942
class_1: Dice=0.7084, IoU=0.5484
class_2: Dice=0.7921, IoU=0.6557
class_3: Dice=0.7877, IoU=0.6498
==================================================

[2] Generating attention maps...
Clipping input data to the valid range for imshow with RGB data ([0..1] for floats or [0..255] for integers).
Clipping input data to the valid range for imshow with RGB data ([0..1] for floats or [0..255] for integers).
âœ“ Saved: outputs/xai_2025-11-15_17-25-23/attention/sample_0021_attention.png

[MECHANISTIC INTERPRETABILITY ANALYSIS]
======================================================================
Sample: sample_0021
======================================================================

ðŸ“Š Layer: LF_l4_FDCA.semantic_att
   â”œâ”€ Features: 1
   â”œâ”€ Mean Importance: 0.1330
   â”œâ”€ Max Importance: 0.1330
   â”œâ”€ Min Importance: 0.1330
   â””â”€ Top-5 Important Features: [0]
      â””â”€ Top-5 Values: ['0.1330']

ðŸ“Š Layer: LF_l4_FDCA.positional_att.conv
   â”œâ”€ Features: 1
   â”œâ”€ Mean Importance: 236.6236
   â”œâ”€ Max Importance: 236.6236
   â”œâ”€ Min Importance: 236.6236
   â””â”€ Top-5 Important Features: [0]
      â””â”€ Top-5 Values: ['236.6236']

ðŸ“Š Layer: LF_l4_FDCA.positional_att
   â”œâ”€ Features: 1
   â”œâ”€ Mean Importance: 49.5671
   â”œâ”€ Max Importance: 49.5671
   â”œâ”€ Min Importance: 49.5671
   â””â”€ Top-5 Important Features: [0]
      â””â”€ Top-5 Values: ['49.5671']

ðŸ“Š Layer: LF_l4_FDCA.slice_att.linear.0
   â”œâ”€ Features: 1
   â”œâ”€ Mean Importance: 68.5628
   â”œâ”€ Max Importance: 68.5628
   â”œâ”€ Min Importance: 68.5628
   â””â”€ Top-5 Important Features: [0]
      â””â”€ Top-5 Values: ['68.5628']

ðŸ“Š Layer: LF_l4_FDCA.slice_att.linear.1
   â”œâ”€ Features: 1
   â”œâ”€ Mean Importance: 58.1675
   â”œâ”€ Max Importance: 58.1675
   â”œâ”€ Min Importance: 58.1675
   â””â”€ Top-5 Important Features: [0]
      â””â”€ Top-5 Values: ['58.1675']

ðŸ“Š Layer: LF_l4_FDCA.slice_att.linear.2
   â”œâ”€ Features: 1
   â”œâ”€ Mean Importance: 55.1814
   â”œâ”€ Max Importance: 55.1814
   â”œâ”€ Min Importance: 55.1814
   â””â”€ Top-5 Important Features: [0]
      â””â”€ Top-5 Values: ['55.1814']

ðŸ“Š Layer: LF_l4_FDCA.slice_att.linear
   â”œâ”€ Features: 1
   â”œâ”€ Mean Importance: 55.1814
   â”œâ”€ Max Importance: 55.1814
   â”œâ”€ Min Importance: 55.1814
   â””â”€ Top-5 Important Features: [0]
      â””â”€ Top-5 Values: ['55.1814']

ðŸ“Š Layer: LF_l4_FDCA.slice_att.non_linear
   â”œâ”€ Features: 1
   â”œâ”€ Mean Importance: 22324348.0000
   â”œâ”€ Max Importance: 22324348.0000
   â”œâ”€ Min Importance: 22324348.0000
   â””â”€ Top-5 Important Features: [0]
      â””â”€ Top-5 Values: ['22324348.0000']

ðŸ“Š Layer: LF_l4_FDCA.slice_att.mean
   â”œâ”€ Features: 1
   â”œâ”€ Mean Importance: 89185872.0000
   â”œâ”€ Max Importance: 89185872.0000
   â”œâ”€ Min Importance: 89185872.0000
   â””â”€ Top-5 Important Features: [0]
      â””â”€ Top-5 Values: ['89185872.0000']

ðŸ“Š Layer: LF_l4_FDCA.slice_att.log_diag
   â”œâ”€ Features: 1
   â”œâ”€ Mean Importance: 5527.7070
   â”œâ”€ Max Importance: 5527.7070
   â”œâ”€ Min Importance: 5527.7070
   â””â”€ Top-5 Important Features: [0]
      â””â”€ Top-5 Values: ['5527.7070']

ðŸ“Š Layer: LF_l4_FDCA.slice_att.factor
   â”œâ”€ Features: 1
   â”œâ”€ Mean Importance: 34545684.0000
   â”œâ”€ Max Importance: 34545684.0000
   â”œâ”€ Min Importance: 34545684.0000
   â””â”€ Top-5 Important Features: [0]
      â””â”€ Top-5 Values: ['34545684.0000']

ðŸ“Š Layer: LF_l4_FDCA.slice_att
   â”œâ”€ Features: 1
   â”œâ”€ Mean Importance: 16871658.0000
   â”œâ”€ Max Importance: 16871658.0000
   â”œâ”€ Min Importance: 16871658.0000
   â””â”€ Top-5 Important Features: [0]
      â””â”€ Top-5 Values: ['16871658.0000']

ðŸ“Š Layer: LF_l4_FDCA
   â”œâ”€ Features: 1
   â”œâ”€ Mean Importance: 2005112835121610752.0000
   â”œâ”€ Max Importance: 2005112835121610752.0000
   â”œâ”€ Min Importance: 2005112835121610752.0000
   â””â”€ Top-5 Important Features: [0]
      â””â”€ Top-5 Values: ['2005112835121610752.0000']

ðŸ“Š Layer: LF_l5_FDCA.semantic_att
   â”œâ”€ Features: 1
   â”œâ”€ Mean Importance: 0.0807
   â”œâ”€ Max Importance: 0.0807
   â”œâ”€ Min Importance: 0.0807
   â””â”€ Top-5 Important Features: [0]
      â””â”€ Top-5 Values: ['0.0807']

ðŸ“Š Layer: LF_l5_FDCA.positional_att.conv
   â”œâ”€ Features: 1
   â”œâ”€ Mean Importance: 66.7153
   â”œâ”€ Max Importance: 66.7153
   â”œâ”€ Min Importance: 66.7153
   â””â”€ Top-5 Important Features: [0]
      â””â”€ Top-5 Values: ['66.7153']

ðŸ“Š Layer: LF_l5_FDCA.positional_att
   â”œâ”€ Features: 1
   â”œâ”€ Mean Importance: 0.0000
   â”œâ”€ Max Importance: 0.0000
   â”œâ”€ Min Importance: 0.0000
   â””â”€ Top-5 Important Features: [0]
      â””â”€ Top-5 Values: ['0.0000']

ðŸ“Š Layer: LF_l5_FDCA.slice_att.linear.0
   â”œâ”€ Features: 1
   â”œâ”€ Mean Importance: 0.0000
   â”œâ”€ Max Importance: 0.0000
   â”œâ”€ Min Importance: 0.0000
   â””â”€ Top-5 Important Features: [0]
      â””â”€ Top-5 Values: ['0.0000']

ðŸ“Š Layer: LF_l5_FDCA.slice_att.linear.1
   â”œâ”€ Features: 1
   â”œâ”€ Mean Importance: 0.0000
   â”œâ”€ Max Importance: 0.0000
   â”œâ”€ Min Importance: 0.0000
   â””â”€ Top-5 Important Features: [0]
      â””â”€ Top-5 Values: ['0.0000']

ðŸ“Š Layer: LF_l5_FDCA.slice_att.linear.2
   â”œâ”€ Features: 1
   â”œâ”€ Mean Importance: 0.0000
   â”œâ”€ Max Importance: 0.0000
   â”œâ”€ Min Importance: 0.0000
   â””â”€ Top-5 Important Features: [0]
      â””â”€ Top-5 Values: ['0.0000']

ðŸ“Š Layer: LF_l5_FDCA.slice_att.linear
   â”œâ”€ Features: 1
   â”œâ”€ Mean Importance: 0.0000
   â”œâ”€ Max Importance: 0.0000
   â”œâ”€ Min Importance: 0.0000
   â””â”€ Top-5 Important Features: [0]
      â””â”€ Top-5 Values: ['0.0000']

ðŸ“Š Layer: LF_l5_FDCA.slice_att.non_linear
   â”œâ”€ Features: 1
   â”œâ”€ Mean Importance: 0.0000
   â”œâ”€ Max Importance: 0.0000
   â”œâ”€ Min Importance: 0.0000
   â””â”€ Top-5 Important Features: [0]
      â””â”€ Top-5 Values: ['0.0000']

ðŸ“Š Layer: LF_l5_FDCA.slice_att.mean
   â”œâ”€ Features: 1
   â”œâ”€ Mean Importance: 0.0017
   â”œâ”€ Max Importance: 0.0017
   â”œâ”€ Min Importance: 0.0017
   â””â”€ Top-5 Important Features: [0]
      â””â”€ Top-5 Values: ['0.0017']

ðŸ“Š Layer: LF_l5_FDCA.slice_att.log_diag
   â”œâ”€ Features: 1
   â”œâ”€ Mean Importance: 0.0000
   â”œâ”€ Max Importance: 0.0000
   â”œâ”€ Min Importance: 0.0000
   â””â”€ Top-5 Important Features: [0]
      â””â”€ Top-5 Values: ['0.0000']

ðŸ“Š Layer: LF_l5_FDCA.slice_att.factor
   â”œâ”€ Features: 1
   â”œâ”€ Mean Importance: 0.0001
   â”œâ”€ Max Importance: 0.0001
   â”œâ”€ Min Importance: 0.0001
   â””â”€ Top-5 Important Features: [0]
      â””â”€ Top-5 Values: ['0.0001']

ðŸ“Š Layer: LF_l5_FDCA.slice_att
   â”œâ”€ Features: 1
   â”œâ”€ Mean Importance: 0.0000
   â”œâ”€ Max Importance: 0.0000
   â”œâ”€ Min Importance: 0.0000
   â””â”€ Top-5 Important Features: [0]
      â””â”€ Top-5 Values: ['0.0000']

ðŸ“Š Layer: LF_l5_FDCA
   â”œâ”€ Features: 1
   â”œâ”€ Mean Importance: 0.0000
   â”œâ”€ Max Importance: 0.0000
   â”œâ”€ Min Importance: 0.0000
   â””â”€ Top-5 Important Features: [0]
      â””â”€ Top-5 Values: ['0.0000']

ðŸ“Š Layer: HF_l4_FDCA.semantic_att
   â”œâ”€ Features: 1
   â”œâ”€ Mean Importance: 0.0823
   â”œâ”€ Max Importance: 0.0823
   â”œâ”€ Min Importance: 0.0823
   â””â”€ Top-5 Important Features: [0]
      â””â”€ Top-5 Values: ['0.0823']

ðŸ“Š Layer: HF_l4_FDCA.positional_att.conv
   â”œâ”€ Features: 1
   â”œâ”€ Mean Importance: 8.7351
   â”œâ”€ Max Importance: 8.7351
   â”œâ”€ Min Importance: 8.7351
   â””â”€ Top-5 Important Features: [0]
      â””â”€ Top-5 Values: ['8.7351']

ðŸ“Š Layer: HF_l4_FDCA.positional_att
   â”œâ”€ Features: 1
   â”œâ”€ Mean Importance: 0.0017
   â”œâ”€ Max Importance: 0.0017
   â”œâ”€ Min Importance: 0.0017
   â””â”€ Top-5 Important Features: [0]
      â””â”€ Top-5 Values: ['0.0017']

ðŸ“Š Layer: HF_l4_FDCA.slice_att.linear.0
   â”œâ”€ Features: 1
   â”œâ”€ Mean Importance: 0.0000
   â”œâ”€ Max Importance: 0.0000
   â”œâ”€ Min Importance: 0.0000
   â””â”€ Top-5 Important Features: [0]
      â””â”€ Top-5 Values: ['0.0000']

ðŸ“Š Layer: HF_l4_FDCA.slice_att.linear.1
   â”œâ”€ Features: 1
   â”œâ”€ Mean Importance: 0.0000
   â”œâ”€ Max Importance: 0.0000
   â”œâ”€ Min Importance: 0.0000
   â””â”€ Top-5 Important Features: [0]
      â””â”€ Top-5 Values: ['0.0000']

ðŸ“Š Layer: HF_l4_FDCA.slice_att.linear.2
   â”œâ”€ Features: 1
   â”œâ”€ Mean Importance: 0.0000
   â”œâ”€ Max Importance: 0.0000
   â”œâ”€ Min Importance: 0.0000
   â””â”€ Top-5 Important Features: [0]
      â””â”€ Top-5 Values: ['0.0000']

ðŸ“Š Layer: HF_l4_FDCA.slice_att.linear
   â”œâ”€ Features: 1
   â”œâ”€ Mean Importance: 0.0000
   â”œâ”€ Max Importance: 0.0000
   â”œâ”€ Min Importance: 0.0000
   â””â”€ Top-5 Important Features: [0]
      â””â”€ Top-5 Values: ['0.0000']

ðŸ“Š Layer: HF_l4_FDCA.slice_att.non_linear
   â”œâ”€ Features: 1
   â”œâ”€ Mean Importance: 0.0000
   â”œâ”€ Max Importance: 0.0000
   â”œâ”€ Min Importance: 0.0000
   â””â”€ Top-5 Important Features: [0]
      â””â”€ Top-5 Values: ['0.0000']

ðŸ“Š Layer: HF_l4_FDCA.slice_att.mean
   â”œâ”€ Features: 1
   â”œâ”€ Mean Importance: 0.0000
   â”œâ”€ Max Importance: 0.0000
   â”œâ”€ Min Importance: 0.0000
   â””â”€ Top-5 Important Features: [0]
      â””â”€ Top-5 Values: ['0.0000']

ðŸ“Š Layer: HF_l4_FDCA.slice_att.log_diag
   â”œâ”€ Features: 1
   â”œâ”€ Mean Importance: 0.0000
   â”œâ”€ Max Importance: 0.0000
   â”œâ”€ Min Importance: 0.0000
   â””â”€ Top-5 Important Features: [0]
      â””â”€ Top-5 Values: ['0.0000']

ðŸ“Š Layer: HF_l4_FDCA.slice_att.factor
   â”œâ”€ Features: 1
   â”œâ”€ Mean Importance: 0.0000
   â”œâ”€ Max Importance: 0.0000
   â”œâ”€ Min Importance: 0.0000
   â””â”€ Top-5 Important Features: [0]
      â””â”€ Top-5 Values: ['0.0000']

ðŸ“Š Layer: HF_l4_FDCA.slice_att
   â”œâ”€ Features: 1
   â”œâ”€ Mean Importance: 0.0048
   â”œâ”€ Max Importance: 0.0048
   â”œâ”€ Min Importance: 0.0048
   â””â”€ Top-5 Important Features: [0]
      â””â”€ Top-5 Values: ['0.0048']

ðŸ“Š Layer: HF_l4_FDCA
   â”œâ”€ Features: 1
   â”œâ”€ Mean Importance: 0.5457
   â”œâ”€ Max Importance: 0.5457
   â”œâ”€ Min Importance: 0.5457
   â””â”€ Top-5 Important Features: [0]
      â””â”€ Top-5 Values: ['0.5457']

ðŸ“Š Layer: HF_l5_FDCA.semantic_att
   â”œâ”€ Features: 1
   â”œâ”€ Mean Importance: 0.0661
   â”œâ”€ Max Importance: 0.0661
   â”œâ”€ Min Importance: 0.0661
   â””â”€ Top-5 Important Features: [0]
      â””â”€ Top-5 Values: ['0.0661']

ðŸ“Š Layer: HF_l5_FDCA.positional_att.conv
   â”œâ”€ Features: 1
   â”œâ”€ Mean Importance: 12.8132
   â”œâ”€ Max Importance: 12.8132
   â”œâ”€ Min Importance: 12.8132
   â””â”€ Top-5 Important Features: [0]
      â””â”€ Top-5 Values: ['12.8132']

ðŸ“Š Layer: HF_l5_FDCA.positional_att
   â”œâ”€ Features: 1
   â”œâ”€ Mean Importance: 0.0001
   â”œâ”€ Max Importance: 0.0001
   â”œâ”€ Min Importance: 0.0001
   â””â”€ Top-5 Important Features: [0]
      â””â”€ Top-5 Values: ['0.0001']

ðŸ“Š Layer: HF_l5_FDCA.slice_att.linear.0
   â”œâ”€ Features: 1
   â”œâ”€ Mean Importance: 0.0000
   â”œâ”€ Max Importance: 0.0000
   â”œâ”€ Min Importance: 0.0000
   â””â”€ Top-5 Important Features: [0]
      â””â”€ Top-5 Values: ['0.0000']

ðŸ“Š Layer: HF_l5_FDCA.slice_att.linear.1
   â”œâ”€ Features: 1
   â”œâ”€ Mean Importance: 0.0000
   â”œâ”€ Max Importance: 0.0000
   â”œâ”€ Min Importance: 0.0000
   â””â”€ Top-5 Important Features: [0]
      â””â”€ Top-5 Values: ['0.0000']

ðŸ“Š Layer: HF_l5_FDCA.slice_att.linear.2
   â”œâ”€ Features: 1
   â”œâ”€ Mean Importance: 0.0000
   â”œâ”€ Max Importance: 0.0000
   â”œâ”€ Min Importance: 0.0000
   â””â”€ Top-5 Important Features: [0]
      â””â”€ Top-5 Values: ['0.0000']

ðŸ“Š Layer: HF_l5_FDCA.slice_att.linear
   â”œâ”€ Features: 1
   â”œâ”€ Mean Importance: 0.0000
   â”œâ”€ Max Importance: 0.0000
   â”œâ”€ Min Importance: 0.0000
   â””â”€ Top-5 Important Features: [0]
      â””â”€ Top-5 Values: ['0.0000']

ðŸ“Š Layer: HF_l5_FDCA.slice_att.non_linear
   â”œâ”€ Features: 1
   â”œâ”€ Mean Importance: 0.0000
   â”œâ”€ Max Importance: 0.0000
   â”œâ”€ Min Importance: 0.0000
   â””â”€ Top-5 Important Features: [0]
      â””â”€ Top-5 Values: ['0.0000']

ðŸ“Š Layer: HF_l5_FDCA.slice_att.mean
   â”œâ”€ Features: 1
   â”œâ”€ Mean Importance: 0.0000
   â”œâ”€ Max Importance: 0.0000
   â”œâ”€ Min Importance: 0.0000
   â””â”€ Top-5 Important Features: [0]
      â””â”€ Top-5 Values: ['0.0000']

ðŸ“Š Layer: HF_l5_FDCA.slice_att.log_diag
   â”œâ”€ Features: 1
   â”œâ”€ Mean Importance: 0.0000
   â”œâ”€ Max Importance: 0.0000
   â”œâ”€ Min Importance: 0.0000
   â””â”€ Top-5 Important Features: [0]
      â””â”€ Top-5 Values: ['0.0000']

ðŸ“Š Layer: HF_l5_FDCA.slice_att.factor
   â”œâ”€ Features: 1
   â”œâ”€ Mean Importance: 0.0000
   â”œâ”€ Max Importance: 0.0000
   â”œâ”€ Min Importance: 0.0000
   â””â”€ Top-5 Important Features: [0]
      â””â”€ Top-5 Values: ['0.0000']

ðŸ“Š Layer: HF_l5_FDCA.slice_att
   â”œâ”€ Features: 1
   â”œâ”€ Mean Importance: 0.0002
   â”œâ”€ Max Importance: 0.0002
   â”œâ”€ Min Importance: 0.0002
   â””â”€ Top-5 Important Features: [0]
      â””â”€ Top-5 Values: ['0.0002']

ðŸ“Š Layer: HF_l5_FDCA
   â”œâ”€ Features: 1
   â”œâ”€ Mean Importance: 0.0006
   â”œâ”€ Max Importance: 0.0006
   â”œâ”€ Min Importance: 0.0006
   â””â”€ Top-5 Important Features: [0]
      â””â”€ Top-5 Values: ['0.0006']

======================================================================
âœ“ Mechanistic analysis complete

[3] Generating Grad-CAM...
Warning: Failed to generate CAM for class 0: element 0 of tensors does not require grad and does not have a grad_fn
Warning: Failed to generate CAM for class 1: element 0 of tensors does not require grad and does not have a grad_fn
Warning: Failed to generate CAM for class 2: element 0 of tensors does not require grad and does not have a grad_fn
Warning: Failed to generate CAM for class 3: element 0 of tensors does not require grad and does not have a grad_fn
[4] Analyzing frequency components...
âœ“ Saved: outputs/xai_2025-11-15_17-25-23/freq_component/sample_0021_freq_comp.png
âœ“ Evaluation complete for sample_0021
Evaluating:  58%|#####7    | 22/38 [06:06<04:22, 16.42s/it]
[1] Getting primary prediction...

[METRICS FOR sample_0022]
==================================================
class_0: Dice=0.9942, IoU=0.9886
class_1: Dice=0.7812, IoU=0.6410
class_2: Dice=0.8351, IoU=0.7169
class_3: Dice=0.8406, IoU=0.7251
==================================================

[2] Generating attention maps...
Clipping input data to the valid range for imshow with RGB data ([0..1] for floats or [0..255] for integers).
Clipping input data to the valid range for imshow with RGB data ([0..1] for floats or [0..255] for integers).
âœ“ Saved: outputs/xai_2025-11-15_17-25-23/attention/sample_0022_attention.png

[MECHANISTIC INTERPRETABILITY ANALYSIS]
======================================================================
Sample: sample_0022
======================================================================

ðŸ“Š Layer: LF_l4_FDCA.semantic_att
   â”œâ”€ Features: 1
   â”œâ”€ Mean Importance: 0.1150
   â”œâ”€ Max Importance: 0.1150
   â”œâ”€ Min Importance: 0.1150
   â””â”€ Top-5 Important Features: [0]
      â””â”€ Top-5 Values: ['0.1150']

ðŸ“Š Layer: LF_l4_FDCA.positional_att.conv
   â”œâ”€ Features: 1
   â”œâ”€ Mean Importance: 226.6266
   â”œâ”€ Max Importance: 226.6266
   â”œâ”€ Min Importance: 226.6266
   â””â”€ Top-5 Important Features: [0]
      â””â”€ Top-5 Values: ['226.6266']

ðŸ“Š Layer: LF_l4_FDCA.positional_att
   â”œâ”€ Features: 1
   â”œâ”€ Mean Importance: 37.2536
   â”œâ”€ Max Importance: 37.2536
   â”œâ”€ Min Importance: 37.2536
   â””â”€ Top-5 Important Features: [0]
      â””â”€ Top-5 Values: ['37.2536']

ðŸ“Š Layer: LF_l4_FDCA.slice_att.linear.0
   â”œâ”€ Features: 1
   â”œâ”€ Mean Importance: 64.1918
   â”œâ”€ Max Importance: 64.1918
   â”œâ”€ Min Importance: 64.1918
   â””â”€ Top-5 Important Features: [0]
      â””â”€ Top-5 Values: ['64.1918']

ðŸ“Š Layer: LF_l4_FDCA.slice_att.linear.1
   â”œâ”€ Features: 1
   â”œâ”€ Mean Importance: 54.4513
   â”œâ”€ Max Importance: 54.4513
   â”œâ”€ Min Importance: 54.4513
   â””â”€ Top-5 Important Features: [0]
      â””â”€ Top-5 Values: ['54.4513']

ðŸ“Š Layer: LF_l4_FDCA.slice_att.linear.2
   â”œâ”€ Features: 1
   â”œâ”€ Mean Importance: 51.6786
   â”œâ”€ Max Importance: 51.6786
   â”œâ”€ Min Importance: 51.6786
   â””â”€ Top-5 Important Features: [0]
      â””â”€ Top-5 Values: ['51.6786']

ðŸ“Š Layer: LF_l4_FDCA.slice_att.linear
   â”œâ”€ Features: 1
   â”œâ”€ Mean Importance: 51.6786
   â”œâ”€ Max Importance: 51.6786
   â”œâ”€ Min Importance: 51.6786
   â””â”€ Top-5 Important Features: [0]
      â””â”€ Top-5 Values: ['51.6786']

ðŸ“Š Layer: LF_l4_FDCA.slice_att.non_linear
   â”œâ”€ Features: 1
   â”œâ”€ Mean Importance: 23120354.0000
   â”œâ”€ Max Importance: 23120354.0000
   â”œâ”€ Min Importance: 23120354.0000
   â””â”€ Top-5 Important Features: [0]
      â””â”€ Top-5 Values: ['23120354.0000']

ðŸ“Š Layer: LF_l4_FDCA.slice_att.mean
   â”œâ”€ Features: 1
   â”œâ”€ Mean Importance: 92380720.0000
   â”œâ”€ Max Importance: 92380720.0000
   â”œâ”€ Min Importance: 92380720.0000
   â””â”€ Top-5 Important Features: [0]
      â””â”€ Top-5 Values: ['92380720.0000']

ðŸ“Š Layer: LF_l4_FDCA.slice_att.log_diag
   â”œâ”€ Features: 1
   â”œâ”€ Mean Importance: 5725.5889
   â”œâ”€ Max Importance: 5725.5889
   â”œâ”€ Min Importance: 5725.5889
   â””â”€ Top-5 Important Features: [0]
      â””â”€ Top-5 Values: ['5725.5889']

ðŸ“Š Layer: LF_l4_FDCA.slice_att.factor
   â”œâ”€ Features: 1
   â”œâ”€ Mean Importance: 35783360.0000
   â”œâ”€ Max Importance: 35783360.0000
   â”œâ”€ Min Importance: 35783360.0000
   â””â”€ Top-5 Important Features: [0]
      â””â”€ Top-5 Values: ['35783360.0000']

ðŸ“Š Layer: LF_l4_FDCA.slice_att
   â”œâ”€ Features: 1
   â”œâ”€ Mean Importance: 13606519.0000
   â”œâ”€ Max Importance: 13606519.0000
   â”œâ”€ Min Importance: 13606519.0000
   â””â”€ Top-5 Important Features: [0]
      â””â”€ Top-5 Values: ['13606519.0000']

ðŸ“Š Layer: LF_l4_FDCA
   â”œâ”€ Features: 1
   â”œâ”€ Mean Importance: 1665142740301643776.0000
   â”œâ”€ Max Importance: 1665142740301643776.0000
   â”œâ”€ Min Importance: 1665142740301643776.0000
   â””â”€ Top-5 Important Features: [0]
      â””â”€ Top-5 Values: ['1665142740301643776.0000']

ðŸ“Š Layer: LF_l5_FDCA.semantic_att
   â”œâ”€ Features: 1
   â”œâ”€ Mean Importance: 0.0870
   â”œâ”€ Max Importance: 0.0870
   â”œâ”€ Min Importance: 0.0870
   â””â”€ Top-5 Important Features: [0]
      â””â”€ Top-5 Values: ['0.0870']

ðŸ“Š Layer: LF_l5_FDCA.positional_att.conv
   â”œâ”€ Features: 1
   â”œâ”€ Mean Importance: 60.1867
   â”œâ”€ Max Importance: 60.1867
   â”œâ”€ Min Importance: 60.1867
   â””â”€ Top-5 Important Features: [0]
      â””â”€ Top-5 Values: ['60.1867']

ðŸ“Š Layer: LF_l5_FDCA.positional_att
   â”œâ”€ Features: 1
   â”œâ”€ Mean Importance: 0.0000
   â”œâ”€ Max Importance: 0.0000
   â”œâ”€ Min Importance: 0.0000
   â””â”€ Top-5 Important Features: [0]
      â””â”€ Top-5 Values: ['0.0000']

ðŸ“Š Layer: LF_l5_FDCA.slice_att.linear.0
   â”œâ”€ Features: 1
   â”œâ”€ Mean Importance: 0.0000
   â”œâ”€ Max Importance: 0.0000
   â”œâ”€ Min Importance: 0.0000
   â””â”€ Top-5 Important Features: [0]
      â””â”€ Top-5 Values: ['0.0000']

ðŸ“Š Layer: LF_l5_FDCA.slice_att.linear.1
   â”œâ”€ Features: 1
   â”œâ”€ Mean Importance: 0.0000
   â”œâ”€ Max Importance: 0.0000
   â”œâ”€ Min Importance: 0.0000
   â””â”€ Top-5 Important Features: [0]
      â””â”€ Top-5 Values: ['0.0000']

ðŸ“Š Layer: LF_l5_FDCA.slice_att.linear.2
   â”œâ”€ Features: 1
   â”œâ”€ Mean Importance: 0.0000
   â”œâ”€ Max Importance: 0.0000
   â”œâ”€ Min Importance: 0.0000
   â””â”€ Top-5 Important Features: [0]
      â””â”€ Top-5 Values: ['0.0000']

ðŸ“Š Layer: LF_l5_FDCA.slice_att.linear
   â”œâ”€ Features: 1
   â”œâ”€ Mean Importance: 0.0000
   â”œâ”€ Max Importance: 0.0000
   â”œâ”€ Min Importance: 0.0000
   â””â”€ Top-5 Important Features: [0]
      â””â”€ Top-5 Values: ['0.0000']

ðŸ“Š Layer: LF_l5_FDCA.slice_att.non_linear
   â”œâ”€ Features: 1
   â”œâ”€ Mean Importance: 0.0000
   â”œâ”€ Max Importance: 0.0000
   â”œâ”€ Min Importance: 0.0000
   â””â”€ Top-5 Important Features: [0]
      â””â”€ Top-5 Values: ['0.0000']

ðŸ“Š Layer: LF_l5_FDCA.slice_att.mean
   â”œâ”€ Features: 1
   â”œâ”€ Mean Importance: 0.0017
   â”œâ”€ Max Importance: 0.0017
   â”œâ”€ Min Importance: 0.0017
   â””â”€ Top-5 Important Features: [0]
      â””â”€ Top-5 Values: ['0.0017']

ðŸ“Š Layer: LF_l5_FDCA.slice_att.log_diag
   â”œâ”€ Features: 1
   â”œâ”€ Mean Importance: 0.0000
   â”œâ”€ Max Importance: 0.0000
   â”œâ”€ Min Importance: 0.0000
   â””â”€ Top-5 Important Features: [0]
      â””â”€ Top-5 Values: ['0.0000']

ðŸ“Š Layer: LF_l5_FDCA.slice_att.factor
   â”œâ”€ Features: 1
   â”œâ”€ Mean Importance: 0.0001
   â”œâ”€ Max Importance: 0.0001
   â”œâ”€ Min Importance: 0.0001
   â””â”€ Top-5 Important Features: [0]
      â””â”€ Top-5 Values: ['0.0001']

ðŸ“Š Layer: LF_l5_FDCA.slice_att
   â”œâ”€ Features: 1
   â”œâ”€ Mean Importance: 0.0000
   â”œâ”€ Max Importance: 0.0000
   â”œâ”€ Min Importance: 0.0000
   â””â”€ Top-5 Important Features: [0]
      â””â”€ Top-5 Values: ['0.0000']

ðŸ“Š Layer: LF_l5_FDCA
   â”œâ”€ Features: 1
   â”œâ”€ Mean Importance: 0.0000
   â”œâ”€ Max Importance: 0.0000
   â”œâ”€ Min Importance: 0.0000
   â””â”€ Top-5 Important Features: [0]
      â””â”€ Top-5 Values: ['0.0000']

ðŸ“Š Layer: HF_l4_FDCA.semantic_att
   â”œâ”€ Features: 1
   â”œâ”€ Mean Importance: 0.0834
   â”œâ”€ Max Importance: 0.0834
   â”œâ”€ Min Importance: 0.0834
   â””â”€ Top-5 Important Features: [0]
      â””â”€ Top-5 Values: ['0.0834']

ðŸ“Š Layer: HF_l4_FDCA.positional_att.conv
   â”œâ”€ Features: 1
   â”œâ”€ Mean Importance: 8.8791
   â”œâ”€ Max Importance: 8.8791
   â”œâ”€ Min Importance: 8.8791
   â””â”€ Top-5 Important Features: [0]
      â””â”€ Top-5 Values: ['8.8791']

ðŸ“Š Layer: HF_l4_FDCA.positional_att
   â”œâ”€ Features: 1
   â”œâ”€ Mean Importance: 0.0020
   â”œâ”€ Max Importance: 0.0020
   â”œâ”€ Min Importance: 0.0020
   â””â”€ Top-5 Important Features: [0]
      â””â”€ Top-5 Values: ['0.0020']

ðŸ“Š Layer: HF_l4_FDCA.slice_att.linear.0
   â”œâ”€ Features: 1
   â”œâ”€ Mean Importance: 0.0000
   â”œâ”€ Max Importance: 0.0000
   â”œâ”€ Min Importance: 0.0000
   â””â”€ Top-5 Important Features: [0]
      â””â”€ Top-5 Values: ['0.0000']

ðŸ“Š Layer: HF_l4_FDCA.slice_att.linear.1
   â”œâ”€ Features: 1
   â”œâ”€ Mean Importance: 0.0000
   â”œâ”€ Max Importance: 0.0000
   â”œâ”€ Min Importance: 0.0000
   â””â”€ Top-5 Important Features: [0]
      â””â”€ Top-5 Values: ['0.0000']

ðŸ“Š Layer: HF_l4_FDCA.slice_att.linear.2
   â”œâ”€ Features: 1
   â”œâ”€ Mean Importance: 0.0000
   â”œâ”€ Max Importance: 0.0000
   â”œâ”€ Min Importance: 0.0000
   â””â”€ Top-5 Important Features: [0]
      â””â”€ Top-5 Values: ['0.0000']

ðŸ“Š Layer: HF_l4_FDCA.slice_att.linear
   â”œâ”€ Features: 1
   â”œâ”€ Mean Importance: 0.0000
   â”œâ”€ Max Importance: 0.0000
   â”œâ”€ Min Importance: 0.0000
   â””â”€ Top-5 Important Features: [0]
      â””â”€ Top-5 Values: ['0.0000']

ðŸ“Š Layer: HF_l4_FDCA.slice_att.non_linear
   â”œâ”€ Features: 1
   â”œâ”€ Mean Importance: 0.0000
   â”œâ”€ Max Importance: 0.0000
   â”œâ”€ Min Importance: 0.0000
   â””â”€ Top-5 Important Features: [0]
      â””â”€ Top-5 Values: ['0.0000']

ðŸ“Š Layer: HF_l4_FDCA.slice_att.mean
   â”œâ”€ Features: 1
   â”œâ”€ Mean Importance: 0.0000
   â”œâ”€ Max Importance: 0.0000
   â”œâ”€ Min Importance: 0.0000
   â””â”€ Top-5 Important Features: [0]
      â””â”€ Top-5 Values: ['0.0000']

ðŸ“Š Layer: HF_l4_FDCA.slice_att.log_diag
   â”œâ”€ Features: 1
   â”œâ”€ Mean Importance: 0.0000
   â”œâ”€ Max Importance: 0.0000
   â”œâ”€ Min Importance: 0.0000
   â””â”€ Top-5 Important Features: [0]
      â””â”€ Top-5 Values: ['0.0000']

ðŸ“Š Layer: HF_l4_FDCA.slice_att.factor
   â”œâ”€ Features: 1
   â”œâ”€ Mean Importance: 0.0000
   â”œâ”€ Max Importance: 0.0000
   â”œâ”€ Min Importance: 0.0000
   â””â”€ Top-5 Important Features: [0]
      â””â”€ Top-5 Values: ['0.0000']

ðŸ“Š Layer: HF_l4_FDCA.slice_att
   â”œâ”€ Features: 1
   â”œâ”€ Mean Importance: 0.0063
   â”œâ”€ Max Importance: 0.0063
   â”œâ”€ Min Importance: 0.0063
   â””â”€ Top-5 Important Features: [0]
      â””â”€ Top-5 Values: ['0.0063']

ðŸ“Š Layer: HF_l4_FDCA
   â”œâ”€ Features: 1
   â”œâ”€ Mean Importance: 0.7106
   â”œâ”€ Max Importance: 0.7106
   â”œâ”€ Min Importance: 0.7106
   â””â”€ Top-5 Important Features: [0]
      â””â”€ Top-5 Values: ['0.7106']

ðŸ“Š Layer: HF_l5_FDCA.semantic_att
   â”œâ”€ Features: 1
   â”œâ”€ Mean Importance: 0.0637
   â”œâ”€ Max Importance: 0.0637
   â”œâ”€ Min Importance: 0.0637
   â””â”€ Top-5 Important Features: [0]
      â””â”€ Top-5 Values: ['0.0637']

ðŸ“Š Layer: HF_l5_FDCA.positional_att.conv
   â”œâ”€ Features: 1
   â”œâ”€ Mean Importance: 13.4461
   â”œâ”€ Max Importance: 13.4461
   â”œâ”€ Min Importance: 13.4461
   â””â”€ Top-5 Important Features: [0]
      â””â”€ Top-5 Values: ['13.4461']

ðŸ“Š Layer: HF_l5_FDCA.positional_att
   â”œâ”€ Features: 1
   â”œâ”€ Mean Importance: 0.0001
   â”œâ”€ Max Importance: 0.0001
   â”œâ”€ Min Importance: 0.0001
   â””â”€ Top-5 Important Features: [0]
      â””â”€ Top-5 Values: ['0.0001']

ðŸ“Š Layer: HF_l5_FDCA.slice_att.linear.0
   â”œâ”€ Features: 1
   â”œâ”€ Mean Importance: 0.0000
   â”œâ”€ Max Importance: 0.0000
   â”œâ”€ Min Importance: 0.0000
   â””â”€ Top-5 Important Features: [0]
      â””â”€ Top-5 Values: ['0.0000']

ðŸ“Š Layer: HF_l5_FDCA.slice_att.linear.1
   â”œâ”€ Features: 1
   â”œâ”€ Mean Importance: 0.0000
   â”œâ”€ Max Importance: 0.0000
   â”œâ”€ Min Importance: 0.0000
   â””â”€ Top-5 Important Features: [0]
      â””â”€ Top-5 Values: ['0.0000']

ðŸ“Š Layer: HF_l5_FDCA.slice_att.linear.2
   â”œâ”€ Features: 1
   â”œâ”€ Mean Importance: 0.0000
   â”œâ”€ Max Importance: 0.0000
   â”œâ”€ Min Importance: 0.0000
   â””â”€ Top-5 Important Features: [0]
      â””â”€ Top-5 Values: ['0.0000']

ðŸ“Š Layer: HF_l5_FDCA.slice_att.linear
   â”œâ”€ Features: 1
   â”œâ”€ Mean Importance: 0.0000
   â”œâ”€ Max Importance: 0.0000
   â”œâ”€ Min Importance: 0.0000
   â””â”€ Top-5 Important Features: [0]
      â””â”€ Top-5 Values: ['0.0000']

ðŸ“Š Layer: HF_l5_FDCA.slice_att.non_linear
   â”œâ”€ Features: 1
   â”œâ”€ Mean Importance: 0.0000
   â”œâ”€ Max Importance: 0.0000
   â”œâ”€ Min Importance: 0.0000
   â””â”€ Top-5 Important Features: [0]
      â””â”€ Top-5 Values: ['0.0000']

ðŸ“Š Layer: HF_l5_FDCA.slice_att.mean
   â”œâ”€ Features: 1
   â”œâ”€ Mean Importance: 0.0000
   â”œâ”€ Max Importance: 0.0000
   â”œâ”€ Min Importance: 0.0000
   â””â”€ Top-5 Important Features: [0]
      â””â”€ Top-5 Values: ['0.0000']

ðŸ“Š Layer: HF_l5_FDCA.slice_att.log_diag
   â”œâ”€ Features: 1
   â”œâ”€ Mean Importance: 0.0000
   â”œâ”€ Max Importance: 0.0000
   â”œâ”€ Min Importance: 0.0000
   â””â”€ Top-5 Important Features: [0]
      â””â”€ Top-5 Values: ['0.0000']

ðŸ“Š Layer: HF_l5_FDCA.slice_att.factor
   â”œâ”€ Features: 1
   â”œâ”€ Mean Importance: 0.0000
   â”œâ”€ Max Importance: 0.0000
   â”œâ”€ Min Importance: 0.0000
   â””â”€ Top-5 Important Features: [0]
      â””â”€ Top-5 Values: ['0.0000']

ðŸ“Š Layer: HF_l5_FDCA.slice_att
   â”œâ”€ Features: 1
   â”œâ”€ Mean Importance: 0.0003
   â”œâ”€ Max Importance: 0.0003
   â”œâ”€ Min Importance: 0.0003
   â””â”€ Top-5 Important Features: [0]
      â””â”€ Top-5 Values: ['0.0003']

ðŸ“Š Layer: HF_l5_FDCA
   â”œâ”€ Features: 1
   â”œâ”€ Mean Importance: 0.0003
   â”œâ”€ Max Importance: 0.0003
   â”œâ”€ Min Importance: 0.0003
   â””â”€ Top-5 Important Features: [0]
      â””â”€ Top-5 Values: ['0.0003']

======================================================================
âœ“ Mechanistic analysis complete

[3] Generating Grad-CAM...
Warning: Failed to generate CAM for class 0: element 0 of tensors does not require grad and does not have a grad_fn
Warning: Failed to generate CAM for class 1: element 0 of tensors does not require grad and does not have a grad_fn
Warning: Failed to generate CAM for class 2: element 0 of tensors does not require grad and does not have a grad_fn
Warning: Failed to generate CAM for class 3: element 0 of tensors does not require grad and does not have a grad_fn
[4] Analyzing frequency components...
âœ“ Saved: outputs/xai_2025-11-15_17-25-23/freq_component/sample_0022_freq_comp.png
âœ“ Evaluation complete for sample_0022
Evaluating:  61%|######    | 23/38 [06:23<04:06, 16.41s/it]
[1] Getting primary prediction...

[METRICS FOR sample_0023]
==================================================
class_0: Dice=0.9987, IoU=0.9974
class_1: Dice=0.7516, IoU=0.6020
class_2: Dice=0.5017, IoU=0.3348
class_3: Dice=0.8419, IoU=0.7270
==================================================

[2] Generating attention maps...
Clipping input data to the valid range for imshow with RGB data ([0..1] for floats or [0..255] for integers).
Clipping input data to the valid range for imshow with RGB data ([0..1] for floats or [0..255] for integers).
âœ“ Saved: outputs/xai_2025-11-15_17-25-23/attention/sample_0023_attention.png

[MECHANISTIC INTERPRETABILITY ANALYSIS]
======================================================================
Sample: sample_0023
======================================================================

ðŸ“Š Layer: LF_l4_FDCA.semantic_att
   â”œâ”€ Features: 1
   â”œâ”€ Mean Importance: 0.1338
   â”œâ”€ Max Importance: 0.1338
   â”œâ”€ Min Importance: 0.1338
   â””â”€ Top-5 Important Features: [0]
      â””â”€ Top-5 Values: ['0.1338']

ðŸ“Š Layer: LF_l4_FDCA.positional_att.conv
   â”œâ”€ Features: 1
   â”œâ”€ Mean Importance: 307.1461
   â”œâ”€ Max Importance: 307.1461
   â”œâ”€ Min Importance: 307.1461
   â””â”€ Top-5 Important Features: [0]
      â””â”€ Top-5 Values: ['307.1461']

ðŸ“Š Layer: LF_l4_FDCA.positional_att
   â”œâ”€ Features: 1
   â”œâ”€ Mean Importance: 56.0659
   â”œâ”€ Max Importance: 56.0659
   â”œâ”€ Min Importance: 56.0659
   â””â”€ Top-5 Important Features: [0]
      â””â”€ Top-5 Values: ['56.0659']

ðŸ“Š Layer: LF_l4_FDCA.slice_att.linear.0
   â”œâ”€ Features: 1
   â”œâ”€ Mean Importance: 100.9067
   â”œâ”€ Max Importance: 100.9067
   â”œâ”€ Min Importance: 100.9067
   â””â”€ Top-5 Important Features: [0]
      â””â”€ Top-5 Values: ['100.9067']

ðŸ“Š Layer: LF_l4_FDCA.slice_att.linear.1
   â”œâ”€ Features: 1
   â”œâ”€ Mean Importance: 85.6048
   â”œâ”€ Max Importance: 85.6048
   â”œâ”€ Min Importance: 85.6048
   â””â”€ Top-5 Important Features: [0]
      â””â”€ Top-5 Values: ['85.6048']

ðŸ“Š Layer: LF_l4_FDCA.slice_att.linear.2
   â”œâ”€ Features: 1
   â”œâ”€ Mean Importance: 81.2211
   â”œâ”€ Max Importance: 81.2211
   â”œâ”€ Min Importance: 81.2211
   â””â”€ Top-5 Important Features: [0]
      â””â”€ Top-5 Values: ['81.2211']

ðŸ“Š Layer: LF_l4_FDCA.slice_att.linear
   â”œâ”€ Features: 1
   â”œâ”€ Mean Importance: 81.2211
   â”œâ”€ Max Importance: 81.2211
   â”œâ”€ Min Importance: 81.2211
   â””â”€ Top-5 Important Features: [0]
      â””â”€ Top-5 Values: ['81.2211']

ðŸ“Š Layer: LF_l4_FDCA.slice_att.non_linear
   â”œâ”€ Features: 1
   â”œâ”€ Mean Importance: 34919412.0000
   â”œâ”€ Max Importance: 34919412.0000
   â”œâ”€ Min Importance: 34919412.0000
   â””â”€ Top-5 Important Features: [0]
      â””â”€ Top-5 Values: ['34919412.0000']

ðŸ“Š Layer: LF_l4_FDCA.slice_att.mean
   â”œâ”€ Features: 1
   â”œâ”€ Mean Importance: 139516592.0000
   â”œâ”€ Max Importance: 139516592.0000
   â”œâ”€ Min Importance: 139516592.0000
   â””â”€ Top-5 Important Features: [0]
      â””â”€ Top-5 Values: ['139516592.0000']

ðŸ“Š Layer: LF_l4_FDCA.slice_att.log_diag
   â”œâ”€ Features: 1
   â”œâ”€ Mean Importance: 8647.0596
   â”œâ”€ Max Importance: 8647.0596
   â”œâ”€ Min Importance: 8647.0596
   â””â”€ Top-5 Important Features: [0]
      â””â”€ Top-5 Values: ['8647.0596']

ðŸ“Š Layer: LF_l4_FDCA.slice_att.factor
   â”œâ”€ Features: 1
   â”œâ”€ Mean Importance: 54041172.0000
   â”œâ”€ Max Importance: 54041172.0000
   â”œâ”€ Min Importance: 54041172.0000
   â””â”€ Top-5 Important Features: [0]
      â””â”€ Top-5 Values: ['54041172.0000']

ðŸ“Š Layer: LF_l4_FDCA.slice_att
   â”œâ”€ Features: 1
   â”œâ”€ Mean Importance: 23493330.0000
   â”œâ”€ Max Importance: 23493330.0000
   â”œâ”€ Min Importance: 23493330.0000
   â””â”€ Top-5 Important Features: [0]
      â””â”€ Top-5 Values: ['23493330.0000']

ðŸ“Š Layer: LF_l4_FDCA
   â”œâ”€ Features: 1
   â”œâ”€ Mean Importance: 4316890458346225664.0000
   â”œâ”€ Max Importance: 4316890458346225664.0000
   â”œâ”€ Min Importance: 4316890458346225664.0000
   â””â”€ Top-5 Important Features: [0]
      â””â”€ Top-5 Values: ['4316890458346225664.0000']

ðŸ“Š Layer: LF_l5_FDCA.semantic_att
   â”œâ”€ Features: 1
   â”œâ”€ Mean Importance: 0.0856
   â”œâ”€ Max Importance: 0.0856
   â”œâ”€ Min Importance: 0.0856
   â””â”€ Top-5 Important Features: [0]
      â””â”€ Top-5 Values: ['0.0856']

ðŸ“Š Layer: LF_l5_FDCA.positional_att.conv
   â”œâ”€ Features: 1
   â”œâ”€ Mean Importance: 70.8080
   â”œâ”€ Max Importance: 70.8080
   â”œâ”€ Min Importance: 70.8080
   â””â”€ Top-5 Important Features: [0]
      â””â”€ Top-5 Values: ['70.8080']

ðŸ“Š Layer: LF_l5_FDCA.positional_att
   â”œâ”€ Features: 1
   â”œâ”€ Mean Importance: 0.0000
   â”œâ”€ Max Importance: 0.0000
   â”œâ”€ Min Importance: 0.0000
   â””â”€ Top-5 Important Features: [0]
      â””â”€ Top-5 Values: ['0.0000']

ðŸ“Š Layer: LF_l5_FDCA.slice_att.linear.0
   â”œâ”€ Features: 1
   â”œâ”€ Mean Importance: 0.0000
   â”œâ”€ Max Importance: 0.0000
   â”œâ”€ Min Importance: 0.0000
   â””â”€ Top-5 Important Features: [0]
      â””â”€ Top-5 Values: ['0.0000']

ðŸ“Š Layer: LF_l5_FDCA.slice_att.linear.1
   â”œâ”€ Features: 1
   â”œâ”€ Mean Importance: 0.0000
   â”œâ”€ Max Importance: 0.0000
   â”œâ”€ Min Importance: 0.0000
   â””â”€ Top-5 Important Features: [0]
      â””â”€ Top-5 Values: ['0.0000']

ðŸ“Š Layer: LF_l5_FDCA.slice_att.linear.2
   â”œâ”€ Features: 1
   â”œâ”€ Mean Importance: 0.0000
   â”œâ”€ Max Importance: 0.0000
   â”œâ”€ Min Importance: 0.0000
   â””â”€ Top-5 Important Features: [0]
      â””â”€ Top-5 Values: ['0.0000']

ðŸ“Š Layer: LF_l5_FDCA.slice_att.linear
   â”œâ”€ Features: 1
   â”œâ”€ Mean Importance: 0.0000
   â”œâ”€ Max Importance: 0.0000
   â”œâ”€ Min Importance: 0.0000
   â””â”€ Top-5 Important Features: [0]
      â””â”€ Top-5 Values: ['0.0000']

ðŸ“Š Layer: LF_l5_FDCA.slice_att.non_linear
   â”œâ”€ Features: 1
   â”œâ”€ Mean Importance: 0.0000
   â”œâ”€ Max Importance: 0.0000
   â”œâ”€ Min Importance: 0.0000
   â””â”€ Top-5 Important Features: [0]
      â””â”€ Top-5 Values: ['0.0000']

ðŸ“Š Layer: LF_l5_FDCA.slice_att.mean
   â”œâ”€ Features: 1
   â”œâ”€ Mean Importance: 0.0017
   â”œâ”€ Max Importance: 0.0017
   â”œâ”€ Min Importance: 0.0017
   â””â”€ Top-5 Important Features: [0]
      â””â”€ Top-5 Values: ['0.0017']

ðŸ“Š Layer: LF_l5_FDCA.slice_att.log_diag
   â”œâ”€ Features: 1
   â”œâ”€ Mean Importance: 0.0000
   â”œâ”€ Max Importance: 0.0000
   â”œâ”€ Min Importance: 0.0000
   â””â”€ Top-5 Important Features: [0]
      â””â”€ Top-5 Values: ['0.0000']

ðŸ“Š Layer: LF_l5_FDCA.slice_att.factor
   â”œâ”€ Features: 1
   â”œâ”€ Mean Importance: 0.0001
   â”œâ”€ Max Importance: 0.0001
   â”œâ”€ Min Importance: 0.0001
   â””â”€ Top-5 Important Features: [0]
      â””â”€ Top-5 Values: ['0.0001']

ðŸ“Š Layer: LF_l5_FDCA.slice_att
   â”œâ”€ Features: 1
   â”œâ”€ Mean Importance: 0.0000
   â”œâ”€ Max Importance: 0.0000
   â”œâ”€ Min Importance: 0.0000
   â””â”€ Top-5 Important Features: [0]
      â””â”€ Top-5 Values: ['0.0000']

ðŸ“Š Layer: LF_l5_FDCA
   â”œâ”€ Features: 1
   â”œâ”€ Mean Importance: 0.0000
   â”œâ”€ Max Importance: 0.0000
   â”œâ”€ Min Importance: 0.0000
   â””â”€ Top-5 Important Features: [0]
      â””â”€ Top-5 Values: ['0.0000']

ðŸ“Š Layer: HF_l4_FDCA.semantic_att
   â”œâ”€ Features: 1
   â”œâ”€ Mean Importance: 0.0837
   â”œâ”€ Max Importance: 0.0837
   â”œâ”€ Min Importance: 0.0837
   â””â”€ Top-5 Important Features: [0]
      â””â”€ Top-5 Values: ['0.0837']

ðŸ“Š Layer: HF_l4_FDCA.positional_att.conv
   â”œâ”€ Features: 1
   â”œâ”€ Mean Importance: 9.7697
   â”œâ”€ Max Importance: 9.7697
   â”œâ”€ Min Importance: 9.7697
   â””â”€ Top-5 Important Features: [0]
      â””â”€ Top-5 Values: ['9.7697']

ðŸ“Š Layer: HF_l4_FDCA.positional_att
   â”œâ”€ Features: 1
   â”œâ”€ Mean Importance: 0.0017
   â”œâ”€ Max Importance: 0.0017
   â”œâ”€ Min Importance: 0.0017
   â””â”€ Top-5 Important Features: [0]
      â””â”€ Top-5 Values: ['0.0017']

ðŸ“Š Layer: HF_l4_FDCA.slice_att.linear.0
   â”œâ”€ Features: 1
   â”œâ”€ Mean Importance: 0.0000
   â”œâ”€ Max Importance: 0.0000
   â”œâ”€ Min Importance: 0.0000
   â””â”€ Top-5 Important Features: [0]
      â””â”€ Top-5 Values: ['0.0000']

ðŸ“Š Layer: HF_l4_FDCA.slice_att.linear.1
   â”œâ”€ Features: 1
   â”œâ”€ Mean Importance: 0.0000
   â”œâ”€ Max Importance: 0.0000
   â”œâ”€ Min Importance: 0.0000
   â””â”€ Top-5 Important Features: [0]
      â””â”€ Top-5 Values: ['0.0000']

ðŸ“Š Layer: HF_l4_FDCA.slice_att.linear.2
   â”œâ”€ Features: 1
   â”œâ”€ Mean Importance: 0.0000
   â”œâ”€ Max Importance: 0.0000
   â”œâ”€ Min Importance: 0.0000
   â””â”€ Top-5 Important Features: [0]
      â””â”€ Top-5 Values: ['0.0000']

ðŸ“Š Layer: HF_l4_FDCA.slice_att.linear
   â”œâ”€ Features: 1
   â”œâ”€ Mean Importance: 0.0000
   â”œâ”€ Max Importance: 0.0000
   â”œâ”€ Min Importance: 0.0000
   â””â”€ Top-5 Important Features: [0]
      â””â”€ Top-5 Values: ['0.0000']

ðŸ“Š Layer: HF_l4_FDCA.slice_att.non_linear
   â”œâ”€ Features: 1
   â”œâ”€ Mean Importance: 0.0000
   â”œâ”€ Max Importance: 0.0000
   â”œâ”€ Min Importance: 0.0000
   â””â”€ Top-5 Important Features: [0]
      â””â”€ Top-5 Values: ['0.0000']

ðŸ“Š Layer: HF_l4_FDCA.slice_att.mean
   â”œâ”€ Features: 1
   â”œâ”€ Mean Importance: 0.0000
   â”œâ”€ Max Importance: 0.0000
   â”œâ”€ Min Importance: 0.0000
   â””â”€ Top-5 Important Features: [0]
      â””â”€ Top-5 Values: ['0.0000']

ðŸ“Š Layer: HF_l4_FDCA.slice_att.log_diag
   â”œâ”€ Features: 1
   â”œâ”€ Mean Importance: 0.0000
   â”œâ”€ Max Importance: 0.0000
   â”œâ”€ Min Importance: 0.0000
   â””â”€ Top-5 Important Features: [0]
      â””â”€ Top-5 Values: ['0.0000']

ðŸ“Š Layer: HF_l4_FDCA.slice_att.factor
   â”œâ”€ Features: 1
   â”œâ”€ Mean Importance: 0.0000
   â”œâ”€ Max Importance: 0.0000
   â”œâ”€ Min Importance: 0.0000
   â””â”€ Top-5 Important Features: [0]
      â””â”€ Top-5 Values: ['0.0000']

ðŸ“Š Layer: HF_l4_FDCA.slice_att
   â”œâ”€ Features: 1
   â”œâ”€ Mean Importance: 0.0042
   â”œâ”€ Max Importance: 0.0042
   â”œâ”€ Min Importance: 0.0042
   â””â”€ Top-5 Important Features: [0]
      â””â”€ Top-5 Values: ['0.0042']

ðŸ“Š Layer: HF_l4_FDCA
   â”œâ”€ Features: 1
   â”œâ”€ Mean Importance: 0.5019
   â”œâ”€ Max Importance: 0.5019
   â”œâ”€ Min Importance: 0.5019
   â””â”€ Top-5 Important Features: [0]
      â””â”€ Top-5 Values: ['0.5019']

ðŸ“Š Layer: HF_l5_FDCA.semantic_att
   â”œâ”€ Features: 1
   â”œâ”€ Mean Importance: 0.0707
   â”œâ”€ Max Importance: 0.0707
   â”œâ”€ Min Importance: 0.0707
   â””â”€ Top-5 Important Features: [0]
      â””â”€ Top-5 Values: ['0.0707']

ðŸ“Š Layer: HF_l5_FDCA.positional_att.conv
   â”œâ”€ Features: 1
   â”œâ”€ Mean Importance: 21.1653
   â”œâ”€ Max Importance: 21.1653
   â”œâ”€ Min Importance: 21.1653
   â””â”€ Top-5 Important Features: [0]
      â””â”€ Top-5 Values: ['21.1653']

ðŸ“Š Layer: HF_l5_FDCA.positional_att
   â”œâ”€ Features: 1
   â”œâ”€ Mean Importance: 0.0001
   â”œâ”€ Max Importance: 0.0001
   â”œâ”€ Min Importance: 0.0001
   â””â”€ Top-5 Important Features: [0]
      â””â”€ Top-5 Values: ['0.0001']

ðŸ“Š Layer: HF_l5_FDCA.slice_att.linear.0
   â”œâ”€ Features: 1
   â”œâ”€ Mean Importance: 0.0000
   â”œâ”€ Max Importance: 0.0000
   â”œâ”€ Min Importance: 0.0000
   â””â”€ Top-5 Important Features: [0]
      â””â”€ Top-5 Values: ['0.0000']

ðŸ“Š Layer: HF_l5_FDCA.slice_att.linear.1
   â”œâ”€ Features: 1
   â”œâ”€ Mean Importance: 0.0000
   â”œâ”€ Max Importance: 0.0000
   â”œâ”€ Min Importance: 0.0000
   â””â”€ Top-5 Important Features: [0]
      â””â”€ Top-5 Values: ['0.0000']

ðŸ“Š Layer: HF_l5_FDCA.slice_att.linear.2
   â”œâ”€ Features: 1
   â”œâ”€ Mean Importance: 0.0000
   â”œâ”€ Max Importance: 0.0000
   â”œâ”€ Min Importance: 0.0000
   â””â”€ Top-5 Important Features: [0]
      â””â”€ Top-5 Values: ['0.0000']

ðŸ“Š Layer: HF_l5_FDCA.slice_att.linear
   â”œâ”€ Features: 1
   â”œâ”€ Mean Importance: 0.0000
   â”œâ”€ Max Importance: 0.0000
   â”œâ”€ Min Importance: 0.0000
   â””â”€ Top-5 Important Features: [0]
      â””â”€ Top-5 Values: ['0.0000']

ðŸ“Š Layer: HF_l5_FDCA.slice_att.non_linear
   â”œâ”€ Features: 1
   â”œâ”€ Mean Importance: 0.0000
   â”œâ”€ Max Importance: 0.0000
   â”œâ”€ Min Importance: 0.0000
   â””â”€ Top-5 Important Features: [0]
      â””â”€ Top-5 Values: ['0.0000']

ðŸ“Š Layer: HF_l5_FDCA.slice_att.mean
   â”œâ”€ Features: 1
   â”œâ”€ Mean Importance: 0.0000
   â”œâ”€ Max Importance: 0.0000
   â”œâ”€ Min Importance: 0.0000
   â””â”€ Top-5 Important Features: [0]
      â””â”€ Top-5 Values: ['0.0000']

ðŸ“Š Layer: HF_l5_FDCA.slice_att.log_diag
   â”œâ”€ Features: 1
   â”œâ”€ Mean Importance: 0.0000
   â”œâ”€ Max Importance: 0.0000
   â”œâ”€ Min Importance: 0.0000
   â””â”€ Top-5 Important Features: [0]
      â””â”€ Top-5 Values: ['0.0000']

ðŸ“Š Layer: HF_l5_FDCA.slice_att.factor
   â”œâ”€ Features: 1
   â”œâ”€ Mean Importance: 0.0000
   â”œâ”€ Max Importance: 0.0000
   â”œâ”€ Min Importance: 0.0000
   â””â”€ Top-5 Important Features: [0]
      â””â”€ Top-5 Values: ['0.0000']

ðŸ“Š Layer: HF_l5_FDCA.slice_att
   â”œâ”€ Features: 1
   â”œâ”€ Mean Importance: 0.0001
   â”œâ”€ Max Importance: 0.0001
   â”œâ”€ Min Importance: 0.0001
   â””â”€ Top-5 Important Features: [0]
      â””â”€ Top-5 Values: ['0.0001']

ðŸ“Š Layer: HF_l5_FDCA
   â”œâ”€ Features: 1
   â”œâ”€ Mean Importance: 0.0002
   â”œâ”€ Max Importance: 0.0002
   â”œâ”€ Min Importance: 0.0002
   â””â”€ Top-5 Important Features: [0]
      â””â”€ Top-5 Values: ['0.0002']

======================================================================
âœ“ Mechanistic analysis complete

[3] Generating Grad-CAM...
Warning: Failed to generate CAM for class 0: element 0 of tensors does not require grad and does not have a grad_fn
Warning: Failed to generate CAM for class 1: element 0 of tensors does not require grad and does not have a grad_fn
Warning: Failed to generate CAM for class 2: element 0 of tensors does not require grad and does not have a grad_fn
Warning: Failed to generate CAM for class 3: element 0 of tensors does not require grad and does not have a grad_fn
[4] Analyzing frequency components...
âœ“ Saved: outputs/xai_2025-11-15_17-25-23/freq_component/sample_0023_freq_comp.png
âœ“ Evaluation complete for sample_0023
Evaluating:  63%|######3   | 24/38 [06:40<03:53, 16.71s/it]
[1] Getting primary prediction...

[METRICS FOR sample_0024]
==================================================
class_0: Dice=0.9927, IoU=0.9856
class_1: Dice=0.7923, IoU=0.6561
class_2: Dice=0.7589, IoU=0.6114
class_3: Dice=0.0000, IoU=0.0000
==================================================

[2] Generating attention maps...
Clipping input data to the valid range for imshow with RGB data ([0..1] for floats or [0..255] for integers).
Clipping input data to the valid range for imshow with RGB data ([0..1] for floats or [0..255] for integers).
âœ“ Saved: outputs/xai_2025-11-15_17-25-23/attention/sample_0024_attention.png

[MECHANISTIC INTERPRETABILITY ANALYSIS]
======================================================================
Sample: sample_0024
======================================================================

ðŸ“Š Layer: LF_l4_FDCA.semantic_att
   â”œâ”€ Features: 1
   â”œâ”€ Mean Importance: 0.1168
   â”œâ”€ Max Importance: 0.1168
   â”œâ”€ Min Importance: 0.1168
   â””â”€ Top-5 Important Features: [0]
      â””â”€ Top-5 Values: ['0.1168']

ðŸ“Š Layer: LF_l4_FDCA.positional_att.conv
   â”œâ”€ Features: 1
   â”œâ”€ Mean Importance: 244.0032
   â”œâ”€ Max Importance: 244.0032
   â”œâ”€ Min Importance: 244.0032
   â””â”€ Top-5 Important Features: [0]
      â””â”€ Top-5 Values: ['244.0032']

ðŸ“Š Layer: LF_l4_FDCA.positional_att
   â”œâ”€ Features: 1
   â”œâ”€ Mean Importance: 42.8644
   â”œâ”€ Max Importance: 42.8644
   â”œâ”€ Min Importance: 42.8644
   â””â”€ Top-5 Important Features: [0]
      â””â”€ Top-5 Values: ['42.8644']

ðŸ“Š Layer: LF_l4_FDCA.slice_att.linear.0
   â”œâ”€ Features: 1
   â”œâ”€ Mean Importance: 72.6377
   â”œâ”€ Max Importance: 72.6377
   â”œâ”€ Min Importance: 72.6377
   â””â”€ Top-5 Important Features: [0]
      â””â”€ Top-5 Values: ['72.6377']

ðŸ“Š Layer: LF_l4_FDCA.slice_att.linear.1
   â”œâ”€ Features: 1
   â”œâ”€ Mean Importance: 61.6185
   â”œâ”€ Max Importance: 61.6185
   â”œâ”€ Min Importance: 61.6185
   â””â”€ Top-5 Important Features: [0]
      â””â”€ Top-5 Values: ['61.6185']

ðŸ“Š Layer: LF_l4_FDCA.slice_att.linear.2
   â”œâ”€ Features: 1
   â”œâ”€ Mean Importance: 58.4750
   â”œâ”€ Max Importance: 58.4750
   â”œâ”€ Min Importance: 58.4750
   â””â”€ Top-5 Important Features: [0]
      â””â”€ Top-5 Values: ['58.4750']

ðŸ“Š Layer: LF_l4_FDCA.slice_att.linear
   â”œâ”€ Features: 1
   â”œâ”€ Mean Importance: 58.4750
   â”œâ”€ Max Importance: 58.4750
   â”œâ”€ Min Importance: 58.4750
   â””â”€ Top-5 Important Features: [0]
      â””â”€ Top-5 Values: ['58.4750']

ðŸ“Š Layer: LF_l4_FDCA.slice_att.non_linear
   â”œâ”€ Features: 1
   â”œâ”€ Mean Importance: 25001420.0000
   â”œâ”€ Max Importance: 25001420.0000
   â”œâ”€ Min Importance: 25001420.0000
   â””â”€ Top-5 Important Features: [0]
      â””â”€ Top-5 Values: ['25001420.0000']

ðŸ“Š Layer: LF_l4_FDCA.slice_att.mean
   â”œâ”€ Features: 1
   â”œâ”€ Mean Importance: 99895480.0000
   â”œâ”€ Max Importance: 99895480.0000
   â”œâ”€ Min Importance: 99895480.0000
   â””â”€ Top-5 Important Features: [0]
      â””â”€ Top-5 Values: ['99895480.0000']

ðŸ“Š Layer: LF_l4_FDCA.slice_att.log_diag
   â”œâ”€ Features: 1
   â”œâ”€ Mean Importance: 6191.3511
   â”œâ”€ Max Importance: 6191.3511
   â”œâ”€ Min Importance: 6191.3511
   â””â”€ Top-5 Important Features: [0]
      â””â”€ Top-5 Values: ['6191.3511']

ðŸ“Š Layer: LF_l4_FDCA.slice_att.factor
   â”œâ”€ Features: 1
   â”œâ”€ Mean Importance: 38694164.0000
   â”œâ”€ Max Importance: 38694164.0000
   â”œâ”€ Min Importance: 38694164.0000
   â””â”€ Top-5 Important Features: [0]
      â””â”€ Top-5 Values: ['38694164.0000']

ðŸ“Š Layer: LF_l4_FDCA.slice_att
   â”œâ”€ Features: 1
   â”œâ”€ Mean Importance: 15938844.0000
   â”œâ”€ Max Importance: 15938844.0000
   â”œâ”€ Min Importance: 15938844.0000
   â””â”€ Top-5 Important Features: [0]
      â””â”€ Top-5 Values: ['15938844.0000']

ðŸ“Š Layer: LF_l4_FDCA
   â”œâ”€ Features: 1
   â”œâ”€ Mean Importance: 2180411684789682176.0000
   â”œâ”€ Max Importance: 2180411684789682176.0000
   â”œâ”€ Min Importance: 2180411684789682176.0000
   â””â”€ Top-5 Important Features: [0]
      â””â”€ Top-5 Values: ['2180411684789682176.0000']

ðŸ“Š Layer: LF_l5_FDCA.semantic_att
   â”œâ”€ Features: 1
   â”œâ”€ Mean Importance: 0.0801
   â”œâ”€ Max Importance: 0.0801
   â”œâ”€ Min Importance: 0.0801
   â””â”€ Top-5 Important Features: [0]
      â””â”€ Top-5 Values: ['0.0801']

ðŸ“Š Layer: LF_l5_FDCA.positional_att.conv
   â”œâ”€ Features: 1
   â”œâ”€ Mean Importance: 68.1466
   â”œâ”€ Max Importance: 68.1466
   â”œâ”€ Min Importance: 68.1466
   â””â”€ Top-5 Important Features: [0]
      â””â”€ Top-5 Values: ['68.1466']

ðŸ“Š Layer: LF_l5_FDCA.positional_att
   â”œâ”€ Features: 1
   â”œâ”€ Mean Importance: 0.0000
   â”œâ”€ Max Importance: 0.0000
   â”œâ”€ Min Importance: 0.0000
   â””â”€ Top-5 Important Features: [0]
      â””â”€ Top-5 Values: ['0.0000']

ðŸ“Š Layer: LF_l5_FDCA.slice_att.linear.0
   â”œâ”€ Features: 1
   â”œâ”€ Mean Importance: 0.0000
   â”œâ”€ Max Importance: 0.0000
   â”œâ”€ Min Importance: 0.0000
   â””â”€ Top-5 Important Features: [0]
      â””â”€ Top-5 Values: ['0.0000']

ðŸ“Š Layer: LF_l5_FDCA.slice_att.linear.1
   â”œâ”€ Features: 1
   â”œâ”€ Mean Importance: 0.0000
   â”œâ”€ Max Importance: 0.0000
   â”œâ”€ Min Importance: 0.0000
   â””â”€ Top-5 Important Features: [0]
      â””â”€ Top-5 Values: ['0.0000']

ðŸ“Š Layer: LF_l5_FDCA.slice_att.linear.2
   â”œâ”€ Features: 1
   â”œâ”€ Mean Importance: 0.0000
   â”œâ”€ Max Importance: 0.0000
   â”œâ”€ Min Importance: 0.0000
   â””â”€ Top-5 Important Features: [0]
      â””â”€ Top-5 Values: ['0.0000']

ðŸ“Š Layer: LF_l5_FDCA.slice_att.linear
   â”œâ”€ Features: 1
   â”œâ”€ Mean Importance: 0.0000
   â”œâ”€ Max Importance: 0.0000
   â”œâ”€ Min Importance: 0.0000
   â””â”€ Top-5 Important Features: [0]
      â””â”€ Top-5 Values: ['0.0000']

ðŸ“Š Layer: LF_l5_FDCA.slice_att.non_linear
   â”œâ”€ Features: 1
   â”œâ”€ Mean Importance: 0.0000
   â”œâ”€ Max Importance: 0.0000
   â”œâ”€ Min Importance: 0.0000
   â””â”€ Top-5 Important Features: [0]
      â””â”€ Top-5 Values: ['0.0000']

ðŸ“Š Layer: LF_l5_FDCA.slice_att.mean
   â”œâ”€ Features: 1
   â”œâ”€ Mean Importance: 0.0017
   â”œâ”€ Max Importance: 0.0017
   â”œâ”€ Min Importance: 0.0017
   â””â”€ Top-5 Important Features: [0]
      â””â”€ Top-5 Values: ['0.0017']

ðŸ“Š Layer: LF_l5_FDCA.slice_att.log_diag
   â”œâ”€ Features: 1
   â”œâ”€ Mean Importance: 0.0000
   â”œâ”€ Max Importance: 0.0000
   â”œâ”€ Min Importance: 0.0000
   â””â”€ Top-5 Important Features: [0]
      â””â”€ Top-5 Values: ['0.0000']

ðŸ“Š Layer: LF_l5_FDCA.slice_att.factor
   â”œâ”€ Features: 1
   â”œâ”€ Mean Importance: 0.0001
   â”œâ”€ Max Importance: 0.0001
   â”œâ”€ Min Importance: 0.0001
   â””â”€ Top-5 Important Features: [0]
      â””â”€ Top-5 Values: ['0.0001']

ðŸ“Š Layer: LF_l5_FDCA.slice_att
   â”œâ”€ Features: 1
   â”œâ”€ Mean Importance: 0.0000
   â”œâ”€ Max Importance: 0.0000
   â”œâ”€ Min Importance: 0.0000
   â””â”€ Top-5 Important Features: [0]
      â””â”€ Top-5 Values: ['0.0000']

ðŸ“Š Layer: LF_l5_FDCA
   â”œâ”€ Features: 1
   â”œâ”€ Mean Importance: 0.0000
   â”œâ”€ Max Importance: 0.0000
   â”œâ”€ Min Importance: 0.0000
   â””â”€ Top-5 Important Features: [0]
      â””â”€ Top-5 Values: ['0.0000']

ðŸ“Š Layer: HF_l4_FDCA.semantic_att
   â”œâ”€ Features: 1
   â”œâ”€ Mean Importance: 0.0829
   â”œâ”€ Max Importance: 0.0829
   â”œâ”€ Min Importance: 0.0829
   â””â”€ Top-5 Important Features: [0]
      â””â”€ Top-5 Values: ['0.0829']

ðŸ“Š Layer: HF_l4_FDCA.positional_att.conv
   â”œâ”€ Features: 1
   â”œâ”€ Mean Importance: 8.4598
   â”œâ”€ Max Importance: 8.4598
   â”œâ”€ Min Importance: 8.4598
   â””â”€ Top-5 Important Features: [0]
      â””â”€ Top-5 Values: ['8.4598']

ðŸ“Š Layer: HF_l4_FDCA.positional_att
   â”œâ”€ Features: 1
   â”œâ”€ Mean Importance: 0.0018
   â”œâ”€ Max Importance: 0.0018
   â”œâ”€ Min Importance: 0.0018
   â””â”€ Top-5 Important Features: [0]
      â””â”€ Top-5 Values: ['0.0018']

ðŸ“Š Layer: HF_l4_FDCA.slice_att.linear.0
   â”œâ”€ Features: 1
   â”œâ”€ Mean Importance: 0.0000
   â”œâ”€ Max Importance: 0.0000
   â”œâ”€ Min Importance: 0.0000
   â””â”€ Top-5 Important Features: [0]
      â””â”€ Top-5 Values: ['0.0000']

ðŸ“Š Layer: HF_l4_FDCA.slice_att.linear.1
   â”œâ”€ Features: 1
   â”œâ”€ Mean Importance: 0.0000
   â”œâ”€ Max Importance: 0.0000
   â”œâ”€ Min Importance: 0.0000
   â””â”€ Top-5 Important Features: [0]
      â””â”€ Top-5 Values: ['0.0000']

ðŸ“Š Layer: HF_l4_FDCA.slice_att.linear.2
   â”œâ”€ Features: 1
   â”œâ”€ Mean Importance: 0.0000
   â”œâ”€ Max Importance: 0.0000
   â”œâ”€ Min Importance: 0.0000
   â””â”€ Top-5 Important Features: [0]
      â””â”€ Top-5 Values: ['0.0000']

ðŸ“Š Layer: HF_l4_FDCA.slice_att.linear
   â”œâ”€ Features: 1
   â”œâ”€ Mean Importance: 0.0000
   â”œâ”€ Max Importance: 0.0000
   â”œâ”€ Min Importance: 0.0000
   â””â”€ Top-5 Important Features: [0]
      â””â”€ Top-5 Values: ['0.0000']

ðŸ“Š Layer: HF_l4_FDCA.slice_att.non_linear
   â”œâ”€ Features: 1
   â”œâ”€ Mean Importance: 0.0000
   â”œâ”€ Max Importance: 0.0000
   â”œâ”€ Min Importance: 0.0000
   â””â”€ Top-5 Important Features: [0]
      â””â”€ Top-5 Values: ['0.0000']

ðŸ“Š Layer: HF_l4_FDCA.slice_att.mean
   â”œâ”€ Features: 1
   â”œâ”€ Mean Importance: 0.0000
   â”œâ”€ Max Importance: 0.0000
   â”œâ”€ Min Importance: 0.0000
   â””â”€ Top-5 Important Features: [0]
      â””â”€ Top-5 Values: ['0.0000']

ðŸ“Š Layer: HF_l4_FDCA.slice_att.log_diag
   â”œâ”€ Features: 1
   â”œâ”€ Mean Importance: 0.0000
   â”œâ”€ Max Importance: 0.0000
   â”œâ”€ Min Importance: 0.0000
   â””â”€ Top-5 Important Features: [0]
      â””â”€ Top-5 Values: ['0.0000']

ðŸ“Š Layer: HF_l4_FDCA.slice_att.factor
   â”œâ”€ Features: 1
   â”œâ”€ Mean Importance: 0.0000
   â”œâ”€ Max Importance: 0.0000
   â”œâ”€ Min Importance: 0.0000
   â””â”€ Top-5 Important Features: [0]
      â””â”€ Top-5 Values: ['0.0000']

ðŸ“Š Layer: HF_l4_FDCA.slice_att
   â”œâ”€ Features: 1
   â”œâ”€ Mean Importance: 0.0044
   â”œâ”€ Max Importance: 0.0044
   â”œâ”€ Min Importance: 0.0044
   â””â”€ Top-5 Important Features: [0]
      â””â”€ Top-5 Values: ['0.0044']

ðŸ“Š Layer: HF_l4_FDCA
   â”œâ”€ Features: 1
   â”œâ”€ Mean Importance: 1.1493
   â”œâ”€ Max Importance: 1.1493
   â”œâ”€ Min Importance: 1.1493
   â””â”€ Top-5 Important Features: [0]
      â””â”€ Top-5 Values: ['1.1493']

ðŸ“Š Layer: HF_l5_FDCA.semantic_att
   â”œâ”€ Features: 1
   â”œâ”€ Mean Importance: 0.0767
   â”œâ”€ Max Importance: 0.0767
   â”œâ”€ Min Importance: 0.0767
   â””â”€ Top-5 Important Features: [0]
      â””â”€ Top-5 Values: ['0.0767']

ðŸ“Š Layer: HF_l5_FDCA.positional_att.conv
   â”œâ”€ Features: 1
   â”œâ”€ Mean Importance: 21.2104
   â”œâ”€ Max Importance: 21.2104
   â”œâ”€ Min Importance: 21.2104
   â””â”€ Top-5 Important Features: [0]
      â””â”€ Top-5 Values: ['21.2104']

ðŸ“Š Layer: HF_l5_FDCA.positional_att
   â”œâ”€ Features: 1
   â”œâ”€ Mean Importance: 0.0000
   â”œâ”€ Max Importance: 0.0000
   â”œâ”€ Min Importance: 0.0000
   â””â”€ Top-5 Important Features: [0]
      â””â”€ Top-5 Values: ['0.0000']

ðŸ“Š Layer: HF_l5_FDCA.slice_att.linear.0
   â”œâ”€ Features: 1
   â”œâ”€ Mean Importance: 0.0000
   â”œâ”€ Max Importance: 0.0000
   â”œâ”€ Min Importance: 0.0000
   â””â”€ Top-5 Important Features: [0]
      â””â”€ Top-5 Values: ['0.0000']

ðŸ“Š Layer: HF_l5_FDCA.slice_att.linear.1
   â”œâ”€ Features: 1
   â”œâ”€ Mean Importance: 0.0000
   â”œâ”€ Max Importance: 0.0000
   â”œâ”€ Min Importance: 0.0000
   â””â”€ Top-5 Important Features: [0]
      â””â”€ Top-5 Values: ['0.0000']

ðŸ“Š Layer: HF_l5_FDCA.slice_att.linear.2
   â”œâ”€ Features: 1
   â”œâ”€ Mean Importance: 0.0000
   â”œâ”€ Max Importance: 0.0000
   â”œâ”€ Min Importance: 0.0000
   â””â”€ Top-5 Important Features: [0]
      â””â”€ Top-5 Values: ['0.0000']

ðŸ“Š Layer: HF_l5_FDCA.slice_att.linear
   â”œâ”€ Features: 1
   â”œâ”€ Mean Importance: 0.0000
   â”œâ”€ Max Importance: 0.0000
   â”œâ”€ Min Importance: 0.0000
   â””â”€ Top-5 Important Features: [0]
      â””â”€ Top-5 Values: ['0.0000']

ðŸ“Š Layer: HF_l5_FDCA.slice_att.non_linear
   â”œâ”€ Features: 1
   â”œâ”€ Mean Importance: 0.0000
   â”œâ”€ Max Importance: 0.0000
   â”œâ”€ Min Importance: 0.0000
   â””â”€ Top-5 Important Features: [0]
      â””â”€ Top-5 Values: ['0.0000']

ðŸ“Š Layer: HF_l5_FDCA.slice_att.mean
   â”œâ”€ Features: 1
   â”œâ”€ Mean Importance: 0.0000
   â”œâ”€ Max Importance: 0.0000
   â”œâ”€ Min Importance: 0.0000
   â””â”€ Top-5 Important Features: [0]
      â””â”€ Top-5 Values: ['0.0000']

ðŸ“Š Layer: HF_l5_FDCA.slice_att.log_diag
   â”œâ”€ Features: 1
   â”œâ”€ Mean Importance: 0.0000
   â”œâ”€ Max Importance: 0.0000
   â”œâ”€ Min Importance: 0.0000
   â””â”€ Top-5 Important Features: [0]
      â””â”€ Top-5 Values: ['0.0000']

ðŸ“Š Layer: HF_l5_FDCA.slice_att.factor
   â”œâ”€ Features: 1
   â”œâ”€ Mean Importance: 0.0000
   â”œâ”€ Max Importance: 0.0000
   â”œâ”€ Min Importance: 0.0000
   â””â”€ Top-5 Important Features: [0]
      â””â”€ Top-5 Values: ['0.0000']

ðŸ“Š Layer: HF_l5_FDCA.slice_att
   â”œâ”€ Features: 1
   â”œâ”€ Mean Importance: 0.0000
   â”œâ”€ Max Importance: 0.0000
   â”œâ”€ Min Importance: 0.0000
   â””â”€ Top-5 Important Features: [0]
      â””â”€ Top-5 Values: ['0.0000']

ðŸ“Š Layer: HF_l5_FDCA
   â”œâ”€ Features: 1
   â”œâ”€ Mean Importance: 0.0001
   â”œâ”€ Max Importance: 0.0001
   â”œâ”€ Min Importance: 0.0001
   â””â”€ Top-5 Important Features: [0]
      â””â”€ Top-5 Values: ['0.0001']

======================================================================
âœ“ Mechanistic analysis complete

[3] Generating Grad-CAM...
Warning: Failed to generate CAM for class 0: element 0 of tensors does not require grad and does not have a grad_fn
Warning: Failed to generate CAM for class 1: element 0 of tensors does not require grad and does not have a grad_fn
Warning: Failed to generate CAM for class 2: element 0 of tensors does not require grad and does not have a grad_fn
Warning: Failed to generate CAM for class 3: element 0 of tensors does not require grad and does not have a grad_fn
[4] Analyzing frequency components...
âœ“ Saved: outputs/xai_2025-11-15_17-25-23/freq_component/sample_0024_freq_comp.png
âœ“ Evaluation complete for sample_0024
Evaluating:  66%|######5   | 25/38 [06:56<03:36, 16.62s/it]
[1] Getting primary prediction...

[METRICS FOR sample_0025]
==================================================
class_0: Dice=0.9974, IoU=0.9949
class_1: Dice=0.9792, IoU=0.9592
class_2: Dice=0.9535, IoU=0.9111
class_3: Dice=0.9474, IoU=0.9000
==================================================

[2] Generating attention maps...
Clipping input data to the valid range for imshow with RGB data ([0..1] for floats or [0..255] for integers).
Clipping input data to the valid range for imshow with RGB data ([0..1] for floats or [0..255] for integers).
âœ“ Saved: outputs/xai_2025-11-15_17-25-23/attention/sample_0025_attention.png

[MECHANISTIC INTERPRETABILITY ANALYSIS]
======================================================================
Sample: sample_0025
======================================================================

ðŸ“Š Layer: LF_l4_FDCA.semantic_att
   â”œâ”€ Features: 1
   â”œâ”€ Mean Importance: 0.1254
   â”œâ”€ Max Importance: 0.1254
   â”œâ”€ Min Importance: 0.1254
   â””â”€ Top-5 Important Features: [0]
      â””â”€ Top-5 Values: ['0.1254']

ðŸ“Š Layer: LF_l4_FDCA.positional_att.conv
   â”œâ”€ Features: 1
   â”œâ”€ Mean Importance: 293.8205
   â”œâ”€ Max Importance: 293.8205
   â”œâ”€ Min Importance: 293.8205
   â””â”€ Top-5 Important Features: [0]
      â””â”€ Top-5 Values: ['293.8205']

ðŸ“Š Layer: LF_l4_FDCA.positional_att
   â”œâ”€ Features: 1
   â”œâ”€ Mean Importance: 52.9815
   â”œâ”€ Max Importance: 52.9815
   â”œâ”€ Min Importance: 52.9815
   â””â”€ Top-5 Important Features: [0]
      â””â”€ Top-5 Values: ['52.9815']

ðŸ“Š Layer: LF_l4_FDCA.slice_att.linear.0
   â”œâ”€ Features: 1
   â”œâ”€ Mean Importance: 100.3881
   â”œâ”€ Max Importance: 100.3881
   â”œâ”€ Min Importance: 100.3881
   â””â”€ Top-5 Important Features: [0]
      â””â”€ Top-5 Values: ['100.3881']

ðŸ“Š Layer: LF_l4_FDCA.slice_att.linear.1
   â”œâ”€ Features: 1
   â”œâ”€ Mean Importance: 85.1617
   â”œâ”€ Max Importance: 85.1617
   â”œâ”€ Min Importance: 85.1617
   â””â”€ Top-5 Important Features: [0]
      â””â”€ Top-5 Values: ['85.1617']

ðŸ“Š Layer: LF_l4_FDCA.slice_att.linear.2
   â”œâ”€ Features: 1
   â”œâ”€ Mean Importance: 80.8091
   â”œâ”€ Max Importance: 80.8091
   â”œâ”€ Min Importance: 80.8091
   â””â”€ Top-5 Important Features: [0]
      â””â”€ Top-5 Values: ['80.8091']

ðŸ“Š Layer: LF_l4_FDCA.slice_att.linear
   â”œâ”€ Features: 1
   â”œâ”€ Mean Importance: 80.8091
   â”œâ”€ Max Importance: 80.8091
   â”œâ”€ Min Importance: 80.8091
   â””â”€ Top-5 Important Features: [0]
      â””â”€ Top-5 Values: ['80.8091']

ðŸ“Š Layer: LF_l4_FDCA.slice_att.non_linear
   â”œâ”€ Features: 1
   â”œâ”€ Mean Importance: 31969336.0000
   â”œâ”€ Max Importance: 31969336.0000
   â”œâ”€ Min Importance: 31969336.0000
   â””â”€ Top-5 Important Features: [0]
      â””â”€ Top-5 Values: ['31969336.0000']

ðŸ“Š Layer: LF_l4_FDCA.slice_att.mean
   â”œâ”€ Features: 1
   â”œâ”€ Mean Importance: 127727144.0000
   â”œâ”€ Max Importance: 127727144.0000
   â”œâ”€ Min Importance: 127727144.0000
   â””â”€ Top-5 Important Features: [0]
      â””â”€ Top-5 Values: ['127727144.0000']

ðŸ“Š Layer: LF_l4_FDCA.slice_att.log_diag
   â”œâ”€ Features: 1
   â”œâ”€ Mean Importance: 7916.3901
   â”œâ”€ Max Importance: 7916.3901
   â”œâ”€ Min Importance: 7916.3901
   â””â”€ Top-5 Important Features: [0]
      â””â”€ Top-5 Values: ['7916.3901']

ðŸ“Š Layer: LF_l4_FDCA.slice_att.factor
   â”œâ”€ Features: 1
   â”œâ”€ Mean Importance: 49474552.0000
   â”œâ”€ Max Importance: 49474552.0000
   â”œâ”€ Min Importance: 49474552.0000
   â””â”€ Top-5 Important Features: [0]
      â””â”€ Top-5 Values: ['49474552.0000']

ðŸ“Š Layer: LF_l4_FDCA.slice_att
   â”œâ”€ Features: 1
   â”œâ”€ Mean Importance: 656414.5000
   â”œâ”€ Max Importance: 656414.5000
   â”œâ”€ Min Importance: 656414.5000
   â””â”€ Top-5 Important Features: [0]
      â””â”€ Top-5 Values: ['656414.5000']

ðŸ“Š Layer: LF_l4_FDCA
   â”œâ”€ Features: 1
   â”œâ”€ Mean Importance: 5863548945170432.0000
   â”œâ”€ Max Importance: 5863548945170432.0000
   â”œâ”€ Min Importance: 5863548945170432.0000
   â””â”€ Top-5 Important Features: [0]
      â””â”€ Top-5 Values: ['5863548945170432.0000']

ðŸ“Š Layer: LF_l5_FDCA.semantic_att
   â”œâ”€ Features: 1
   â”œâ”€ Mean Importance: 0.0817
   â”œâ”€ Max Importance: 0.0817
   â”œâ”€ Min Importance: 0.0817
   â””â”€ Top-5 Important Features: [0]
      â””â”€ Top-5 Values: ['0.0817']

ðŸ“Š Layer: LF_l5_FDCA.positional_att.conv
   â”œâ”€ Features: 1
   â”œâ”€ Mean Importance: 67.8208
   â”œâ”€ Max Importance: 67.8208
   â”œâ”€ Min Importance: 67.8208
   â””â”€ Top-5 Important Features: [0]
      â””â”€ Top-5 Values: ['67.8208']

ðŸ“Š Layer: LF_l5_FDCA.positional_att
   â”œâ”€ Features: 1
   â”œâ”€ Mean Importance: 0.0000
   â”œâ”€ Max Importance: 0.0000
   â”œâ”€ Min Importance: 0.0000
   â””â”€ Top-5 Important Features: [0]
      â””â”€ Top-5 Values: ['0.0000']

ðŸ“Š Layer: LF_l5_FDCA.slice_att.linear.0
   â”œâ”€ Features: 1
   â”œâ”€ Mean Importance: 0.0000
   â”œâ”€ Max Importance: 0.0000
   â”œâ”€ Min Importance: 0.0000
   â””â”€ Top-5 Important Features: [0]
      â””â”€ Top-5 Values: ['0.0000']

ðŸ“Š Layer: LF_l5_FDCA.slice_att.linear.1
   â”œâ”€ Features: 1
   â”œâ”€ Mean Importance: 0.0000
   â”œâ”€ Max Importance: 0.0000
   â”œâ”€ Min Importance: 0.0000
   â””â”€ Top-5 Important Features: [0]
      â””â”€ Top-5 Values: ['0.0000']

ðŸ“Š Layer: LF_l5_FDCA.slice_att.linear.2
   â”œâ”€ Features: 1
   â”œâ”€ Mean Importance: 0.0000
   â”œâ”€ Max Importance: 0.0000
   â”œâ”€ Min Importance: 0.0000
   â””â”€ Top-5 Important Features: [0]
      â””â”€ Top-5 Values: ['0.0000']

ðŸ“Š Layer: LF_l5_FDCA.slice_att.linear
   â”œâ”€ Features: 1
   â”œâ”€ Mean Importance: 0.0000
   â”œâ”€ Max Importance: 0.0000
   â”œâ”€ Min Importance: 0.0000
   â””â”€ Top-5 Important Features: [0]
      â””â”€ Top-5 Values: ['0.0000']

ðŸ“Š Layer: LF_l5_FDCA.slice_att.non_linear
   â”œâ”€ Features: 1
   â”œâ”€ Mean Importance: 0.0000
   â”œâ”€ Max Importance: 0.0000
   â”œâ”€ Min Importance: 0.0000
   â””â”€ Top-5 Important Features: [0]
      â””â”€ Top-5 Values: ['0.0000']

ðŸ“Š Layer: LF_l5_FDCA.slice_att.mean
   â”œâ”€ Features: 1
   â”œâ”€ Mean Importance: 0.0017
   â”œâ”€ Max Importance: 0.0017
   â”œâ”€ Min Importance: 0.0017
   â””â”€ Top-5 Important Features: [0]
      â””â”€ Top-5 Values: ['0.0017']

ðŸ“Š Layer: LF_l5_FDCA.slice_att.log_diag
   â”œâ”€ Features: 1
   â”œâ”€ Mean Importance: 0.0000
   â”œâ”€ Max Importance: 0.0000
   â”œâ”€ Min Importance: 0.0000
   â””â”€ Top-5 Important Features: [0]
      â””â”€ Top-5 Values: ['0.0000']

ðŸ“Š Layer: LF_l5_FDCA.slice_att.factor
   â”œâ”€ Features: 1
   â”œâ”€ Mean Importance: 0.0001
   â”œâ”€ Max Importance: 0.0001
   â”œâ”€ Min Importance: 0.0001
   â””â”€ Top-5 Important Features: [0]
      â””â”€ Top-5 Values: ['0.0001']

ðŸ“Š Layer: LF_l5_FDCA.slice_att
   â”œâ”€ Features: 1
   â”œâ”€ Mean Importance: 0.0000
   â”œâ”€ Max Importance: 0.0000
   â”œâ”€ Min Importance: 0.0000
   â””â”€ Top-5 Important Features: [0]
      â””â”€ Top-5 Values: ['0.0000']

ðŸ“Š Layer: LF_l5_FDCA
   â”œâ”€ Features: 1
   â”œâ”€ Mean Importance: 0.0000
   â”œâ”€ Max Importance: 0.0000
   â”œâ”€ Min Importance: 0.0000
   â””â”€ Top-5 Important Features: [0]
      â””â”€ Top-5 Values: ['0.0000']

ðŸ“Š Layer: HF_l4_FDCA.semantic_att
   â”œâ”€ Features: 1
   â”œâ”€ Mean Importance: 0.0813
   â”œâ”€ Max Importance: 0.0813
   â”œâ”€ Min Importance: 0.0813
   â””â”€ Top-5 Important Features: [0]
      â””â”€ Top-5 Values: ['0.0813']

ðŸ“Š Layer: HF_l4_FDCA.positional_att.conv
   â”œâ”€ Features: 1
   â”œâ”€ Mean Importance: 8.6478
   â”œâ”€ Max Importance: 8.6478
   â”œâ”€ Min Importance: 8.6478
   â””â”€ Top-5 Important Features: [0]
      â””â”€ Top-5 Values: ['8.6478']

ðŸ“Š Layer: HF_l4_FDCA.positional_att
   â”œâ”€ Features: 1
   â”œâ”€ Mean Importance: 0.0018
   â”œâ”€ Max Importance: 0.0018
   â”œâ”€ Min Importance: 0.0018
   â””â”€ Top-5 Important Features: [0]
      â””â”€ Top-5 Values: ['0.0018']

ðŸ“Š Layer: HF_l4_FDCA.slice_att.linear.0
   â”œâ”€ Features: 1
   â”œâ”€ Mean Importance: 0.0000
   â”œâ”€ Max Importance: 0.0000
   â”œâ”€ Min Importance: 0.0000
   â””â”€ Top-5 Important Features: [0]
      â””â”€ Top-5 Values: ['0.0000']

ðŸ“Š Layer: HF_l4_FDCA.slice_att.linear.1
   â”œâ”€ Features: 1
   â”œâ”€ Mean Importance: 0.0000
   â”œâ”€ Max Importance: 0.0000
   â”œâ”€ Min Importance: 0.0000
   â””â”€ Top-5 Important Features: [0]
      â””â”€ Top-5 Values: ['0.0000']

ðŸ“Š Layer: HF_l4_FDCA.slice_att.linear.2
   â”œâ”€ Features: 1
   â”œâ”€ Mean Importance: 0.0000
   â”œâ”€ Max Importance: 0.0000
   â”œâ”€ Min Importance: 0.0000
   â””â”€ Top-5 Important Features: [0]
      â””â”€ Top-5 Values: ['0.0000']

ðŸ“Š Layer: HF_l4_FDCA.slice_att.linear
   â”œâ”€ Features: 1
   â”œâ”€ Mean Importance: 0.0000
   â”œâ”€ Max Importance: 0.0000
   â”œâ”€ Min Importance: 0.0000
   â””â”€ Top-5 Important Features: [0]
      â””â”€ Top-5 Values: ['0.0000']

ðŸ“Š Layer: HF_l4_FDCA.slice_att.non_linear
   â”œâ”€ Features: 1
   â”œâ”€ Mean Importance: 0.0000
   â”œâ”€ Max Importance: 0.0000
   â”œâ”€ Min Importance: 0.0000
   â””â”€ Top-5 Important Features: [0]
      â””â”€ Top-5 Values: ['0.0000']

ðŸ“Š Layer: HF_l4_FDCA.slice_att.mean
   â”œâ”€ Features: 1
   â”œâ”€ Mean Importance: 0.0000
   â”œâ”€ Max Importance: 0.0000
   â”œâ”€ Min Importance: 0.0000
   â””â”€ Top-5 Important Features: [0]
      â””â”€ Top-5 Values: ['0.0000']

ðŸ“Š Layer: HF_l4_FDCA.slice_att.log_diag
   â”œâ”€ Features: 1
   â”œâ”€ Mean Importance: 0.0000
   â”œâ”€ Max Importance: 0.0000
   â”œâ”€ Min Importance: 0.0000
   â””â”€ Top-5 Important Features: [0]
      â””â”€ Top-5 Values: ['0.0000']

ðŸ“Š Layer: HF_l4_FDCA.slice_att.factor
   â”œâ”€ Features: 1
   â”œâ”€ Mean Importance: 0.0000
   â”œâ”€ Max Importance: 0.0000
   â”œâ”€ Min Importance: 0.0000
   â””â”€ Top-5 Important Features: [0]
      â””â”€ Top-5 Values: ['0.0000']

ðŸ“Š Layer: HF_l4_FDCA.slice_att
   â”œâ”€ Features: 1
   â”œâ”€ Mean Importance: 0.0091
   â”œâ”€ Max Importance: 0.0091
   â”œâ”€ Min Importance: 0.0091
   â””â”€ Top-5 Important Features: [0]
      â””â”€ Top-5 Values: ['0.0091']

ðŸ“Š Layer: HF_l4_FDCA
   â”œâ”€ Features: 1
   â”œâ”€ Mean Importance: 1.3857
   â”œâ”€ Max Importance: 1.3857
   â”œâ”€ Min Importance: 1.3857
   â””â”€ Top-5 Important Features: [0]
      â””â”€ Top-5 Values: ['1.3857']

ðŸ“Š Layer: HF_l5_FDCA.semantic_att
   â”œâ”€ Features: 1
   â”œâ”€ Mean Importance: 0.0656
   â”œâ”€ Max Importance: 0.0656
   â”œâ”€ Min Importance: 0.0656
   â””â”€ Top-5 Important Features: [0]
      â””â”€ Top-5 Values: ['0.0656']

ðŸ“Š Layer: HF_l5_FDCA.positional_att.conv
   â”œâ”€ Features: 1
   â”œâ”€ Mean Importance: 16.0568
   â”œâ”€ Max Importance: 16.0568
   â”œâ”€ Min Importance: 16.0568
   â””â”€ Top-5 Important Features: [0]
      â””â”€ Top-5 Values: ['16.0568']

ðŸ“Š Layer: HF_l5_FDCA.positional_att
   â”œâ”€ Features: 1
   â”œâ”€ Mean Importance: 0.0001
   â”œâ”€ Max Importance: 0.0001
   â”œâ”€ Min Importance: 0.0001
   â””â”€ Top-5 Important Features: [0]
      â””â”€ Top-5 Values: ['0.0001']

ðŸ“Š Layer: HF_l5_FDCA.slice_att.linear.0
   â”œâ”€ Features: 1
   â”œâ”€ Mean Importance: 0.0000
   â”œâ”€ Max Importance: 0.0000
   â”œâ”€ Min Importance: 0.0000
   â””â”€ Top-5 Important Features: [0]
      â””â”€ Top-5 Values: ['0.0000']

ðŸ“Š Layer: HF_l5_FDCA.slice_att.linear.1
   â”œâ”€ Features: 1
   â”œâ”€ Mean Importance: 0.0000
   â”œâ”€ Max Importance: 0.0000
   â”œâ”€ Min Importance: 0.0000
   â””â”€ Top-5 Important Features: [0]
      â””â”€ Top-5 Values: ['0.0000']

ðŸ“Š Layer: HF_l5_FDCA.slice_att.linear.2
   â”œâ”€ Features: 1
   â”œâ”€ Mean Importance: 0.0000
   â”œâ”€ Max Importance: 0.0000
   â”œâ”€ Min Importance: 0.0000
   â””â”€ Top-5 Important Features: [0]
      â””â”€ Top-5 Values: ['0.0000']

ðŸ“Š Layer: HF_l5_FDCA.slice_att.linear
   â”œâ”€ Features: 1
   â”œâ”€ Mean Importance: 0.0000
   â”œâ”€ Max Importance: 0.0000
   â”œâ”€ Min Importance: 0.0000
   â””â”€ Top-5 Important Features: [0]
      â””â”€ Top-5 Values: ['0.0000']

ðŸ“Š Layer: HF_l5_FDCA.slice_att.non_linear
   â”œâ”€ Features: 1
   â”œâ”€ Mean Importance: 0.0000
   â”œâ”€ Max Importance: 0.0000
   â”œâ”€ Min Importance: 0.0000
   â””â”€ Top-5 Important Features: [0]
      â””â”€ Top-5 Values: ['0.0000']

ðŸ“Š Layer: HF_l5_FDCA.slice_att.mean
   â”œâ”€ Features: 1
   â”œâ”€ Mean Importance: 0.0000
   â”œâ”€ Max Importance: 0.0000
   â”œâ”€ Min Importance: 0.0000
   â””â”€ Top-5 Important Features: [0]
      â””â”€ Top-5 Values: ['0.0000']

ðŸ“Š Layer: HF_l5_FDCA.slice_att.log_diag
   â”œâ”€ Features: 1
   â”œâ”€ Mean Importance: 0.0000
   â”œâ”€ Max Importance: 0.0000
   â”œâ”€ Min Importance: 0.0000
   â””â”€ Top-5 Important Features: [0]
      â””â”€ Top-5 Values: ['0.0000']

ðŸ“Š Layer: HF_l5_FDCA.slice_att.factor
   â”œâ”€ Features: 1
   â”œâ”€ Mean Importance: 0.0000
   â”œâ”€ Max Importance: 0.0000
   â”œâ”€ Min Importance: 0.0000
   â””â”€ Top-5 Important Features: [0]
      â””â”€ Top-5 Values: ['0.0000']

ðŸ“Š Layer: HF_l5_FDCA.slice_att
   â”œâ”€ Features: 1
   â”œâ”€ Mean Importance: 0.0002
   â”œâ”€ Max Importance: 0.0002
   â”œâ”€ Min Importance: 0.0002
   â””â”€ Top-5 Important Features: [0]
      â””â”€ Top-5 Values: ['0.0002']

ðŸ“Š Layer: HF_l5_FDCA
   â”œâ”€ Features: 1
   â”œâ”€ Mean Importance: 0.0008
   â”œâ”€ Max Importance: 0.0008
   â”œâ”€ Min Importance: 0.0008
   â””â”€ Top-5 Important Features: [0]
      â””â”€ Top-5 Values: ['0.0008']

======================================================================
âœ“ Mechanistic analysis complete

[3] Generating Grad-CAM...
Warning: Failed to generate CAM for class 0: element 0 of tensors does not require grad and does not have a grad_fn
Warning: Failed to generate CAM for class 1: element 0 of tensors does not require grad and does not have a grad_fn
Warning: Failed to generate CAM for class 2: element 0 of tensors does not require grad and does not have a grad_fn
Warning: Failed to generate CAM for class 3: element 0 of tensors does not require grad and does not have a grad_fn
[4] Analyzing frequency components...
âœ“ Saved: outputs/xai_2025-11-15_17-25-23/freq_component/sample_0025_freq_comp.png
âœ“ Evaluation complete for sample_0025
Evaluating:  68%|######8   | 26/38 [07:13<03:20, 16.73s/it]
[1] Getting primary prediction...

[METRICS FOR sample_0026]
==================================================
class_0: Dice=0.9946, IoU=0.9893
class_1: Dice=0.1255, IoU=0.0670
class_2: Dice=0.5561, IoU=0.3851
class_3: Dice=0.7094, IoU=0.5496
==================================================

[2] Generating attention maps...
Clipping input data to the valid range for imshow with RGB data ([0..1] for floats or [0..255] for integers).
Clipping input data to the valid range for imshow with RGB data ([0..1] for floats or [0..255] for integers).
âœ“ Saved: outputs/xai_2025-11-15_17-25-23/attention/sample_0026_attention.png

[MECHANISTIC INTERPRETABILITY ANALYSIS]
======================================================================
Sample: sample_0026
======================================================================

ðŸ“Š Layer: LF_l4_FDCA.semantic_att
   â”œâ”€ Features: 1
   â”œâ”€ Mean Importance: 0.1083
   â”œâ”€ Max Importance: 0.1083
   â”œâ”€ Min Importance: 0.1083
   â””â”€ Top-5 Important Features: [0]
      â””â”€ Top-5 Values: ['0.1083']

ðŸ“Š Layer: LF_l4_FDCA.positional_att.conv
   â”œâ”€ Features: 1
   â”œâ”€ Mean Importance: 235.2405
   â”œâ”€ Max Importance: 235.2405
   â”œâ”€ Min Importance: 235.2405
   â””â”€ Top-5 Important Features: [0]
      â””â”€ Top-5 Values: ['235.2405']

ðŸ“Š Layer: LF_l4_FDCA.positional_att
   â”œâ”€ Features: 1
   â”œâ”€ Mean Importance: 32.4988
   â”œâ”€ Max Importance: 32.4988
   â”œâ”€ Min Importance: 32.4988
   â””â”€ Top-5 Important Features: [0]
      â””â”€ Top-5 Values: ['32.4988']

ðŸ“Š Layer: LF_l4_FDCA.slice_att.linear.0
   â”œâ”€ Features: 1
   â”œâ”€ Mean Importance: 51.1628
   â”œâ”€ Max Importance: 51.1628
   â”œâ”€ Min Importance: 51.1628
   â””â”€ Top-5 Important Features: [0]
      â””â”€ Top-5 Values: ['51.1628']

ðŸ“Š Layer: LF_l4_FDCA.slice_att.linear.1
   â”œâ”€ Features: 1
   â”œâ”€ Mean Importance: 43.3963
   â”œâ”€ Max Importance: 43.3963
   â”œâ”€ Min Importance: 43.3963
   â””â”€ Top-5 Important Features: [0]
      â””â”€ Top-5 Values: ['43.3963']

ðŸ“Š Layer: LF_l4_FDCA.slice_att.linear.2
   â”œâ”€ Features: 1
   â”œâ”€ Mean Importance: 41.1899
   â”œâ”€ Max Importance: 41.1899
   â”œâ”€ Min Importance: 41.1899
   â””â”€ Top-5 Important Features: [0]
      â””â”€ Top-5 Values: ['41.1899']

ðŸ“Š Layer: LF_l4_FDCA.slice_att.linear
   â”œâ”€ Features: 1
   â”œâ”€ Mean Importance: 41.1899
   â”œâ”€ Max Importance: 41.1899
   â”œâ”€ Min Importance: 41.1899
   â””â”€ Top-5 Important Features: [0]
      â””â”€ Top-5 Values: ['41.1899']

ðŸ“Š Layer: LF_l4_FDCA.slice_att.non_linear
   â”œâ”€ Features: 1
   â”œâ”€ Mean Importance: 21702480.0000
   â”œâ”€ Max Importance: 21702480.0000
   â”œâ”€ Min Importance: 21702480.0000
   â””â”€ Top-5 Important Features: [0]
      â””â”€ Top-5 Values: ['21702480.0000']

ðŸ“Š Layer: LF_l4_FDCA.slice_att.mean
   â”œâ”€ Features: 1
   â”œâ”€ Mean Importance: 86723248.0000
   â”œâ”€ Max Importance: 86723248.0000
   â”œâ”€ Min Importance: 86723248.0000
   â””â”€ Top-5 Important Features: [0]
      â””â”€ Top-5 Values: ['86723248.0000']

ðŸ“Š Layer: LF_l4_FDCA.slice_att.log_diag
   â”œâ”€ Features: 1
   â”œâ”€ Mean Importance: 5374.8779
   â”œâ”€ Max Importance: 5374.8779
   â”œâ”€ Min Importance: 5374.8779
   â””â”€ Top-5 Important Features: [0]
      â””â”€ Top-5 Values: ['5374.8779']

ðŸ“Š Layer: LF_l4_FDCA.slice_att.factor
   â”œâ”€ Features: 1
   â”œâ”€ Mean Importance: 33592044.0000
   â”œâ”€ Max Importance: 33592044.0000
   â”œâ”€ Min Importance: 33592044.0000
   â””â”€ Top-5 Important Features: [0]
      â””â”€ Top-5 Values: ['33592044.0000']

ðŸ“Š Layer: LF_l4_FDCA.slice_att
   â”œâ”€ Features: 1
   â”œâ”€ Mean Importance: 11001145.0000
   â”œâ”€ Max Importance: 11001145.0000
   â”œâ”€ Min Importance: 11001145.0000
   â””â”€ Top-5 Important Features: [0]
      â””â”€ Top-5 Values: ['11001145.0000']

ðŸ“Š Layer: LF_l4_FDCA
   â”œâ”€ Features: 1
   â”œâ”€ Mean Importance: 1105184489300033536.0000
   â”œâ”€ Max Importance: 1105184489300033536.0000
   â”œâ”€ Min Importance: 1105184489300033536.0000
   â””â”€ Top-5 Important Features: [0]
      â””â”€ Top-5 Values: ['1105184489300033536.0000']

ðŸ“Š Layer: LF_l5_FDCA.semantic_att
   â”œâ”€ Features: 1
   â”œâ”€ Mean Importance: 0.0865
   â”œâ”€ Max Importance: 0.0865
   â”œâ”€ Min Importance: 0.0865
   â””â”€ Top-5 Important Features: [0]
      â””â”€ Top-5 Values: ['0.0865']

ðŸ“Š Layer: LF_l5_FDCA.positional_att.conv
   â”œâ”€ Features: 1
   â”œâ”€ Mean Importance: 61.6259
   â”œâ”€ Max Importance: 61.6259
   â”œâ”€ Min Importance: 61.6259
   â””â”€ Top-5 Important Features: [0]
      â””â”€ Top-5 Values: ['61.6259']

ðŸ“Š Layer: LF_l5_FDCA.positional_att
   â”œâ”€ Features: 1
   â”œâ”€ Mean Importance: 0.0000
   â”œâ”€ Max Importance: 0.0000
   â”œâ”€ Min Importance: 0.0000
   â””â”€ Top-5 Important Features: [0]
      â””â”€ Top-5 Values: ['0.0000']

ðŸ“Š Layer: LF_l5_FDCA.slice_att.linear.0
   â”œâ”€ Features: 1
   â”œâ”€ Mean Importance: 0.0000
   â”œâ”€ Max Importance: 0.0000
   â”œâ”€ Min Importance: 0.0000
   â””â”€ Top-5 Important Features: [0]
      â””â”€ Top-5 Values: ['0.0000']

ðŸ“Š Layer: LF_l5_FDCA.slice_att.linear.1
   â”œâ”€ Features: 1
   â”œâ”€ Mean Importance: 0.0000
   â”œâ”€ Max Importance: 0.0000
   â”œâ”€ Min Importance: 0.0000
   â””â”€ Top-5 Important Features: [0]
      â””â”€ Top-5 Values: ['0.0000']

ðŸ“Š Layer: LF_l5_FDCA.slice_att.linear.2
   â”œâ”€ Features: 1
   â”œâ”€ Mean Importance: 0.0000
   â”œâ”€ Max Importance: 0.0000
   â”œâ”€ Min Importance: 0.0000
   â””â”€ Top-5 Important Features: [0]
      â””â”€ Top-5 Values: ['0.0000']

ðŸ“Š Layer: LF_l5_FDCA.slice_att.linear
   â”œâ”€ Features: 1
   â”œâ”€ Mean Importance: 0.0000
   â”œâ”€ Max Importance: 0.0000
   â”œâ”€ Min Importance: 0.0000
   â””â”€ Top-5 Important Features: [0]
      â””â”€ Top-5 Values: ['0.0000']

ðŸ“Š Layer: LF_l5_FDCA.slice_att.non_linear
   â”œâ”€ Features: 1
   â”œâ”€ Mean Importance: 0.0000
   â”œâ”€ Max Importance: 0.0000
   â”œâ”€ Min Importance: 0.0000
   â””â”€ Top-5 Important Features: [0]
      â””â”€ Top-5 Values: ['0.0000']

ðŸ“Š Layer: LF_l5_FDCA.slice_att.mean
   â”œâ”€ Features: 1
   â”œâ”€ Mean Importance: 0.0017
   â”œâ”€ Max Importance: 0.0017
   â”œâ”€ Min Importance: 0.0017
   â””â”€ Top-5 Important Features: [0]
      â””â”€ Top-5 Values: ['0.0017']

ðŸ“Š Layer: LF_l5_FDCA.slice_att.log_diag
   â”œâ”€ Features: 1
   â”œâ”€ Mean Importance: 0.0000
   â”œâ”€ Max Importance: 0.0000
   â”œâ”€ Min Importance: 0.0000
   â””â”€ Top-5 Important Features: [0]
      â””â”€ Top-5 Values: ['0.0000']

ðŸ“Š Layer: LF_l5_FDCA.slice_att.factor
   â”œâ”€ Features: 1
   â”œâ”€ Mean Importance: 0.0001
   â”œâ”€ Max Importance: 0.0001
   â”œâ”€ Min Importance: 0.0001
   â””â”€ Top-5 Important Features: [0]
      â””â”€ Top-5 Values: ['0.0001']

ðŸ“Š Layer: LF_l5_FDCA.slice_att
   â”œâ”€ Features: 1
   â”œâ”€ Mean Importance: 0.0000
   â”œâ”€ Max Importance: 0.0000
   â”œâ”€ Min Importance: 0.0000
   â””â”€ Top-5 Important Features: [0]
      â””â”€ Top-5 Values: ['0.0000']

ðŸ“Š Layer: LF_l5_FDCA
   â”œâ”€ Features: 1
   â”œâ”€ Mean Importance: 0.0000
   â”œâ”€ Max Importance: 0.0000
   â”œâ”€ Min Importance: 0.0000
   â””â”€ Top-5 Important Features: [0]
      â””â”€ Top-5 Values: ['0.0000']

ðŸ“Š Layer: HF_l4_FDCA.semantic_att
   â”œâ”€ Features: 1
   â”œâ”€ Mean Importance: 0.0833
   â”œâ”€ Max Importance: 0.0833
   â”œâ”€ Min Importance: 0.0833
   â””â”€ Top-5 Important Features: [0]
      â””â”€ Top-5 Values: ['0.0833']

ðŸ“Š Layer: HF_l4_FDCA.positional_att.conv
   â”œâ”€ Features: 1
   â”œâ”€ Mean Importance: 9.3888
   â”œâ”€ Max Importance: 9.3888
   â”œâ”€ Min Importance: 9.3888
   â””â”€ Top-5 Important Features: [0]
      â””â”€ Top-5 Values: ['9.3888']

ðŸ“Š Layer: HF_l4_FDCA.positional_att
   â”œâ”€ Features: 1
   â”œâ”€ Mean Importance: 0.0018
   â”œâ”€ Max Importance: 0.0018
   â”œâ”€ Min Importance: 0.0018
   â””â”€ Top-5 Important Features: [0]
      â””â”€ Top-5 Values: ['0.0018']

ðŸ“Š Layer: HF_l4_FDCA.slice_att.linear.0
   â”œâ”€ Features: 1
   â”œâ”€ Mean Importance: 0.0000
   â”œâ”€ Max Importance: 0.0000
   â”œâ”€ Min Importance: 0.0000
   â””â”€ Top-5 Important Features: [0]
      â””â”€ Top-5 Values: ['0.0000']

ðŸ“Š Layer: HF_l4_FDCA.slice_att.linear.1
   â”œâ”€ Features: 1
   â”œâ”€ Mean Importance: 0.0000
   â”œâ”€ Max Importance: 0.0000
   â”œâ”€ Min Importance: 0.0000
   â””â”€ Top-5 Important Features: [0]
      â””â”€ Top-5 Values: ['0.0000']

ðŸ“Š Layer: HF_l4_FDCA.slice_att.linear.2
   â”œâ”€ Features: 1
   â”œâ”€ Mean Importance: 0.0000
   â”œâ”€ Max Importance: 0.0000
   â”œâ”€ Min Importance: 0.0000
   â””â”€ Top-5 Important Features: [0]
      â””â”€ Top-5 Values: ['0.0000']

ðŸ“Š Layer: HF_l4_FDCA.slice_att.linear
   â”œâ”€ Features: 1
   â”œâ”€ Mean Importance: 0.0000
   â”œâ”€ Max Importance: 0.0000
   â”œâ”€ Min Importance: 0.0000
   â””â”€ Top-5 Important Features: [0]
      â””â”€ Top-5 Values: ['0.0000']

ðŸ“Š Layer: HF_l4_FDCA.slice_att.non_linear
   â”œâ”€ Features: 1
   â”œâ”€ Mean Importance: 0.0000
   â”œâ”€ Max Importance: 0.0000
   â”œâ”€ Min Importance: 0.0000
   â””â”€ Top-5 Important Features: [0]
      â””â”€ Top-5 Values: ['0.0000']

ðŸ“Š Layer: HF_l4_FDCA.slice_att.mean
   â”œâ”€ Features: 1
   â”œâ”€ Mean Importance: 0.0000
   â”œâ”€ Max Importance: 0.0000
   â”œâ”€ Min Importance: 0.0000
   â””â”€ Top-5 Important Features: [0]
      â””â”€ Top-5 Values: ['0.0000']

ðŸ“Š Layer: HF_l4_FDCA.slice_att.log_diag
   â”œâ”€ Features: 1
   â”œâ”€ Mean Importance: 0.0000
   â”œâ”€ Max Importance: 0.0000
   â”œâ”€ Min Importance: 0.0000
   â””â”€ Top-5 Important Features: [0]
      â””â”€ Top-5 Values: ['0.0000']

ðŸ“Š Layer: HF_l4_FDCA.slice_att.factor
   â”œâ”€ Features: 1
   â”œâ”€ Mean Importance: 0.0000
   â”œâ”€ Max Importance: 0.0000
   â”œâ”€ Min Importance: 0.0000
   â””â”€ Top-5 Important Features: [0]
      â””â”€ Top-5 Values: ['0.0000']

ðŸ“Š Layer: HF_l4_FDCA.slice_att
   â”œâ”€ Features: 1
   â”œâ”€ Mean Importance: 0.0052
   â”œâ”€ Max Importance: 0.0052
   â”œâ”€ Min Importance: 0.0052
   â””â”€ Top-5 Important Features: [0]
      â””â”€ Top-5 Values: ['0.0052']

ðŸ“Š Layer: HF_l4_FDCA
   â”œâ”€ Features: 1
   â”œâ”€ Mean Importance: 0.7984
   â”œâ”€ Max Importance: 0.7984
   â”œâ”€ Min Importance: 0.7984
   â””â”€ Top-5 Important Features: [0]
      â””â”€ Top-5 Values: ['0.7984']

ðŸ“Š Layer: HF_l5_FDCA.semantic_att
   â”œâ”€ Features: 1
   â”œâ”€ Mean Importance: 0.0649
   â”œâ”€ Max Importance: 0.0649
   â”œâ”€ Min Importance: 0.0649
   â””â”€ Top-5 Important Features: [0]
      â””â”€ Top-5 Values: ['0.0649']

ðŸ“Š Layer: HF_l5_FDCA.positional_att.conv
   â”œâ”€ Features: 1
   â”œâ”€ Mean Importance: 16.2515
   â”œâ”€ Max Importance: 16.2515
   â”œâ”€ Min Importance: 16.2515
   â””â”€ Top-5 Important Features: [0]
      â””â”€ Top-5 Values: ['16.2515']

ðŸ“Š Layer: HF_l5_FDCA.positional_att
   â”œâ”€ Features: 1
   â”œâ”€ Mean Importance: 0.0001
   â”œâ”€ Max Importance: 0.0001
   â”œâ”€ Min Importance: 0.0001
   â””â”€ Top-5 Important Features: [0]
      â””â”€ Top-5 Values: ['0.0001']

ðŸ“Š Layer: HF_l5_FDCA.slice_att.linear.0
   â”œâ”€ Features: 1
   â”œâ”€ Mean Importance: 0.0000
   â”œâ”€ Max Importance: 0.0000
   â”œâ”€ Min Importance: 0.0000
   â””â”€ Top-5 Important Features: [0]
      â””â”€ Top-5 Values: ['0.0000']

ðŸ“Š Layer: HF_l5_FDCA.slice_att.linear.1
   â”œâ”€ Features: 1
   â”œâ”€ Mean Importance: 0.0000
   â”œâ”€ Max Importance: 0.0000
   â”œâ”€ Min Importance: 0.0000
   â””â”€ Top-5 Important Features: [0]
      â””â”€ Top-5 Values: ['0.0000']

ðŸ“Š Layer: HF_l5_FDCA.slice_att.linear.2
   â”œâ”€ Features: 1
   â”œâ”€ Mean Importance: 0.0000
   â”œâ”€ Max Importance: 0.0000
   â”œâ”€ Min Importance: 0.0000
   â””â”€ Top-5 Important Features: [0]
      â””â”€ Top-5 Values: ['0.0000']

ðŸ“Š Layer: HF_l5_FDCA.slice_att.linear
   â”œâ”€ Features: 1
   â”œâ”€ Mean Importance: 0.0000
   â”œâ”€ Max Importance: 0.0000
   â”œâ”€ Min Importance: 0.0000
   â””â”€ Top-5 Important Features: [0]
      â””â”€ Top-5 Values: ['0.0000']

ðŸ“Š Layer: HF_l5_FDCA.slice_att.non_linear
   â”œâ”€ Features: 1
   â”œâ”€ Mean Importance: 0.0000
   â”œâ”€ Max Importance: 0.0000
   â”œâ”€ Min Importance: 0.0000
   â””â”€ Top-5 Important Features: [0]
      â””â”€ Top-5 Values: ['0.0000']

ðŸ“Š Layer: HF_l5_FDCA.slice_att.mean
   â”œâ”€ Features: 1
   â”œâ”€ Mean Importance: 0.0000
   â”œâ”€ Max Importance: 0.0000
   â”œâ”€ Min Importance: 0.0000
   â””â”€ Top-5 Important Features: [0]
      â””â”€ Top-5 Values: ['0.0000']

ðŸ“Š Layer: HF_l5_FDCA.slice_att.log_diag
   â”œâ”€ Features: 1
   â”œâ”€ Mean Importance: 0.0000
   â”œâ”€ Max Importance: 0.0000
   â”œâ”€ Min Importance: 0.0000
   â””â”€ Top-5 Important Features: [0]
      â””â”€ Top-5 Values: ['0.0000']

ðŸ“Š Layer: HF_l5_FDCA.slice_att.factor
   â”œâ”€ Features: 1
   â”œâ”€ Mean Importance: 0.0000
   â”œâ”€ Max Importance: 0.0000
   â”œâ”€ Min Importance: 0.0000
   â””â”€ Top-5 Important Features: [0]
      â””â”€ Top-5 Values: ['0.0000']

ðŸ“Š Layer: HF_l5_FDCA.slice_att
   â”œâ”€ Features: 1
   â”œâ”€ Mean Importance: 0.0002
   â”œâ”€ Max Importance: 0.0002
   â”œâ”€ Min Importance: 0.0002
   â””â”€ Top-5 Important Features: [0]
      â””â”€ Top-5 Values: ['0.0002']

ðŸ“Š Layer: HF_l5_FDCA
   â”œâ”€ Features: 1
   â”œâ”€ Mean Importance: 0.0002
   â”œâ”€ Max Importance: 0.0002
   â”œâ”€ Min Importance: 0.0002
   â””â”€ Top-5 Important Features: [0]
      â””â”€ Top-5 Values: ['0.0002']

======================================================================
âœ“ Mechanistic analysis complete

[3] Generating Grad-CAM...
Warning: Failed to generate CAM for class 0: element 0 of tensors does not require grad and does not have a grad_fn
Warning: Failed to generate CAM for class 1: element 0 of tensors does not require grad and does not have a grad_fn
Warning: Failed to generate CAM for class 2: element 0 of tensors does not require grad and does not have a grad_fn
Warning: Failed to generate CAM for class 3: element 0 of tensors does not require grad and does not have a grad_fn
[4] Analyzing frequency components...
âœ“ Saved: outputs/xai_2025-11-15_17-25-23/freq_component/sample_0026_freq_comp.png
âœ“ Evaluation complete for sample_0026
Evaluating:  71%|#######1  | 27/38 [07:30<03:03, 16.70s/it]
[1] Getting primary prediction...

[METRICS FOR sample_0027]
==================================================
class_0: Dice=0.9976, IoU=0.9953
class_1: Dice=0.6588, IoU=0.4912
class_2: Dice=0.9046, IoU=0.8258
class_3: Dice=0.8702, IoU=0.7702
==================================================

[2] Generating attention maps...
Clipping input data to the valid range for imshow with RGB data ([0..1] for floats or [0..255] for integers).
Clipping input data to the valid range for imshow with RGB data ([0..1] for floats or [0..255] for integers).
âœ“ Saved: outputs/xai_2025-11-15_17-25-23/attention/sample_0027_attention.png

[MECHANISTIC INTERPRETABILITY ANALYSIS]
======================================================================
Sample: sample_0027
======================================================================

ðŸ“Š Layer: LF_l4_FDCA.semantic_att
   â”œâ”€ Features: 1
   â”œâ”€ Mean Importance: 0.1352
   â”œâ”€ Max Importance: 0.1352
   â”œâ”€ Min Importance: 0.1352
   â””â”€ Top-5 Important Features: [0]
      â””â”€ Top-5 Values: ['0.1352']

ðŸ“Š Layer: LF_l4_FDCA.positional_att.conv
   â”œâ”€ Features: 1
   â”œâ”€ Mean Importance: 240.0694
   â”œâ”€ Max Importance: 240.0694
   â”œâ”€ Min Importance: 240.0694
   â””â”€ Top-5 Important Features: [0]
      â””â”€ Top-5 Values: ['240.0694']

ðŸ“Š Layer: LF_l4_FDCA.positional_att
   â”œâ”€ Features: 1
   â”œâ”€ Mean Importance: 55.3937
   â”œâ”€ Max Importance: 55.3937
   â”œâ”€ Min Importance: 55.3937
   â””â”€ Top-5 Important Features: [0]
      â””â”€ Top-5 Values: ['55.3937']

ðŸ“Š Layer: LF_l4_FDCA.slice_att.linear.0
   â”œâ”€ Features: 1
   â”œâ”€ Mean Importance: 68.3913
   â”œâ”€ Max Importance: 68.3913
   â”œâ”€ Min Importance: 68.3913
   â””â”€ Top-5 Important Features: [0]
      â””â”€ Top-5 Values: ['68.3913']

ðŸ“Š Layer: LF_l4_FDCA.slice_att.linear.1
   â”œâ”€ Features: 1
   â”œâ”€ Mean Importance: 58.0224
   â”œâ”€ Max Importance: 58.0224
   â”œâ”€ Min Importance: 58.0224
   â””â”€ Top-5 Important Features: [0]
      â””â”€ Top-5 Values: ['58.0224']

ðŸ“Š Layer: LF_l4_FDCA.slice_att.linear.2
   â”œâ”€ Features: 1
   â”œâ”€ Mean Importance: 55.0315
   â”œâ”€ Max Importance: 55.0315
   â”œâ”€ Min Importance: 55.0315
   â””â”€ Top-5 Important Features: [0]
      â””â”€ Top-5 Values: ['55.0315']

ðŸ“Š Layer: LF_l4_FDCA.slice_att.linear
   â”œâ”€ Features: 1
   â”œâ”€ Mean Importance: 55.0315
   â”œâ”€ Max Importance: 55.0315
   â”œâ”€ Min Importance: 55.0315
   â””â”€ Top-5 Important Features: [0]
      â””â”€ Top-5 Values: ['55.0315']

ðŸ“Š Layer: LF_l4_FDCA.slice_att.non_linear
   â”œâ”€ Features: 1
   â”œâ”€ Mean Importance: 22047532.0000
   â”œâ”€ Max Importance: 22047532.0000
   â”œâ”€ Min Importance: 22047532.0000
   â””â”€ Top-5 Important Features: [0]
      â””â”€ Top-5 Values: ['22047532.0000']

ðŸ“Š Layer: LF_l4_FDCA.slice_att.mean
   â”œâ”€ Features: 1
   â”œâ”€ Mean Importance: 88071464.0000
   â”œâ”€ Max Importance: 88071464.0000
   â”œâ”€ Min Importance: 88071464.0000
   â””â”€ Top-5 Important Features: [0]
      â””â”€ Top-5 Values: ['88071464.0000']

ðŸ“Š Layer: LF_l4_FDCA.slice_att.log_diag
   â”œâ”€ Features: 1
   â”œâ”€ Mean Importance: 5458.7139
   â”œâ”€ Max Importance: 5458.7139
   â”œâ”€ Min Importance: 5458.7139
   â””â”€ Top-5 Important Features: [0]
      â””â”€ Top-5 Values: ['5458.7139']

ðŸ“Š Layer: LF_l4_FDCA.slice_att.factor
   â”œâ”€ Features: 1
   â”œâ”€ Mean Importance: 34113920.0000
   â”œâ”€ Max Importance: 34113920.0000
   â”œâ”€ Min Importance: 34113920.0000
   â””â”€ Top-5 Important Features: [0]
      â””â”€ Top-5 Values: ['34113920.0000']

ðŸ“Š Layer: LF_l4_FDCA.slice_att
   â”œâ”€ Features: 1
   â”œâ”€ Mean Importance: 18541152.0000
   â”œâ”€ Max Importance: 18541152.0000
   â”œâ”€ Min Importance: 18541152.0000
   â””â”€ Top-5 Important Features: [0]
      â””â”€ Top-5 Values: ['18541152.0000']

ðŸ“Š Layer: LF_l4_FDCA
   â”œâ”€ Features: 1
   â”œâ”€ Mean Importance: 2114391234221965312.0000
   â”œâ”€ Max Importance: 2114391234221965312.0000
   â”œâ”€ Min Importance: 2114391234221965312.0000
   â””â”€ Top-5 Important Features: [0]
      â””â”€ Top-5 Values: ['2114391234221965312.0000']

ðŸ“Š Layer: LF_l5_FDCA.semantic_att
   â”œâ”€ Features: 1
   â”œâ”€ Mean Importance: 0.0820
   â”œâ”€ Max Importance: 0.0820
   â”œâ”€ Min Importance: 0.0820
   â””â”€ Top-5 Important Features: [0]
      â””â”€ Top-5 Values: ['0.0820']

ðŸ“Š Layer: LF_l5_FDCA.positional_att.conv
   â”œâ”€ Features: 1
   â”œâ”€ Mean Importance: 72.0614
   â”œâ”€ Max Importance: 72.0614
   â”œâ”€ Min Importance: 72.0614
   â””â”€ Top-5 Important Features: [0]
      â””â”€ Top-5 Values: ['72.0614']

ðŸ“Š Layer: LF_l5_FDCA.positional_att
   â”œâ”€ Features: 1
   â”œâ”€ Mean Importance: 0.0000
   â”œâ”€ Max Importance: 0.0000
   â”œâ”€ Min Importance: 0.0000
   â””â”€ Top-5 Important Features: [0]
      â””â”€ Top-5 Values: ['0.0000']

ðŸ“Š Layer: LF_l5_FDCA.slice_att.linear.0
   â”œâ”€ Features: 1
   â”œâ”€ Mean Importance: 0.0000
   â”œâ”€ Max Importance: 0.0000
   â”œâ”€ Min Importance: 0.0000
   â””â”€ Top-5 Important Features: [0]
      â””â”€ Top-5 Values: ['0.0000']

ðŸ“Š Layer: LF_l5_FDCA.slice_att.linear.1
   â”œâ”€ Features: 1
   â”œâ”€ Mean Importance: 0.0000
   â”œâ”€ Max Importance: 0.0000
   â”œâ”€ Min Importance: 0.0000
   â””â”€ Top-5 Important Features: [0]
      â””â”€ Top-5 Values: ['0.0000']

ðŸ“Š Layer: LF_l5_FDCA.slice_att.linear.2
   â”œâ”€ Features: 1
   â”œâ”€ Mean Importance: 0.0000
   â”œâ”€ Max Importance: 0.0000
   â”œâ”€ Min Importance: 0.0000
   â””â”€ Top-5 Important Features: [0]
      â””â”€ Top-5 Values: ['0.0000']

ðŸ“Š Layer: LF_l5_FDCA.slice_att.linear
   â”œâ”€ Features: 1
   â”œâ”€ Mean Importance: 0.0000
   â”œâ”€ Max Importance: 0.0000
   â”œâ”€ Min Importance: 0.0000
   â””â”€ Top-5 Important Features: [0]
      â””â”€ Top-5 Values: ['0.0000']

ðŸ“Š Layer: LF_l5_FDCA.slice_att.non_linear
   â”œâ”€ Features: 1
   â”œâ”€ Mean Importance: 0.0000
   â”œâ”€ Max Importance: 0.0000
   â”œâ”€ Min Importance: 0.0000
   â””â”€ Top-5 Important Features: [0]
      â””â”€ Top-5 Values: ['0.0000']

ðŸ“Š Layer: LF_l5_FDCA.slice_att.mean
   â”œâ”€ Features: 1
   â”œâ”€ Mean Importance: 0.0017
   â”œâ”€ Max Importance: 0.0017
   â”œâ”€ Min Importance: 0.0017
   â””â”€ Top-5 Important Features: [0]
      â””â”€ Top-5 Values: ['0.0017']

ðŸ“Š Layer: LF_l5_FDCA.slice_att.log_diag
   â”œâ”€ Features: 1
   â”œâ”€ Mean Importance: 0.0000
   â”œâ”€ Max Importance: 0.0000
   â”œâ”€ Min Importance: 0.0000
   â””â”€ Top-5 Important Features: [0]
      â””â”€ Top-5 Values: ['0.0000']

ðŸ“Š Layer: LF_l5_FDCA.slice_att.factor
   â”œâ”€ Features: 1
   â”œâ”€ Mean Importance: 0.0001
   â”œâ”€ Max Importance: 0.0001
   â”œâ”€ Min Importance: 0.0001
   â””â”€ Top-5 Important Features: [0]
      â””â”€ Top-5 Values: ['0.0001']

ðŸ“Š Layer: LF_l5_FDCA.slice_att
   â”œâ”€ Features: 1
   â”œâ”€ Mean Importance: 0.0000
   â”œâ”€ Max Importance: 0.0000
   â”œâ”€ Min Importance: 0.0000
   â””â”€ Top-5 Important Features: [0]
      â””â”€ Top-5 Values: ['0.0000']

ðŸ“Š Layer: LF_l5_FDCA
   â”œâ”€ Features: 1
   â”œâ”€ Mean Importance: 0.0000
   â”œâ”€ Max Importance: 0.0000
   â”œâ”€ Min Importance: 0.0000
   â””â”€ Top-5 Important Features: [0]
      â””â”€ Top-5 Values: ['0.0000']

ðŸ“Š Layer: HF_l4_FDCA.semantic_att
   â”œâ”€ Features: 1
   â”œâ”€ Mean Importance: 0.0830
   â”œâ”€ Max Importance: 0.0830
   â”œâ”€ Min Importance: 0.0830
   â””â”€ Top-5 Important Features: [0]
      â””â”€ Top-5 Values: ['0.0830']

ðŸ“Š Layer: HF_l4_FDCA.positional_att.conv
   â”œâ”€ Features: 1
   â”œâ”€ Mean Importance: 8.8147
   â”œâ”€ Max Importance: 8.8147
   â”œâ”€ Min Importance: 8.8147
   â””â”€ Top-5 Important Features: [0]
      â””â”€ Top-5 Values: ['8.8147']

ðŸ“Š Layer: HF_l4_FDCA.positional_att
   â”œâ”€ Features: 1
   â”œâ”€ Mean Importance: 0.0019
   â”œâ”€ Max Importance: 0.0019
   â”œâ”€ Min Importance: 0.0019
   â””â”€ Top-5 Important Features: [0]
      â””â”€ Top-5 Values: ['0.0019']

ðŸ“Š Layer: HF_l4_FDCA.slice_att.linear.0
   â”œâ”€ Features: 1
   â”œâ”€ Mean Importance: 0.0000
   â”œâ”€ Max Importance: 0.0000
   â”œâ”€ Min Importance: 0.0000
   â””â”€ Top-5 Important Features: [0]
      â””â”€ Top-5 Values: ['0.0000']

ðŸ“Š Layer: HF_l4_FDCA.slice_att.linear.1
   â”œâ”€ Features: 1
   â”œâ”€ Mean Importance: 0.0000
   â”œâ”€ Max Importance: 0.0000
   â”œâ”€ Min Importance: 0.0000
   â””â”€ Top-5 Important Features: [0]
      â””â”€ Top-5 Values: ['0.0000']

ðŸ“Š Layer: HF_l4_FDCA.slice_att.linear.2
   â”œâ”€ Features: 1
   â”œâ”€ Mean Importance: 0.0000
   â”œâ”€ Max Importance: 0.0000
   â”œâ”€ Min Importance: 0.0000
   â””â”€ Top-5 Important Features: [0]
      â””â”€ Top-5 Values: ['0.0000']

ðŸ“Š Layer: HF_l4_FDCA.slice_att.linear
   â”œâ”€ Features: 1
   â”œâ”€ Mean Importance: 0.0000
   â”œâ”€ Max Importance: 0.0000
   â”œâ”€ Min Importance: 0.0000
   â””â”€ Top-5 Important Features: [0]
      â””â”€ Top-5 Values: ['0.0000']

ðŸ“Š Layer: HF_l4_FDCA.slice_att.non_linear
   â”œâ”€ Features: 1
   â”œâ”€ Mean Importance: 0.0000
   â”œâ”€ Max Importance: 0.0000
   â”œâ”€ Min Importance: 0.0000
   â””â”€ Top-5 Important Features: [0]
      â””â”€ Top-5 Values: ['0.0000']

ðŸ“Š Layer: HF_l4_FDCA.slice_att.mean
   â”œâ”€ Features: 1
   â”œâ”€ Mean Importance: 0.0000
   â”œâ”€ Max Importance: 0.0000
   â”œâ”€ Min Importance: 0.0000
   â””â”€ Top-5 Important Features: [0]
      â””â”€ Top-5 Values: ['0.0000']

ðŸ“Š Layer: HF_l4_FDCA.slice_att.log_diag
   â”œâ”€ Features: 1
   â”œâ”€ Mean Importance: 0.0000
   â”œâ”€ Max Importance: 0.0000
   â”œâ”€ Min Importance: 0.0000
   â””â”€ Top-5 Important Features: [0]
      â””â”€ Top-5 Values: ['0.0000']

ðŸ“Š Layer: HF_l4_FDCA.slice_att.factor
   â”œâ”€ Features: 1
   â”œâ”€ Mean Importance: 0.0000
   â”œâ”€ Max Importance: 0.0000
   â”œâ”€ Min Importance: 0.0000
   â””â”€ Top-5 Important Features: [0]
      â””â”€ Top-5 Values: ['0.0000']

ðŸ“Š Layer: HF_l4_FDCA.slice_att
   â”œâ”€ Features: 1
   â”œâ”€ Mean Importance: 0.0063
   â”œâ”€ Max Importance: 0.0063
   â”œâ”€ Min Importance: 0.0063
   â””â”€ Top-5 Important Features: [0]
      â””â”€ Top-5 Values: ['0.0063']

ðŸ“Š Layer: HF_l4_FDCA
   â”œâ”€ Features: 1
   â”œâ”€ Mean Importance: 0.7407
   â”œâ”€ Max Importance: 0.7407
   â”œâ”€ Min Importance: 0.7407
   â””â”€ Top-5 Important Features: [0]
      â””â”€ Top-5 Values: ['0.7407']

ðŸ“Š Layer: HF_l5_FDCA.semantic_att
   â”œâ”€ Features: 1
   â”œâ”€ Mean Importance: 0.0672
   â”œâ”€ Max Importance: 0.0672
   â”œâ”€ Min Importance: 0.0672
   â””â”€ Top-5 Important Features: [0]
      â””â”€ Top-5 Values: ['0.0672']

ðŸ“Š Layer: HF_l5_FDCA.positional_att.conv
   â”œâ”€ Features: 1
   â”œâ”€ Mean Importance: 14.4169
   â”œâ”€ Max Importance: 14.4169
   â”œâ”€ Min Importance: 14.4169
   â””â”€ Top-5 Important Features: [0]
      â””â”€ Top-5 Values: ['14.4169']

ðŸ“Š Layer: HF_l5_FDCA.positional_att
   â”œâ”€ Features: 1
   â”œâ”€ Mean Importance: 0.0001
   â”œâ”€ Max Importance: 0.0001
   â”œâ”€ Min Importance: 0.0001
   â””â”€ Top-5 Important Features: [0]
      â””â”€ Top-5 Values: ['0.0001']

ðŸ“Š Layer: HF_l5_FDCA.slice_att.linear.0
   â”œâ”€ Features: 1
   â”œâ”€ Mean Importance: 0.0000
   â”œâ”€ Max Importance: 0.0000
   â”œâ”€ Min Importance: 0.0000
   â””â”€ Top-5 Important Features: [0]
      â””â”€ Top-5 Values: ['0.0000']

ðŸ“Š Layer: HF_l5_FDCA.slice_att.linear.1
   â”œâ”€ Features: 1
   â”œâ”€ Mean Importance: 0.0000
   â”œâ”€ Max Importance: 0.0000
   â”œâ”€ Min Importance: 0.0000
   â””â”€ Top-5 Important Features: [0]
      â””â”€ Top-5 Values: ['0.0000']

ðŸ“Š Layer: HF_l5_FDCA.slice_att.linear.2
   â”œâ”€ Features: 1
   â”œâ”€ Mean Importance: 0.0000
   â”œâ”€ Max Importance: 0.0000
   â”œâ”€ Min Importance: 0.0000
   â””â”€ Top-5 Important Features: [0]
      â””â”€ Top-5 Values: ['0.0000']

ðŸ“Š Layer: HF_l5_FDCA.slice_att.linear
   â”œâ”€ Features: 1
   â”œâ”€ Mean Importance: 0.0000
   â”œâ”€ Max Importance: 0.0000
   â”œâ”€ Min Importance: 0.0000
   â””â”€ Top-5 Important Features: [0]
      â””â”€ Top-5 Values: ['0.0000']

ðŸ“Š Layer: HF_l5_FDCA.slice_att.non_linear
   â”œâ”€ Features: 1
   â”œâ”€ Mean Importance: 0.0000
   â”œâ”€ Max Importance: 0.0000
   â”œâ”€ Min Importance: 0.0000
   â””â”€ Top-5 Important Features: [0]
      â””â”€ Top-5 Values: ['0.0000']

ðŸ“Š Layer: HF_l5_FDCA.slice_att.mean
   â”œâ”€ Features: 1
   â”œâ”€ Mean Importance: 0.0000
   â”œâ”€ Max Importance: 0.0000
   â”œâ”€ Min Importance: 0.0000
   â””â”€ Top-5 Important Features: [0]
      â””â”€ Top-5 Values: ['0.0000']

ðŸ“Š Layer: HF_l5_FDCA.slice_att.log_diag
   â”œâ”€ Features: 1
   â”œâ”€ Mean Importance: 0.0000
   â”œâ”€ Max Importance: 0.0000
   â”œâ”€ Min Importance: 0.0000
   â””â”€ Top-5 Important Features: [0]
      â””â”€ Top-5 Values: ['0.0000']

ðŸ“Š Layer: HF_l5_FDCA.slice_att.factor
   â”œâ”€ Features: 1
   â”œâ”€ Mean Importance: 0.0000
   â”œâ”€ Max Importance: 0.0000
   â”œâ”€ Min Importance: 0.0000
   â””â”€ Top-5 Important Features: [0]
      â””â”€ Top-5 Values: ['0.0000']

ðŸ“Š Layer: HF_l5_FDCA.slice_att
   â”œâ”€ Features: 1
   â”œâ”€ Mean Importance: 0.0002
   â”œâ”€ Max Importance: 0.0002
   â”œâ”€ Min Importance: 0.0002
   â””â”€ Top-5 Important Features: [0]
      â””â”€ Top-5 Values: ['0.0002']

ðŸ“Š Layer: HF_l5_FDCA
   â”œâ”€ Features: 1
   â”œâ”€ Mean Importance: 0.0006
   â”œâ”€ Max Importance: 0.0006
   â”œâ”€ Min Importance: 0.0006
   â””â”€ Top-5 Important Features: [0]
      â””â”€ Top-5 Values: ['0.0006']

======================================================================
âœ“ Mechanistic analysis complete

[3] Generating Grad-CAM...
Warning: Failed to generate CAM for class 0: element 0 of tensors does not require grad and does not have a grad_fn
Warning: Failed to generate CAM for class 1: element 0 of tensors does not require grad and does not have a grad_fn
Warning: Failed to generate CAM for class 2: element 0 of tensors does not require grad and does not have a grad_fn
Warning: Failed to generate CAM for class 3: element 0 of tensors does not require grad and does not have a grad_fn
[4] Analyzing frequency components...
âœ“ Saved: outputs/xai_2025-11-15_17-25-23/freq_component/sample_0027_freq_comp.png
âœ“ Evaluation complete for sample_0027
Evaluating:  74%|#######3  | 28/38 [07:46<02:45, 16.54s/it]
[1] Getting primary prediction...

[METRICS FOR sample_0028]
==================================================
class_0: Dice=0.9971, IoU=0.9943
class_1: Dice=0.5033, IoU=0.3363
class_2: Dice=0.8757, IoU=0.7788
class_3: Dice=0.8345, IoU=0.7159
==================================================

[2] Generating attention maps...
Clipping input data to the valid range for imshow with RGB data ([0..1] for floats or [0..255] for integers).
Clipping input data to the valid range for imshow with RGB data ([0..1] for floats or [0..255] for integers).
âœ“ Saved: outputs/xai_2025-11-15_17-25-23/attention/sample_0028_attention.png

[MECHANISTIC INTERPRETABILITY ANALYSIS]
======================================================================
Sample: sample_0028
======================================================================

ðŸ“Š Layer: LF_l4_FDCA.semantic_att
   â”œâ”€ Features: 1
   â”œâ”€ Mean Importance: 0.1089
   â”œâ”€ Max Importance: 0.1089
   â”œâ”€ Min Importance: 0.1089
   â””â”€ Top-5 Important Features: [0]
      â””â”€ Top-5 Values: ['0.1089']

ðŸ“Š Layer: LF_l4_FDCA.positional_att.conv
   â”œâ”€ Features: 1
   â”œâ”€ Mean Importance: 307.9914
   â”œâ”€ Max Importance: 307.9914
   â”œâ”€ Min Importance: 307.9914
   â””â”€ Top-5 Important Features: [0]
      â””â”€ Top-5 Values: ['307.9914']

ðŸ“Š Layer: LF_l4_FDCA.positional_att
   â”œâ”€ Features: 1
   â”œâ”€ Mean Importance: 44.6272
   â”œâ”€ Max Importance: 44.6272
   â”œâ”€ Min Importance: 44.6272
   â””â”€ Top-5 Important Features: [0]
      â””â”€ Top-5 Values: ['44.6272']

ðŸ“Š Layer: LF_l4_FDCA.slice_att.linear.0
   â”œâ”€ Features: 1
   â”œâ”€ Mean Importance: 103.5635
   â”œâ”€ Max Importance: 103.5635
   â”œâ”€ Min Importance: 103.5635
   â””â”€ Top-5 Important Features: [0]
      â””â”€ Top-5 Values: ['103.5635']

ðŸ“Š Layer: LF_l4_FDCA.slice_att.linear.1
   â”œâ”€ Features: 1
   â”œâ”€ Mean Importance: 87.8458
   â”œâ”€ Max Importance: 87.8458
   â”œâ”€ Min Importance: 87.8458
   â””â”€ Top-5 Important Features: [0]
      â””â”€ Top-5 Values: ['87.8458']

ðŸ“Š Layer: LF_l4_FDCA.slice_att.linear.2
   â”œâ”€ Features: 1
   â”œâ”€ Mean Importance: 83.3807
   â”œâ”€ Max Importance: 83.3807
   â”œâ”€ Min Importance: 83.3807
   â””â”€ Top-5 Important Features: [0]
      â””â”€ Top-5 Values: ['83.3807']

ðŸ“Š Layer: LF_l4_FDCA.slice_att.linear
   â”œâ”€ Features: 1
   â”œâ”€ Mean Importance: 83.3807
   â”œâ”€ Max Importance: 83.3807
   â”œâ”€ Min Importance: 83.3807
   â””â”€ Top-5 Important Features: [0]
      â””â”€ Top-5 Values: ['83.3807']

ðŸ“Š Layer: LF_l4_FDCA.slice_att.non_linear
   â”œâ”€ Features: 1
   â”œâ”€ Mean Importance: 36082424.0000
   â”œâ”€ Max Importance: 36082424.0000
   â”œâ”€ Min Importance: 36082424.0000
   â””â”€ Top-5 Important Features: [0]
      â””â”€ Top-5 Values: ['36082424.0000']

ðŸ“Š Layer: LF_l4_FDCA.slice_att.mean
   â”œâ”€ Features: 1
   â”œâ”€ Mean Importance: 144187520.0000
   â”œâ”€ Max Importance: 144187520.0000
   â”œâ”€ Min Importance: 144187520.0000
   â””â”€ Top-5 Important Features: [0]
      â””â”€ Top-5 Values: ['144187520.0000']

ðŸ“Š Layer: LF_l4_FDCA.slice_att.log_diag
   â”œâ”€ Features: 1
   â”œâ”€ Mean Importance: 8936.3379
   â”œâ”€ Max Importance: 8936.3379
   â”œâ”€ Min Importance: 8936.3379
   â””â”€ Top-5 Important Features: [0]
      â””â”€ Top-5 Values: ['8936.3379']

ðŸ“Š Layer: LF_l4_FDCA.slice_att.factor
   â”œâ”€ Features: 1
   â”œâ”€ Mean Importance: 55850720.0000
   â”œâ”€ Max Importance: 55850720.0000
   â”œâ”€ Min Importance: 55850720.0000
   â””â”€ Top-5 Important Features: [0]
      â””â”€ Top-5 Values: ['55850720.0000']

ðŸ“Š Layer: LF_l4_FDCA.slice_att
   â”œâ”€ Features: 1
   â”œâ”€ Mean Importance: 22511278.0000
   â”œâ”€ Max Importance: 22511278.0000
   â”œâ”€ Min Importance: 22511278.0000
   â””â”€ Top-5 Important Features: [0]
      â””â”€ Top-5 Values: ['22511278.0000']

ðŸ“Š Layer: LF_l4_FDCA
   â”œâ”€ Features: 1
   â”œâ”€ Mean Importance: 4532162190681047040.0000
   â”œâ”€ Max Importance: 4532162190681047040.0000
   â”œâ”€ Min Importance: 4532162190681047040.0000
   â””â”€ Top-5 Important Features: [0]
      â””â”€ Top-5 Values: ['4532162190681047040.0000']

ðŸ“Š Layer: LF_l5_FDCA.semantic_att
   â”œâ”€ Features: 1
   â”œâ”€ Mean Importance: 0.0798
   â”œâ”€ Max Importance: 0.0798
   â”œâ”€ Min Importance: 0.0798
   â””â”€ Top-5 Important Features: [0]
      â””â”€ Top-5 Values: ['0.0798']

ðŸ“Š Layer: LF_l5_FDCA.positional_att.conv
   â”œâ”€ Features: 1
   â”œâ”€ Mean Importance: 77.8324
   â”œâ”€ Max Importance: 77.8324
   â”œâ”€ Min Importance: 77.8324
   â””â”€ Top-5 Important Features: [0]
      â””â”€ Top-5 Values: ['77.8324']

ðŸ“Š Layer: LF_l5_FDCA.positional_att
   â”œâ”€ Features: 1
   â”œâ”€ Mean Importance: 0.0000
   â”œâ”€ Max Importance: 0.0000
   â”œâ”€ Min Importance: 0.0000
   â””â”€ Top-5 Important Features: [0]
      â””â”€ Top-5 Values: ['0.0000']

ðŸ“Š Layer: LF_l5_FDCA.slice_att.linear.0
   â”œâ”€ Features: 1
   â”œâ”€ Mean Importance: 0.0000
   â”œâ”€ Max Importance: 0.0000
   â”œâ”€ Min Importance: 0.0000
   â””â”€ Top-5 Important Features: [0]
      â””â”€ Top-5 Values: ['0.0000']

ðŸ“Š Layer: LF_l5_FDCA.slice_att.linear.1
   â”œâ”€ Features: 1
   â”œâ”€ Mean Importance: 0.0000
   â”œâ”€ Max Importance: 0.0000
   â”œâ”€ Min Importance: 0.0000
   â””â”€ Top-5 Important Features: [0]
      â””â”€ Top-5 Values: ['0.0000']

ðŸ“Š Layer: LF_l5_FDCA.slice_att.linear.2
   â”œâ”€ Features: 1
   â”œâ”€ Mean Importance: 0.0000
   â”œâ”€ Max Importance: 0.0000
   â”œâ”€ Min Importance: 0.0000
   â””â”€ Top-5 Important Features: [0]
      â””â”€ Top-5 Values: ['0.0000']

ðŸ“Š Layer: LF_l5_FDCA.slice_att.linear
   â”œâ”€ Features: 1
   â”œâ”€ Mean Importance: 0.0000
   â”œâ”€ Max Importance: 0.0000
   â”œâ”€ Min Importance: 0.0000
   â””â”€ Top-5 Important Features: [0]
      â””â”€ Top-5 Values: ['0.0000']

ðŸ“Š Layer: LF_l5_FDCA.slice_att.non_linear
   â”œâ”€ Features: 1
   â”œâ”€ Mean Importance: 0.0000
   â”œâ”€ Max Importance: 0.0000
   â”œâ”€ Min Importance: 0.0000
   â””â”€ Top-5 Important Features: [0]
      â””â”€ Top-5 Values: ['0.0000']

ðŸ“Š Layer: LF_l5_FDCA.slice_att.mean
   â”œâ”€ Features: 1
   â”œâ”€ Mean Importance: 0.0017
   â”œâ”€ Max Importance: 0.0017
   â”œâ”€ Min Importance: 0.0017
   â””â”€ Top-5 Important Features: [0]
      â””â”€ Top-5 Values: ['0.0017']

ðŸ“Š Layer: LF_l5_FDCA.slice_att.log_diag
   â”œâ”€ Features: 1
   â”œâ”€ Mean Importance: 0.0000
   â”œâ”€ Max Importance: 0.0000
   â”œâ”€ Min Importance: 0.0000
   â””â”€ Top-5 Important Features: [0]
      â””â”€ Top-5 Values: ['0.0000']

ðŸ“Š Layer: LF_l5_FDCA.slice_att.factor
   â”œâ”€ Features: 1
   â”œâ”€ Mean Importance: 0.0001
   â”œâ”€ Max Importance: 0.0001
   â”œâ”€ Min Importance: 0.0001
   â””â”€ Top-5 Important Features: [0]
      â””â”€ Top-5 Values: ['0.0001']

ðŸ“Š Layer: LF_l5_FDCA.slice_att
   â”œâ”€ Features: 1
   â”œâ”€ Mean Importance: 0.0000
   â”œâ”€ Max Importance: 0.0000
   â”œâ”€ Min Importance: 0.0000
   â””â”€ Top-5 Important Features: [0]
      â””â”€ Top-5 Values: ['0.0000']

ðŸ“Š Layer: LF_l5_FDCA
   â”œâ”€ Features: 1
   â”œâ”€ Mean Importance: 0.0000
   â”œâ”€ Max Importance: 0.0000
   â”œâ”€ Min Importance: 0.0000
   â””â”€ Top-5 Important Features: [0]
      â””â”€ Top-5 Values: ['0.0000']

ðŸ“Š Layer: HF_l4_FDCA.semantic_att
   â”œâ”€ Features: 1
   â”œâ”€ Mean Importance: 0.0815
   â”œâ”€ Max Importance: 0.0815
   â”œâ”€ Min Importance: 0.0815
   â””â”€ Top-5 Important Features: [0]
      â””â”€ Top-5 Values: ['0.0815']

ðŸ“Š Layer: HF_l4_FDCA.positional_att.conv
   â”œâ”€ Features: 1
   â”œâ”€ Mean Importance: 8.0940
   â”œâ”€ Max Importance: 8.0940
   â”œâ”€ Min Importance: 8.0940
   â””â”€ Top-5 Important Features: [0]
      â””â”€ Top-5 Values: ['8.0940']

ðŸ“Š Layer: HF_l4_FDCA.positional_att
   â”œâ”€ Features: 1
   â”œâ”€ Mean Importance: 0.0019
   â”œâ”€ Max Importance: 0.0019
   â”œâ”€ Min Importance: 0.0019
   â””â”€ Top-5 Important Features: [0]
      â””â”€ Top-5 Values: ['0.0019']

ðŸ“Š Layer: HF_l4_FDCA.slice_att.linear.0
   â”œâ”€ Features: 1
   â”œâ”€ Mean Importance: 0.0000
   â”œâ”€ Max Importance: 0.0000
   â”œâ”€ Min Importance: 0.0000
   â””â”€ Top-5 Important Features: [0]
      â””â”€ Top-5 Values: ['0.0000']

ðŸ“Š Layer: HF_l4_FDCA.slice_att.linear.1
   â”œâ”€ Features: 1
   â”œâ”€ Mean Importance: 0.0000
   â”œâ”€ Max Importance: 0.0000
   â”œâ”€ Min Importance: 0.0000
   â””â”€ Top-5 Important Features: [0]
      â””â”€ Top-5 Values: ['0.0000']

ðŸ“Š Layer: HF_l4_FDCA.slice_att.linear.2
   â”œâ”€ Features: 1
   â”œâ”€ Mean Importance: 0.0000
   â”œâ”€ Max Importance: 0.0000
   â”œâ”€ Min Importance: 0.0000
   â””â”€ Top-5 Important Features: [0]
      â””â”€ Top-5 Values: ['0.0000']

ðŸ“Š Layer: HF_l4_FDCA.slice_att.linear
   â”œâ”€ Features: 1
   â”œâ”€ Mean Importance: 0.0000
   â”œâ”€ Max Importance: 0.0000
   â”œâ”€ Min Importance: 0.0000
   â””â”€ Top-5 Important Features: [0]
      â””â”€ Top-5 Values: ['0.0000']

ðŸ“Š Layer: HF_l4_FDCA.slice_att.non_linear
   â”œâ”€ Features: 1
   â”œâ”€ Mean Importance: 0.0000
   â”œâ”€ Max Importance: 0.0000
   â”œâ”€ Min Importance: 0.0000
   â””â”€ Top-5 Important Features: [0]
      â””â”€ Top-5 Values: ['0.0000']

ðŸ“Š Layer: HF_l4_FDCA.slice_att.mean
   â”œâ”€ Features: 1
   â”œâ”€ Mean Importance: 0.0000
   â”œâ”€ Max Importance: 0.0000
   â”œâ”€ Min Importance: 0.0000
   â””â”€ Top-5 Important Features: [0]
      â””â”€ Top-5 Values: ['0.0000']

ðŸ“Š Layer: HF_l4_FDCA.slice_att.log_diag
   â”œâ”€ Features: 1
   â”œâ”€ Mean Importance: 0.0000
   â”œâ”€ Max Importance: 0.0000
   â”œâ”€ Min Importance: 0.0000
   â””â”€ Top-5 Important Features: [0]
      â””â”€ Top-5 Values: ['0.0000']

ðŸ“Š Layer: HF_l4_FDCA.slice_att.factor
   â”œâ”€ Features: 1
   â”œâ”€ Mean Importance: 0.0000
   â”œâ”€ Max Importance: 0.0000
   â”œâ”€ Min Importance: 0.0000
   â””â”€ Top-5 Important Features: [0]
      â””â”€ Top-5 Values: ['0.0000']

ðŸ“Š Layer: HF_l4_FDCA.slice_att
   â”œâ”€ Features: 1
   â”œâ”€ Mean Importance: 0.0061
   â”œâ”€ Max Importance: 0.0061
   â”œâ”€ Min Importance: 0.0061
   â””â”€ Top-5 Important Features: [0]
      â””â”€ Top-5 Values: ['0.0061']

ðŸ“Š Layer: HF_l4_FDCA
   â”œâ”€ Features: 1
   â”œâ”€ Mean Importance: 0.8550
   â”œâ”€ Max Importance: 0.8550
   â”œâ”€ Min Importance: 0.8550
   â””â”€ Top-5 Important Features: [0]
      â””â”€ Top-5 Values: ['0.8550']

ðŸ“Š Layer: HF_l5_FDCA.semantic_att
   â”œâ”€ Features: 1
   â”œâ”€ Mean Importance: 0.0681
   â”œâ”€ Max Importance: 0.0681
   â”œâ”€ Min Importance: 0.0681
   â””â”€ Top-5 Important Features: [0]
      â””â”€ Top-5 Values: ['0.0681']

ðŸ“Š Layer: HF_l5_FDCA.positional_att.conv
   â”œâ”€ Features: 1
   â”œâ”€ Mean Importance: 15.6501
   â”œâ”€ Max Importance: 15.6501
   â”œâ”€ Min Importance: 15.6501
   â””â”€ Top-5 Important Features: [0]
      â””â”€ Top-5 Values: ['15.6501']

ðŸ“Š Layer: HF_l5_FDCA.positional_att
   â”œâ”€ Features: 1
   â”œâ”€ Mean Importance: 0.0001
   â”œâ”€ Max Importance: 0.0001
   â”œâ”€ Min Importance: 0.0001
   â””â”€ Top-5 Important Features: [0]
      â””â”€ Top-5 Values: ['0.0001']

ðŸ“Š Layer: HF_l5_FDCA.slice_att.linear.0
   â”œâ”€ Features: 1
   â”œâ”€ Mean Importance: 0.0000
   â”œâ”€ Max Importance: 0.0000
   â”œâ”€ Min Importance: 0.0000
   â””â”€ Top-5 Important Features: [0]
      â””â”€ Top-5 Values: ['0.0000']

ðŸ“Š Layer: HF_l5_FDCA.slice_att.linear.1
   â”œâ”€ Features: 1
   â”œâ”€ Mean Importance: 0.0000
   â”œâ”€ Max Importance: 0.0000
   â”œâ”€ Min Importance: 0.0000
   â””â”€ Top-5 Important Features: [0]
      â””â”€ Top-5 Values: ['0.0000']

ðŸ“Š Layer: HF_l5_FDCA.slice_att.linear.2
   â”œâ”€ Features: 1
   â”œâ”€ Mean Importance: 0.0000
   â”œâ”€ Max Importance: 0.0000
   â”œâ”€ Min Importance: 0.0000
   â””â”€ Top-5 Important Features: [0]
      â””â”€ Top-5 Values: ['0.0000']

ðŸ“Š Layer: HF_l5_FDCA.slice_att.linear
   â”œâ”€ Features: 1
   â”œâ”€ Mean Importance: 0.0000
   â”œâ”€ Max Importance: 0.0000
   â”œâ”€ Min Importance: 0.0000
   â””â”€ Top-5 Important Features: [0]
      â””â”€ Top-5 Values: ['0.0000']

ðŸ“Š Layer: HF_l5_FDCA.slice_att.non_linear
   â”œâ”€ Features: 1
   â”œâ”€ Mean Importance: 0.0000
   â”œâ”€ Max Importance: 0.0000
   â”œâ”€ Min Importance: 0.0000
   â””â”€ Top-5 Important Features: [0]
      â””â”€ Top-5 Values: ['0.0000']

ðŸ“Š Layer: HF_l5_FDCA.slice_att.mean
   â”œâ”€ Features: 1
   â”œâ”€ Mean Importance: 0.0000
   â”œâ”€ Max Importance: 0.0000
   â”œâ”€ Min Importance: 0.0000
   â””â”€ Top-5 Important Features: [0]
      â””â”€ Top-5 Values: ['0.0000']

ðŸ“Š Layer: HF_l5_FDCA.slice_att.log_diag
   â”œâ”€ Features: 1
   â”œâ”€ Mean Importance: 0.0000
   â”œâ”€ Max Importance: 0.0000
   â”œâ”€ Min Importance: 0.0000
   â””â”€ Top-5 Important Features: [0]
      â””â”€ Top-5 Values: ['0.0000']

ðŸ“Š Layer: HF_l5_FDCA.slice_att.factor
   â”œâ”€ Features: 1
   â”œâ”€ Mean Importance: 0.0000
   â”œâ”€ Max Importance: 0.0000
   â”œâ”€ Min Importance: 0.0000
   â””â”€ Top-5 Important Features: [0]
      â””â”€ Top-5 Values: ['0.0000']

ðŸ“Š Layer: HF_l5_FDCA.slice_att
   â”œâ”€ Features: 1
   â”œâ”€ Mean Importance: 0.0001
   â”œâ”€ Max Importance: 0.0001
   â”œâ”€ Min Importance: 0.0001
   â””â”€ Top-5 Important Features: [0]
      â””â”€ Top-5 Values: ['0.0001']

ðŸ“Š Layer: HF_l5_FDCA
   â”œâ”€ Features: 1
   â”œâ”€ Mean Importance: 0.0001
   â”œâ”€ Max Importance: 0.0001
   â”œâ”€ Min Importance: 0.0001
   â””â”€ Top-5 Important Features: [0]
      â””â”€ Top-5 Values: ['0.0001']

======================================================================
âœ“ Mechanistic analysis complete

[3] Generating Grad-CAM...
Warning: Failed to generate CAM for class 0: element 0 of tensors does not require grad and does not have a grad_fn
Warning: Failed to generate CAM for class 1: element 0 of tensors does not require grad and does not have a grad_fn
Warning: Failed to generate CAM for class 2: element 0 of tensors does not require grad and does not have a grad_fn
Warning: Failed to generate CAM for class 3: element 0 of tensors does not require grad and does not have a grad_fn
[4] Analyzing frequency components...
âœ“ Saved: outputs/xai_2025-11-15_17-25-23/freq_component/sample_0028_freq_comp.png
âœ“ Evaluation complete for sample_0028
Evaluating:  76%|#######6  | 29/38 [08:03<02:29, 16.66s/it]
[1] Getting primary prediction...

[METRICS FOR sample_0029]
==================================================
class_0: Dice=0.9981, IoU=0.9962
class_1: Dice=0.0621, IoU=0.0320
class_2: Dice=0.7156, IoU=0.5572
class_3: Dice=0.0000, IoU=0.0000
==================================================

[2] Generating attention maps...
Clipping input data to the valid range for imshow with RGB data ([0..1] for floats or [0..255] for integers).
Clipping input data to the valid range for imshow with RGB data ([0..1] for floats or [0..255] for integers).
âœ“ Saved: outputs/xai_2025-11-15_17-25-23/attention/sample_0029_attention.png

[MECHANISTIC INTERPRETABILITY ANALYSIS]
======================================================================
Sample: sample_0029
======================================================================

ðŸ“Š Layer: LF_l4_FDCA.semantic_att
   â”œâ”€ Features: 1
   â”œâ”€ Mean Importance: 0.1102
   â”œâ”€ Max Importance: 0.1102
   â”œâ”€ Min Importance: 0.1102
   â””â”€ Top-5 Important Features: [0]
      â””â”€ Top-5 Values: ['0.1102']

ðŸ“Š Layer: LF_l4_FDCA.positional_att.conv
   â”œâ”€ Features: 1
   â”œâ”€ Mean Importance: 265.7760
   â”œâ”€ Max Importance: 265.7760
   â”œâ”€ Min Importance: 265.7760
   â””â”€ Top-5 Important Features: [0]
      â””â”€ Top-5 Values: ['265.7760']

ðŸ“Š Layer: LF_l4_FDCA.positional_att
   â”œâ”€ Features: 1
   â”œâ”€ Mean Importance: 40.8352
   â”œâ”€ Max Importance: 40.8352
   â”œâ”€ Min Importance: 40.8352
   â””â”€ Top-5 Important Features: [0]
      â””â”€ Top-5 Values: ['40.8352']

ðŸ“Š Layer: LF_l4_FDCA.slice_att.linear.0
   â”œâ”€ Features: 1
   â”œâ”€ Mean Importance: 78.2507
   â”œâ”€ Max Importance: 78.2507
   â”œâ”€ Min Importance: 78.2507
   â””â”€ Top-5 Important Features: [0]
      â””â”€ Top-5 Values: ['78.2507']

ðŸ“Š Layer: LF_l4_FDCA.slice_att.linear.1
   â”œâ”€ Features: 1
   â”œâ”€ Mean Importance: 66.3767
   â”œâ”€ Max Importance: 66.3767
   â”œâ”€ Min Importance: 66.3767
   â””â”€ Top-5 Important Features: [0]
      â””â”€ Top-5 Values: ['66.3767']

ðŸ“Š Layer: LF_l4_FDCA.slice_att.linear.2
   â”œâ”€ Features: 1
   â”œâ”€ Mean Importance: 62.9980
   â”œâ”€ Max Importance: 62.9980
   â”œâ”€ Min Importance: 62.9980
   â””â”€ Top-5 Important Features: [0]
      â””â”€ Top-5 Values: ['62.9980']

ðŸ“Š Layer: LF_l4_FDCA.slice_att.linear
   â”œâ”€ Features: 1
   â”œâ”€ Mean Importance: 62.9980
   â”œâ”€ Max Importance: 62.9980
   â”œâ”€ Min Importance: 62.9980
   â””â”€ Top-5 Important Features: [0]
      â””â”€ Top-5 Values: ['62.9980']

ðŸ“Š Layer: LF_l4_FDCA.slice_att.non_linear
   â”œâ”€ Features: 1
   â”œâ”€ Mean Importance: 26676776.0000
   â”œâ”€ Max Importance: 26676776.0000
   â”œâ”€ Min Importance: 26676776.0000
   â””â”€ Top-5 Important Features: [0]
      â””â”€ Top-5 Values: ['26676776.0000']

ðŸ“Š Layer: LF_l4_FDCA.slice_att.mean
   â”œâ”€ Features: 1
   â”œâ”€ Mean Importance: 106597184.0000
   â”œâ”€ Max Importance: 106597184.0000
   â”œâ”€ Min Importance: 106597184.0000
   â””â”€ Top-5 Important Features: [0]
      â””â”€ Top-5 Values: ['106597184.0000']

ðŸ“Š Layer: LF_l4_FDCA.slice_att.log_diag
   â”œâ”€ Features: 1
   â”œâ”€ Mean Importance: 6606.6421
   â”œâ”€ Max Importance: 6606.6421
   â”œâ”€ Min Importance: 6606.6421
   â””â”€ Top-5 Important Features: [0]
      â””â”€ Top-5 Values: ['6606.6421']

ðŸ“Š Layer: LF_l4_FDCA.slice_att.factor
   â”œâ”€ Features: 1
   â”œâ”€ Mean Importance: 41290132.0000
   â”œâ”€ Max Importance: 41290132.0000
   â”œâ”€ Min Importance: 41290132.0000
   â””â”€ Top-5 Important Features: [0]
      â””â”€ Top-5 Values: ['41290132.0000']

ðŸ“Š Layer: LF_l4_FDCA.slice_att
   â”œâ”€ Features: 1
   â”œâ”€ Mean Importance: 16947886.0000
   â”œâ”€ Max Importance: 16947886.0000
   â”œâ”€ Min Importance: 16947886.0000
   â””â”€ Top-5 Important Features: [0]
      â””â”€ Top-5 Values: ['16947886.0000']

ðŸ“Š Layer: LF_l4_FDCA
   â”œâ”€ Features: 1
   â”œâ”€ Mean Importance: 2521726070013558784.0000
   â”œâ”€ Max Importance: 2521726070013558784.0000
   â”œâ”€ Min Importance: 2521726070013558784.0000
   â””â”€ Top-5 Important Features: [0]
      â””â”€ Top-5 Values: ['2521726070013558784.0000']

ðŸ“Š Layer: LF_l5_FDCA.semantic_att
   â”œâ”€ Features: 1
   â”œâ”€ Mean Importance: 0.0829
   â”œâ”€ Max Importance: 0.0829
   â”œâ”€ Min Importance: 0.0829
   â””â”€ Top-5 Important Features: [0]
      â””â”€ Top-5 Values: ['0.0829']

ðŸ“Š Layer: LF_l5_FDCA.positional_att.conv
   â”œâ”€ Features: 1
   â”œâ”€ Mean Importance: 68.8801
   â”œâ”€ Max Importance: 68.8801
   â”œâ”€ Min Importance: 68.8801
   â””â”€ Top-5 Important Features: [0]
      â””â”€ Top-5 Values: ['68.8801']

ðŸ“Š Layer: LF_l5_FDCA.positional_att
   â”œâ”€ Features: 1
   â”œâ”€ Mean Importance: 0.0000
   â”œâ”€ Max Importance: 0.0000
   â”œâ”€ Min Importance: 0.0000
   â””â”€ Top-5 Important Features: [0]
      â””â”€ Top-5 Values: ['0.0000']

ðŸ“Š Layer: LF_l5_FDCA.slice_att.linear.0
   â”œâ”€ Features: 1
   â”œâ”€ Mean Importance: 0.0000
   â”œâ”€ Max Importance: 0.0000
   â”œâ”€ Min Importance: 0.0000
   â””â”€ Top-5 Important Features: [0]
      â””â”€ Top-5 Values: ['0.0000']

ðŸ“Š Layer: LF_l5_FDCA.slice_att.linear.1
   â”œâ”€ Features: 1
   â”œâ”€ Mean Importance: 0.0000
   â”œâ”€ Max Importance: 0.0000
   â”œâ”€ Min Importance: 0.0000
   â””â”€ Top-5 Important Features: [0]
      â””â”€ Top-5 Values: ['0.0000']

ðŸ“Š Layer: LF_l5_FDCA.slice_att.linear.2
   â”œâ”€ Features: 1
   â”œâ”€ Mean Importance: 0.0000
   â”œâ”€ Max Importance: 0.0000
   â”œâ”€ Min Importance: 0.0000
   â””â”€ Top-5 Important Features: [0]
      â””â”€ Top-5 Values: ['0.0000']

ðŸ“Š Layer: LF_l5_FDCA.slice_att.linear
   â”œâ”€ Features: 1
   â”œâ”€ Mean Importance: 0.0000
   â”œâ”€ Max Importance: 0.0000
   â”œâ”€ Min Importance: 0.0000
   â””â”€ Top-5 Important Features: [0]
      â””â”€ Top-5 Values: ['0.0000']

ðŸ“Š Layer: LF_l5_FDCA.slice_att.non_linear
   â”œâ”€ Features: 1
   â”œâ”€ Mean Importance: 0.0000
   â”œâ”€ Max Importance: 0.0000
   â”œâ”€ Min Importance: 0.0000
   â””â”€ Top-5 Important Features: [0]
      â””â”€ Top-5 Values: ['0.0000']

ðŸ“Š Layer: LF_l5_FDCA.slice_att.mean
   â”œâ”€ Features: 1
   â”œâ”€ Mean Importance: 0.0017
   â”œâ”€ Max Importance: 0.0017
   â”œâ”€ Min Importance: 0.0017
   â””â”€ Top-5 Important Features: [0]
      â””â”€ Top-5 Values: ['0.0017']

ðŸ“Š Layer: LF_l5_FDCA.slice_att.log_diag
   â”œâ”€ Features: 1
   â”œâ”€ Mean Importance: 0.0000
   â”œâ”€ Max Importance: 0.0000
   â”œâ”€ Min Importance: 0.0000
   â””â”€ Top-5 Important Features: [0]
      â””â”€ Top-5 Values: ['0.0000']

ðŸ“Š Layer: LF_l5_FDCA.slice_att.factor
   â”œâ”€ Features: 1
   â”œâ”€ Mean Importance: 0.0001
   â”œâ”€ Max Importance: 0.0001
   â”œâ”€ Min Importance: 0.0001
   â””â”€ Top-5 Important Features: [0]
      â””â”€ Top-5 Values: ['0.0001']

ðŸ“Š Layer: LF_l5_FDCA.slice_att
   â”œâ”€ Features: 1
   â”œâ”€ Mean Importance: 0.0000
   â”œâ”€ Max Importance: 0.0000
   â”œâ”€ Min Importance: 0.0000
   â””â”€ Top-5 Important Features: [0]
      â””â”€ Top-5 Values: ['0.0000']

ðŸ“Š Layer: LF_l5_FDCA
   â”œâ”€ Features: 1
   â”œâ”€ Mean Importance: 0.0000
   â”œâ”€ Max Importance: 0.0000
   â”œâ”€ Min Importance: 0.0000
   â””â”€ Top-5 Important Features: [0]
      â””â”€ Top-5 Values: ['0.0000']

ðŸ“Š Layer: HF_l4_FDCA.semantic_att
   â”œâ”€ Features: 1
   â”œâ”€ Mean Importance: 0.0839
   â”œâ”€ Max Importance: 0.0839
   â”œâ”€ Min Importance: 0.0839
   â””â”€ Top-5 Important Features: [0]
      â””â”€ Top-5 Values: ['0.0839']

ðŸ“Š Layer: HF_l4_FDCA.positional_att.conv
   â”œâ”€ Features: 1
   â”œâ”€ Mean Importance: 9.4311
   â”œâ”€ Max Importance: 9.4311
   â”œâ”€ Min Importance: 9.4311
   â””â”€ Top-5 Important Features: [0]
      â””â”€ Top-5 Values: ['9.4311']

ðŸ“Š Layer: HF_l4_FDCA.positional_att
   â”œâ”€ Features: 1
   â”œâ”€ Mean Importance: 0.0018
   â”œâ”€ Max Importance: 0.0018
   â”œâ”€ Min Importance: 0.0018
   â””â”€ Top-5 Important Features: [0]
      â””â”€ Top-5 Values: ['0.0018']

ðŸ“Š Layer: HF_l4_FDCA.slice_att.linear.0
   â”œâ”€ Features: 1
   â”œâ”€ Mean Importance: 0.0000
   â”œâ”€ Max Importance: 0.0000
   â”œâ”€ Min Importance: 0.0000
   â””â”€ Top-5 Important Features: [0]
      â””â”€ Top-5 Values: ['0.0000']

ðŸ“Š Layer: HF_l4_FDCA.slice_att.linear.1
   â”œâ”€ Features: 1
   â”œâ”€ Mean Importance: 0.0000
   â”œâ”€ Max Importance: 0.0000
   â”œâ”€ Min Importance: 0.0000
   â””â”€ Top-5 Important Features: [0]
      â””â”€ Top-5 Values: ['0.0000']

ðŸ“Š Layer: HF_l4_FDCA.slice_att.linear.2
   â”œâ”€ Features: 1
   â”œâ”€ Mean Importance: 0.0000
   â”œâ”€ Max Importance: 0.0000
   â”œâ”€ Min Importance: 0.0000
   â””â”€ Top-5 Important Features: [0]
      â””â”€ Top-5 Values: ['0.0000']

ðŸ“Š Layer: HF_l4_FDCA.slice_att.linear
   â”œâ”€ Features: 1
   â”œâ”€ Mean Importance: 0.0000
   â”œâ”€ Max Importance: 0.0000
   â”œâ”€ Min Importance: 0.0000
   â””â”€ Top-5 Important Features: [0]
      â””â”€ Top-5 Values: ['0.0000']

ðŸ“Š Layer: HF_l4_FDCA.slice_att.non_linear
   â”œâ”€ Features: 1
   â”œâ”€ Mean Importance: 0.0000
   â”œâ”€ Max Importance: 0.0000
   â”œâ”€ Min Importance: 0.0000
   â””â”€ Top-5 Important Features: [0]
      â””â”€ Top-5 Values: ['0.0000']

ðŸ“Š Layer: HF_l4_FDCA.slice_att.mean
   â”œâ”€ Features: 1
   â”œâ”€ Mean Importance: 0.0000
   â”œâ”€ Max Importance: 0.0000
   â”œâ”€ Min Importance: 0.0000
   â””â”€ Top-5 Important Features: [0]
      â””â”€ Top-5 Values: ['0.0000']

ðŸ“Š Layer: HF_l4_FDCA.slice_att.log_diag
   â”œâ”€ Features: 1
   â”œâ”€ Mean Importance: 0.0000
   â”œâ”€ Max Importance: 0.0000
   â”œâ”€ Min Importance: 0.0000
   â””â”€ Top-5 Important Features: [0]
      â””â”€ Top-5 Values: ['0.0000']

ðŸ“Š Layer: HF_l4_FDCA.slice_att.factor
   â”œâ”€ Features: 1
   â”œâ”€ Mean Importance: 0.0000
   â”œâ”€ Max Importance: 0.0000
   â”œâ”€ Min Importance: 0.0000
   â””â”€ Top-5 Important Features: [0]
      â””â”€ Top-5 Values: ['0.0000']

ðŸ“Š Layer: HF_l4_FDCA.slice_att
   â”œâ”€ Features: 1
   â”œâ”€ Mean Importance: 0.0051
   â”œâ”€ Max Importance: 0.0051
   â”œâ”€ Min Importance: 0.0051
   â””â”€ Top-5 Important Features: [0]
      â””â”€ Top-5 Values: ['0.0051']

ðŸ“Š Layer: HF_l4_FDCA
   â”œâ”€ Features: 1
   â”œâ”€ Mean Importance: 0.8903
   â”œâ”€ Max Importance: 0.8903
   â”œâ”€ Min Importance: 0.8903
   â””â”€ Top-5 Important Features: [0]
      â””â”€ Top-5 Values: ['0.8903']

ðŸ“Š Layer: HF_l5_FDCA.semantic_att
   â”œâ”€ Features: 1
   â”œâ”€ Mean Importance: 0.0771
   â”œâ”€ Max Importance: 0.0771
   â”œâ”€ Min Importance: 0.0771
   â””â”€ Top-5 Important Features: [0]
      â””â”€ Top-5 Values: ['0.0771']

ðŸ“Š Layer: HF_l5_FDCA.positional_att.conv
   â”œâ”€ Features: 1
   â”œâ”€ Mean Importance: 16.0302
   â”œâ”€ Max Importance: 16.0302
   â”œâ”€ Min Importance: 16.0302
   â””â”€ Top-5 Important Features: [0]
      â””â”€ Top-5 Values: ['16.0302']

ðŸ“Š Layer: HF_l5_FDCA.positional_att
   â”œâ”€ Features: 1
   â”œâ”€ Mean Importance: 0.0001
   â”œâ”€ Max Importance: 0.0001
   â”œâ”€ Min Importance: 0.0001
   â””â”€ Top-5 Important Features: [0]
      â””â”€ Top-5 Values: ['0.0001']

ðŸ“Š Layer: HF_l5_FDCA.slice_att.linear.0
   â”œâ”€ Features: 1
   â”œâ”€ Mean Importance: 0.0000
   â”œâ”€ Max Importance: 0.0000
   â”œâ”€ Min Importance: 0.0000
   â””â”€ Top-5 Important Features: [0]
      â””â”€ Top-5 Values: ['0.0000']

ðŸ“Š Layer: HF_l5_FDCA.slice_att.linear.1
   â”œâ”€ Features: 1
   â”œâ”€ Mean Importance: 0.0000
   â”œâ”€ Max Importance: 0.0000
   â”œâ”€ Min Importance: 0.0000
   â””â”€ Top-5 Important Features: [0]
      â””â”€ Top-5 Values: ['0.0000']

ðŸ“Š Layer: HF_l5_FDCA.slice_att.linear.2
   â”œâ”€ Features: 1
   â”œâ”€ Mean Importance: 0.0000
   â”œâ”€ Max Importance: 0.0000
   â”œâ”€ Min Importance: 0.0000
   â””â”€ Top-5 Important Features: [0]
      â””â”€ Top-5 Values: ['0.0000']

ðŸ“Š Layer: HF_l5_FDCA.slice_att.linear
   â”œâ”€ Features: 1
   â”œâ”€ Mean Importance: 0.0000
   â”œâ”€ Max Importance: 0.0000
   â”œâ”€ Min Importance: 0.0000
   â””â”€ Top-5 Important Features: [0]
      â””â”€ Top-5 Values: ['0.0000']

ðŸ“Š Layer: HF_l5_FDCA.slice_att.non_linear
   â”œâ”€ Features: 1
   â”œâ”€ Mean Importance: 0.0000
   â”œâ”€ Max Importance: 0.0000
   â”œâ”€ Min Importance: 0.0000
   â””â”€ Top-5 Important Features: [0]
      â””â”€ Top-5 Values: ['0.0000']

ðŸ“Š Layer: HF_l5_FDCA.slice_att.mean
   â”œâ”€ Features: 1
   â”œâ”€ Mean Importance: 0.0000
   â”œâ”€ Max Importance: 0.0000
   â”œâ”€ Min Importance: 0.0000
   â””â”€ Top-5 Important Features: [0]
      â””â”€ Top-5 Values: ['0.0000']

ðŸ“Š Layer: HF_l5_FDCA.slice_att.log_diag
   â”œâ”€ Features: 1
   â”œâ”€ Mean Importance: 0.0000
   â”œâ”€ Max Importance: 0.0000
   â”œâ”€ Min Importance: 0.0000
   â””â”€ Top-5 Important Features: [0]
      â””â”€ Top-5 Values: ['0.0000']

ðŸ“Š Layer: HF_l5_FDCA.slice_att.factor
   â”œâ”€ Features: 1
   â”œâ”€ Mean Importance: 0.0000
   â”œâ”€ Max Importance: 0.0000
   â”œâ”€ Min Importance: 0.0000
   â””â”€ Top-5 Important Features: [0]
      â””â”€ Top-5 Values: ['0.0000']

ðŸ“Š Layer: HF_l5_FDCA.slice_att
   â”œâ”€ Features: 1
   â”œâ”€ Mean Importance: 0.0001
   â”œâ”€ Max Importance: 0.0001
   â”œâ”€ Min Importance: 0.0001
   â””â”€ Top-5 Important Features: [0]
      â””â”€ Top-5 Values: ['0.0001']

ðŸ“Š Layer: HF_l5_FDCA
   â”œâ”€ Features: 1
   â”œâ”€ Mean Importance: 0.0002
   â”œâ”€ Max Importance: 0.0002
   â”œâ”€ Min Importance: 0.0002
   â””â”€ Top-5 Important Features: [0]
      â””â”€ Top-5 Values: ['0.0002']

======================================================================
âœ“ Mechanistic analysis complete

[3] Generating Grad-CAM...
Warning: Failed to generate CAM for class 0: element 0 of tensors does not require grad and does not have a grad_fn
Warning: Failed to generate CAM for class 1: element 0 of tensors does not require grad and does not have a grad_fn
Warning: Failed to generate CAM for class 2: element 0 of tensors does not require grad and does not have a grad_fn
Warning: Failed to generate CAM for class 3: element 0 of tensors does not require grad and does not have a grad_fn
[4] Analyzing frequency components...
âœ“ Saved: outputs/xai_2025-11-15_17-25-23/freq_component/sample_0029_freq_comp.png
âœ“ Evaluation complete for sample_0029
Evaluating:  79%|#######8  | 30/38 [08:19<02:11, 16.49s/it]
[1] Getting primary prediction...

[METRICS FOR sample_0030]
==================================================
class_0: Dice=0.9909, IoU=0.9819
class_1: Dice=0.6632, IoU=0.4961
class_2: Dice=0.7068, IoU=0.5465
class_3: Dice=0.6635, IoU=0.4965
==================================================

[2] Generating attention maps...
Clipping input data to the valid range for imshow with RGB data ([0..1] for floats or [0..255] for integers).
Clipping input data to the valid range for imshow with RGB data ([0..1] for floats or [0..255] for integers).
âœ“ Saved: outputs/xai_2025-11-15_17-25-23/attention/sample_0030_attention.png

[MECHANISTIC INTERPRETABILITY ANALYSIS]
======================================================================
Sample: sample_0030
======================================================================

ðŸ“Š Layer: LF_l4_FDCA.semantic_att
   â”œâ”€ Features: 1
   â”œâ”€ Mean Importance: 0.1070
   â”œâ”€ Max Importance: 0.1070
   â”œâ”€ Min Importance: 0.1070
   â””â”€ Top-5 Important Features: [0]
      â””â”€ Top-5 Values: ['0.1070']

ðŸ“Š Layer: LF_l4_FDCA.positional_att.conv
   â”œâ”€ Features: 1
   â”œâ”€ Mean Importance: 274.7306
   â”œâ”€ Max Importance: 274.7306
   â”œâ”€ Min Importance: 274.7306
   â””â”€ Top-5 Important Features: [0]
      â””â”€ Top-5 Values: ['274.7306']

ðŸ“Š Layer: LF_l4_FDCA.positional_att
   â”œâ”€ Features: 1
   â”œâ”€ Mean Importance: 42.6026
   â”œâ”€ Max Importance: 42.6026
   â”œâ”€ Min Importance: 42.6026
   â””â”€ Top-5 Important Features: [0]
      â””â”€ Top-5 Values: ['42.6026']

ðŸ“Š Layer: LF_l4_FDCA.slice_att.linear.0
   â”œâ”€ Features: 1
   â”œâ”€ Mean Importance: 93.2894
   â”œâ”€ Max Importance: 93.2894
   â”œâ”€ Min Importance: 93.2894
   â””â”€ Top-5 Important Features: [0]
      â””â”€ Top-5 Values: ['93.2894']

ðŸ“Š Layer: LF_l4_FDCA.slice_att.linear.1
   â”œâ”€ Features: 1
   â”œâ”€ Mean Importance: 79.1313
   â”œâ”€ Max Importance: 79.1313
   â”œâ”€ Min Importance: 79.1313
   â””â”€ Top-5 Important Features: [0]
      â””â”€ Top-5 Values: ['79.1313']

ðŸ“Š Layer: LF_l4_FDCA.slice_att.linear.2
   â”œâ”€ Features: 1
   â”œâ”€ Mean Importance: 75.1084
   â”œâ”€ Max Importance: 75.1084
   â”œâ”€ Min Importance: 75.1084
   â””â”€ Top-5 Important Features: [0]
      â””â”€ Top-5 Values: ['75.1084']

ðŸ“Š Layer: LF_l4_FDCA.slice_att.linear
   â”œâ”€ Features: 1
   â”œâ”€ Mean Importance: 75.1084
   â”œâ”€ Max Importance: 75.1084
   â”œâ”€ Min Importance: 75.1084
   â””â”€ Top-5 Important Features: [0]
      â””â”€ Top-5 Values: ['75.1084']

ðŸ“Š Layer: LF_l4_FDCA.slice_att.non_linear
   â”œâ”€ Features: 1
   â”œâ”€ Mean Importance: 28806116.0000
   â”œâ”€ Max Importance: 28806116.0000
   â”œâ”€ Min Importance: 28806116.0000
   â””â”€ Top-5 Important Features: [0]
      â””â”€ Top-5 Values: ['28806116.0000']

ðŸ“Š Layer: LF_l4_FDCA.slice_att.mean
   â”œâ”€ Features: 1
   â”œâ”€ Mean Importance: 115107240.0000
   â”œâ”€ Max Importance: 115107240.0000
   â”œâ”€ Min Importance: 115107240.0000
   â””â”€ Top-5 Important Features: [0]
      â””â”€ Top-5 Values: ['115107240.0000']

ðŸ“Š Layer: LF_l4_FDCA.slice_att.log_diag
   â”œâ”€ Features: 1
   â”œâ”€ Mean Importance: 7134.0601
   â”œâ”€ Max Importance: 7134.0601
   â”œâ”€ Min Importance: 7134.0601
   â””â”€ Top-5 Important Features: [0]
      â””â”€ Top-5 Values: ['7134.0601']

ðŸ“Š Layer: LF_l4_FDCA.slice_att.factor
   â”œâ”€ Features: 1
   â”œâ”€ Mean Importance: 44586496.0000
   â”œâ”€ Max Importance: 44586496.0000
   â”œâ”€ Min Importance: 44586496.0000
   â””â”€ Top-5 Important Features: [0]
      â””â”€ Top-5 Values: ['44586496.0000']

ðŸ“Š Layer: LF_l4_FDCA.slice_att
   â”œâ”€ Features: 1
   â”œâ”€ Mean Importance: 20234744.0000
   â”œâ”€ Max Importance: 20234744.0000
   â”œâ”€ Min Importance: 20234744.0000
   â””â”€ Top-5 Important Features: [0]
      â””â”€ Top-5 Values: ['20234744.0000']

ðŸ“Š Layer: LF_l4_FDCA
   â”œâ”€ Features: 1
   â”œâ”€ Mean Importance: 3578184395858640896.0000
   â”œâ”€ Max Importance: 3578184395858640896.0000
   â”œâ”€ Min Importance: 3578184395858640896.0000
   â””â”€ Top-5 Important Features: [0]
      â””â”€ Top-5 Values: ['3578184395858640896.0000']

ðŸ“Š Layer: LF_l5_FDCA.semantic_att
   â”œâ”€ Features: 1
   â”œâ”€ Mean Importance: 0.0812
   â”œâ”€ Max Importance: 0.0812
   â”œâ”€ Min Importance: 0.0812
   â””â”€ Top-5 Important Features: [0]
      â””â”€ Top-5 Values: ['0.0812']

ðŸ“Š Layer: LF_l5_FDCA.positional_att.conv
   â”œâ”€ Features: 1
   â”œâ”€ Mean Importance: 75.7230
   â”œâ”€ Max Importance: 75.7230
   â”œâ”€ Min Importance: 75.7230
   â””â”€ Top-5 Important Features: [0]
      â””â”€ Top-5 Values: ['75.7230']

ðŸ“Š Layer: LF_l5_FDCA.positional_att
   â”œâ”€ Features: 1
   â”œâ”€ Mean Importance: 0.0000
   â”œâ”€ Max Importance: 0.0000
   â”œâ”€ Min Importance: 0.0000
   â””â”€ Top-5 Important Features: [0]
      â””â”€ Top-5 Values: ['0.0000']

ðŸ“Š Layer: LF_l5_FDCA.slice_att.linear.0
   â”œâ”€ Features: 1
   â”œâ”€ Mean Importance: 0.0000
   â”œâ”€ Max Importance: 0.0000
   â”œâ”€ Min Importance: 0.0000
   â””â”€ Top-5 Important Features: [0]
      â””â”€ Top-5 Values: ['0.0000']

ðŸ“Š Layer: LF_l5_FDCA.slice_att.linear.1
   â”œâ”€ Features: 1
   â”œâ”€ Mean Importance: 0.0000
   â”œâ”€ Max Importance: 0.0000
   â”œâ”€ Min Importance: 0.0000
   â””â”€ Top-5 Important Features: [0]
      â””â”€ Top-5 Values: ['0.0000']

ðŸ“Š Layer: LF_l5_FDCA.slice_att.linear.2
   â”œâ”€ Features: 1
   â”œâ”€ Mean Importance: 0.0000
   â”œâ”€ Max Importance: 0.0000
   â”œâ”€ Min Importance: 0.0000
   â””â”€ Top-5 Important Features: [0]
      â””â”€ Top-5 Values: ['0.0000']

ðŸ“Š Layer: LF_l5_FDCA.slice_att.linear
   â”œâ”€ Features: 1
   â”œâ”€ Mean Importance: 0.0000
   â”œâ”€ Max Importance: 0.0000
   â”œâ”€ Min Importance: 0.0000
   â””â”€ Top-5 Important Features: [0]
      â””â”€ Top-5 Values: ['0.0000']

ðŸ“Š Layer: LF_l5_FDCA.slice_att.non_linear
   â”œâ”€ Features: 1
   â”œâ”€ Mean Importance: 0.0000
   â”œâ”€ Max Importance: 0.0000
   â”œâ”€ Min Importance: 0.0000
   â””â”€ Top-5 Important Features: [0]
      â””â”€ Top-5 Values: ['0.0000']

ðŸ“Š Layer: LF_l5_FDCA.slice_att.mean
   â”œâ”€ Features: 1
   â”œâ”€ Mean Importance: 0.0017
   â”œâ”€ Max Importance: 0.0017
   â”œâ”€ Min Importance: 0.0017
   â””â”€ Top-5 Important Features: [0]
      â””â”€ Top-5 Values: ['0.0017']

ðŸ“Š Layer: LF_l5_FDCA.slice_att.log_diag
   â”œâ”€ Features: 1
   â”œâ”€ Mean Importance: 0.0000
   â”œâ”€ Max Importance: 0.0000
   â”œâ”€ Min Importance: 0.0000
   â””â”€ Top-5 Important Features: [0]
      â””â”€ Top-5 Values: ['0.0000']

ðŸ“Š Layer: LF_l5_FDCA.slice_att.factor
   â”œâ”€ Features: 1
   â”œâ”€ Mean Importance: 0.0001
   â”œâ”€ Max Importance: 0.0001
   â”œâ”€ Min Importance: 0.0001
   â””â”€ Top-5 Important Features: [0]
      â””â”€ Top-5 Values: ['0.0001']

ðŸ“Š Layer: LF_l5_FDCA.slice_att
   â”œâ”€ Features: 1
   â”œâ”€ Mean Importance: 0.0000
   â”œâ”€ Max Importance: 0.0000
   â”œâ”€ Min Importance: 0.0000
   â””â”€ Top-5 Important Features: [0]
      â””â”€ Top-5 Values: ['0.0000']

ðŸ“Š Layer: LF_l5_FDCA
   â”œâ”€ Features: 1
   â”œâ”€ Mean Importance: 0.0000
   â”œâ”€ Max Importance: 0.0000
   â”œâ”€ Min Importance: 0.0000
   â””â”€ Top-5 Important Features: [0]
      â””â”€ Top-5 Values: ['0.0000']

ðŸ“Š Layer: HF_l4_FDCA.semantic_att
   â”œâ”€ Features: 1
   â”œâ”€ Mean Importance: 0.0829
   â”œâ”€ Max Importance: 0.0829
   â”œâ”€ Min Importance: 0.0829
   â””â”€ Top-5 Important Features: [0]
      â””â”€ Top-5 Values: ['0.0829']

ðŸ“Š Layer: HF_l4_FDCA.positional_att.conv
   â”œâ”€ Features: 1
   â”œâ”€ Mean Importance: 8.6773
   â”œâ”€ Max Importance: 8.6773
   â”œâ”€ Min Importance: 8.6773
   â””â”€ Top-5 Important Features: [0]
      â””â”€ Top-5 Values: ['8.6773']

ðŸ“Š Layer: HF_l4_FDCA.positional_att
   â”œâ”€ Features: 1
   â”œâ”€ Mean Importance: 0.0019
   â”œâ”€ Max Importance: 0.0019
   â”œâ”€ Min Importance: 0.0019
   â””â”€ Top-5 Important Features: [0]
      â””â”€ Top-5 Values: ['0.0019']

ðŸ“Š Layer: HF_l4_FDCA.slice_att.linear.0
   â”œâ”€ Features: 1
   â”œâ”€ Mean Importance: 0.0000
   â”œâ”€ Max Importance: 0.0000
   â”œâ”€ Min Importance: 0.0000
   â””â”€ Top-5 Important Features: [0]
      â””â”€ Top-5 Values: ['0.0000']

ðŸ“Š Layer: HF_l4_FDCA.slice_att.linear.1
   â”œâ”€ Features: 1
   â”œâ”€ Mean Importance: 0.0000
   â”œâ”€ Max Importance: 0.0000
   â”œâ”€ Min Importance: 0.0000
   â””â”€ Top-5 Important Features: [0]
      â””â”€ Top-5 Values: ['0.0000']

ðŸ“Š Layer: HF_l4_FDCA.slice_att.linear.2
   â”œâ”€ Features: 1
   â”œâ”€ Mean Importance: 0.0000
   â”œâ”€ Max Importance: 0.0000
   â”œâ”€ Min Importance: 0.0000
   â””â”€ Top-5 Important Features: [0]
      â””â”€ Top-5 Values: ['0.0000']

ðŸ“Š Layer: HF_l4_FDCA.slice_att.linear
   â”œâ”€ Features: 1
   â”œâ”€ Mean Importance: 0.0000
   â”œâ”€ Max Importance: 0.0000
   â”œâ”€ Min Importance: 0.0000
   â””â”€ Top-5 Important Features: [0]
      â””â”€ Top-5 Values: ['0.0000']

ðŸ“Š Layer: HF_l4_FDCA.slice_att.non_linear
   â”œâ”€ Features: 1
   â”œâ”€ Mean Importance: 0.0000
   â”œâ”€ Max Importance: 0.0000
   â”œâ”€ Min Importance: 0.0000
   â””â”€ Top-5 Important Features: [0]
      â””â”€ Top-5 Values: ['0.0000']

ðŸ“Š Layer: HF_l4_FDCA.slice_att.mean
   â”œâ”€ Features: 1
   â”œâ”€ Mean Importance: 0.0000
   â”œâ”€ Max Importance: 0.0000
   â”œâ”€ Min Importance: 0.0000
   â””â”€ Top-5 Important Features: [0]
      â””â”€ Top-5 Values: ['0.0000']

ðŸ“Š Layer: HF_l4_FDCA.slice_att.log_diag
   â”œâ”€ Features: 1
   â”œâ”€ Mean Importance: 0.0000
   â”œâ”€ Max Importance: 0.0000
   â”œâ”€ Min Importance: 0.0000
   â””â”€ Top-5 Important Features: [0]
      â””â”€ Top-5 Values: ['0.0000']

ðŸ“Š Layer: HF_l4_FDCA.slice_att.factor
   â”œâ”€ Features: 1
   â”œâ”€ Mean Importance: 0.0000
   â”œâ”€ Max Importance: 0.0000
   â”œâ”€ Min Importance: 0.0000
   â””â”€ Top-5 Important Features: [0]
      â””â”€ Top-5 Values: ['0.0000']

ðŸ“Š Layer: HF_l4_FDCA.slice_att
   â”œâ”€ Features: 1
   â”œâ”€ Mean Importance: 0.0061
   â”œâ”€ Max Importance: 0.0061
   â”œâ”€ Min Importance: 0.0061
   â””â”€ Top-5 Important Features: [0]
      â””â”€ Top-5 Values: ['0.0061']

ðŸ“Š Layer: HF_l4_FDCA
   â”œâ”€ Features: 1
   â”œâ”€ Mean Importance: 0.6844
   â”œâ”€ Max Importance: 0.6844
   â”œâ”€ Min Importance: 0.6844
   â””â”€ Top-5 Important Features: [0]
      â””â”€ Top-5 Values: ['0.6844']

ðŸ“Š Layer: HF_l5_FDCA.semantic_att
   â”œâ”€ Features: 1
   â”œâ”€ Mean Importance: 0.0663
   â”œâ”€ Max Importance: 0.0663
   â”œâ”€ Min Importance: 0.0663
   â””â”€ Top-5 Important Features: [0]
      â””â”€ Top-5 Values: ['0.0663']

ðŸ“Š Layer: HF_l5_FDCA.positional_att.conv
   â”œâ”€ Features: 1
   â”œâ”€ Mean Importance: 14.7135
   â”œâ”€ Max Importance: 14.7135
   â”œâ”€ Min Importance: 14.7135
   â””â”€ Top-5 Important Features: [0]
      â””â”€ Top-5 Values: ['14.7135']

ðŸ“Š Layer: HF_l5_FDCA.positional_att
   â”œâ”€ Features: 1
   â”œâ”€ Mean Importance: 0.0001
   â”œâ”€ Max Importance: 0.0001
   â”œâ”€ Min Importance: 0.0001
   â””â”€ Top-5 Important Features: [0]
      â””â”€ Top-5 Values: ['0.0001']

ðŸ“Š Layer: HF_l5_FDCA.slice_att.linear.0
   â”œâ”€ Features: 1
   â”œâ”€ Mean Importance: 0.0000
   â”œâ”€ Max Importance: 0.0000
   â”œâ”€ Min Importance: 0.0000
   â””â”€ Top-5 Important Features: [0]
      â””â”€ Top-5 Values: ['0.0000']

ðŸ“Š Layer: HF_l5_FDCA.slice_att.linear.1
   â”œâ”€ Features: 1
   â”œâ”€ Mean Importance: 0.0000
   â”œâ”€ Max Importance: 0.0000
   â”œâ”€ Min Importance: 0.0000
   â””â”€ Top-5 Important Features: [0]
      â””â”€ Top-5 Values: ['0.0000']

ðŸ“Š Layer: HF_l5_FDCA.slice_att.linear.2
   â”œâ”€ Features: 1
   â”œâ”€ Mean Importance: 0.0000
   â”œâ”€ Max Importance: 0.0000
   â”œâ”€ Min Importance: 0.0000
   â””â”€ Top-5 Important Features: [0]
      â””â”€ Top-5 Values: ['0.0000']

ðŸ“Š Layer: HF_l5_FDCA.slice_att.linear
   â”œâ”€ Features: 1
   â”œâ”€ Mean Importance: 0.0000
   â”œâ”€ Max Importance: 0.0000
   â”œâ”€ Min Importance: 0.0000
   â””â”€ Top-5 Important Features: [0]
      â””â”€ Top-5 Values: ['0.0000']

ðŸ“Š Layer: HF_l5_FDCA.slice_att.non_linear
   â”œâ”€ Features: 1
   â”œâ”€ Mean Importance: 0.0000
   â”œâ”€ Max Importance: 0.0000
   â”œâ”€ Min Importance: 0.0000
   â””â”€ Top-5 Important Features: [0]
      â””â”€ Top-5 Values: ['0.0000']

ðŸ“Š Layer: HF_l5_FDCA.slice_att.mean
   â”œâ”€ Features: 1
   â”œâ”€ Mean Importance: 0.0000
   â”œâ”€ Max Importance: 0.0000
   â”œâ”€ Min Importance: 0.0000
   â””â”€ Top-5 Important Features: [0]
      â””â”€ Top-5 Values: ['0.0000']

ðŸ“Š Layer: HF_l5_FDCA.slice_att.log_diag
   â”œâ”€ Features: 1
   â”œâ”€ Mean Importance: 0.0000
   â”œâ”€ Max Importance: 0.0000
   â”œâ”€ Min Importance: 0.0000
   â””â”€ Top-5 Important Features: [0]
      â””â”€ Top-5 Values: ['0.0000']

ðŸ“Š Layer: HF_l5_FDCA.slice_att.factor
   â”œâ”€ Features: 1
   â”œâ”€ Mean Importance: 0.0000
   â”œâ”€ Max Importance: 0.0000
   â”œâ”€ Min Importance: 0.0000
   â””â”€ Top-5 Important Features: [0]
      â””â”€ Top-5 Values: ['0.0000']

ðŸ“Š Layer: HF_l5_FDCA.slice_att
   â”œâ”€ Features: 1
   â”œâ”€ Mean Importance: 0.0003
   â”œâ”€ Max Importance: 0.0003
   â”œâ”€ Min Importance: 0.0003
   â””â”€ Top-5 Important Features: [0]
      â””â”€ Top-5 Values: ['0.0003']

ðŸ“Š Layer: HF_l5_FDCA
   â”œâ”€ Features: 1
   â”œâ”€ Mean Importance: 0.0005
   â”œâ”€ Max Importance: 0.0005
   â”œâ”€ Min Importance: 0.0005
   â””â”€ Top-5 Important Features: [0]
      â””â”€ Top-5 Values: ['0.0005']

======================================================================
âœ“ Mechanistic analysis complete

[3] Generating Grad-CAM...
Warning: Failed to generate CAM for class 0: element 0 of tensors does not require grad and does not have a grad_fn
Warning: Failed to generate CAM for class 1: element 0 of tensors does not require grad and does not have a grad_fn
Warning: Failed to generate CAM for class 2: element 0 of tensors does not require grad and does not have a grad_fn
Warning: Failed to generate CAM for class 3: element 0 of tensors does not require grad and does not have a grad_fn
[4] Analyzing frequency components...
âœ“ Saved: outputs/xai_2025-11-15_17-25-23/freq_component/sample_0030_freq_comp.png
âœ“ Evaluation complete for sample_0030
Evaluating:  82%|########1 | 31/38 [08:35<01:53, 16.25s/it]
[1] Getting primary prediction...

[METRICS FOR sample_0031]
==================================================
class_0: Dice=0.9928, IoU=0.9857
class_1: Dice=0.6373, IoU=0.4677
class_2: Dice=0.8917, IoU=0.8046
class_3: Dice=0.7240, IoU=0.5674
==================================================

[2] Generating attention maps...
Clipping input data to the valid range for imshow with RGB data ([0..1] for floats or [0..255] for integers).
Clipping input data to the valid range for imshow with RGB data ([0..1] for floats or [0..255] for integers).
âœ“ Saved: outputs/xai_2025-11-15_17-25-23/attention/sample_0031_attention.png

[MECHANISTIC INTERPRETABILITY ANALYSIS]
======================================================================
Sample: sample_0031
======================================================================

ðŸ“Š Layer: LF_l4_FDCA.semantic_att
   â”œâ”€ Features: 1
   â”œâ”€ Mean Importance: 0.1049
   â”œâ”€ Max Importance: 0.1049
   â”œâ”€ Min Importance: 0.1049
   â””â”€ Top-5 Important Features: [0]
      â””â”€ Top-5 Values: ['0.1049']

ðŸ“Š Layer: LF_l4_FDCA.positional_att.conv
   â”œâ”€ Features: 1
   â”œâ”€ Mean Importance: 256.6985
   â”œâ”€ Max Importance: 256.6985
   â”œâ”€ Min Importance: 256.6985
   â””â”€ Top-5 Important Features: [0]
      â””â”€ Top-5 Values: ['256.6985']

ðŸ“Š Layer: LF_l4_FDCA.positional_att
   â”œâ”€ Features: 1
   â”œâ”€ Mean Importance: 39.6910
   â”œâ”€ Max Importance: 39.6910
   â”œâ”€ Min Importance: 39.6910
   â””â”€ Top-5 Important Features: [0]
      â””â”€ Top-5 Values: ['39.6910']

ðŸ“Š Layer: LF_l4_FDCA.slice_att.linear.0
   â”œâ”€ Features: 1
   â”œâ”€ Mean Importance: 74.8703
   â”œâ”€ Max Importance: 74.8703
   â”œâ”€ Min Importance: 74.8703
   â””â”€ Top-5 Important Features: [0]
      â””â”€ Top-5 Values: ['74.8703']

ðŸ“Š Layer: LF_l4_FDCA.slice_att.linear.1
   â”œâ”€ Features: 1
   â”œâ”€ Mean Importance: 63.5089
   â”œâ”€ Max Importance: 63.5089
   â”œâ”€ Min Importance: 63.5089
   â””â”€ Top-5 Important Features: [0]
      â””â”€ Top-5 Values: ['63.5089']

ðŸ“Š Layer: LF_l4_FDCA.slice_att.linear.2
   â”œâ”€ Features: 1
   â”œâ”€ Mean Importance: 60.2771
   â”œâ”€ Max Importance: 60.2771
   â”œâ”€ Min Importance: 60.2771
   â””â”€ Top-5 Important Features: [0]
      â””â”€ Top-5 Values: ['60.2771']

ðŸ“Š Layer: LF_l4_FDCA.slice_att.linear
   â”œâ”€ Features: 1
   â”œâ”€ Mean Importance: 60.2771
   â”œâ”€ Max Importance: 60.2771
   â”œâ”€ Min Importance: 60.2771
   â””â”€ Top-5 Important Features: [0]
      â””â”€ Top-5 Values: ['60.2771']

ðŸ“Š Layer: LF_l4_FDCA.slice_att.non_linear
   â”œâ”€ Features: 1
   â”œâ”€ Mean Importance: 25240742.0000
   â”œâ”€ Max Importance: 25240742.0000
   â”œâ”€ Min Importance: 25240742.0000
   â””â”€ Top-5 Important Features: [0]
      â””â”€ Top-5 Values: ['25240742.0000']

ðŸ“Š Layer: LF_l4_FDCA.slice_att.mean
   â”œâ”€ Features: 1
   â”œâ”€ Mean Importance: 100852800.0000
   â”œâ”€ Max Importance: 100852800.0000
   â”œâ”€ Min Importance: 100852800.0000
   â””â”€ Top-5 Important Features: [0]
      â””â”€ Top-5 Values: ['100852800.0000']

ðŸ“Š Layer: LF_l4_FDCA.slice_att.log_diag
   â”œâ”€ Features: 1
   â”œâ”€ Mean Importance: 6250.6738
   â”œâ”€ Max Importance: 6250.6738
   â”œâ”€ Min Importance: 6250.6738
   â””â”€ Top-5 Important Features: [0]
      â””â”€ Top-5 Values: ['6250.6738']

ðŸ“Š Layer: LF_l4_FDCA.slice_att.factor
   â”œâ”€ Features: 1
   â”œâ”€ Mean Importance: 39064980.0000
   â”œâ”€ Max Importance: 39064980.0000
   â”œâ”€ Min Importance: 39064980.0000
   â””â”€ Top-5 Important Features: [0]
      â””â”€ Top-5 Values: ['39064980.0000']

ðŸ“Š Layer: LF_l4_FDCA.slice_att
   â”œâ”€ Features: 1
   â”œâ”€ Mean Importance: 16254598.0000
   â”œâ”€ Max Importance: 16254598.0000
   â”œâ”€ Min Importance: 16254598.0000
   â””â”€ Top-5 Important Features: [0]
      â””â”€ Top-5 Values: ['16254598.0000']

ðŸ“Š Layer: LF_l4_FDCA
   â”œâ”€ Features: 1
   â”œâ”€ Mean Importance: 2298662785967456256.0000
   â”œâ”€ Max Importance: 2298662785967456256.0000
   â”œâ”€ Min Importance: 2298662785967456256.0000
   â””â”€ Top-5 Important Features: [0]
      â””â”€ Top-5 Values: ['2298662785967456256.0000']

ðŸ“Š Layer: LF_l5_FDCA.semantic_att
   â”œâ”€ Features: 1
   â”œâ”€ Mean Importance: 0.0791
   â”œâ”€ Max Importance: 0.0791
   â”œâ”€ Min Importance: 0.0791
   â””â”€ Top-5 Important Features: [0]
      â””â”€ Top-5 Values: ['0.0791']

ðŸ“Š Layer: LF_l5_FDCA.positional_att.conv
   â”œâ”€ Features: 1
   â”œâ”€ Mean Importance: 76.7867
   â”œâ”€ Max Importance: 76.7867
   â”œâ”€ Min Importance: 76.7867
   â””â”€ Top-5 Important Features: [0]
      â””â”€ Top-5 Values: ['76.7867']

ðŸ“Š Layer: LF_l5_FDCA.positional_att
   â”œâ”€ Features: 1
   â”œâ”€ Mean Importance: 0.0000
   â”œâ”€ Max Importance: 0.0000
   â”œâ”€ Min Importance: 0.0000
   â””â”€ Top-5 Important Features: [0]
      â””â”€ Top-5 Values: ['0.0000']

ðŸ“Š Layer: LF_l5_FDCA.slice_att.linear.0
   â”œâ”€ Features: 1
   â”œâ”€ Mean Importance: 0.0000
   â”œâ”€ Max Importance: 0.0000
   â”œâ”€ Min Importance: 0.0000
   â””â”€ Top-5 Important Features: [0]
      â””â”€ Top-5 Values: ['0.0000']

ðŸ“Š Layer: LF_l5_FDCA.slice_att.linear.1
   â”œâ”€ Features: 1
   â”œâ”€ Mean Importance: 0.0000
   â”œâ”€ Max Importance: 0.0000
   â”œâ”€ Min Importance: 0.0000
   â””â”€ Top-5 Important Features: [0]
      â””â”€ Top-5 Values: ['0.0000']

ðŸ“Š Layer: LF_l5_FDCA.slice_att.linear.2
   â”œâ”€ Features: 1
   â”œâ”€ Mean Importance: 0.0000
   â”œâ”€ Max Importance: 0.0000
   â”œâ”€ Min Importance: 0.0000
   â””â”€ Top-5 Important Features: [0]
      â””â”€ Top-5 Values: ['0.0000']

ðŸ“Š Layer: LF_l5_FDCA.slice_att.linear
   â”œâ”€ Features: 1
   â”œâ”€ Mean Importance: 0.0000
   â”œâ”€ Max Importance: 0.0000
   â”œâ”€ Min Importance: 0.0000
   â””â”€ Top-5 Important Features: [0]
      â””â”€ Top-5 Values: ['0.0000']

ðŸ“Š Layer: LF_l5_FDCA.slice_att.non_linear
   â”œâ”€ Features: 1
   â”œâ”€ Mean Importance: 0.0000
   â”œâ”€ Max Importance: 0.0000
   â”œâ”€ Min Importance: 0.0000
   â””â”€ Top-5 Important Features: [0]
      â””â”€ Top-5 Values: ['0.0000']

ðŸ“Š Layer: LF_l5_FDCA.slice_att.mean
   â”œâ”€ Features: 1
   â”œâ”€ Mean Importance: 0.0017
   â”œâ”€ Max Importance: 0.0017
   â”œâ”€ Min Importance: 0.0017
   â””â”€ Top-5 Important Features: [0]
      â””â”€ Top-5 Values: ['0.0017']

ðŸ“Š Layer: LF_l5_FDCA.slice_att.log_diag
   â”œâ”€ Features: 1
   â”œâ”€ Mean Importance: 0.0000
   â”œâ”€ Max Importance: 0.0000
   â”œâ”€ Min Importance: 0.0000
   â””â”€ Top-5 Important Features: [0]
      â””â”€ Top-5 Values: ['0.0000']

ðŸ“Š Layer: LF_l5_FDCA.slice_att.factor
   â”œâ”€ Features: 1
   â”œâ”€ Mean Importance: 0.0001
   â”œâ”€ Max Importance: 0.0001
   â”œâ”€ Min Importance: 0.0001
   â””â”€ Top-5 Important Features: [0]
      â””â”€ Top-5 Values: ['0.0001']

ðŸ“Š Layer: LF_l5_FDCA.slice_att
   â”œâ”€ Features: 1
   â”œâ”€ Mean Importance: 0.0000
   â”œâ”€ Max Importance: 0.0000
   â”œâ”€ Min Importance: 0.0000
   â””â”€ Top-5 Important Features: [0]
      â””â”€ Top-5 Values: ['0.0000']

ðŸ“Š Layer: LF_l5_FDCA
   â”œâ”€ Features: 1
   â”œâ”€ Mean Importance: 0.0000
   â”œâ”€ Max Importance: 0.0000
   â”œâ”€ Min Importance: 0.0000
   â””â”€ Top-5 Important Features: [0]
      â””â”€ Top-5 Values: ['0.0000']

ðŸ“Š Layer: HF_l4_FDCA.semantic_att
   â”œâ”€ Features: 1
   â”œâ”€ Mean Importance: 0.0810
   â”œâ”€ Max Importance: 0.0810
   â”œâ”€ Min Importance: 0.0810
   â””â”€ Top-5 Important Features: [0]
      â””â”€ Top-5 Values: ['0.0810']

ðŸ“Š Layer: HF_l4_FDCA.positional_att.conv
   â”œâ”€ Features: 1
   â”œâ”€ Mean Importance: 7.8405
   â”œâ”€ Max Importance: 7.8405
   â”œâ”€ Min Importance: 7.8405
   â””â”€ Top-5 Important Features: [0]
      â””â”€ Top-5 Values: ['7.8405']

ðŸ“Š Layer: HF_l4_FDCA.positional_att
   â”œâ”€ Features: 1
   â”œâ”€ Mean Importance: 0.0019
   â”œâ”€ Max Importance: 0.0019
   â”œâ”€ Min Importance: 0.0019
   â””â”€ Top-5 Important Features: [0]
      â””â”€ Top-5 Values: ['0.0019']

ðŸ“Š Layer: HF_l4_FDCA.slice_att.linear.0
   â”œâ”€ Features: 1
   â”œâ”€ Mean Importance: 0.0000
   â”œâ”€ Max Importance: 0.0000
   â”œâ”€ Min Importance: 0.0000
   â””â”€ Top-5 Important Features: [0]
      â””â”€ Top-5 Values: ['0.0000']

ðŸ“Š Layer: HF_l4_FDCA.slice_att.linear.1
   â”œâ”€ Features: 1
   â”œâ”€ Mean Importance: 0.0000
   â”œâ”€ Max Importance: 0.0000
   â”œâ”€ Min Importance: 0.0000
   â””â”€ Top-5 Important Features: [0]
      â””â”€ Top-5 Values: ['0.0000']

ðŸ“Š Layer: HF_l4_FDCA.slice_att.linear.2
   â”œâ”€ Features: 1
   â”œâ”€ Mean Importance: 0.0000
   â”œâ”€ Max Importance: 0.0000
   â”œâ”€ Min Importance: 0.0000
   â””â”€ Top-5 Important Features: [0]
      â””â”€ Top-5 Values: ['0.0000']

ðŸ“Š Layer: HF_l4_FDCA.slice_att.linear
   â”œâ”€ Features: 1
   â”œâ”€ Mean Importance: 0.0000
   â”œâ”€ Max Importance: 0.0000
   â”œâ”€ Min Importance: 0.0000
   â””â”€ Top-5 Important Features: [0]
      â””â”€ Top-5 Values: ['0.0000']

ðŸ“Š Layer: HF_l4_FDCA.slice_att.non_linear
   â”œâ”€ Features: 1
   â”œâ”€ Mean Importance: 0.0000
   â”œâ”€ Max Importance: 0.0000
   â”œâ”€ Min Importance: 0.0000
   â””â”€ Top-5 Important Features: [0]
      â””â”€ Top-5 Values: ['0.0000']

ðŸ“Š Layer: HF_l4_FDCA.slice_att.mean
   â”œâ”€ Features: 1
   â”œâ”€ Mean Importance: 0.0000
   â”œâ”€ Max Importance: 0.0000
   â”œâ”€ Min Importance: 0.0000
   â””â”€ Top-5 Important Features: [0]
      â””â”€ Top-5 Values: ['0.0000']

ðŸ“Š Layer: HF_l4_FDCA.slice_att.log_diag
   â”œâ”€ Features: 1
   â”œâ”€ Mean Importance: 0.0000
   â”œâ”€ Max Importance: 0.0000
   â”œâ”€ Min Importance: 0.0000
   â””â”€ Top-5 Important Features: [0]
      â””â”€ Top-5 Values: ['0.0000']

ðŸ“Š Layer: HF_l4_FDCA.slice_att.factor
   â”œâ”€ Features: 1
   â”œâ”€ Mean Importance: 0.0000
   â”œâ”€ Max Importance: 0.0000
   â”œâ”€ Min Importance: 0.0000
   â””â”€ Top-5 Important Features: [0]
      â””â”€ Top-5 Values: ['0.0000']

ðŸ“Š Layer: HF_l4_FDCA.slice_att
   â”œâ”€ Features: 1
   â”œâ”€ Mean Importance: 0.0045
   â”œâ”€ Max Importance: 0.0045
   â”œâ”€ Min Importance: 0.0045
   â””â”€ Top-5 Important Features: [0]
      â””â”€ Top-5 Values: ['0.0045']

ðŸ“Š Layer: HF_l4_FDCA
   â”œâ”€ Features: 1
   â”œâ”€ Mean Importance: 0.6467
   â”œâ”€ Max Importance: 0.6467
   â”œâ”€ Min Importance: 0.6467
   â””â”€ Top-5 Important Features: [0]
      â””â”€ Top-5 Values: ['0.6467']

ðŸ“Š Layer: HF_l5_FDCA.semantic_att
   â”œâ”€ Features: 1
   â”œâ”€ Mean Importance: 0.0640
   â”œâ”€ Max Importance: 0.0640
   â”œâ”€ Min Importance: 0.0640
   â””â”€ Top-5 Important Features: [0]
      â””â”€ Top-5 Values: ['0.0640']

ðŸ“Š Layer: HF_l5_FDCA.positional_att.conv
   â”œâ”€ Features: 1
   â”œâ”€ Mean Importance: 12.7677
   â”œâ”€ Max Importance: 12.7677
   â”œâ”€ Min Importance: 12.7677
   â””â”€ Top-5 Important Features: [0]
      â””â”€ Top-5 Values: ['12.7677']

ðŸ“Š Layer: HF_l5_FDCA.positional_att
   â”œâ”€ Features: 1
   â”œâ”€ Mean Importance: 0.0001
   â”œâ”€ Max Importance: 0.0001
   â”œâ”€ Min Importance: 0.0001
   â””â”€ Top-5 Important Features: [0]
      â””â”€ Top-5 Values: ['0.0001']

ðŸ“Š Layer: HF_l5_FDCA.slice_att.linear.0
   â”œâ”€ Features: 1
   â”œâ”€ Mean Importance: 0.0000
   â”œâ”€ Max Importance: 0.0000
   â”œâ”€ Min Importance: 0.0000
   â””â”€ Top-5 Important Features: [0]
      â””â”€ Top-5 Values: ['0.0000']

ðŸ“Š Layer: HF_l5_FDCA.slice_att.linear.1
   â”œâ”€ Features: 1
   â”œâ”€ Mean Importance: 0.0000
   â”œâ”€ Max Importance: 0.0000
   â”œâ”€ Min Importance: 0.0000
   â””â”€ Top-5 Important Features: [0]
      â””â”€ Top-5 Values: ['0.0000']

ðŸ“Š Layer: HF_l5_FDCA.slice_att.linear.2
   â”œâ”€ Features: 1
   â”œâ”€ Mean Importance: 0.0000
   â”œâ”€ Max Importance: 0.0000
   â”œâ”€ Min Importance: 0.0000
   â””â”€ Top-5 Important Features: [0]
      â””â”€ Top-5 Values: ['0.0000']

ðŸ“Š Layer: HF_l5_FDCA.slice_att.linear
   â”œâ”€ Features: 1
   â”œâ”€ Mean Importance: 0.0000
   â”œâ”€ Max Importance: 0.0000
   â”œâ”€ Min Importance: 0.0000
   â””â”€ Top-5 Important Features: [0]
      â””â”€ Top-5 Values: ['0.0000']

ðŸ“Š Layer: HF_l5_FDCA.slice_att.non_linear
   â”œâ”€ Features: 1
   â”œâ”€ Mean Importance: 0.0000
   â”œâ”€ Max Importance: 0.0000
   â”œâ”€ Min Importance: 0.0000
   â””â”€ Top-5 Important Features: [0]
      â””â”€ Top-5 Values: ['0.0000']

ðŸ“Š Layer: HF_l5_FDCA.slice_att.mean
   â”œâ”€ Features: 1
   â”œâ”€ Mean Importance: 0.0000
   â”œâ”€ Max Importance: 0.0000
   â”œâ”€ Min Importance: 0.0000
   â””â”€ Top-5 Important Features: [0]
      â””â”€ Top-5 Values: ['0.0000']

ðŸ“Š Layer: HF_l5_FDCA.slice_att.log_diag
   â”œâ”€ Features: 1
   â”œâ”€ Mean Importance: 0.0000
   â”œâ”€ Max Importance: 0.0000
   â”œâ”€ Min Importance: 0.0000
   â””â”€ Top-5 Important Features: [0]
      â””â”€ Top-5 Values: ['0.0000']

ðŸ“Š Layer: HF_l5_FDCA.slice_att.factor
   â”œâ”€ Features: 1
   â”œâ”€ Mean Importance: 0.0000
   â”œâ”€ Max Importance: 0.0000
   â”œâ”€ Min Importance: 0.0000
   â””â”€ Top-5 Important Features: [0]
      â””â”€ Top-5 Values: ['0.0000']

ðŸ“Š Layer: HF_l5_FDCA.slice_att
   â”œâ”€ Features: 1
   â”œâ”€ Mean Importance: 0.0001
   â”œâ”€ Max Importance: 0.0001
   â”œâ”€ Min Importance: 0.0001
   â””â”€ Top-5 Important Features: [0]
      â””â”€ Top-5 Values: ['0.0001']

ðŸ“Š Layer: HF_l5_FDCA
   â”œâ”€ Features: 1
   â”œâ”€ Mean Importance: 0.0002
   â”œâ”€ Max Importance: 0.0002
   â”œâ”€ Min Importance: 0.0002
   â””â”€ Top-5 Important Features: [0]
      â””â”€ Top-5 Values: ['0.0002']

======================================================================
âœ“ Mechanistic analysis complete

[3] Generating Grad-CAM...
Warning: Failed to generate CAM for class 0: element 0 of tensors does not require grad and does not have a grad_fn
Warning: Failed to generate CAM for class 1: element 0 of tensors does not require grad and does not have a grad_fn
Warning: Failed to generate CAM for class 2: element 0 of tensors does not require grad and does not have a grad_fn
Warning: Failed to generate CAM for class 3: element 0 of tensors does not require grad and does not have a grad_fn
[4] Analyzing frequency components...
âœ“ Saved: outputs/xai_2025-11-15_17-25-23/freq_component/sample_0031_freq_comp.png
âœ“ Evaluation complete for sample_0031
Evaluating:  84%|########4 | 32/38 [08:50<01:36, 16.00s/it]
[1] Getting primary prediction...

[METRICS FOR sample_0032]
==================================================
class_0: Dice=0.9967, IoU=0.9934
class_1: Dice=0.8930, IoU=0.8067
class_2: Dice=0.8403, IoU=0.7245
class_3: Dice=0.8166, IoU=0.6901
==================================================

[2] Generating attention maps...
Clipping input data to the valid range for imshow with RGB data ([0..1] for floats or [0..255] for integers).
Clipping input data to the valid range for imshow with RGB data ([0..1] for floats or [0..255] for integers).
âœ“ Saved: outputs/xai_2025-11-15_17-25-23/attention/sample_0032_attention.png

[MECHANISTIC INTERPRETABILITY ANALYSIS]
======================================================================
Sample: sample_0032
======================================================================

ðŸ“Š Layer: LF_l4_FDCA.semantic_att
   â”œâ”€ Features: 1
   â”œâ”€ Mean Importance: 0.1094
   â”œâ”€ Max Importance: 0.1094
   â”œâ”€ Min Importance: 0.1094
   â””â”€ Top-5 Important Features: [0]
      â””â”€ Top-5 Values: ['0.1094']

ðŸ“Š Layer: LF_l4_FDCA.positional_att.conv
   â”œâ”€ Features: 1
   â”œâ”€ Mean Importance: 242.5391
   â”œâ”€ Max Importance: 242.5391
   â”œâ”€ Min Importance: 242.5391
   â””â”€ Top-5 Important Features: [0]
      â””â”€ Top-5 Values: ['242.5391']

ðŸ“Š Layer: LF_l4_FDCA.positional_att
   â”œâ”€ Features: 1
   â”œâ”€ Mean Importance: 39.2613
   â”œâ”€ Max Importance: 39.2613
   â”œâ”€ Min Importance: 39.2613
   â””â”€ Top-5 Important Features: [0]
      â””â”€ Top-5 Values: ['39.2613']

ðŸ“Š Layer: LF_l4_FDCA.slice_att.linear.0
   â”œâ”€ Features: 1
   â”œâ”€ Mean Importance: 76.8814
   â”œâ”€ Max Importance: 76.8814
   â”œâ”€ Min Importance: 76.8814
   â””â”€ Top-5 Important Features: [0]
      â””â”€ Top-5 Values: ['76.8814']

ðŸ“Š Layer: LF_l4_FDCA.slice_att.linear.1
   â”œâ”€ Features: 1
   â”œâ”€ Mean Importance: 65.2140
   â”œâ”€ Max Importance: 65.2140
   â”œâ”€ Min Importance: 65.2140
   â””â”€ Top-5 Important Features: [0]
      â””â”€ Top-5 Values: ['65.2140']

ðŸ“Š Layer: LF_l4_FDCA.slice_att.linear.2
   â”œâ”€ Features: 1
   â”œâ”€ Mean Importance: 61.8971
   â”œâ”€ Max Importance: 61.8971
   â”œâ”€ Min Importance: 61.8971
   â””â”€ Top-5 Important Features: [0]
      â””â”€ Top-5 Values: ['61.8971']

ðŸ“Š Layer: LF_l4_FDCA.slice_att.linear
   â”œâ”€ Features: 1
   â”œâ”€ Mean Importance: 61.8971
   â”œâ”€ Max Importance: 61.8971
   â”œâ”€ Min Importance: 61.8971
   â””â”€ Top-5 Important Features: [0]
      â””â”€ Top-5 Values: ['61.8971']

ðŸ“Š Layer: LF_l4_FDCA.slice_att.non_linear
   â”œâ”€ Features: 1
   â”œâ”€ Mean Importance: 25633240.0000
   â”œâ”€ Max Importance: 25633240.0000
   â”œâ”€ Min Importance: 25633240.0000
   â””â”€ Top-5 Important Features: [0]
      â””â”€ Top-5 Values: ['25633240.0000']

ðŸ“Š Layer: LF_l4_FDCA.slice_att.mean
   â”œâ”€ Features: 1
   â”œâ”€ Mean Importance: 102425800.0000
   â”œâ”€ Max Importance: 102425800.0000
   â”œâ”€ Min Importance: 102425800.0000
   â””â”€ Top-5 Important Features: [0]
      â””â”€ Top-5 Values: ['102425800.0000']

ðŸ“Š Layer: LF_l4_FDCA.slice_att.log_diag
   â”œâ”€ Features: 1
   â”œâ”€ Mean Importance: 6348.1216
   â”œâ”€ Max Importance: 6348.1216
   â”œâ”€ Min Importance: 6348.1216
   â””â”€ Top-5 Important Features: [0]
      â””â”€ Top-5 Values: ['6348.1216']

ðŸ“Š Layer: LF_l4_FDCA.slice_att.factor
   â”œâ”€ Features: 1
   â”œâ”€ Mean Importance: 39674336.0000
   â”œâ”€ Max Importance: 39674336.0000
   â”œâ”€ Min Importance: 39674336.0000
   â””â”€ Top-5 Important Features: [0]
      â””â”€ Top-5 Values: ['39674336.0000']

ðŸ“Š Layer: LF_l4_FDCA.slice_att
   â”œâ”€ Features: 1
   â”œâ”€ Mean Importance: 16562119.0000
   â”œâ”€ Max Importance: 16562119.0000
   â”œâ”€ Min Importance: 16562119.0000
   â””â”€ Top-5 Important Features: [0]
      â””â”€ Top-5 Values: ['16562119.0000']

ðŸ“Š Layer: LF_l4_FDCA
   â”œâ”€ Features: 1
   â”œâ”€ Mean Importance: 2406063219207569408.0000
   â”œâ”€ Max Importance: 2406063219207569408.0000
   â”œâ”€ Min Importance: 2406063219207569408.0000
   â””â”€ Top-5 Important Features: [0]
      â””â”€ Top-5 Values: ['2406063219207569408.0000']

ðŸ“Š Layer: LF_l5_FDCA.semantic_att
   â”œâ”€ Features: 1
   â”œâ”€ Mean Importance: 0.0828
   â”œâ”€ Max Importance: 0.0828
   â”œâ”€ Min Importance: 0.0828
   â””â”€ Top-5 Important Features: [0]
      â””â”€ Top-5 Values: ['0.0828']

ðŸ“Š Layer: LF_l5_FDCA.positional_att.conv
   â”œâ”€ Features: 1
   â”œâ”€ Mean Importance: 77.7950
   â”œâ”€ Max Importance: 77.7950
   â”œâ”€ Min Importance: 77.7950
   â””â”€ Top-5 Important Features: [0]
      â””â”€ Top-5 Values: ['77.7950']

ðŸ“Š Layer: LF_l5_FDCA.positional_att
   â”œâ”€ Features: 1
   â”œâ”€ Mean Importance: 0.0000
   â”œâ”€ Max Importance: 0.0000
   â”œâ”€ Min Importance: 0.0000
   â””â”€ Top-5 Important Features: [0]
      â””â”€ Top-5 Values: ['0.0000']

ðŸ“Š Layer: LF_l5_FDCA.slice_att.linear.0
   â”œâ”€ Features: 1
   â”œâ”€ Mean Importance: 0.0000
   â”œâ”€ Max Importance: 0.0000
   â”œâ”€ Min Importance: 0.0000
   â””â”€ Top-5 Important Features: [0]
      â””â”€ Top-5 Values: ['0.0000']

ðŸ“Š Layer: LF_l5_FDCA.slice_att.linear.1
   â”œâ”€ Features: 1
   â”œâ”€ Mean Importance: 0.0000
   â”œâ”€ Max Importance: 0.0000
   â”œâ”€ Min Importance: 0.0000
   â””â”€ Top-5 Important Features: [0]
      â””â”€ Top-5 Values: ['0.0000']

ðŸ“Š Layer: LF_l5_FDCA.slice_att.linear.2
   â”œâ”€ Features: 1
   â”œâ”€ Mean Importance: 0.0000
   â”œâ”€ Max Importance: 0.0000
   â”œâ”€ Min Importance: 0.0000
   â””â”€ Top-5 Important Features: [0]
      â””â”€ Top-5 Values: ['0.0000']

ðŸ“Š Layer: LF_l5_FDCA.slice_att.linear
   â”œâ”€ Features: 1
   â”œâ”€ Mean Importance: 0.0000
   â”œâ”€ Max Importance: 0.0000
   â”œâ”€ Min Importance: 0.0000
   â””â”€ Top-5 Important Features: [0]
      â””â”€ Top-5 Values: ['0.0000']

ðŸ“Š Layer: LF_l5_FDCA.slice_att.non_linear
   â”œâ”€ Features: 1
   â”œâ”€ Mean Importance: 0.0000
   â”œâ”€ Max Importance: 0.0000
   â”œâ”€ Min Importance: 0.0000
   â””â”€ Top-5 Important Features: [0]
      â””â”€ Top-5 Values: ['0.0000']

ðŸ“Š Layer: LF_l5_FDCA.slice_att.mean
   â”œâ”€ Features: 1
   â”œâ”€ Mean Importance: 0.0017
   â”œâ”€ Max Importance: 0.0017
   â”œâ”€ Min Importance: 0.0017
   â””â”€ Top-5 Important Features: [0]
      â””â”€ Top-5 Values: ['0.0017']

ðŸ“Š Layer: LF_l5_FDCA.slice_att.log_diag
   â”œâ”€ Features: 1
   â”œâ”€ Mean Importance: 0.0000
   â”œâ”€ Max Importance: 0.0000
   â”œâ”€ Min Importance: 0.0000
   â””â”€ Top-5 Important Features: [0]
      â””â”€ Top-5 Values: ['0.0000']

ðŸ“Š Layer: LF_l5_FDCA.slice_att.factor
   â”œâ”€ Features: 1
   â”œâ”€ Mean Importance: 0.0001
   â”œâ”€ Max Importance: 0.0001
   â”œâ”€ Min Importance: 0.0001
   â””â”€ Top-5 Important Features: [0]
      â””â”€ Top-5 Values: ['0.0001']

ðŸ“Š Layer: LF_l5_FDCA.slice_att
   â”œâ”€ Features: 1
   â”œâ”€ Mean Importance: 0.0000
   â”œâ”€ Max Importance: 0.0000
   â”œâ”€ Min Importance: 0.0000
   â””â”€ Top-5 Important Features: [0]
      â””â”€ Top-5 Values: ['0.0000']

ðŸ“Š Layer: LF_l5_FDCA
   â”œâ”€ Features: 1
   â”œâ”€ Mean Importance: 0.0000
   â”œâ”€ Max Importance: 0.0000
   â”œâ”€ Min Importance: 0.0000
   â””â”€ Top-5 Important Features: [0]
      â””â”€ Top-5 Values: ['0.0000']

ðŸ“Š Layer: HF_l4_FDCA.semantic_att
   â”œâ”€ Features: 1
   â”œâ”€ Mean Importance: 0.0829
   â”œâ”€ Max Importance: 0.0829
   â”œâ”€ Min Importance: 0.0829
   â””â”€ Top-5 Important Features: [0]
      â””â”€ Top-5 Values: ['0.0829']

ðŸ“Š Layer: HF_l4_FDCA.positional_att.conv
   â”œâ”€ Features: 1
   â”œâ”€ Mean Importance: 9.7048
   â”œâ”€ Max Importance: 9.7048
   â”œâ”€ Min Importance: 9.7048
   â””â”€ Top-5 Important Features: [0]
      â””â”€ Top-5 Values: ['9.7048']

ðŸ“Š Layer: HF_l4_FDCA.positional_att
   â”œâ”€ Features: 1
   â”œâ”€ Mean Importance: 0.0017
   â”œâ”€ Max Importance: 0.0017
   â”œâ”€ Min Importance: 0.0017
   â””â”€ Top-5 Important Features: [0]
      â””â”€ Top-5 Values: ['0.0017']

ðŸ“Š Layer: HF_l4_FDCA.slice_att.linear.0
   â”œâ”€ Features: 1
   â”œâ”€ Mean Importance: 0.0000
   â”œâ”€ Max Importance: 0.0000
   â”œâ”€ Min Importance: 0.0000
   â””â”€ Top-5 Important Features: [0]
      â””â”€ Top-5 Values: ['0.0000']

ðŸ“Š Layer: HF_l4_FDCA.slice_att.linear.1
   â”œâ”€ Features: 1
   â”œâ”€ Mean Importance: 0.0000
   â”œâ”€ Max Importance: 0.0000
   â”œâ”€ Min Importance: 0.0000
   â””â”€ Top-5 Important Features: [0]
      â””â”€ Top-5 Values: ['0.0000']

ðŸ“Š Layer: HF_l4_FDCA.slice_att.linear.2
   â”œâ”€ Features: 1
   â”œâ”€ Mean Importance: 0.0000
   â”œâ”€ Max Importance: 0.0000
   â”œâ”€ Min Importance: 0.0000
   â””â”€ Top-5 Important Features: [0]
      â””â”€ Top-5 Values: ['0.0000']

ðŸ“Š Layer: HF_l4_FDCA.slice_att.linear
   â”œâ”€ Features: 1
   â”œâ”€ Mean Importance: 0.0000
   â”œâ”€ Max Importance: 0.0000
   â”œâ”€ Min Importance: 0.0000
   â””â”€ Top-5 Important Features: [0]
      â””â”€ Top-5 Values: ['0.0000']

ðŸ“Š Layer: HF_l4_FDCA.slice_att.non_linear
   â”œâ”€ Features: 1
   â”œâ”€ Mean Importance: 0.0000
   â”œâ”€ Max Importance: 0.0000
   â”œâ”€ Min Importance: 0.0000
   â””â”€ Top-5 Important Features: [0]
      â””â”€ Top-5 Values: ['0.0000']

ðŸ“Š Layer: HF_l4_FDCA.slice_att.mean
   â”œâ”€ Features: 1
   â”œâ”€ Mean Importance: 0.0000
   â”œâ”€ Max Importance: 0.0000
   â”œâ”€ Min Importance: 0.0000
   â””â”€ Top-5 Important Features: [0]
      â””â”€ Top-5 Values: ['0.0000']

ðŸ“Š Layer: HF_l4_FDCA.slice_att.log_diag
   â”œâ”€ Features: 1
   â”œâ”€ Mean Importance: 0.0000
   â”œâ”€ Max Importance: 0.0000
   â”œâ”€ Min Importance: 0.0000
   â””â”€ Top-5 Important Features: [0]
      â””â”€ Top-5 Values: ['0.0000']

ðŸ“Š Layer: HF_l4_FDCA.slice_att.factor
   â”œâ”€ Features: 1
   â”œâ”€ Mean Importance: 0.0000
   â”œâ”€ Max Importance: 0.0000
   â”œâ”€ Min Importance: 0.0000
   â””â”€ Top-5 Important Features: [0]
      â””â”€ Top-5 Values: ['0.0000']

ðŸ“Š Layer: HF_l4_FDCA.slice_att
   â”œâ”€ Features: 1
   â”œâ”€ Mean Importance: 0.0057
   â”œâ”€ Max Importance: 0.0057
   â”œâ”€ Min Importance: 0.0057
   â””â”€ Top-5 Important Features: [0]
      â””â”€ Top-5 Values: ['0.0057']

ðŸ“Š Layer: HF_l4_FDCA
   â”œâ”€ Features: 1
   â”œâ”€ Mean Importance: 0.5031
   â”œâ”€ Max Importance: 0.5031
   â”œâ”€ Min Importance: 0.5031
   â””â”€ Top-5 Important Features: [0]
      â””â”€ Top-5 Values: ['0.5031']

ðŸ“Š Layer: HF_l5_FDCA.semantic_att
   â”œâ”€ Features: 1
   â”œâ”€ Mean Importance: 0.0647
   â”œâ”€ Max Importance: 0.0647
   â”œâ”€ Min Importance: 0.0647
   â””â”€ Top-5 Important Features: [0]
      â””â”€ Top-5 Values: ['0.0647']

ðŸ“Š Layer: HF_l5_FDCA.positional_att.conv
   â”œâ”€ Features: 1
   â”œâ”€ Mean Importance: 13.8232
   â”œâ”€ Max Importance: 13.8232
   â”œâ”€ Min Importance: 13.8232
   â””â”€ Top-5 Important Features: [0]
      â””â”€ Top-5 Values: ['13.8232']

ðŸ“Š Layer: HF_l5_FDCA.positional_att
   â”œâ”€ Features: 1
   â”œâ”€ Mean Importance: 0.0001
   â”œâ”€ Max Importance: 0.0001
   â”œâ”€ Min Importance: 0.0001
   â””â”€ Top-5 Important Features: [0]
      â””â”€ Top-5 Values: ['0.0001']

ðŸ“Š Layer: HF_l5_FDCA.slice_att.linear.0
   â”œâ”€ Features: 1
   â”œâ”€ Mean Importance: 0.0000
   â”œâ”€ Max Importance: 0.0000
   â”œâ”€ Min Importance: 0.0000
   â””â”€ Top-5 Important Features: [0]
      â””â”€ Top-5 Values: ['0.0000']

ðŸ“Š Layer: HF_l5_FDCA.slice_att.linear.1
   â”œâ”€ Features: 1
   â”œâ”€ Mean Importance: 0.0000
   â”œâ”€ Max Importance: 0.0000
   â”œâ”€ Min Importance: 0.0000
   â””â”€ Top-5 Important Features: [0]
      â””â”€ Top-5 Values: ['0.0000']

ðŸ“Š Layer: HF_l5_FDCA.slice_att.linear.2
   â”œâ”€ Features: 1
   â”œâ”€ Mean Importance: 0.0000
   â”œâ”€ Max Importance: 0.0000
   â”œâ”€ Min Importance: 0.0000
   â””â”€ Top-5 Important Features: [0]
      â””â”€ Top-5 Values: ['0.0000']

ðŸ“Š Layer: HF_l5_FDCA.slice_att.linear
   â”œâ”€ Features: 1
   â”œâ”€ Mean Importance: 0.0000
   â”œâ”€ Max Importance: 0.0000
   â”œâ”€ Min Importance: 0.0000
   â””â”€ Top-5 Important Features: [0]
      â””â”€ Top-5 Values: ['0.0000']

ðŸ“Š Layer: HF_l5_FDCA.slice_att.non_linear
   â”œâ”€ Features: 1
   â”œâ”€ Mean Importance: 0.0000
   â”œâ”€ Max Importance: 0.0000
   â”œâ”€ Min Importance: 0.0000
   â””â”€ Top-5 Important Features: [0]
      â””â”€ Top-5 Values: ['0.0000']

ðŸ“Š Layer: HF_l5_FDCA.slice_att.mean
   â”œâ”€ Features: 1
   â”œâ”€ Mean Importance: 0.0000
   â”œâ”€ Max Importance: 0.0000
   â”œâ”€ Min Importance: 0.0000
   â””â”€ Top-5 Important Features: [0]
      â””â”€ Top-5 Values: ['0.0000']

ðŸ“Š Layer: HF_l5_FDCA.slice_att.log_diag
   â”œâ”€ Features: 1
   â”œâ”€ Mean Importance: 0.0000
   â”œâ”€ Max Importance: 0.0000
   â”œâ”€ Min Importance: 0.0000
   â””â”€ Top-5 Important Features: [0]
      â””â”€ Top-5 Values: ['0.0000']

ðŸ“Š Layer: HF_l5_FDCA.slice_att.factor
   â”œâ”€ Features: 1
   â”œâ”€ Mean Importance: 0.0000
   â”œâ”€ Max Importance: 0.0000
   â”œâ”€ Min Importance: 0.0000
   â””â”€ Top-5 Important Features: [0]
      â””â”€ Top-5 Values: ['0.0000']

ðŸ“Š Layer: HF_l5_FDCA.slice_att
   â”œâ”€ Features: 1
   â”œâ”€ Mean Importance: 0.0005
   â”œâ”€ Max Importance: 0.0005
   â”œâ”€ Min Importance: 0.0005
   â””â”€ Top-5 Important Features: [0]
      â””â”€ Top-5 Values: ['0.0005']

ðŸ“Š Layer: HF_l5_FDCA
   â”œâ”€ Features: 1
   â”œâ”€ Mean Importance: 0.0013
   â”œâ”€ Max Importance: 0.0013
   â”œâ”€ Min Importance: 0.0013
   â””â”€ Top-5 Important Features: [0]
      â””â”€ Top-5 Values: ['0.0013']

======================================================================
âœ“ Mechanistic analysis complete

[3] Generating Grad-CAM...
Warning: Failed to generate CAM for class 0: element 0 of tensors does not require grad and does not have a grad_fn
Warning: Failed to generate CAM for class 1: element 0 of tensors does not require grad and does not have a grad_fn
Warning: Failed to generate CAM for class 2: element 0 of tensors does not require grad and does not have a grad_fn
Warning: Failed to generate CAM for class 3: element 0 of tensors does not require grad and does not have a grad_fn
[4] Analyzing frequency components...
âœ“ Saved: outputs/xai_2025-11-15_17-25-23/freq_component/sample_0032_freq_comp.png
âœ“ Evaluation complete for sample_0032
Evaluating:  87%|########6 | 33/38 [09:06<01:19, 15.87s/it]
[1] Getting primary prediction...

[METRICS FOR sample_0033]
==================================================
class_0: Dice=0.9946, IoU=0.9893
class_1: Dice=0.3553, IoU=0.2160
class_2: Dice=0.7148, IoU=0.5562
class_3: Dice=0.6570, IoU=0.4892
==================================================

[2] Generating attention maps...
Clipping input data to the valid range for imshow with RGB data ([0..1] for floats or [0..255] for integers).
Clipping input data to the valid range for imshow with RGB data ([0..1] for floats or [0..255] for integers).
âœ“ Saved: outputs/xai_2025-11-15_17-25-23/attention/sample_0033_attention.png

[MECHANISTIC INTERPRETABILITY ANALYSIS]
======================================================================
Sample: sample_0033
======================================================================

ðŸ“Š Layer: LF_l4_FDCA.semantic_att
   â”œâ”€ Features: 1
   â”œâ”€ Mean Importance: 0.1330
   â”œâ”€ Max Importance: 0.1330
   â”œâ”€ Min Importance: 0.1330
   â””â”€ Top-5 Important Features: [0]
      â””â”€ Top-5 Values: ['0.1330']

ðŸ“Š Layer: LF_l4_FDCA.positional_att.conv
   â”œâ”€ Features: 1
   â”œâ”€ Mean Importance: 286.6065
   â”œâ”€ Max Importance: 286.6065
   â”œâ”€ Min Importance: 286.6065
   â””â”€ Top-5 Important Features: [0]
      â””â”€ Top-5 Values: ['286.6065']

ðŸ“Š Layer: LF_l4_FDCA.positional_att
   â”œâ”€ Features: 1
   â”œâ”€ Mean Importance: 53.3753
   â”œâ”€ Max Importance: 53.3753
   â”œâ”€ Min Importance: 53.3753
   â””â”€ Top-5 Important Features: [0]
      â””â”€ Top-5 Values: ['53.3753']

ðŸ“Š Layer: LF_l4_FDCA.slice_att.linear.0
   â”œâ”€ Features: 1
   â”œâ”€ Mean Importance: 94.0087
   â”œâ”€ Max Importance: 94.0087
   â”œâ”€ Min Importance: 94.0087
   â””â”€ Top-5 Important Features: [0]
      â””â”€ Top-5 Values: ['94.0087']

ðŸ“Š Layer: LF_l4_FDCA.slice_att.linear.1
   â”œâ”€ Features: 1
   â”œâ”€ Mean Importance: 79.7521
   â”œâ”€ Max Importance: 79.7521
   â”œâ”€ Min Importance: 79.7521
   â””â”€ Top-5 Important Features: [0]
      â””â”€ Top-5 Values: ['79.7521']

ðŸ“Š Layer: LF_l4_FDCA.slice_att.linear.2
   â”œâ”€ Features: 1
   â”œâ”€ Mean Importance: 75.6703
   â”œâ”€ Max Importance: 75.6703
   â”œâ”€ Min Importance: 75.6703
   â””â”€ Top-5 Important Features: [0]
      â””â”€ Top-5 Values: ['75.6703']

ðŸ“Š Layer: LF_l4_FDCA.slice_att.linear
   â”œâ”€ Features: 1
   â”œâ”€ Mean Importance: 75.6703
   â”œâ”€ Max Importance: 75.6703
   â”œâ”€ Min Importance: 75.6703
   â””â”€ Top-5 Important Features: [0]
      â””â”€ Top-5 Values: ['75.6703']

ðŸ“Š Layer: LF_l4_FDCA.slice_att.non_linear
   â”œâ”€ Features: 1
   â”œâ”€ Mean Importance: 30740474.0000
   â”œâ”€ Max Importance: 30740474.0000
   â”œâ”€ Min Importance: 30740474.0000
   â””â”€ Top-5 Important Features: [0]
      â””â”€ Top-5 Values: ['30740474.0000']

ðŸ“Š Layer: LF_l4_FDCA.slice_att.mean
   â”œâ”€ Features: 1
   â”œâ”€ Mean Importance: 122821872.0000
   â”œâ”€ Max Importance: 122821872.0000
   â”œâ”€ Min Importance: 122821872.0000
   â””â”€ Top-5 Important Features: [0]
      â””â”€ Top-5 Values: ['122821872.0000']

ðŸ“Š Layer: LF_l4_FDCA.slice_att.log_diag
   â”œâ”€ Features: 1
   â”œâ”€ Mean Importance: 7612.3281
   â”œâ”€ Max Importance: 7612.3281
   â”œâ”€ Min Importance: 7612.3281
   â””â”€ Top-5 Important Features: [0]
      â””â”€ Top-5 Values: ['7612.3281']

ðŸ“Š Layer: LF_l4_FDCA.slice_att.factor
   â”œâ”€ Features: 1
   â”œâ”€ Mean Importance: 47574564.0000
   â”œâ”€ Max Importance: 47574564.0000
   â”œâ”€ Min Importance: 47574564.0000
   â””â”€ Top-5 Important Features: [0]
      â””â”€ Top-5 Values: ['47574564.0000']

ðŸ“Š Layer: LF_l4_FDCA.slice_att
   â”œâ”€ Features: 1
   â”œâ”€ Mean Importance: 20999490.0000
   â”œâ”€ Max Importance: 20999490.0000
   â”œâ”€ Min Importance: 20999490.0000
   â””â”€ Top-5 Important Features: [0]
      â””â”€ Top-5 Values: ['20999490.0000']

ðŸ“Š Layer: LF_l4_FDCA
   â”œâ”€ Features: 1
   â”œâ”€ Mean Importance: 3667189587249201152.0000
   â”œâ”€ Max Importance: 3667189587249201152.0000
   â”œâ”€ Min Importance: 3667189587249201152.0000
   â””â”€ Top-5 Important Features: [0]
      â””â”€ Top-5 Values: ['3667189587249201152.0000']

ðŸ“Š Layer: LF_l5_FDCA.semantic_att
   â”œâ”€ Features: 1
   â”œâ”€ Mean Importance: 0.0857
   â”œâ”€ Max Importance: 0.0857
   â”œâ”€ Min Importance: 0.0857
   â””â”€ Top-5 Important Features: [0]
      â””â”€ Top-5 Values: ['0.0857']

ðŸ“Š Layer: LF_l5_FDCA.positional_att.conv
   â”œâ”€ Features: 1
   â”œâ”€ Mean Importance: 71.2837
   â”œâ”€ Max Importance: 71.2837
   â”œâ”€ Min Importance: 71.2837
   â””â”€ Top-5 Important Features: [0]
      â””â”€ Top-5 Values: ['71.2837']

ðŸ“Š Layer: LF_l5_FDCA.positional_att
   â”œâ”€ Features: 1
   â”œâ”€ Mean Importance: 0.0000
   â”œâ”€ Max Importance: 0.0000
   â”œâ”€ Min Importance: 0.0000
   â””â”€ Top-5 Important Features: [0]
      â””â”€ Top-5 Values: ['0.0000']

ðŸ“Š Layer: LF_l5_FDCA.slice_att.linear.0
   â”œâ”€ Features: 1
   â”œâ”€ Mean Importance: 0.0000
   â”œâ”€ Max Importance: 0.0000
   â”œâ”€ Min Importance: 0.0000
   â””â”€ Top-5 Important Features: [0]
      â””â”€ Top-5 Values: ['0.0000']

ðŸ“Š Layer: LF_l5_FDCA.slice_att.linear.1
   â”œâ”€ Features: 1
   â”œâ”€ Mean Importance: 0.0000
   â”œâ”€ Max Importance: 0.0000
   â”œâ”€ Min Importance: 0.0000
   â””â”€ Top-5 Important Features: [0]
      â””â”€ Top-5 Values: ['0.0000']

ðŸ“Š Layer: LF_l5_FDCA.slice_att.linear.2
   â”œâ”€ Features: 1
   â”œâ”€ Mean Importance: 0.0000
   â”œâ”€ Max Importance: 0.0000
   â”œâ”€ Min Importance: 0.0000
   â””â”€ Top-5 Important Features: [0]
      â””â”€ Top-5 Values: ['0.0000']

ðŸ“Š Layer: LF_l5_FDCA.slice_att.linear
   â”œâ”€ Features: 1
   â”œâ”€ Mean Importance: 0.0000
   â”œâ”€ Max Importance: 0.0000
   â”œâ”€ Min Importance: 0.0000
   â””â”€ Top-5 Important Features: [0]
      â””â”€ Top-5 Values: ['0.0000']

ðŸ“Š Layer: LF_l5_FDCA.slice_att.non_linear
   â”œâ”€ Features: 1
   â”œâ”€ Mean Importance: 0.0000
   â”œâ”€ Max Importance: 0.0000
   â”œâ”€ Min Importance: 0.0000
   â””â”€ Top-5 Important Features: [0]
      â””â”€ Top-5 Values: ['0.0000']

ðŸ“Š Layer: LF_l5_FDCA.slice_att.mean
   â”œâ”€ Features: 1
   â”œâ”€ Mean Importance: 0.0017
   â”œâ”€ Max Importance: 0.0017
   â”œâ”€ Min Importance: 0.0017
   â””â”€ Top-5 Important Features: [0]
      â””â”€ Top-5 Values: ['0.0017']

ðŸ“Š Layer: LF_l5_FDCA.slice_att.log_diag
   â”œâ”€ Features: 1
   â”œâ”€ Mean Importance: 0.0000
   â”œâ”€ Max Importance: 0.0000
   â”œâ”€ Min Importance: 0.0000
   â””â”€ Top-5 Important Features: [0]
      â””â”€ Top-5 Values: ['0.0000']

ðŸ“Š Layer: LF_l5_FDCA.slice_att.factor
   â”œâ”€ Features: 1
   â”œâ”€ Mean Importance: 0.0001
   â”œâ”€ Max Importance: 0.0001
   â”œâ”€ Min Importance: 0.0001
   â””â”€ Top-5 Important Features: [0]
      â””â”€ Top-5 Values: ['0.0001']

ðŸ“Š Layer: LF_l5_FDCA.slice_att
   â”œâ”€ Features: 1
   â”œâ”€ Mean Importance: 0.0000
   â”œâ”€ Max Importance: 0.0000
   â”œâ”€ Min Importance: 0.0000
   â””â”€ Top-5 Important Features: [0]
      â””â”€ Top-5 Values: ['0.0000']

ðŸ“Š Layer: LF_l5_FDCA
   â”œâ”€ Features: 1
   â”œâ”€ Mean Importance: 0.0000
   â”œâ”€ Max Importance: 0.0000
   â”œâ”€ Min Importance: 0.0000
   â””â”€ Top-5 Important Features: [0]
      â””â”€ Top-5 Values: ['0.0000']

ðŸ“Š Layer: HF_l4_FDCA.semantic_att
   â”œâ”€ Features: 1
   â”œâ”€ Mean Importance: 0.0834
   â”œâ”€ Max Importance: 0.0834
   â”œâ”€ Min Importance: 0.0834
   â””â”€ Top-5 Important Features: [0]
      â””â”€ Top-5 Values: ['0.0834']

ðŸ“Š Layer: HF_l4_FDCA.positional_att.conv
   â”œâ”€ Features: 1
   â”œâ”€ Mean Importance: 7.8785
   â”œâ”€ Max Importance: 7.8785
   â”œâ”€ Min Importance: 7.8785
   â””â”€ Top-5 Important Features: [0]
      â””â”€ Top-5 Values: ['7.8785']

ðŸ“Š Layer: HF_l4_FDCA.positional_att
   â”œâ”€ Features: 1
   â”œâ”€ Mean Importance: 0.0019
   â”œâ”€ Max Importance: 0.0019
   â”œâ”€ Min Importance: 0.0019
   â””â”€ Top-5 Important Features: [0]
      â””â”€ Top-5 Values: ['0.0019']

ðŸ“Š Layer: HF_l4_FDCA.slice_att.linear.0
   â”œâ”€ Features: 1
   â”œâ”€ Mean Importance: 0.0000
   â”œâ”€ Max Importance: 0.0000
   â”œâ”€ Min Importance: 0.0000
   â””â”€ Top-5 Important Features: [0]
      â””â”€ Top-5 Values: ['0.0000']

ðŸ“Š Layer: HF_l4_FDCA.slice_att.linear.1
   â”œâ”€ Features: 1
   â”œâ”€ Mean Importance: 0.0000
   â”œâ”€ Max Importance: 0.0000
   â”œâ”€ Min Importance: 0.0000
   â””â”€ Top-5 Important Features: [0]
      â””â”€ Top-5 Values: ['0.0000']

ðŸ“Š Layer: HF_l4_FDCA.slice_att.linear.2
   â”œâ”€ Features: 1
   â”œâ”€ Mean Importance: 0.0000
   â”œâ”€ Max Importance: 0.0000
   â”œâ”€ Min Importance: 0.0000
   â””â”€ Top-5 Important Features: [0]
      â””â”€ Top-5 Values: ['0.0000']

ðŸ“Š Layer: HF_l4_FDCA.slice_att.linear
   â”œâ”€ Features: 1
   â”œâ”€ Mean Importance: 0.0000
   â”œâ”€ Max Importance: 0.0000
   â”œâ”€ Min Importance: 0.0000
   â””â”€ Top-5 Important Features: [0]
      â””â”€ Top-5 Values: ['0.0000']

ðŸ“Š Layer: HF_l4_FDCA.slice_att.non_linear
   â”œâ”€ Features: 1
   â”œâ”€ Mean Importance: 0.0000
   â”œâ”€ Max Importance: 0.0000
   â”œâ”€ Min Importance: 0.0000
   â””â”€ Top-5 Important Features: [0]
      â””â”€ Top-5 Values: ['0.0000']

ðŸ“Š Layer: HF_l4_FDCA.slice_att.mean
   â”œâ”€ Features: 1
   â”œâ”€ Mean Importance: 0.0000
   â”œâ”€ Max Importance: 0.0000
   â”œâ”€ Min Importance: 0.0000
   â””â”€ Top-5 Important Features: [0]
      â””â”€ Top-5 Values: ['0.0000']

ðŸ“Š Layer: HF_l4_FDCA.slice_att.log_diag
   â”œâ”€ Features: 1
   â”œâ”€ Mean Importance: 0.0000
   â”œâ”€ Max Importance: 0.0000
   â”œâ”€ Min Importance: 0.0000
   â””â”€ Top-5 Important Features: [0]
      â””â”€ Top-5 Values: ['0.0000']

ðŸ“Š Layer: HF_l4_FDCA.slice_att.factor
   â”œâ”€ Features: 1
   â”œâ”€ Mean Importance: 0.0000
   â”œâ”€ Max Importance: 0.0000
   â”œâ”€ Min Importance: 0.0000
   â””â”€ Top-5 Important Features: [0]
      â””â”€ Top-5 Values: ['0.0000']

ðŸ“Š Layer: HF_l4_FDCA.slice_att
   â”œâ”€ Features: 1
   â”œâ”€ Mean Importance: 0.0036
   â”œâ”€ Max Importance: 0.0036
   â”œâ”€ Min Importance: 0.0036
   â””â”€ Top-5 Important Features: [0]
      â””â”€ Top-5 Values: ['0.0036']

ðŸ“Š Layer: HF_l4_FDCA
   â”œâ”€ Features: 1
   â”œâ”€ Mean Importance: 0.9873
   â”œâ”€ Max Importance: 0.9873
   â”œâ”€ Min Importance: 0.9873
   â””â”€ Top-5 Important Features: [0]
      â””â”€ Top-5 Values: ['0.9873']

ðŸ“Š Layer: HF_l5_FDCA.semantic_att
   â”œâ”€ Features: 1
   â”œâ”€ Mean Importance: 0.0758
   â”œâ”€ Max Importance: 0.0758
   â”œâ”€ Min Importance: 0.0758
   â””â”€ Top-5 Important Features: [0]
      â””â”€ Top-5 Values: ['0.0758']

ðŸ“Š Layer: HF_l5_FDCA.positional_att.conv
   â”œâ”€ Features: 1
   â”œâ”€ Mean Importance: 14.9019
   â”œâ”€ Max Importance: 14.9019
   â”œâ”€ Min Importance: 14.9019
   â””â”€ Top-5 Important Features: [0]
      â””â”€ Top-5 Values: ['14.9019']

ðŸ“Š Layer: HF_l5_FDCA.positional_att
   â”œâ”€ Features: 1
   â”œâ”€ Mean Importance: 0.0001
   â”œâ”€ Max Importance: 0.0001
   â”œâ”€ Min Importance: 0.0001
   â””â”€ Top-5 Important Features: [0]
      â””â”€ Top-5 Values: ['0.0001']

ðŸ“Š Layer: HF_l5_FDCA.slice_att.linear.0
   â”œâ”€ Features: 1
   â”œâ”€ Mean Importance: 0.0000
   â”œâ”€ Max Importance: 0.0000
   â”œâ”€ Min Importance: 0.0000
   â””â”€ Top-5 Important Features: [0]
      â””â”€ Top-5 Values: ['0.0000']

ðŸ“Š Layer: HF_l5_FDCA.slice_att.linear.1
   â”œâ”€ Features: 1
   â”œâ”€ Mean Importance: 0.0000
   â”œâ”€ Max Importance: 0.0000
   â”œâ”€ Min Importance: 0.0000
   â””â”€ Top-5 Important Features: [0]
      â””â”€ Top-5 Values: ['0.0000']

ðŸ“Š Layer: HF_l5_FDCA.slice_att.linear.2
   â”œâ”€ Features: 1
   â”œâ”€ Mean Importance: 0.0000
   â”œâ”€ Max Importance: 0.0000
   â”œâ”€ Min Importance: 0.0000
   â””â”€ Top-5 Important Features: [0]
      â””â”€ Top-5 Values: ['0.0000']

ðŸ“Š Layer: HF_l5_FDCA.slice_att.linear
   â”œâ”€ Features: 1
   â”œâ”€ Mean Importance: 0.0000
   â”œâ”€ Max Importance: 0.0000
   â”œâ”€ Min Importance: 0.0000
   â””â”€ Top-5 Important Features: [0]
      â””â”€ Top-5 Values: ['0.0000']

ðŸ“Š Layer: HF_l5_FDCA.slice_att.non_linear
   â”œâ”€ Features: 1
   â”œâ”€ Mean Importance: 0.0000
   â”œâ”€ Max Importance: 0.0000
   â”œâ”€ Min Importance: 0.0000
   â””â”€ Top-5 Important Features: [0]
      â””â”€ Top-5 Values: ['0.0000']

ðŸ“Š Layer: HF_l5_FDCA.slice_att.mean
   â”œâ”€ Features: 1
   â”œâ”€ Mean Importance: 0.0000
   â”œâ”€ Max Importance: 0.0000
   â”œâ”€ Min Importance: 0.0000
   â””â”€ Top-5 Important Features: [0]
      â””â”€ Top-5 Values: ['0.0000']

ðŸ“Š Layer: HF_l5_FDCA.slice_att.log_diag
   â”œâ”€ Features: 1
   â”œâ”€ Mean Importance: 0.0000
   â”œâ”€ Max Importance: 0.0000
   â”œâ”€ Min Importance: 0.0000
   â””â”€ Top-5 Important Features: [0]
      â””â”€ Top-5 Values: ['0.0000']

ðŸ“Š Layer: HF_l5_FDCA.slice_att.factor
   â”œâ”€ Features: 1
   â”œâ”€ Mean Importance: 0.0000
   â”œâ”€ Max Importance: 0.0000
   â”œâ”€ Min Importance: 0.0000
   â””â”€ Top-5 Important Features: [0]
      â””â”€ Top-5 Values: ['0.0000']

ðŸ“Š Layer: HF_l5_FDCA.slice_att
   â”œâ”€ Features: 1
   â”œâ”€ Mean Importance: 0.0001
   â”œâ”€ Max Importance: 0.0001
   â”œâ”€ Min Importance: 0.0001
   â””â”€ Top-5 Important Features: [0]
      â””â”€ Top-5 Values: ['0.0001']

ðŸ“Š Layer: HF_l5_FDCA
   â”œâ”€ Features: 1
   â”œâ”€ Mean Importance: 0.0001
   â”œâ”€ Max Importance: 0.0001
   â”œâ”€ Min Importance: 0.0001
   â””â”€ Top-5 Important Features: [0]
      â””â”€ Top-5 Values: ['0.0001']

======================================================================
âœ“ Mechanistic analysis complete

[3] Generating Grad-CAM...
Warning: Failed to generate CAM for class 0: element 0 of tensors does not require grad and does not have a grad_fn
Warning: Failed to generate CAM for class 1: element 0 of tensors does not require grad and does not have a grad_fn
Warning: Failed to generate CAM for class 2: element 0 of tensors does not require grad and does not have a grad_fn
Warning: Failed to generate CAM for class 3: element 0 of tensors does not require grad and does not have a grad_fn
[4] Analyzing frequency components...
âœ“ Saved: outputs/xai_2025-11-15_17-25-23/freq_component/sample_0033_freq_comp.png
âœ“ Evaluation complete for sample_0033
Evaluating:  89%|########9 | 34/38 [09:22<01:04, 16.09s/it]
[1] Getting primary prediction...

[METRICS FOR sample_0034]
==================================================
class_0: Dice=0.9966, IoU=0.9933
class_1: Dice=0.0858, IoU=0.0448
class_2: Dice=0.6754, IoU=0.5099
class_3: Dice=0.8137, IoU=0.6859
==================================================

[2] Generating attention maps...
Clipping input data to the valid range for imshow with RGB data ([0..1] for floats or [0..255] for integers).
Clipping input data to the valid range for imshow with RGB data ([0..1] for floats or [0..255] for integers).
âœ“ Saved: outputs/xai_2025-11-15_17-25-23/attention/sample_0034_attention.png

[MECHANISTIC INTERPRETABILITY ANALYSIS]
======================================================================
Sample: sample_0034
======================================================================

ðŸ“Š Layer: LF_l4_FDCA.semantic_att
   â”œâ”€ Features: 1
   â”œâ”€ Mean Importance: 0.1292
   â”œâ”€ Max Importance: 0.1292
   â”œâ”€ Min Importance: 0.1292
   â””â”€ Top-5 Important Features: [0]
      â””â”€ Top-5 Values: ['0.1292']

ðŸ“Š Layer: LF_l4_FDCA.positional_att.conv
   â”œâ”€ Features: 1
   â”œâ”€ Mean Importance: 223.6635
   â”œâ”€ Max Importance: 223.6635
   â”œâ”€ Min Importance: 223.6635
   â””â”€ Top-5 Important Features: [0]
      â””â”€ Top-5 Values: ['223.6635']

ðŸ“Š Layer: LF_l4_FDCA.positional_att
   â”œâ”€ Features: 1
   â”œâ”€ Mean Importance: 40.3512
   â”œâ”€ Max Importance: 40.3512
   â”œâ”€ Min Importance: 40.3512
   â””â”€ Top-5 Important Features: [0]
      â””â”€ Top-5 Values: ['40.3512']

ðŸ“Š Layer: LF_l4_FDCA.slice_att.linear.0
   â”œâ”€ Features: 1
   â”œâ”€ Mean Importance: 60.8113
   â”œâ”€ Max Importance: 60.8113
   â”œâ”€ Min Importance: 60.8113
   â””â”€ Top-5 Important Features: [0]
      â””â”€ Top-5 Values: ['60.8113']

ðŸ“Š Layer: LF_l4_FDCA.slice_att.linear.1
   â”œâ”€ Features: 1
   â”œâ”€ Mean Importance: 51.5869
   â”œâ”€ Max Importance: 51.5869
   â”œâ”€ Min Importance: 51.5869
   â””â”€ Top-5 Important Features: [0]
      â””â”€ Top-5 Values: ['51.5869']

ðŸ“Š Layer: LF_l4_FDCA.slice_att.linear.2
   â”œâ”€ Features: 1
   â”œâ”€ Mean Importance: 48.9521
   â”œâ”€ Max Importance: 48.9521
   â”œâ”€ Min Importance: 48.9521
   â””â”€ Top-5 Important Features: [0]
      â””â”€ Top-5 Values: ['48.9521']

ðŸ“Š Layer: LF_l4_FDCA.slice_att.linear
   â”œâ”€ Features: 1
   â”œâ”€ Mean Importance: 48.9521
   â”œâ”€ Max Importance: 48.9521
   â”œâ”€ Min Importance: 48.9521
   â””â”€ Top-5 Important Features: [0]
      â””â”€ Top-5 Values: ['48.9521']

ðŸ“Š Layer: LF_l4_FDCA.slice_att.non_linear
   â”œâ”€ Features: 1
   â”œâ”€ Mean Importance: 22299244.0000
   â”œâ”€ Max Importance: 22299244.0000
   â”œâ”€ Min Importance: 22299244.0000
   â””â”€ Top-5 Important Features: [0]
      â””â”€ Top-5 Values: ['22299244.0000']

ðŸ“Š Layer: LF_l4_FDCA.slice_att.mean
   â”œâ”€ Features: 1
   â”œâ”€ Mean Importance: 89097376.0000
   â”œâ”€ Max Importance: 89097376.0000
   â”œâ”€ Min Importance: 89097376.0000
   â””â”€ Top-5 Important Features: [0]
      â””â”€ Top-5 Values: ['89097376.0000']

ðŸ“Š Layer: LF_l4_FDCA.slice_att.log_diag
   â”œâ”€ Features: 1
   â”œâ”€ Mean Importance: 5522.1157
   â”œâ”€ Max Importance: 5522.1157
   â”œâ”€ Min Importance: 5522.1157
   â””â”€ Top-5 Important Features: [0]
      â””â”€ Top-5 Values: ['5522.1157']

ðŸ“Š Layer: LF_l4_FDCA.slice_att.factor
   â”œâ”€ Features: 1
   â”œâ”€ Mean Importance: 34511536.0000
   â”œâ”€ Max Importance: 34511536.0000
   â”œâ”€ Min Importance: 34511536.0000
   â””â”€ Top-5 Important Features: [0]
      â””â”€ Top-5 Values: ['34511536.0000']

ðŸ“Š Layer: LF_l4_FDCA.slice_att
   â”œâ”€ Features: 1
   â”œâ”€ Mean Importance: 13177025.0000
   â”œâ”€ Max Importance: 13177025.0000
   â”œâ”€ Min Importance: 13177025.0000
   â””â”€ Top-5 Important Features: [0]
      â””â”€ Top-5 Values: ['13177025.0000']

ðŸ“Š Layer: LF_l4_FDCA
   â”œâ”€ Features: 1
   â”œâ”€ Mean Importance: 1449284693391310848.0000
   â”œâ”€ Max Importance: 1449284693391310848.0000
   â”œâ”€ Min Importance: 1449284693391310848.0000
   â””â”€ Top-5 Important Features: [0]
      â””â”€ Top-5 Values: ['1449284693391310848.0000']

ðŸ“Š Layer: LF_l5_FDCA.semantic_att
   â”œâ”€ Features: 1
   â”œâ”€ Mean Importance: 0.0809
   â”œâ”€ Max Importance: 0.0809
   â”œâ”€ Min Importance: 0.0809
   â””â”€ Top-5 Important Features: [0]
      â””â”€ Top-5 Values: ['0.0809']

ðŸ“Š Layer: LF_l5_FDCA.positional_att.conv
   â”œâ”€ Features: 1
   â”œâ”€ Mean Importance: 73.5921
   â”œâ”€ Max Importance: 73.5921
   â”œâ”€ Min Importance: 73.5921
   â””â”€ Top-5 Important Features: [0]
      â””â”€ Top-5 Values: ['73.5921']

ðŸ“Š Layer: LF_l5_FDCA.positional_att
   â”œâ”€ Features: 1
   â”œâ”€ Mean Importance: 0.0000
   â”œâ”€ Max Importance: 0.0000
   â”œâ”€ Min Importance: 0.0000
   â””â”€ Top-5 Important Features: [0]
      â””â”€ Top-5 Values: ['0.0000']

ðŸ“Š Layer: LF_l5_FDCA.slice_att.linear.0
   â”œâ”€ Features: 1
   â”œâ”€ Mean Importance: 0.0000
   â”œâ”€ Max Importance: 0.0000
   â”œâ”€ Min Importance: 0.0000
   â””â”€ Top-5 Important Features: [0]
      â””â”€ Top-5 Values: ['0.0000']

ðŸ“Š Layer: LF_l5_FDCA.slice_att.linear.1
   â”œâ”€ Features: 1
   â”œâ”€ Mean Importance: 0.0000
   â”œâ”€ Max Importance: 0.0000
   â”œâ”€ Min Importance: 0.0000
   â””â”€ Top-5 Important Features: [0]
      â””â”€ Top-5 Values: ['0.0000']

ðŸ“Š Layer: LF_l5_FDCA.slice_att.linear.2
   â”œâ”€ Features: 1
   â”œâ”€ Mean Importance: 0.0000
   â”œâ”€ Max Importance: 0.0000
   â”œâ”€ Min Importance: 0.0000
   â””â”€ Top-5 Important Features: [0]
      â””â”€ Top-5 Values: ['0.0000']

ðŸ“Š Layer: LF_l5_FDCA.slice_att.linear
   â”œâ”€ Features: 1
   â”œâ”€ Mean Importance: 0.0000
   â”œâ”€ Max Importance: 0.0000
   â”œâ”€ Min Importance: 0.0000
   â””â”€ Top-5 Important Features: [0]
      â””â”€ Top-5 Values: ['0.0000']

ðŸ“Š Layer: LF_l5_FDCA.slice_att.non_linear
   â”œâ”€ Features: 1
   â”œâ”€ Mean Importance: 0.0000
   â”œâ”€ Max Importance: 0.0000
   â”œâ”€ Min Importance: 0.0000
   â””â”€ Top-5 Important Features: [0]
      â””â”€ Top-5 Values: ['0.0000']

ðŸ“Š Layer: LF_l5_FDCA.slice_att.mean
   â”œâ”€ Features: 1
   â”œâ”€ Mean Importance: 0.0017
   â”œâ”€ Max Importance: 0.0017
   â”œâ”€ Min Importance: 0.0017
   â””â”€ Top-5 Important Features: [0]
      â””â”€ Top-5 Values: ['0.0017']

ðŸ“Š Layer: LF_l5_FDCA.slice_att.log_diag
   â”œâ”€ Features: 1
   â”œâ”€ Mean Importance: 0.0000
   â”œâ”€ Max Importance: 0.0000
   â”œâ”€ Min Importance: 0.0000
   â””â”€ Top-5 Important Features: [0]
      â””â”€ Top-5 Values: ['0.0000']

ðŸ“Š Layer: LF_l5_FDCA.slice_att.factor
   â”œâ”€ Features: 1
   â”œâ”€ Mean Importance: 0.0001
   â”œâ”€ Max Importance: 0.0001
   â”œâ”€ Min Importance: 0.0001
   â””â”€ Top-5 Important Features: [0]
      â””â”€ Top-5 Values: ['0.0001']

ðŸ“Š Layer: LF_l5_FDCA.slice_att
   â”œâ”€ Features: 1
   â”œâ”€ Mean Importance: 0.0000
   â”œâ”€ Max Importance: 0.0000
   â”œâ”€ Min Importance: 0.0000
   â””â”€ Top-5 Important Features: [0]
      â””â”€ Top-5 Values: ['0.0000']

ðŸ“Š Layer: LF_l5_FDCA
   â”œâ”€ Features: 1
   â”œâ”€ Mean Importance: 0.0000
   â”œâ”€ Max Importance: 0.0000
   â”œâ”€ Min Importance: 0.0000
   â””â”€ Top-5 Important Features: [0]
      â””â”€ Top-5 Values: ['0.0000']

ðŸ“Š Layer: HF_l4_FDCA.semantic_att
   â”œâ”€ Features: 1
   â”œâ”€ Mean Importance: 0.0812
   â”œâ”€ Max Importance: 0.0812
   â”œâ”€ Min Importance: 0.0812
   â””â”€ Top-5 Important Features: [0]
      â””â”€ Top-5 Values: ['0.0812']

ðŸ“Š Layer: HF_l4_FDCA.positional_att.conv
   â”œâ”€ Features: 1
   â”œâ”€ Mean Importance: 9.6573
   â”œâ”€ Max Importance: 9.6573
   â”œâ”€ Min Importance: 9.6573
   â””â”€ Top-5 Important Features: [0]
      â””â”€ Top-5 Values: ['9.6573']

ðŸ“Š Layer: HF_l4_FDCA.positional_att
   â”œâ”€ Features: 1
   â”œâ”€ Mean Importance: 0.0017
   â”œâ”€ Max Importance: 0.0017
   â”œâ”€ Min Importance: 0.0017
   â””â”€ Top-5 Important Features: [0]
      â””â”€ Top-5 Values: ['0.0017']

ðŸ“Š Layer: HF_l4_FDCA.slice_att.linear.0
   â”œâ”€ Features: 1
   â”œâ”€ Mean Importance: 0.0000
   â”œâ”€ Max Importance: 0.0000
   â”œâ”€ Min Importance: 0.0000
   â””â”€ Top-5 Important Features: [0]
      â””â”€ Top-5 Values: ['0.0000']

ðŸ“Š Layer: HF_l4_FDCA.slice_att.linear.1
   â”œâ”€ Features: 1
   â”œâ”€ Mean Importance: 0.0000
   â”œâ”€ Max Importance: 0.0000
   â”œâ”€ Min Importance: 0.0000
   â””â”€ Top-5 Important Features: [0]
      â””â”€ Top-5 Values: ['0.0000']

ðŸ“Š Layer: HF_l4_FDCA.slice_att.linear.2
   â”œâ”€ Features: 1
   â”œâ”€ Mean Importance: 0.0000
   â”œâ”€ Max Importance: 0.0000
   â”œâ”€ Min Importance: 0.0000
   â””â”€ Top-5 Important Features: [0]
      â””â”€ Top-5 Values: ['0.0000']

ðŸ“Š Layer: HF_l4_FDCA.slice_att.linear
   â”œâ”€ Features: 1
   â”œâ”€ Mean Importance: 0.0000
   â”œâ”€ Max Importance: 0.0000
   â”œâ”€ Min Importance: 0.0000
   â””â”€ Top-5 Important Features: [0]
      â””â”€ Top-5 Values: ['0.0000']

ðŸ“Š Layer: HF_l4_FDCA.slice_att.non_linear
   â”œâ”€ Features: 1
   â”œâ”€ Mean Importance: 0.0000
   â”œâ”€ Max Importance: 0.0000
   â”œâ”€ Min Importance: 0.0000
   â””â”€ Top-5 Important Features: [0]
      â””â”€ Top-5 Values: ['0.0000']

ðŸ“Š Layer: HF_l4_FDCA.slice_att.mean
   â”œâ”€ Features: 1
   â”œâ”€ Mean Importance: 0.0000
   â”œâ”€ Max Importance: 0.0000
   â”œâ”€ Min Importance: 0.0000
   â””â”€ Top-5 Important Features: [0]
      â””â”€ Top-5 Values: ['0.0000']

ðŸ“Š Layer: HF_l4_FDCA.slice_att.log_diag
   â”œâ”€ Features: 1
   â”œâ”€ Mean Importance: 0.0000
   â”œâ”€ Max Importance: 0.0000
   â”œâ”€ Min Importance: 0.0000
   â””â”€ Top-5 Important Features: [0]
      â””â”€ Top-5 Values: ['0.0000']

ðŸ“Š Layer: HF_l4_FDCA.slice_att.factor
   â”œâ”€ Features: 1
   â”œâ”€ Mean Importance: 0.0000
   â”œâ”€ Max Importance: 0.0000
   â”œâ”€ Min Importance: 0.0000
   â””â”€ Top-5 Important Features: [0]
      â””â”€ Top-5 Values: ['0.0000']

ðŸ“Š Layer: HF_l4_FDCA.slice_att
   â”œâ”€ Features: 1
   â”œâ”€ Mean Importance: 0.0036
   â”œâ”€ Max Importance: 0.0036
   â”œâ”€ Min Importance: 0.0036
   â””â”€ Top-5 Important Features: [0]
      â””â”€ Top-5 Values: ['0.0036']

ðŸ“Š Layer: HF_l4_FDCA
   â”œâ”€ Features: 1
   â”œâ”€ Mean Importance: 0.6544
   â”œâ”€ Max Importance: 0.6544
   â”œâ”€ Min Importance: 0.6544
   â””â”€ Top-5 Important Features: [0]
      â””â”€ Top-5 Values: ['0.6544']

ðŸ“Š Layer: HF_l5_FDCA.semantic_att
   â”œâ”€ Features: 1
   â”œâ”€ Mean Importance: 0.0696
   â”œâ”€ Max Importance: 0.0696
   â”œâ”€ Min Importance: 0.0696
   â””â”€ Top-5 Important Features: [0]
      â””â”€ Top-5 Values: ['0.0696']

ðŸ“Š Layer: HF_l5_FDCA.positional_att.conv
   â”œâ”€ Features: 1
   â”œâ”€ Mean Importance: 18.5948
   â”œâ”€ Max Importance: 18.5948
   â”œâ”€ Min Importance: 18.5948
   â””â”€ Top-5 Important Features: [0]
      â””â”€ Top-5 Values: ['18.5948']

ðŸ“Š Layer: HF_l5_FDCA.positional_att
   â”œâ”€ Features: 1
   â”œâ”€ Mean Importance: 0.0001
   â”œâ”€ Max Importance: 0.0001
   â”œâ”€ Min Importance: 0.0001
   â””â”€ Top-5 Important Features: [0]
      â””â”€ Top-5 Values: ['0.0001']

ðŸ“Š Layer: HF_l5_FDCA.slice_att.linear.0
   â”œâ”€ Features: 1
   â”œâ”€ Mean Importance: 0.0000
   â”œâ”€ Max Importance: 0.0000
   â”œâ”€ Min Importance: 0.0000
   â””â”€ Top-5 Important Features: [0]
      â””â”€ Top-5 Values: ['0.0000']

ðŸ“Š Layer: HF_l5_FDCA.slice_att.linear.1
   â”œâ”€ Features: 1
   â”œâ”€ Mean Importance: 0.0000
   â”œâ”€ Max Importance: 0.0000
   â”œâ”€ Min Importance: 0.0000
   â””â”€ Top-5 Important Features: [0]
      â””â”€ Top-5 Values: ['0.0000']

ðŸ“Š Layer: HF_l5_FDCA.slice_att.linear.2
   â”œâ”€ Features: 1
   â”œâ”€ Mean Importance: 0.0000
   â”œâ”€ Max Importance: 0.0000
   â”œâ”€ Min Importance: 0.0000
   â””â”€ Top-5 Important Features: [0]
      â””â”€ Top-5 Values: ['0.0000']

ðŸ“Š Layer: HF_l5_FDCA.slice_att.linear
   â”œâ”€ Features: 1
   â”œâ”€ Mean Importance: 0.0000
   â”œâ”€ Max Importance: 0.0000
   â”œâ”€ Min Importance: 0.0000
   â””â”€ Top-5 Important Features: [0]
      â””â”€ Top-5 Values: ['0.0000']

ðŸ“Š Layer: HF_l5_FDCA.slice_att.non_linear
   â”œâ”€ Features: 1
   â”œâ”€ Mean Importance: 0.0000
   â”œâ”€ Max Importance: 0.0000
   â”œâ”€ Min Importance: 0.0000
   â””â”€ Top-5 Important Features: [0]
      â””â”€ Top-5 Values: ['0.0000']

ðŸ“Š Layer: HF_l5_FDCA.slice_att.mean
   â”œâ”€ Features: 1
   â”œâ”€ Mean Importance: 0.0000
   â”œâ”€ Max Importance: 0.0000
   â”œâ”€ Min Importance: 0.0000
   â””â”€ Top-5 Important Features: [0]
      â””â”€ Top-5 Values: ['0.0000']

ðŸ“Š Layer: HF_l5_FDCA.slice_att.log_diag
   â”œâ”€ Features: 1
   â”œâ”€ Mean Importance: 0.0000
   â”œâ”€ Max Importance: 0.0000
   â”œâ”€ Min Importance: 0.0000
   â””â”€ Top-5 Important Features: [0]
      â””â”€ Top-5 Values: ['0.0000']

ðŸ“Š Layer: HF_l5_FDCA.slice_att.factor
   â”œâ”€ Features: 1
   â”œâ”€ Mean Importance: 0.0000
   â”œâ”€ Max Importance: 0.0000
   â”œâ”€ Min Importance: 0.0000
   â””â”€ Top-5 Important Features: [0]
      â””â”€ Top-5 Values: ['0.0000']

ðŸ“Š Layer: HF_l5_FDCA.slice_att
   â”œâ”€ Features: 1
   â”œâ”€ Mean Importance: 0.0002
   â”œâ”€ Max Importance: 0.0002
   â”œâ”€ Min Importance: 0.0002
   â””â”€ Top-5 Important Features: [0]
      â””â”€ Top-5 Values: ['0.0002']

ðŸ“Š Layer: HF_l5_FDCA
   â”œâ”€ Features: 1
   â”œâ”€ Mean Importance: 0.0007
   â”œâ”€ Max Importance: 0.0007
   â”œâ”€ Min Importance: 0.0007
   â””â”€ Top-5 Important Features: [0]
      â””â”€ Top-5 Values: ['0.0007']

======================================================================
âœ“ Mechanistic analysis complete

[3] Generating Grad-CAM...
Warning: Failed to generate CAM for class 0: element 0 of tensors does not require grad and does not have a grad_fn
Warning: Failed to generate CAM for class 1: element 0 of tensors does not require grad and does not have a grad_fn
Warning: Failed to generate CAM for class 2: element 0 of tensors does not require grad and does not have a grad_fn
Warning: Failed to generate CAM for class 3: element 0 of tensors does not require grad and does not have a grad_fn
[4] Analyzing frequency components...
âœ“ Saved: outputs/xai_2025-11-15_17-25-23/freq_component/sample_0034_freq_comp.png
âœ“ Evaluation complete for sample_0034
Evaluating:  92%|#########2| 35/38 [09:39<00:48, 16.30s/it]
[1] Getting primary prediction...

[METRICS FOR sample_0035]
==================================================
class_0: Dice=0.9985, IoU=0.9970
class_1: Dice=0.9014, IoU=0.8205
class_2: Dice=0.9258, IoU=0.8618
class_3: Dice=0.9384, IoU=0.8840
==================================================

[2] Generating attention maps...
Clipping input data to the valid range for imshow with RGB data ([0..1] for floats or [0..255] for integers).
Clipping input data to the valid range for imshow with RGB data ([0..1] for floats or [0..255] for integers).
âœ“ Saved: outputs/xai_2025-11-15_17-25-23/attention/sample_0035_attention.png

[MECHANISTIC INTERPRETABILITY ANALYSIS]
======================================================================
Sample: sample_0035
======================================================================

ðŸ“Š Layer: LF_l4_FDCA.semantic_att
   â”œâ”€ Features: 1
   â”œâ”€ Mean Importance: 0.1425
   â”œâ”€ Max Importance: 0.1425
   â”œâ”€ Min Importance: 0.1425
   â””â”€ Top-5 Important Features: [0]
      â””â”€ Top-5 Values: ['0.1425']

ðŸ“Š Layer: LF_l4_FDCA.positional_att.conv
   â”œâ”€ Features: 1
   â”œâ”€ Mean Importance: 299.6970
   â”œâ”€ Max Importance: 299.6970
   â”œâ”€ Min Importance: 299.6970
   â””â”€ Top-5 Important Features: [0]
      â””â”€ Top-5 Values: ['299.6970']

ðŸ“Š Layer: LF_l4_FDCA.positional_att
   â”œâ”€ Features: 1
   â”œâ”€ Mean Importance: 62.0862
   â”œâ”€ Max Importance: 62.0862
   â”œâ”€ Min Importance: 62.0862
   â””â”€ Top-5 Important Features: [0]
      â””â”€ Top-5 Values: ['62.0862']

ðŸ“Š Layer: LF_l4_FDCA.slice_att.linear.0
   â”œâ”€ Features: 1
   â”œâ”€ Mean Importance: 104.3798
   â”œâ”€ Max Importance: 104.3798
   â”œâ”€ Min Importance: 104.3798
   â””â”€ Top-5 Important Features: [0]
      â””â”€ Top-5 Values: ['104.3798']

ðŸ“Š Layer: LF_l4_FDCA.slice_att.linear.1
   â”œâ”€ Features: 1
   â”œâ”€ Mean Importance: 88.5553
   â”œâ”€ Max Importance: 88.5553
   â”œâ”€ Min Importance: 88.5553
   â””â”€ Top-5 Important Features: [0]
      â””â”€ Top-5 Values: ['88.5553']

ðŸ“Š Layer: LF_l4_FDCA.slice_att.linear.2
   â”œâ”€ Features: 1
   â”œâ”€ Mean Importance: 84.0055
   â”œâ”€ Max Importance: 84.0055
   â”œâ”€ Min Importance: 84.0055
   â””â”€ Top-5 Important Features: [0]
      â””â”€ Top-5 Values: ['84.0055']

ðŸ“Š Layer: LF_l4_FDCA.slice_att.linear
   â”œâ”€ Features: 1
   â”œâ”€ Mean Importance: 84.0055
   â”œâ”€ Max Importance: 84.0055
   â”œâ”€ Min Importance: 84.0055
   â””â”€ Top-5 Important Features: [0]
      â””â”€ Top-5 Values: ['84.0055']

ðŸ“Š Layer: LF_l4_FDCA.slice_att.non_linear
   â”œâ”€ Features: 1
   â”œâ”€ Mean Importance: 34483080.0000
   â”œâ”€ Max Importance: 34483080.0000
   â”œâ”€ Min Importance: 34483080.0000
   â””â”€ Top-5 Important Features: [0]
      â””â”€ Top-5 Values: ['34483080.0000']

ðŸ“Š Layer: LF_l4_FDCA.slice_att.mean
   â”œâ”€ Features: 1
   â”œâ”€ Mean Importance: 137761952.0000
   â”œâ”€ Max Importance: 137761952.0000
   â”œâ”€ Min Importance: 137761952.0000
   â””â”€ Top-5 Important Features: [0]
      â””â”€ Top-5 Values: ['137761952.0000']

ðŸ“Š Layer: LF_l4_FDCA.slice_att.log_diag
   â”œâ”€ Features: 1
   â”œâ”€ Mean Importance: 8538.4131
   â”œâ”€ Max Importance: 8538.4131
   â”œâ”€ Min Importance: 8538.4131
   â””â”€ Top-5 Important Features: [0]
      â””â”€ Top-5 Values: ['8538.4131']

ðŸ“Š Layer: LF_l4_FDCA.slice_att.factor
   â”œâ”€ Features: 1
   â”œâ”€ Mean Importance: 53361408.0000
   â”œâ”€ Max Importance: 53361408.0000
   â”œâ”€ Min Importance: 53361408.0000
   â””â”€ Top-5 Important Features: [0]
      â””â”€ Top-5 Values: ['53361408.0000']

ðŸ“Š Layer: LF_l4_FDCA.slice_att
   â”œâ”€ Features: 1
   â”œâ”€ Mean Importance: 24271994.0000
   â”œâ”€ Max Importance: 24271994.0000
   â”œâ”€ Min Importance: 24271994.0000
   â””â”€ Top-5 Important Features: [0]
      â””â”€ Top-5 Values: ['24271994.0000']

ðŸ“Š Layer: LF_l4_FDCA
   â”œâ”€ Features: 1
   â”œâ”€ Mean Importance: 4581308161419378688.0000
   â”œâ”€ Max Importance: 4581308161419378688.0000
   â”œâ”€ Min Importance: 4581308161419378688.0000
   â””â”€ Top-5 Important Features: [0]
      â””â”€ Top-5 Values: ['4581308161419378688.0000']

ðŸ“Š Layer: LF_l5_FDCA.semantic_att
   â”œâ”€ Features: 1
   â”œâ”€ Mean Importance: 0.0846
   â”œâ”€ Max Importance: 0.0846
   â”œâ”€ Min Importance: 0.0846
   â””â”€ Top-5 Important Features: [0]
      â””â”€ Top-5 Values: ['0.0846']

ðŸ“Š Layer: LF_l5_FDCA.positional_att.conv
   â”œâ”€ Features: 1
   â”œâ”€ Mean Importance: 64.2283
   â”œâ”€ Max Importance: 64.2283
   â”œâ”€ Min Importance: 64.2283
   â””â”€ Top-5 Important Features: [0]
      â””â”€ Top-5 Values: ['64.2283']

ðŸ“Š Layer: LF_l5_FDCA.positional_att
   â”œâ”€ Features: 1
   â”œâ”€ Mean Importance: 0.0000
   â”œâ”€ Max Importance: 0.0000
   â”œâ”€ Min Importance: 0.0000
   â””â”€ Top-5 Important Features: [0]
      â””â”€ Top-5 Values: ['0.0000']

ðŸ“Š Layer: LF_l5_FDCA.slice_att.linear.0
   â”œâ”€ Features: 1
   â”œâ”€ Mean Importance: 0.0000
   â”œâ”€ Max Importance: 0.0000
   â”œâ”€ Min Importance: 0.0000
   â””â”€ Top-5 Important Features: [0]
      â””â”€ Top-5 Values: ['0.0000']

ðŸ“Š Layer: LF_l5_FDCA.slice_att.linear.1
   â”œâ”€ Features: 1
   â”œâ”€ Mean Importance: 0.0000
   â”œâ”€ Max Importance: 0.0000
   â”œâ”€ Min Importance: 0.0000
   â””â”€ Top-5 Important Features: [0]
      â””â”€ Top-5 Values: ['0.0000']

ðŸ“Š Layer: LF_l5_FDCA.slice_att.linear.2
   â”œâ”€ Features: 1
   â”œâ”€ Mean Importance: 0.0000
   â”œâ”€ Max Importance: 0.0000
   â”œâ”€ Min Importance: 0.0000
   â””â”€ Top-5 Important Features: [0]
      â””â”€ Top-5 Values: ['0.0000']

ðŸ“Š Layer: LF_l5_FDCA.slice_att.linear
   â”œâ”€ Features: 1
   â”œâ”€ Mean Importance: 0.0000
   â”œâ”€ Max Importance: 0.0000
   â”œâ”€ Min Importance: 0.0000
   â””â”€ Top-5 Important Features: [0]
      â””â”€ Top-5 Values: ['0.0000']

ðŸ“Š Layer: LF_l5_FDCA.slice_att.non_linear
   â”œâ”€ Features: 1
   â”œâ”€ Mean Importance: 0.0000
   â”œâ”€ Max Importance: 0.0000
   â”œâ”€ Min Importance: 0.0000
   â””â”€ Top-5 Important Features: [0]
      â””â”€ Top-5 Values: ['0.0000']

ðŸ“Š Layer: LF_l5_FDCA.slice_att.mean
   â”œâ”€ Features: 1
   â”œâ”€ Mean Importance: 0.0017
   â”œâ”€ Max Importance: 0.0017
   â”œâ”€ Min Importance: 0.0017
   â””â”€ Top-5 Important Features: [0]
      â””â”€ Top-5 Values: ['0.0017']

ðŸ“Š Layer: LF_l5_FDCA.slice_att.log_diag
   â”œâ”€ Features: 1
   â”œâ”€ Mean Importance: 0.0000
   â”œâ”€ Max Importance: 0.0000
   â”œâ”€ Min Importance: 0.0000
   â””â”€ Top-5 Important Features: [0]
      â””â”€ Top-5 Values: ['0.0000']

ðŸ“Š Layer: LF_l5_FDCA.slice_att.factor
   â”œâ”€ Features: 1
   â”œâ”€ Mean Importance: 0.0001
   â”œâ”€ Max Importance: 0.0001
   â”œâ”€ Min Importance: 0.0001
   â””â”€ Top-5 Important Features: [0]
      â””â”€ Top-5 Values: ['0.0001']

ðŸ“Š Layer: LF_l5_FDCA.slice_att
   â”œâ”€ Features: 1
   â”œâ”€ Mean Importance: 0.0000
   â”œâ”€ Max Importance: 0.0000
   â”œâ”€ Min Importance: 0.0000
   â””â”€ Top-5 Important Features: [0]
      â””â”€ Top-5 Values: ['0.0000']

ðŸ“Š Layer: LF_l5_FDCA
   â”œâ”€ Features: 1
   â”œâ”€ Mean Importance: 0.0000
   â”œâ”€ Max Importance: 0.0000
   â”œâ”€ Min Importance: 0.0000
   â””â”€ Top-5 Important Features: [0]
      â””â”€ Top-5 Values: ['0.0000']

ðŸ“Š Layer: HF_l4_FDCA.semantic_att
   â”œâ”€ Features: 1
   â”œâ”€ Mean Importance: 0.0824
   â”œâ”€ Max Importance: 0.0824
   â”œâ”€ Min Importance: 0.0824
   â””â”€ Top-5 Important Features: [0]
      â””â”€ Top-5 Values: ['0.0824']

ðŸ“Š Layer: HF_l4_FDCA.positional_att.conv
   â”œâ”€ Features: 1
   â”œâ”€ Mean Importance: 8.9436
   â”œâ”€ Max Importance: 8.9436
   â”œâ”€ Min Importance: 8.9436
   â””â”€ Top-5 Important Features: [0]
      â””â”€ Top-5 Values: ['8.9436']

ðŸ“Š Layer: HF_l4_FDCA.positional_att
   â”œâ”€ Features: 1
   â”œâ”€ Mean Importance: 0.0018
   â”œâ”€ Max Importance: 0.0018
   â”œâ”€ Min Importance: 0.0018
   â””â”€ Top-5 Important Features: [0]
      â””â”€ Top-5 Values: ['0.0018']

ðŸ“Š Layer: HF_l4_FDCA.slice_att.linear.0
   â”œâ”€ Features: 1
   â”œâ”€ Mean Importance: 0.0000
   â”œâ”€ Max Importance: 0.0000
   â”œâ”€ Min Importance: 0.0000
   â””â”€ Top-5 Important Features: [0]
      â””â”€ Top-5 Values: ['0.0000']

ðŸ“Š Layer: HF_l4_FDCA.slice_att.linear.1
   â”œâ”€ Features: 1
   â”œâ”€ Mean Importance: 0.0000
   â”œâ”€ Max Importance: 0.0000
   â”œâ”€ Min Importance: 0.0000
   â””â”€ Top-5 Important Features: [0]
      â””â”€ Top-5 Values: ['0.0000']

ðŸ“Š Layer: HF_l4_FDCA.slice_att.linear.2
   â”œâ”€ Features: 1
   â”œâ”€ Mean Importance: 0.0000
   â”œâ”€ Max Importance: 0.0000
   â”œâ”€ Min Importance: 0.0000
   â””â”€ Top-5 Important Features: [0]
      â””â”€ Top-5 Values: ['0.0000']

ðŸ“Š Layer: HF_l4_FDCA.slice_att.linear
   â”œâ”€ Features: 1
   â”œâ”€ Mean Importance: 0.0000
   â”œâ”€ Max Importance: 0.0000
   â”œâ”€ Min Importance: 0.0000
   â””â”€ Top-5 Important Features: [0]
      â””â”€ Top-5 Values: ['0.0000']

ðŸ“Š Layer: HF_l4_FDCA.slice_att.non_linear
   â”œâ”€ Features: 1
   â”œâ”€ Mean Importance: 0.0000
   â”œâ”€ Max Importance: 0.0000
   â”œâ”€ Min Importance: 0.0000
   â””â”€ Top-5 Important Features: [0]
      â””â”€ Top-5 Values: ['0.0000']

ðŸ“Š Layer: HF_l4_FDCA.slice_att.mean
   â”œâ”€ Features: 1
   â”œâ”€ Mean Importance: 0.0000
   â”œâ”€ Max Importance: 0.0000
   â”œâ”€ Min Importance: 0.0000
   â””â”€ Top-5 Important Features: [0]
      â””â”€ Top-5 Values: ['0.0000']

ðŸ“Š Layer: HF_l4_FDCA.slice_att.log_diag
   â”œâ”€ Features: 1
   â”œâ”€ Mean Importance: 0.0000
   â”œâ”€ Max Importance: 0.0000
   â”œâ”€ Min Importance: 0.0000
   â””â”€ Top-5 Important Features: [0]
      â””â”€ Top-5 Values: ['0.0000']

ðŸ“Š Layer: HF_l4_FDCA.slice_att.factor
   â”œâ”€ Features: 1
   â”œâ”€ Mean Importance: 0.0000
   â”œâ”€ Max Importance: 0.0000
   â”œâ”€ Min Importance: 0.0000
   â””â”€ Top-5 Important Features: [0]
      â””â”€ Top-5 Values: ['0.0000']

ðŸ“Š Layer: HF_l4_FDCA.slice_att
   â”œâ”€ Features: 1
   â”œâ”€ Mean Importance: 0.0029
   â”œâ”€ Max Importance: 0.0029
   â”œâ”€ Min Importance: 0.0029
   â””â”€ Top-5 Important Features: [0]
      â””â”€ Top-5 Values: ['0.0029']

ðŸ“Š Layer: HF_l4_FDCA
   â”œâ”€ Features: 1
   â”œâ”€ Mean Importance: 0.2393
   â”œâ”€ Max Importance: 0.2393
   â”œâ”€ Min Importance: 0.2393
   â””â”€ Top-5 Important Features: [0]
      â””â”€ Top-5 Values: ['0.2393']

ðŸ“Š Layer: HF_l5_FDCA.semantic_att
   â”œâ”€ Features: 1
   â”œâ”€ Mean Importance: 0.0654
   â”œâ”€ Max Importance: 0.0654
   â”œâ”€ Min Importance: 0.0654
   â””â”€ Top-5 Important Features: [0]
      â””â”€ Top-5 Values: ['0.0654']

ðŸ“Š Layer: HF_l5_FDCA.positional_att.conv
   â”œâ”€ Features: 1
   â”œâ”€ Mean Importance: 13.2172
   â”œâ”€ Max Importance: 13.2172
   â”œâ”€ Min Importance: 13.2172
   â””â”€ Top-5 Important Features: [0]
      â””â”€ Top-5 Values: ['13.2172']

ðŸ“Š Layer: HF_l5_FDCA.positional_att
   â”œâ”€ Features: 1
   â”œâ”€ Mean Importance: 0.0001
   â”œâ”€ Max Importance: 0.0001
   â”œâ”€ Min Importance: 0.0001
   â””â”€ Top-5 Important Features: [0]
      â””â”€ Top-5 Values: ['0.0001']

ðŸ“Š Layer: HF_l5_FDCA.slice_att.linear.0
   â”œâ”€ Features: 1
   â”œâ”€ Mean Importance: 0.0000
   â”œâ”€ Max Importance: 0.0000
   â”œâ”€ Min Importance: 0.0000
   â””â”€ Top-5 Important Features: [0]
      â””â”€ Top-5 Values: ['0.0000']

ðŸ“Š Layer: HF_l5_FDCA.slice_att.linear.1
   â”œâ”€ Features: 1
   â”œâ”€ Mean Importance: 0.0000
   â”œâ”€ Max Importance: 0.0000
   â”œâ”€ Min Importance: 0.0000
   â””â”€ Top-5 Important Features: [0]
      â””â”€ Top-5 Values: ['0.0000']

ðŸ“Š Layer: HF_l5_FDCA.slice_att.linear.2
   â”œâ”€ Features: 1
   â”œâ”€ Mean Importance: 0.0000
   â”œâ”€ Max Importance: 0.0000
   â”œâ”€ Min Importance: 0.0000
   â””â”€ Top-5 Important Features: [0]
      â””â”€ Top-5 Values: ['0.0000']

ðŸ“Š Layer: HF_l5_FDCA.slice_att.linear
   â”œâ”€ Features: 1
   â”œâ”€ Mean Importance: 0.0000
   â”œâ”€ Max Importance: 0.0000
   â”œâ”€ Min Importance: 0.0000
   â””â”€ Top-5 Important Features: [0]
      â””â”€ Top-5 Values: ['0.0000']

ðŸ“Š Layer: HF_l5_FDCA.slice_att.non_linear
   â”œâ”€ Features: 1
   â”œâ”€ Mean Importance: 0.0000
   â”œâ”€ Max Importance: 0.0000
   â”œâ”€ Min Importance: 0.0000
   â””â”€ Top-5 Important Features: [0]
      â””â”€ Top-5 Values: ['0.0000']

ðŸ“Š Layer: HF_l5_FDCA.slice_att.mean
   â”œâ”€ Features: 1
   â”œâ”€ Mean Importance: 0.0000
   â”œâ”€ Max Importance: 0.0000
   â”œâ”€ Min Importance: 0.0000
   â””â”€ Top-5 Important Features: [0]
      â””â”€ Top-5 Values: ['0.0000']

ðŸ“Š Layer: HF_l5_FDCA.slice_att.log_diag
   â”œâ”€ Features: 1
   â”œâ”€ Mean Importance: 0.0000
   â”œâ”€ Max Importance: 0.0000
   â”œâ”€ Min Importance: 0.0000
   â””â”€ Top-5 Important Features: [0]
      â””â”€ Top-5 Values: ['0.0000']

ðŸ“Š Layer: HF_l5_FDCA.slice_att.factor
   â”œâ”€ Features: 1
   â”œâ”€ Mean Importance: 0.0000
   â”œâ”€ Max Importance: 0.0000
   â”œâ”€ Min Importance: 0.0000
   â””â”€ Top-5 Important Features: [0]
      â””â”€ Top-5 Values: ['0.0000']

ðŸ“Š Layer: HF_l5_FDCA.slice_att
   â”œâ”€ Features: 1
   â”œâ”€ Mean Importance: 0.0007
   â”œâ”€ Max Importance: 0.0007
   â”œâ”€ Min Importance: 0.0007
   â””â”€ Top-5 Important Features: [0]
      â””â”€ Top-5 Values: ['0.0007']

ðŸ“Š Layer: HF_l5_FDCA
   â”œâ”€ Features: 1
   â”œâ”€ Mean Importance: 0.0017
   â”œâ”€ Max Importance: 0.0017
   â”œâ”€ Min Importance: 0.0017
   â””â”€ Top-5 Important Features: [0]
      â””â”€ Top-5 Values: ['0.0017']

======================================================================
âœ“ Mechanistic analysis complete

[3] Generating Grad-CAM...
Warning: Failed to generate CAM for class 0: element 0 of tensors does not require grad and does not have a grad_fn
Warning: Failed to generate CAM for class 1: element 0 of tensors does not require grad and does not have a grad_fn
Warning: Failed to generate CAM for class 2: element 0 of tensors does not require grad and does not have a grad_fn
Warning: Failed to generate CAM for class 3: element 0 of tensors does not require grad and does not have a grad_fn
[4] Analyzing frequency components...
âœ“ Saved: outputs/xai_2025-11-15_17-25-23/freq_component/sample_0035_freq_comp.png
âœ“ Evaluation complete for sample_0035
Evaluating:  95%|#########4| 36/38 [09:55<00:32, 16.07s/it]
[1] Getting primary prediction...

[METRICS FOR sample_0036]
==================================================
class_0: Dice=0.9899, IoU=0.9799
class_1: Dice=0.8433, IoU=0.7290
class_2: Dice=0.8577, IoU=0.7509
class_3: Dice=0.8580, IoU=0.7513
==================================================

[2] Generating attention maps...
Clipping input data to the valid range for imshow with RGB data ([0..1] for floats or [0..255] for integers).
Clipping input data to the valid range for imshow with RGB data ([0..1] for floats or [0..255] for integers).
âœ“ Saved: outputs/xai_2025-11-15_17-25-23/attention/sample_0036_attention.png

[MECHANISTIC INTERPRETABILITY ANALYSIS]
======================================================================
Sample: sample_0036
======================================================================

ðŸ“Š Layer: LF_l4_FDCA.semantic_att
   â”œâ”€ Features: 1
   â”œâ”€ Mean Importance: 0.1224
   â”œâ”€ Max Importance: 0.1224
   â”œâ”€ Min Importance: 0.1224
   â””â”€ Top-5 Important Features: [0]
      â””â”€ Top-5 Values: ['0.1224']

ðŸ“Š Layer: LF_l4_FDCA.positional_att.conv
   â”œâ”€ Features: 1
   â”œâ”€ Mean Importance: 253.5365
   â”œâ”€ Max Importance: 253.5365
   â”œâ”€ Min Importance: 253.5365
   â””â”€ Top-5 Important Features: [0]
      â””â”€ Top-5 Values: ['253.5365']

ðŸ“Š Layer: LF_l4_FDCA.positional_att
   â”œâ”€ Features: 1
   â”œâ”€ Mean Importance: 44.2432
   â”œâ”€ Max Importance: 44.2432
   â”œâ”€ Min Importance: 44.2432
   â””â”€ Top-5 Important Features: [0]
      â””â”€ Top-5 Values: ['44.2432']

ðŸ“Š Layer: LF_l4_FDCA.slice_att.linear.0
   â”œâ”€ Features: 1
   â”œâ”€ Mean Importance: 78.2955
   â”œâ”€ Max Importance: 78.2955
   â”œâ”€ Min Importance: 78.2955
   â””â”€ Top-5 Important Features: [0]
      â””â”€ Top-5 Values: ['78.2955']

ðŸ“Š Layer: LF_l4_FDCA.slice_att.linear.1
   â”œâ”€ Features: 1
   â”œâ”€ Mean Importance: 66.4175
   â”œâ”€ Max Importance: 66.4175
   â”œâ”€ Min Importance: 66.4175
   â””â”€ Top-5 Important Features: [0]
      â””â”€ Top-5 Values: ['66.4175']

ðŸ“Š Layer: LF_l4_FDCA.slice_att.linear.2
   â”œâ”€ Features: 1
   â”œâ”€ Mean Importance: 63.0293
   â”œâ”€ Max Importance: 63.0293
   â”œâ”€ Min Importance: 63.0293
   â””â”€ Top-5 Important Features: [0]
      â””â”€ Top-5 Values: ['63.0293']

ðŸ“Š Layer: LF_l4_FDCA.slice_att.linear
   â”œâ”€ Features: 1
   â”œâ”€ Mean Importance: 63.0293
   â”œâ”€ Max Importance: 63.0293
   â”œâ”€ Min Importance: 63.0293
   â””â”€ Top-5 Important Features: [0]
      â””â”€ Top-5 Values: ['63.0293']

ðŸ“Š Layer: LF_l4_FDCA.slice_att.non_linear
   â”œâ”€ Features: 1
   â”œâ”€ Mean Importance: 27994172.0000
   â”œâ”€ Max Importance: 27994172.0000
   â”œâ”€ Min Importance: 27994172.0000
   â””â”€ Top-5 Important Features: [0]
      â””â”€ Top-5 Values: ['27994172.0000']

ðŸ“Š Layer: LF_l4_FDCA.slice_att.mean
   â”œâ”€ Features: 1
   â”œâ”€ Mean Importance: 111848832.0000
   â”œâ”€ Max Importance: 111848832.0000
   â”œâ”€ Min Importance: 111848832.0000
   â””â”€ Top-5 Important Features: [0]
      â””â”€ Top-5 Values: ['111848832.0000']

ðŸ“Š Layer: LF_l4_FDCA.slice_att.log_diag
   â”œâ”€ Features: 1
   â”œâ”€ Mean Importance: 6932.2388
   â”œâ”€ Max Importance: 6932.2388
   â”œâ”€ Min Importance: 6932.2388
   â””â”€ Top-5 Important Features: [0]
      â””â”€ Top-5 Values: ['6932.2388']

ðŸ“Š Layer: LF_l4_FDCA.slice_att.factor
   â”œâ”€ Features: 1
   â”œâ”€ Mean Importance: 43324200.0000
   â”œâ”€ Max Importance: 43324200.0000
   â”œâ”€ Min Importance: 43324200.0000
   â””â”€ Top-5 Important Features: [0]
      â””â”€ Top-5 Values: ['43324200.0000']

ðŸ“Š Layer: LF_l4_FDCA.slice_att
   â”œâ”€ Features: 1
   â”œâ”€ Mean Importance: 17379802.0000
   â”œâ”€ Max Importance: 17379802.0000
   â”œâ”€ Min Importance: 17379802.0000
   â””â”€ Top-5 Important Features: [0]
      â””â”€ Top-5 Values: ['17379802.0000']

ðŸ“Š Layer: LF_l4_FDCA
   â”œâ”€ Features: 1
   â”œâ”€ Mean Importance: 2533048565878489088.0000
   â”œâ”€ Max Importance: 2533048565878489088.0000
   â”œâ”€ Min Importance: 2533048565878489088.0000
   â””â”€ Top-5 Important Features: [0]
      â””â”€ Top-5 Values: ['2533048565878489088.0000']

ðŸ“Š Layer: LF_l5_FDCA.semantic_att
   â”œâ”€ Features: 1
   â”œâ”€ Mean Importance: 0.0806
   â”œâ”€ Max Importance: 0.0806
   â”œâ”€ Min Importance: 0.0806
   â””â”€ Top-5 Important Features: [0]
      â””â”€ Top-5 Values: ['0.0806']

ðŸ“Š Layer: LF_l5_FDCA.positional_att.conv
   â”œâ”€ Features: 1
   â”œâ”€ Mean Importance: 75.1968
   â”œâ”€ Max Importance: 75.1968
   â”œâ”€ Min Importance: 75.1968
   â””â”€ Top-5 Important Features: [0]
      â””â”€ Top-5 Values: ['75.1968']

ðŸ“Š Layer: LF_l5_FDCA.positional_att
   â”œâ”€ Features: 1
   â”œâ”€ Mean Importance: 0.0000
   â”œâ”€ Max Importance: 0.0000
   â”œâ”€ Min Importance: 0.0000
   â””â”€ Top-5 Important Features: [0]
      â””â”€ Top-5 Values: ['0.0000']

ðŸ“Š Layer: LF_l5_FDCA.slice_att.linear.0
   â”œâ”€ Features: 1
   â”œâ”€ Mean Importance: 0.0000
   â”œâ”€ Max Importance: 0.0000
   â”œâ”€ Min Importance: 0.0000
   â””â”€ Top-5 Important Features: [0]
      â””â”€ Top-5 Values: ['0.0000']

ðŸ“Š Layer: LF_l5_FDCA.slice_att.linear.1
   â”œâ”€ Features: 1
   â”œâ”€ Mean Importance: 0.0000
   â”œâ”€ Max Importance: 0.0000
   â”œâ”€ Min Importance: 0.0000
   â””â”€ Top-5 Important Features: [0]
      â””â”€ Top-5 Values: ['0.0000']

ðŸ“Š Layer: LF_l5_FDCA.slice_att.linear.2
   â”œâ”€ Features: 1
   â”œâ”€ Mean Importance: 0.0000
   â”œâ”€ Max Importance: 0.0000
   â”œâ”€ Min Importance: 0.0000
   â””â”€ Top-5 Important Features: [0]
      â””â”€ Top-5 Values: ['0.0000']

ðŸ“Š Layer: LF_l5_FDCA.slice_att.linear
   â”œâ”€ Features: 1
   â”œâ”€ Mean Importance: 0.0000
   â”œâ”€ Max Importance: 0.0000
   â”œâ”€ Min Importance: 0.0000
   â””â”€ Top-5 Important Features: [0]
      â””â”€ Top-5 Values: ['0.0000']

ðŸ“Š Layer: LF_l5_FDCA.slice_att.non_linear
   â”œâ”€ Features: 1
   â”œâ”€ Mean Importance: 0.0000
   â”œâ”€ Max Importance: 0.0000
   â”œâ”€ Min Importance: 0.0000
   â””â”€ Top-5 Important Features: [0]
      â””â”€ Top-5 Values: ['0.0000']

ðŸ“Š Layer: LF_l5_FDCA.slice_att.mean
   â”œâ”€ Features: 1
   â”œâ”€ Mean Importance: 0.0017
   â”œâ”€ Max Importance: 0.0017
   â”œâ”€ Min Importance: 0.0017
   â””â”€ Top-5 Important Features: [0]
      â””â”€ Top-5 Values: ['0.0017']

ðŸ“Š Layer: LF_l5_FDCA.slice_att.log_diag
   â”œâ”€ Features: 1
   â”œâ”€ Mean Importance: 0.0000
   â”œâ”€ Max Importance: 0.0000
   â”œâ”€ Min Importance: 0.0000
   â””â”€ Top-5 Important Features: [0]
      â””â”€ Top-5 Values: ['0.0000']

ðŸ“Š Layer: LF_l5_FDCA.slice_att.factor
   â”œâ”€ Features: 1
   â”œâ”€ Mean Importance: 0.0001
   â”œâ”€ Max Importance: 0.0001
   â”œâ”€ Min Importance: 0.0001
   â””â”€ Top-5 Important Features: [0]
      â””â”€ Top-5 Values: ['0.0001']

ðŸ“Š Layer: LF_l5_FDCA.slice_att
   â”œâ”€ Features: 1
   â”œâ”€ Mean Importance: 0.0000
   â”œâ”€ Max Importance: 0.0000
   â”œâ”€ Min Importance: 0.0000
   â””â”€ Top-5 Important Features: [0]
      â””â”€ Top-5 Values: ['0.0000']

ðŸ“Š Layer: LF_l5_FDCA
   â”œâ”€ Features: 1
   â”œâ”€ Mean Importance: 0.0000
   â”œâ”€ Max Importance: 0.0000
   â”œâ”€ Min Importance: 0.0000
   â””â”€ Top-5 Important Features: [0]
      â””â”€ Top-5 Values: ['0.0000']

ðŸ“Š Layer: HF_l4_FDCA.semantic_att
   â”œâ”€ Features: 1
   â”œâ”€ Mean Importance: 0.0825
   â”œâ”€ Max Importance: 0.0825
   â”œâ”€ Min Importance: 0.0825
   â””â”€ Top-5 Important Features: [0]
      â””â”€ Top-5 Values: ['0.0825']

ðŸ“Š Layer: HF_l4_FDCA.positional_att.conv
   â”œâ”€ Features: 1
   â”œâ”€ Mean Importance: 10.3028
   â”œâ”€ Max Importance: 10.3028
   â”œâ”€ Min Importance: 10.3028
   â””â”€ Top-5 Important Features: [0]
      â””â”€ Top-5 Values: ['10.3028']

ðŸ“Š Layer: HF_l4_FDCA.positional_att
   â”œâ”€ Features: 1
   â”œâ”€ Mean Importance: 0.0017
   â”œâ”€ Max Importance: 0.0017
   â”œâ”€ Min Importance: 0.0017
   â””â”€ Top-5 Important Features: [0]
      â””â”€ Top-5 Values: ['0.0017']

ðŸ“Š Layer: HF_l4_FDCA.slice_att.linear.0
   â”œâ”€ Features: 1
   â”œâ”€ Mean Importance: 0.0000
   â”œâ”€ Max Importance: 0.0000
   â”œâ”€ Min Importance: 0.0000
   â””â”€ Top-5 Important Features: [0]
      â””â”€ Top-5 Values: ['0.0000']

ðŸ“Š Layer: HF_l4_FDCA.slice_att.linear.1
   â”œâ”€ Features: 1
   â”œâ”€ Mean Importance: 0.0000
   â”œâ”€ Max Importance: 0.0000
   â”œâ”€ Min Importance: 0.0000
   â””â”€ Top-5 Important Features: [0]
      â””â”€ Top-5 Values: ['0.0000']

ðŸ“Š Layer: HF_l4_FDCA.slice_att.linear.2
   â”œâ”€ Features: 1
   â”œâ”€ Mean Importance: 0.0000
   â”œâ”€ Max Importance: 0.0000
   â”œâ”€ Min Importance: 0.0000
   â””â”€ Top-5 Important Features: [0]
      â””â”€ Top-5 Values: ['0.0000']

ðŸ“Š Layer: HF_l4_FDCA.slice_att.linear
   â”œâ”€ Features: 1
   â”œâ”€ Mean Importance: 0.0000
   â”œâ”€ Max Importance: 0.0000
   â”œâ”€ Min Importance: 0.0000
   â””â”€ Top-5 Important Features: [0]
      â””â”€ Top-5 Values: ['0.0000']

ðŸ“Š Layer: HF_l4_FDCA.slice_att.non_linear
   â”œâ”€ Features: 1
   â”œâ”€ Mean Importance: 0.0000
   â”œâ”€ Max Importance: 0.0000
   â”œâ”€ Min Importance: 0.0000
   â””â”€ Top-5 Important Features: [0]
      â””â”€ Top-5 Values: ['0.0000']

ðŸ“Š Layer: HF_l4_FDCA.slice_att.mean
   â”œâ”€ Features: 1
   â”œâ”€ Mean Importance: 0.0000
   â”œâ”€ Max Importance: 0.0000
   â”œâ”€ Min Importance: 0.0000
   â””â”€ Top-5 Important Features: [0]
      â””â”€ Top-5 Values: ['0.0000']

ðŸ“Š Layer: HF_l4_FDCA.slice_att.log_diag
   â”œâ”€ Features: 1
   â”œâ”€ Mean Importance: 0.0000
   â”œâ”€ Max Importance: 0.0000
   â”œâ”€ Min Importance: 0.0000
   â””â”€ Top-5 Important Features: [0]
      â””â”€ Top-5 Values: ['0.0000']

ðŸ“Š Layer: HF_l4_FDCA.slice_att.factor
   â”œâ”€ Features: 1
   â”œâ”€ Mean Importance: 0.0000
   â”œâ”€ Max Importance: 0.0000
   â”œâ”€ Min Importance: 0.0000
   â””â”€ Top-5 Important Features: [0]
      â””â”€ Top-5 Values: ['0.0000']

ðŸ“Š Layer: HF_l4_FDCA.slice_att
   â”œâ”€ Features: 1
   â”œâ”€ Mean Importance: 0.0074
   â”œâ”€ Max Importance: 0.0074
   â”œâ”€ Min Importance: 0.0074
   â””â”€ Top-5 Important Features: [0]
      â””â”€ Top-5 Values: ['0.0074']

ðŸ“Š Layer: HF_l4_FDCA
   â”œâ”€ Features: 1
   â”œâ”€ Mean Importance: 1.2604
   â”œâ”€ Max Importance: 1.2604
   â”œâ”€ Min Importance: 1.2604
   â””â”€ Top-5 Important Features: [0]
      â””â”€ Top-5 Values: ['1.2604']

ðŸ“Š Layer: HF_l5_FDCA.semantic_att
   â”œâ”€ Features: 1
   â”œâ”€ Mean Importance: 0.0707
   â”œâ”€ Max Importance: 0.0707
   â”œâ”€ Min Importance: 0.0707
   â””â”€ Top-5 Important Features: [0]
      â””â”€ Top-5 Values: ['0.0707']

ðŸ“Š Layer: HF_l5_FDCA.positional_att.conv
   â”œâ”€ Features: 1
   â”œâ”€ Mean Importance: 13.0628
   â”œâ”€ Max Importance: 13.0628
   â”œâ”€ Min Importance: 13.0628
   â””â”€ Top-5 Important Features: [0]
      â””â”€ Top-5 Values: ['13.0628']

ðŸ“Š Layer: HF_l5_FDCA.positional_att
   â”œâ”€ Features: 1
   â”œâ”€ Mean Importance: 0.0001
   â”œâ”€ Max Importance: 0.0001
   â”œâ”€ Min Importance: 0.0001
   â””â”€ Top-5 Important Features: [0]
      â””â”€ Top-5 Values: ['0.0001']

ðŸ“Š Layer: HF_l5_FDCA.slice_att.linear.0
   â”œâ”€ Features: 1
   â”œâ”€ Mean Importance: 0.0000
   â”œâ”€ Max Importance: 0.0000
   â”œâ”€ Min Importance: 0.0000
   â””â”€ Top-5 Important Features: [0]
      â””â”€ Top-5 Values: ['0.0000']

ðŸ“Š Layer: HF_l5_FDCA.slice_att.linear.1
   â”œâ”€ Features: 1
   â”œâ”€ Mean Importance: 0.0000
   â”œâ”€ Max Importance: 0.0000
   â”œâ”€ Min Importance: 0.0000
   â””â”€ Top-5 Important Features: [0]
      â””â”€ Top-5 Values: ['0.0000']

ðŸ“Š Layer: HF_l5_FDCA.slice_att.linear.2
   â”œâ”€ Features: 1
   â”œâ”€ Mean Importance: 0.0000
   â”œâ”€ Max Importance: 0.0000
   â”œâ”€ Min Importance: 0.0000
   â””â”€ Top-5 Important Features: [0]
      â””â”€ Top-5 Values: ['0.0000']

ðŸ“Š Layer: HF_l5_FDCA.slice_att.linear
   â”œâ”€ Features: 1
   â”œâ”€ Mean Importance: 0.0000
   â”œâ”€ Max Importance: 0.0000
   â”œâ”€ Min Importance: 0.0000
   â””â”€ Top-5 Important Features: [0]
      â””â”€ Top-5 Values: ['0.0000']

ðŸ“Š Layer: HF_l5_FDCA.slice_att.non_linear
   â”œâ”€ Features: 1
   â”œâ”€ Mean Importance: 0.0000
   â”œâ”€ Max Importance: 0.0000
   â”œâ”€ Min Importance: 0.0000
   â””â”€ Top-5 Important Features: [0]
      â””â”€ Top-5 Values: ['0.0000']

ðŸ“Š Layer: HF_l5_FDCA.slice_att.mean
   â”œâ”€ Features: 1
   â”œâ”€ Mean Importance: 0.0000
   â”œâ”€ Max Importance: 0.0000
   â”œâ”€ Min Importance: 0.0000
   â””â”€ Top-5 Important Features: [0]
      â””â”€ Top-5 Values: ['0.0000']

ðŸ“Š Layer: HF_l5_FDCA.slice_att.log_diag
   â”œâ”€ Features: 1
   â”œâ”€ Mean Importance: 0.0000
   â”œâ”€ Max Importance: 0.0000
   â”œâ”€ Min Importance: 0.0000
   â””â”€ Top-5 Important Features: [0]
      â””â”€ Top-5 Values: ['0.0000']

ðŸ“Š Layer: HF_l5_FDCA.slice_att.factor
   â”œâ”€ Features: 1
   â”œâ”€ Mean Importance: 0.0000
   â”œâ”€ Max Importance: 0.0000
   â”œâ”€ Min Importance: 0.0000
   â””â”€ Top-5 Important Features: [0]
      â””â”€ Top-5 Values: ['0.0000']

ðŸ“Š Layer: HF_l5_FDCA.slice_att
   â”œâ”€ Features: 1
   â”œâ”€ Mean Importance: 0.0003
   â”œâ”€ Max Importance: 0.0003
   â”œâ”€ Min Importance: 0.0003
   â””â”€ Top-5 Important Features: [0]
      â””â”€ Top-5 Values: ['0.0003']

ðŸ“Š Layer: HF_l5_FDCA
   â”œâ”€ Features: 1
   â”œâ”€ Mean Importance: 0.0002
   â”œâ”€ Max Importance: 0.0002
   â”œâ”€ Min Importance: 0.0002
   â””â”€ Top-5 Important Features: [0]
      â””â”€ Top-5 Values: ['0.0002']

======================================================================
âœ“ Mechanistic analysis complete

[3] Generating Grad-CAM...
Warning: Failed to generate CAM for class 0: element 0 of tensors does not require grad and does not have a grad_fn
Warning: Failed to generate CAM for class 1: element 0 of tensors does not require grad and does not have a grad_fn
Warning: Failed to generate CAM for class 2: element 0 of tensors does not require grad and does not have a grad_fn
Warning: Failed to generate CAM for class 3: element 0 of tensors does not require grad and does not have a grad_fn
[4] Analyzing frequency components...
âœ“ Saved: outputs/xai_2025-11-15_17-25-23/freq_component/sample_0036_freq_comp.png
âœ“ Evaluation complete for sample_0036
Evaluating:  97%|#########7| 37/38 [10:11<00:16, 16.18s/it]
[1] Getting primary prediction...

[METRICS FOR sample_0037]
==================================================
class_0: Dice=0.9913, IoU=0.9827
class_1: Dice=0.7623, IoU=0.6158
class_2: Dice=0.8298, IoU=0.7091
class_3: Dice=0.6369, IoU=0.4673
==================================================

[2] Generating attention maps...
Clipping input data to the valid range for imshow with RGB data ([0..1] for floats or [0..255] for integers).
Clipping input data to the valid range for imshow with RGB data ([0..1] for floats or [0..255] for integers).
âœ“ Saved: outputs/xai_2025-11-15_17-25-23/attention/sample_0037_attention.png

[MECHANISTIC INTERPRETABILITY ANALYSIS]
======================================================================
Sample: sample_0037
======================================================================

ðŸ“Š Layer: LF_l4_FDCA.semantic_att
   â”œâ”€ Features: 1
   â”œâ”€ Mean Importance: 0.1198
   â”œâ”€ Max Importance: 0.1198
   â”œâ”€ Min Importance: 0.1198
   â””â”€ Top-5 Important Features: [0]
      â””â”€ Top-5 Values: ['0.1198']

ðŸ“Š Layer: LF_l4_FDCA.positional_att.conv
   â”œâ”€ Features: 1
   â”œâ”€ Mean Importance: 224.7109
   â”œâ”€ Max Importance: 224.7109
   â”œâ”€ Min Importance: 224.7109
   â””â”€ Top-5 Important Features: [0]
      â””â”€ Top-5 Values: ['224.7109']

ðŸ“Š Layer: LF_l4_FDCA.positional_att
   â”œâ”€ Features: 1
   â”œâ”€ Mean Importance: 41.6412
   â”œâ”€ Max Importance: 41.6412
   â”œâ”€ Min Importance: 41.6412
   â””â”€ Top-5 Important Features: [0]
      â””â”€ Top-5 Values: ['41.6412']

ðŸ“Š Layer: LF_l4_FDCA.slice_att.linear.0
   â”œâ”€ Features: 1
   â”œâ”€ Mean Importance: 66.4878
   â”œâ”€ Max Importance: 66.4878
   â”œâ”€ Min Importance: 66.4878
   â””â”€ Top-5 Important Features: [0]
      â””â”€ Top-5 Values: ['66.4878']

ðŸ“Š Layer: LF_l4_FDCA.slice_att.linear.1
   â”œâ”€ Features: 1
   â”œâ”€ Mean Importance: 56.4019
   â”œâ”€ Max Importance: 56.4019
   â”œâ”€ Min Importance: 56.4019
   â””â”€ Top-5 Important Features: [0]
      â””â”€ Top-5 Values: ['56.4019']

ðŸ“Š Layer: LF_l4_FDCA.slice_att.linear.2
   â”œâ”€ Features: 1
   â”œâ”€ Mean Importance: 53.5220
   â”œâ”€ Max Importance: 53.5220
   â”œâ”€ Min Importance: 53.5220
   â””â”€ Top-5 Important Features: [0]
      â””â”€ Top-5 Values: ['53.5220']

ðŸ“Š Layer: LF_l4_FDCA.slice_att.linear
   â”œâ”€ Features: 1
   â”œâ”€ Mean Importance: 53.5220
   â”œâ”€ Max Importance: 53.5220
   â”œâ”€ Min Importance: 53.5220
   â””â”€ Top-5 Important Features: [0]
      â””â”€ Top-5 Values: ['53.5220']

ðŸ“Š Layer: LF_l4_FDCA.slice_att.non_linear
   â”œâ”€ Features: 1
   â”œâ”€ Mean Importance: 21375882.0000
   â”œâ”€ Max Importance: 21375882.0000
   â”œâ”€ Min Importance: 21375882.0000
   â””â”€ Top-5 Important Features: [0]
      â””â”€ Top-5 Values: ['21375882.0000']

ðŸ“Š Layer: LF_l4_FDCA.slice_att.mean
   â”œâ”€ Features: 1
   â”œâ”€ Mean Importance: 85405456.0000
   â”œâ”€ Max Importance: 85405456.0000
   â”œâ”€ Min Importance: 85405456.0000
   â””â”€ Top-5 Important Features: [0]
      â””â”€ Top-5 Values: ['85405456.0000']

ðŸ“Š Layer: LF_l4_FDCA.slice_att.log_diag
   â”œâ”€ Features: 1
   â”œâ”€ Mean Importance: 5293.3198
   â”œâ”€ Max Importance: 5293.3198
   â”œâ”€ Min Importance: 5293.3198
   â””â”€ Top-5 Important Features: [0]
      â””â”€ Top-5 Values: ['5293.3198']

ðŸ“Š Layer: LF_l4_FDCA.slice_att.factor
   â”œâ”€ Features: 1
   â”œâ”€ Mean Importance: 33081452.0000
   â”œâ”€ Max Importance: 33081452.0000
   â”œâ”€ Min Importance: 33081452.0000
   â””â”€ Top-5 Important Features: [0]
      â””â”€ Top-5 Values: ['33081452.0000']

ðŸ“Š Layer: LF_l4_FDCA.slice_att
   â”œâ”€ Features: 1
   â”œâ”€ Mean Importance: 14464942.0000
   â”œâ”€ Max Importance: 14464942.0000
   â”œâ”€ Min Importance: 14464942.0000
   â””â”€ Top-5 Important Features: [0]
      â””â”€ Top-5 Values: ['14464942.0000']

ðŸ“Š Layer: LF_l4_FDCA
   â”œâ”€ Features: 1
   â”œâ”€ Mean Importance: 1777482592090587136.0000
   â”œâ”€ Max Importance: 1777482592090587136.0000
   â”œâ”€ Min Importance: 1777482592090587136.0000
   â””â”€ Top-5 Important Features: [0]
      â””â”€ Top-5 Values: ['1777482592090587136.0000']

ðŸ“Š Layer: LF_l5_FDCA.semantic_att
   â”œâ”€ Features: 1
   â”œâ”€ Mean Importance: 0.0825
   â”œâ”€ Max Importance: 0.0825
   â”œâ”€ Min Importance: 0.0825
   â””â”€ Top-5 Important Features: [0]
      â””â”€ Top-5 Values: ['0.0825']

ðŸ“Š Layer: LF_l5_FDCA.positional_att.conv
   â”œâ”€ Features: 1
   â”œâ”€ Mean Importance: 67.0450
   â”œâ”€ Max Importance: 67.0450
   â”œâ”€ Min Importance: 67.0450
   â””â”€ Top-5 Important Features: [0]
      â””â”€ Top-5 Values: ['67.0450']

ðŸ“Š Layer: LF_l5_FDCA.positional_att
   â”œâ”€ Features: 1
   â”œâ”€ Mean Importance: 0.0000
   â”œâ”€ Max Importance: 0.0000
   â”œâ”€ Min Importance: 0.0000
   â””â”€ Top-5 Important Features: [0]
      â””â”€ Top-5 Values: ['0.0000']

ðŸ“Š Layer: LF_l5_FDCA.slice_att.linear.0
   â”œâ”€ Features: 1
   â”œâ”€ Mean Importance: 0.0000
   â”œâ”€ Max Importance: 0.0000
   â”œâ”€ Min Importance: 0.0000
   â””â”€ Top-5 Important Features: [0]
      â””â”€ Top-5 Values: ['0.0000']

ðŸ“Š Layer: LF_l5_FDCA.slice_att.linear.1
   â”œâ”€ Features: 1
   â”œâ”€ Mean Importance: 0.0000
   â”œâ”€ Max Importance: 0.0000
   â”œâ”€ Min Importance: 0.0000
   â””â”€ Top-5 Important Features: [0]
      â””â”€ Top-5 Values: ['0.0000']

ðŸ“Š Layer: LF_l5_FDCA.slice_att.linear.2
   â”œâ”€ Features: 1
   â”œâ”€ Mean Importance: 0.0000
   â”œâ”€ Max Importance: 0.0000
   â”œâ”€ Min Importance: 0.0000
   â””â”€ Top-5 Important Features: [0]
      â””â”€ Top-5 Values: ['0.0000']

ðŸ“Š Layer: LF_l5_FDCA.slice_att.linear
   â”œâ”€ Features: 1
   â”œâ”€ Mean Importance: 0.0000
   â”œâ”€ Max Importance: 0.0000
   â”œâ”€ Min Importance: 0.0000
   â””â”€ Top-5 Important Features: [0]
      â””â”€ Top-5 Values: ['0.0000']

ðŸ“Š Layer: LF_l5_FDCA.slice_att.non_linear
   â”œâ”€ Features: 1
   â”œâ”€ Mean Importance: 0.0000
   â”œâ”€ Max Importance: 0.0000
   â”œâ”€ Min Importance: 0.0000
   â””â”€ Top-5 Important Features: [0]
      â””â”€ Top-5 Values: ['0.0000']

ðŸ“Š Layer: LF_l5_FDCA.slice_att.mean
   â”œâ”€ Features: 1
   â”œâ”€ Mean Importance: 0.0017
   â”œâ”€ Max Importance: 0.0017
   â”œâ”€ Min Importance: 0.0017
   â””â”€ Top-5 Important Features: [0]
      â””â”€ Top-5 Values: ['0.0017']

ðŸ“Š Layer: LF_l5_FDCA.slice_att.log_diag
   â”œâ”€ Features: 1
   â”œâ”€ Mean Importance: 0.0000
   â”œâ”€ Max Importance: 0.0000
   â”œâ”€ Min Importance: 0.0000
   â””â”€ Top-5 Important Features: [0]
      â””â”€ Top-5 Values: ['0.0000']

ðŸ“Š Layer: LF_l5_FDCA.slice_att.factor
   â”œâ”€ Features: 1
   â”œâ”€ Mean Importance: 0.0001
   â”œâ”€ Max Importance: 0.0001
   â”œâ”€ Min Importance: 0.0001
   â””â”€ Top-5 Important Features: [0]
      â””â”€ Top-5 Values: ['0.0001']

ðŸ“Š Layer: LF_l5_FDCA.slice_att
   â”œâ”€ Features: 1
   â”œâ”€ Mean Importance: 0.0000
   â”œâ”€ Max Importance: 0.0000
   â”œâ”€ Min Importance: 0.0000
   â””â”€ Top-5 Important Features: [0]
      â””â”€ Top-5 Values: ['0.0000']

ðŸ“Š Layer: LF_l5_FDCA
   â”œâ”€ Features: 1
   â”œâ”€ Mean Importance: 0.0000
   â”œâ”€ Max Importance: 0.0000
   â”œâ”€ Min Importance: 0.0000
   â””â”€ Top-5 Important Features: [0]
      â””â”€ Top-5 Values: ['0.0000']

ðŸ“Š Layer: HF_l4_FDCA.semantic_att
   â”œâ”€ Features: 1
   â”œâ”€ Mean Importance: 0.0836
   â”œâ”€ Max Importance: 0.0836
   â”œâ”€ Min Importance: 0.0836
   â””â”€ Top-5 Important Features: [0]
      â””â”€ Top-5 Values: ['0.0836']

ðŸ“Š Layer: HF_l4_FDCA.positional_att.conv
   â”œâ”€ Features: 1
   â”œâ”€ Mean Importance: 9.0065
   â”œâ”€ Max Importance: 9.0065
   â”œâ”€ Min Importance: 9.0065
   â””â”€ Top-5 Important Features: [0]
      â””â”€ Top-5 Values: ['9.0065']

ðŸ“Š Layer: HF_l4_FDCA.positional_att
   â”œâ”€ Features: 1
   â”œâ”€ Mean Importance: 0.0017
   â”œâ”€ Max Importance: 0.0017
   â”œâ”€ Min Importance: 0.0017
   â””â”€ Top-5 Important Features: [0]
      â””â”€ Top-5 Values: ['0.0017']

ðŸ“Š Layer: HF_l4_FDCA.slice_att.linear.0
   â”œâ”€ Features: 1
   â”œâ”€ Mean Importance: 0.0000
   â”œâ”€ Max Importance: 0.0000
   â”œâ”€ Min Importance: 0.0000
   â””â”€ Top-5 Important Features: [0]
      â””â”€ Top-5 Values: ['0.0000']

ðŸ“Š Layer: HF_l4_FDCA.slice_att.linear.1
   â”œâ”€ Features: 1
   â”œâ”€ Mean Importance: 0.0000
   â”œâ”€ Max Importance: 0.0000
   â”œâ”€ Min Importance: 0.0000
   â””â”€ Top-5 Important Features: [0]
      â””â”€ Top-5 Values: ['0.0000']

ðŸ“Š Layer: HF_l4_FDCA.slice_att.linear.2
   â”œâ”€ Features: 1
   â”œâ”€ Mean Importance: 0.0000
   â”œâ”€ Max Importance: 0.0000
   â”œâ”€ Min Importance: 0.0000
   â””â”€ Top-5 Important Features: [0]
      â””â”€ Top-5 Values: ['0.0000']

ðŸ“Š Layer: HF_l4_FDCA.slice_att.linear
   â”œâ”€ Features: 1
   â”œâ”€ Mean Importance: 0.0000
   â”œâ”€ Max Importance: 0.0000
   â”œâ”€ Min Importance: 0.0000
   â””â”€ Top-5 Important Features: [0]
      â””â”€ Top-5 Values: ['0.0000']

ðŸ“Š Layer: HF_l4_FDCA.slice_att.non_linear
   â”œâ”€ Features: 1
   â”œâ”€ Mean Importance: 0.0000
   â”œâ”€ Max Importance: 0.0000
   â”œâ”€ Min Importance: 0.0000
   â””â”€ Top-5 Important Features: [0]
      â””â”€ Top-5 Values: ['0.0000']

ðŸ“Š Layer: HF_l4_FDCA.slice_att.mean
   â”œâ”€ Features: 1
   â”œâ”€ Mean Importance: 0.0000
   â”œâ”€ Max Importance: 0.0000
   â”œâ”€ Min Importance: 0.0000
   â””â”€ Top-5 Important Features: [0]
      â””â”€ Top-5 Values: ['0.0000']

ðŸ“Š Layer: HF_l4_FDCA.slice_att.log_diag
   â”œâ”€ Features: 1
   â”œâ”€ Mean Importance: 0.0000
   â”œâ”€ Max Importance: 0.0000
   â”œâ”€ Min Importance: 0.0000
   â””â”€ Top-5 Important Features: [0]
      â””â”€ Top-5 Values: ['0.0000']

ðŸ“Š Layer: HF_l4_FDCA.slice_att.factor
   â”œâ”€ Features: 1
   â”œâ”€ Mean Importance: 0.0000
   â”œâ”€ Max Importance: 0.0000
   â”œâ”€ Min Importance: 0.0000
   â””â”€ Top-5 Important Features: [0]
      â””â”€ Top-5 Values: ['0.0000']

ðŸ“Š Layer: HF_l4_FDCA.slice_att
   â”œâ”€ Features: 1
   â”œâ”€ Mean Importance: 0.0043
   â”œâ”€ Max Importance: 0.0043
   â”œâ”€ Min Importance: 0.0043
   â””â”€ Top-5 Important Features: [0]
      â””â”€ Top-5 Values: ['0.0043']

ðŸ“Š Layer: HF_l4_FDCA
   â”œâ”€ Features: 1
   â”œâ”€ Mean Importance: 0.7832
   â”œâ”€ Max Importance: 0.7832
   â”œâ”€ Min Importance: 0.7832
   â””â”€ Top-5 Important Features: [0]
      â””â”€ Top-5 Values: ['0.7832']

ðŸ“Š Layer: HF_l5_FDCA.semantic_att
   â”œâ”€ Features: 1
   â”œâ”€ Mean Importance: 0.0733
   â”œâ”€ Max Importance: 0.0733
   â”œâ”€ Min Importance: 0.0733
   â””â”€ Top-5 Important Features: [0]
      â””â”€ Top-5 Values: ['0.0733']

ðŸ“Š Layer: HF_l5_FDCA.positional_att.conv
   â”œâ”€ Features: 1
   â”œâ”€ Mean Importance: 16.8995
   â”œâ”€ Max Importance: 16.8995
   â”œâ”€ Min Importance: 16.8995
   â””â”€ Top-5 Important Features: [0]
      â””â”€ Top-5 Values: ['16.8995']

ðŸ“Š Layer: HF_l5_FDCA.positional_att
   â”œâ”€ Features: 1
   â”œâ”€ Mean Importance: 0.0001
   â”œâ”€ Max Importance: 0.0001
   â”œâ”€ Min Importance: 0.0001
   â””â”€ Top-5 Important Features: [0]
      â””â”€ Top-5 Values: ['0.0001']

ðŸ“Š Layer: HF_l5_FDCA.slice_att.linear.0
   â”œâ”€ Features: 1
   â”œâ”€ Mean Importance: 0.0000
   â”œâ”€ Max Importance: 0.0000
   â”œâ”€ Min Importance: 0.0000
   â””â”€ Top-5 Important Features: [0]
      â””â”€ Top-5 Values: ['0.0000']

ðŸ“Š Layer: HF_l5_FDCA.slice_att.linear.1
   â”œâ”€ Features: 1
   â”œâ”€ Mean Importance: 0.0000
   â”œâ”€ Max Importance: 0.0000
   â”œâ”€ Min Importance: 0.0000
   â””â”€ Top-5 Important Features: [0]
      â””â”€ Top-5 Values: ['0.0000']

ðŸ“Š Layer: HF_l5_FDCA.slice_att.linear.2
   â”œâ”€ Features: 1
   â”œâ”€ Mean Importance: 0.0000
   â”œâ”€ Max Importance: 0.0000
   â”œâ”€ Min Importance: 0.0000
   â””â”€ Top-5 Important Features: [0]
      â””â”€ Top-5 Values: ['0.0000']

ðŸ“Š Layer: HF_l5_FDCA.slice_att.linear
   â”œâ”€ Features: 1
   â”œâ”€ Mean Importance: 0.0000
   â”œâ”€ Max Importance: 0.0000
   â”œâ”€ Min Importance: 0.0000
   â””â”€ Top-5 Important Features: [0]
      â””â”€ Top-5 Values: ['0.0000']

ðŸ“Š Layer: HF_l5_FDCA.slice_att.non_linear
   â”œâ”€ Features: 1
   â”œâ”€ Mean Importance: 0.0000
   â”œâ”€ Max Importance: 0.0000
   â”œâ”€ Min Importance: 0.0000
   â””â”€ Top-5 Important Features: [0]
      â””â”€ Top-5 Values: ['0.0000']

ðŸ“Š Layer: HF_l5_FDCA.slice_att.mean
   â”œâ”€ Features: 1
   â”œâ”€ Mean Importance: 0.0000
   â”œâ”€ Max Importance: 0.0000
   â”œâ”€ Min Importance: 0.0000
   â””â”€ Top-5 Important Features: [0]
      â””â”€ Top-5 Values: ['0.0000']

ðŸ“Š Layer: HF_l5_FDCA.slice_att.log_diag
   â”œâ”€ Features: 1
   â”œâ”€ Mean Importance: 0.0000
   â”œâ”€ Max Importance: 0.0000
   â”œâ”€ Min Importance: 0.0000
   â””â”€ Top-5 Important Features: [0]
      â””â”€ Top-5 Values: ['0.0000']

ðŸ“Š Layer: HF_l5_FDCA.slice_att.factor
   â”œâ”€ Features: 1
   â”œâ”€ Mean Importance: 0.0000
   â”œâ”€ Max Importance: 0.0000
   â”œâ”€ Min Importance: 0.0000
   â””â”€ Top-5 Important Features: [0]
      â””â”€ Top-5 Values: ['0.0000']

ðŸ“Š Layer: HF_l5_FDCA.slice_att
   â”œâ”€ Features: 1
   â”œâ”€ Mean Importance: 0.0002
   â”œâ”€ Max Importance: 0.0002
   â”œâ”€ Min Importance: 0.0002
   â””â”€ Top-5 Important Features: [0]
      â””â”€ Top-5 Values: ['0.0002']

ðŸ“Š Layer: HF_l5_FDCA
   â”œâ”€ Features: 1
   â”œâ”€ Mean Importance: 0.0002
   â”œâ”€ Max Importance: 0.0002
   â”œâ”€ Min Importance: 0.0002
   â””â”€ Top-5 Important Features: [0]
      â””â”€ Top-5 Values: ['0.0002']

======================================================================
âœ“ Mechanistic analysis complete

[3] Generating Grad-CAM...
Warning: Failed to generate CAM for class 0: element 0 of tensors does not require grad and does not have a grad_fn
Warning: Failed to generate CAM for class 1: element 0 of tensors does not require grad and does not have a grad_fn
Warning: Failed to generate CAM for class 2: element 0 of tensors does not require grad and does not have a grad_fn
Warning: Failed to generate CAM for class 3: element 0 of tensors does not require grad and does not have a grad_fn
[4] Analyzing frequency components...
âœ“ Saved: outputs/xai_2025-11-15_17-25-23/freq_component/sample_0037_freq_comp.png
âœ“ Evaluation complete for sample_0037
Evaluating: 100%|##########| 38/38 [10:28<00:00, 16.42s/it]Evaluating: 100%|##########| 38/38 [10:28<00:00, 16.55s/it]


======================================================================
Running standard validation pass (for exact print_val_loss/print_val_eval output)...
======================================================================

[*] Load /home/manish/BrainTumorHFF/HFF/data/brats20/final/0-test.txt, which contains 38 paired volume
modilities: ['flair_L', 't1_L', 't1ce_L', 't2_L', 'flair_H1', 'flair_H2', 'flair_H3', 'flair_H4', 't1_H1', 't1_H2', 't1_H3', 't1_H4', 't1ce_H1', 't1ce_H2', 't1ce_H3', 't1ce_H4', 't2_H1', 't2_H2', 't2_H3', 't2_H4']
[*] Load /home/manish/BrainTumorHFF/HFF/data/brats20/final/0-test.txt, which contains 38 paired volume
modilities: ['flair_L', 't1_L', 't1ce_L', 't2_L', 'flair_H1', 'flair_H2', 'flair_H3', 'flair_H4', 't1_H1', 't1_H2', 't1_H3', 't1_H4', 't1ce_H1', 't1ce_H2', 't1ce_H3', 't1ce_H4', 't2_H1', 't2_H2', 't2_H3', 't2_H4']
Validation Pass (printing):   0%|          | 0/38 [00:00<?, ?it/s]Validation Pass (printing):   3%|2         | 1/38 [00:06<03:46,  6.11s/it]Validation Pass (printing):   5%|5         | 2/38 [00:08<02:11,  3.65s/it]Validation Pass (printing):   8%|7         | 3/38 [00:10<01:41,  2.89s/it]Validation Pass (printing):  11%|#         | 4/38 [00:11<01:25,  2.51s/it]Validation Pass (printing):  13%|#3        | 5/38 [00:13<01:14,  2.26s/it]Validation Pass (printing):  16%|#5        | 6/38 [00:15<01:07,  2.10s/it]Validation Pass (printing):  18%|#8        | 7/38 [00:17<01:02,  2.03s/it]Validation Pass (printing):  21%|##1       | 8/38 [00:19<01:00,  2.02s/it]Validation Pass (printing):  24%|##3       | 9/38 [00:21<00:58,  2.03s/it]Validation Pass (printing):  26%|##6       | 10/38 [00:23<00:58,  2.08s/it]Validation Pass (printing):  29%|##8       | 11/38 [00:25<00:56,  2.08s/it]Validation Pass (printing):  32%|###1      | 12/38 [00:28<00:55,  2.13s/it]Validation Pass (printing):  34%|###4      | 13/38 [00:30<00:53,  2.15s/it]Validation Pass (printing):  37%|###6      | 14/38 [00:32<00:52,  2.18s/it]Validation Pass (printing):  39%|###9      | 15/38 [00:34<00:50,  2.18s/it]Validation Pass (printing):  42%|####2     | 16/38 [00:36<00:46,  2.11s/it]Validation Pass (printing):  45%|####4     | 17/38 [00:38<00:45,  2.16s/it]Validation Pass (printing):  47%|####7     | 18/38 [00:41<00:44,  2.22s/it]Validation Pass (printing):  50%|#####     | 19/38 [00:43<00:42,  2.25s/it]Validation Pass (printing):  53%|#####2    | 20/38 [00:45<00:40,  2.27s/it]Validation Pass (printing):  55%|#####5    | 21/38 [00:48<00:38,  2.25s/it]Validation Pass (printing):  58%|#####7    | 22/38 [00:50<00:36,  2.26s/it]Validation Pass (printing):  61%|######    | 23/38 [00:52<00:33,  2.24s/it]Validation Pass (printing):  63%|######3   | 24/38 [00:54<00:31,  2.22s/it]Validation Pass (printing):  66%|######5   | 25/38 [00:57<00:29,  2.29s/it]Validation Pass (printing):  68%|######8   | 26/38 [00:59<00:27,  2.32s/it]Validation Pass (printing):  71%|#######1  | 27/38 [01:01<00:25,  2.36s/it]Validation Pass (printing):  74%|#######3  | 28/38 [01:04<00:23,  2.36s/it]Validation Pass (printing):  76%|#######6  | 29/38 [01:06<00:21,  2.35s/it]Validation Pass (printing):  79%|#######8  | 30/38 [01:09<00:19,  2.38s/it]Validation Pass (printing):  82%|########1 | 31/38 [01:10<00:14,  2.08s/it]Validation Pass (printing):  84%|########4 | 32/38 [01:11<00:10,  1.80s/it]Validation Pass (printing):  87%|########6 | 33/38 [01:12<00:08,  1.61s/it]Validation Pass (printing):  89%|########9 | 34/38 [01:14<00:05,  1.48s/it]Validation Pass (printing):  92%|#########2| 35/38 [01:15<00:04,  1.40s/it]Validation Pass (printing):  95%|#########4| 36/38 [01:16<00:02,  1.34s/it]Validation Pass (printing):  97%|#########7| 37/38 [01:17<00:01,  1.29s/it]Validation Pass (printing): 100%|##########| 38/38 [01:18<00:00,  1.26s/it]Validation Pass (printing): 100%|##########| 38/38 [01:19<00:00,  2.08s/it]
---------------------------------------------------------------
| Val Sup Loss LF: 0.2063 | Val Sup Loss HF: 0.2209 |
---------------------------------------------------------------
| Val ET Dice LF: 0.7838        | Val ET Dice HF: 0.7630        |
| Val ET HD95 LF: nan           | Val ET HD95 HF: nan           |
| Val TC Dice LF: 0.8445        | Val TC Dice HF: 0.8452        |
| Val TC HD95 LF: 5.7768        | Val TC HD95 HF: 6.3424        |
| Val WT Dice LF: 0.9079        | Val WT Dice HF: 0.8953        |
| Val WT HD95 LF: 5.6439        | Val WT HD95 HF: 7.0914        |

======================================================================
EVALUATION COMPLETE
======================================================================
Samples evaluated (XAI pass): 38
Output directory: ./outputs
All XAI outputs saved with 600 DPI resolution (if enabled)

Generated outputs:
 - Attention maps: True
 - Grad-CAM visualizations: True
 - Frequency analysis: True
 - Dice & IoU Metrics (per-sample): YES âœ“
 - Mechanistic Interpretability: YES âœ“
