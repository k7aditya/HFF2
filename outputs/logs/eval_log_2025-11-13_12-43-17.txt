
======================================================================
HFF-NET ENHANCED EVALUATION WITH XAI
======================================================================
Log file: ./outputs/logs/eval_log_2025-11-13_12-43-17.txt
Output directory: ./outputs

[Loading] Model from /home/manish/BrainTumorHFF/HFF/saved_models/checkpoints/hff/brats20/all/hff-l=0.3-e=200-s=50-g=0.55-b=1-cw=15-w=3-100L-H-2025-11-13_02-00-01/best_Result2_et_0.6920_tc_0.7381_wt_0.8162.pth
✓ Model loaded successfully
✓ XAI modules initialized
✓ Output directory: outputs

[Loading] Data from /home/manish/BrainTumorHFF/HFF/data/brats20/final/0-train.txt
[*] Load /home/manish/BrainTumorHFF/HFF/data/brats20/final/0-train.txt, which contains 295 paired volume
modilities: ['flair_L', 't1_L', 't1ce_L', 't2_L', 'flair_H1', 'flair_H2', 'flair_H3', 'flair_H4', 't1_H1', 't1_H2', 't1_H3', 't1_H4', 't1ce_H1', 't1ce_H2', 't1ce_H3', 't1ce_H4', 't2_H1', 't2_H2', 't2_H3', 't2_H4']
[*] Load /home/manish/BrainTumorHFF/HFF/data/brats20/final/0-train.txt, which contains 295 paired volume
modilities: ['flair_L', 't1_L', 't1ce_L', 't2_L', 'flair_H1', 'flair_H2', 'flair_H3', 'flair_H4', 't1_H1', 't1_H2', 't1_H3', 't1_H4', 't1ce_H1', 't1ce_H2', 't1ce_H3', 't1ce_H4', 't2_H1', 't2_H2', 't2_H3', 't2_H4']
✓ Data loaded: 295 batches

[Starting] Evaluation...
======================================================================
Evaluating:   0%|          | 0/295 [00:00<?, ?it/s]
[1] Getting primary prediction...
[2] Generating attention maps...
Warning: Attention generation failed: Invalid shape (128, 128, 128) for image data
[3] Generating Grad-CAM...
Warning: Failed to generate CAM for class 0: element 0 of tensors does not require grad and does not have a grad_fn
Warning: Failed to generate CAM for class 1: element 0 of tensors does not require grad and does not have a grad_fn
Warning: Failed to generate CAM for class 2: element 0 of tensors does not require grad and does not have a grad_fn
Warning: Failed to generate CAM for class 3: element 0 of tensors does not require grad and does not have a grad_fn
[4] Analyzing frequency components...
Warning: Frequency analysis failed: Invalid shape (128, 128, 128) for image data
✓ Evaluation complete for sample_0000
Evaluating:   0%|          | 1/295 [00:08<40:33,  8.28s/it]
[1] Getting primary prediction...
[2] Generating attention maps...
Warning: Attention generation failed: Invalid shape (128, 128, 128) for image data
[3] Generating Grad-CAM...
Warning: Failed to generate CAM for class 0: element 0 of tensors does not require grad and does not have a grad_fn
Warning: Failed to generate CAM for class 1: element 0 of tensors does not require grad and does not have a grad_fn
Warning: Failed to generate CAM for class 2: element 0 of tensors does not require grad and does not have a grad_fn
Warning: Failed to generate CAM for class 3: element 0 of tensors does not require grad and does not have a grad_fn
[4] Analyzing frequency components...
Warning: Frequency analysis failed: Invalid shape (128, 128, 128) for image data
✓ Evaluation complete for sample_0001
Evaluating:   1%|          | 2/295 [00:10<22:05,  4.52s/it]
[1] Getting primary prediction...
[2] Generating attention maps...
Warning: Attention generation failed: Invalid shape (128, 128, 128) for image data
[3] Generating Grad-CAM...
Warning: Failed to generate CAM for class 0: element 0 of tensors does not require grad and does not have a grad_fn
Warning: Failed to generate CAM for class 1: element 0 of tensors does not require grad and does not have a grad_fn
Warning: Failed to generate CAM for class 2: element 0 of tensors does not require grad and does not have a grad_fn
Warning: Failed to generate CAM for class 3: element 0 of tensors does not require grad and does not have a grad_fn
[4] Analyzing frequency components...
Warning: Frequency analysis failed: Invalid shape (128, 128, 128) for image data
✓ Evaluation complete for sample_0002
Evaluating:   1%|1         | 3/295 [00:12<17:15,  3.55s/it]
[1] Getting primary prediction...
[2] Generating attention maps...
Warning: Attention generation failed: Invalid shape (128, 128, 128) for image data
[3] Generating Grad-CAM...
Warning: Failed to generate CAM for class 0: element 0 of tensors does not require grad and does not have a grad_fn
Warning: Failed to generate CAM for class 1: element 0 of tensors does not require grad and does not have a grad_fn
Warning: Failed to generate CAM for class 2: element 0 of tensors does not require grad and does not have a grad_fn
Warning: Failed to generate CAM for class 3: element 0 of tensors does not require grad and does not have a grad_fn
[4] Analyzing frequency components...
Warning: Frequency analysis failed: Invalid shape (128, 128, 128) for image data
✓ Evaluation complete for sample_0003
Evaluating:   1%|1         | 4/295 [00:14<13:54,  2.87s/it]
[1] Getting primary prediction...
[2] Generating attention maps...
Warning: Attention generation failed: Invalid shape (128, 128, 128) for image data
[3] Generating Grad-CAM...
Warning: Failed to generate CAM for class 0: element 0 of tensors does not require grad and does not have a grad_fn
Warning: Failed to generate CAM for class 1: element 0 of tensors does not require grad and does not have a grad_fn
Warning: Failed to generate CAM for class 2: element 0 of tensors does not require grad and does not have a grad_fn
Warning: Failed to generate CAM for class 3: element 0 of tensors does not require grad and does not have a grad_fn
[4] Analyzing frequency components...
Warning: Frequency analysis failed: Invalid shape (128, 128, 128) for image data
✓ Evaluation complete for sample_0004
Evaluating:   2%|1         | 5/295 [00:16<11:58,  2.48s/it]Evaluating:   2%|1         | 5/295 [00:19<18:56,  3.92s/it]

======================================================================
EVALUATION COMPLETE
======================================================================
Samples evaluated: 5
Output directory: ./outputs
All results saved with 600 DPI resolution

Generated outputs:
  - Attention maps: True
  - Grad-CAM visualizations: True
  - Frequency analysis: True
